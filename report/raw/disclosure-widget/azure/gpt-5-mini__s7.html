<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#1368d6;
      --bg:#f7f9fc;
      --card:#fff;
      --muted:#6b7280;
      --radius:8px;
      --gap:12px;
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,var(--bg), #fff);
      color:#111827;
      margin:24px;
      line-height:1.45;
    }

    h1 { font-size:1.35rem; margin:0 0 18px 0; }
    p.lead { margin-top:6px; color:var(--muted); }

    .example {
      background: var(--card);
      border: 1px solid rgba(17,24,39,0.06);
      padding:16px;
      border-radius: var(--radius);
      box-shadow: 0 1px 2px rgba(16,24,40,0.03);
      max-width:760px;
      margin:18px 0;
    }

    /* Toggle button visuals */
    .toggle {
      display:flex;
      align-items:center;
      gap:12px;
      width:100%;
      padding:12px 14px;
      background:linear-gradient(180deg,#fff,#fbfdff);
      border:1px solid rgba(17,24,39,0.06);
      border-radius:8px;
      cursor:pointer;
      font-weight:600;
      color:#0f1724;
      text-align:left;
      transition: box-shadow .12s ease, transform .06s ease;
    }
    .toggle:active { transform: translateY(1px); }
    .toggle:focus { outline: 3px solid rgba(19,104,214,0.16); outline-offset:2px; box-shadow:0 4px 12px rgba(19,104,214,0.06); }

    .toggle .label { flex:1; }
    .toggle .meta { color:var(--muted); font-weight:500; font-size:0.9rem; }

    .icon {
      width:18px;
      height:18px;
      display:inline-block;
      transition: transform 200ms ease;
      transform-origin:50% 50%;
      color:var(--accent);
      flex-shrink:0;
    }
    /* rotate arrow when expanded */
    button[aria-expanded="true"] .icon { transform: rotate(90deg); }

    /* Controlled content container */
    .details {
      overflow: hidden;
      max-height: 0px; /* collapsed */
      transition: max-height 320ms cubic-bezier(.2,.9,.2,1);
      margin-top:12px;
      border-radius:8px;
      background: linear-gradient(180deg,#fbfdff,#fff);
      border:1px solid rgba(17,24,39,0.03);
      padding: 0 12px;
    }

    /* inner padding for revealed content */
    .details .inner {
      padding: 12px 6px 16px 6px;
    }

    /* small note */
    .hint {
      font-size:0.9rem;
      color:var(--muted);
      margin-top:8px;
    }

    /* Accordion specific spacing */
    .accordion .item { margin-bottom:10px; }
    .accordion .item:last-child { margin-bottom:0; }

    /* Simple demo content styles */
    .demo-card {
      padding:10px;
      border-radius:6px;
      background:linear-gradient(180deg,#fff,#fbfdff);
      border:1px solid rgba(17,24,39,0.04);
    }

    /* make sure the region label is visually distinct */
    .sr-only {
      position: absolute;
      width:1px;
      height:1px;
      padding:0;
      margin:-1px;
      overflow:hidden;
      clip:rect(0,0,0,0);
      white-space:nowrap;
      border:0;
    }
  </style>
</head>
<body>
  <h1>Expand / Collapse Widget Examples</h1>
  <p class="lead">Two accessible examples are shown below. Each widget is wrapped in a container with the class "example". The element that is shown/hidden uses the class "details".</p>

  <!-- Example 1: Single simple toggle -->
  <div class="example" aria-label="Single toggle example">
    <div>
      <button id="toggle1" class="toggle" aria-expanded="false" aria-controls="content1">
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path fill="currentColor" d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6z"/>
        </svg>
        <span class="label">Show more information</span>
        <span class="meta">Details</span>
      </button>

      <div id="content1" class="details" role="region" aria-hidden="true" aria-labelledby="toggle1">
        <div class="inner">
          <div class="demo-card">
            <strong>Quick note:</strong>
            <p style="margin:8px 0 0 0; color:#374151;">
              This panel demonstrates a single expand/collapse control. Use the button to toggle visibility. The button uses aria-expanded and aria-controls while the content uses the class "details" as requested.
            </p>
          </div>
        </div>
      </div>

      <div class="hint">Tip: The button can be toggled with Enter or Space. Press Escape while focused on the button to close.</div>
    </div>
  </div>

  <!-- Example 2: Accordion with three items (only one open at a time) -->
  <div class="example accordion" aria-label="Accordion example">
    <p style="margin:0 0 12px 0; font-weight:600;">Accordion (only one open)</p>

    <div class="item">
      <button id="acc1-btn" class="toggle" aria-expanded="false" aria-controls="acc1">
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path fill="currentColor" d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6z"/>
        </svg>
        <span class="label">Accordion item one</span>
        <span class="meta">Overview</span>
      </button>
      <div id="acc1" class="details" role="region" aria-hidden="true" aria-labelledby="acc1-btn">
        <div class="inner">
          <div class="demo-card">
            <p style="margin:0; color:#374151;">Item one contains some introductory content. When you open another accordion item in this example, this one will close automatically.</p>
          </div>
        </div>
      </div>
    </div>

    <div class="item">
      <button id="acc2-btn" class="toggle" aria-expanded="false" aria-controls="acc2">
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path fill="currentColor" d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6z"/>
        </svg>
        <span class="label">Accordion item two</span>
        <span class="meta">Details</span>
      </button>
      <div id="acc2" class="details" role="region" aria-hidden="true" aria-labelledby="acc2-btn">
        <div class="inner">
          <div class="demo-card">
            <p style="margin:0; color:#374151;">Item two holds additional details. The container for this controlled content has the class "details".</p>
            <ul style="margin:8px 0 0 18px; color:#374151;">
              <li>Point A</li>
              <li>Point B</li>
              <li>Point C</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="item">
      <button id="acc3-btn" class="toggle" aria-expanded="false" aria-controls="acc3">
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path fill="currentColor" d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6z"/>
        </svg>
        <span class="label">Accordion item three</span>
        <span class="meta">More</span>
      </button>
      <div id="acc3" class="details" role="region" aria-hidden="true" aria-labelledby="acc3-btn">
        <div class="inner">
          <div class="demo-card">
            <p style="margin:0; color:#374151;">Item three demonstrates longer content. Resize the window or add content dynamically and the transition will adapt when opening or closing.</p>
            <p style="margin:8px 0 0 0; color:#374151;">Try opening this item and then another to see the accordion behavior.</p>
          </div>
        </div>
      </div>
    </div>

    <div class="hint">This example auto-closes other items when you open a new one. All content containers use the class "details".</div>
  </div>

  <script>
    (function () {
      /**
       * Utility to open a details region with animated max-height and ARIA updates.
       * @param {HTMLElement} button - the controlling button (aria-controls points to target)
       */
      function openDetails(button) {
        const id = button.getAttribute('aria-controls');
        const panel = document.getElementById(id);
        if (!panel) return;

        // ARIA
        button.setAttribute('aria-expanded', 'true');
        panel.setAttribute('aria-hidden', 'false');
        panel.classList.add('open');

        // If currently collapsed (maxHeight 0 or missing), set explicit height to animate.
        // Ensure we can transition from current height to target height.
        // Set the max-height to the scrollHeight to animate open.
        // Then after transition end, set max-height to 'none' so content can grow naturally.
        // Start by making sure it's not 'none' so a transition can occur.
        panel.style.maxHeight = panel.scrollHeight + 'px';

        function onEnd(e) {
          if (e.target !== panel) return;
          // After opening, allow natural height
          panel.style.maxHeight = 'none';
          panel.removeEventListener('transitionend', onEnd);
        }
        panel.addEventListener('transitionend', onEnd);
      }

      /**
       * Close a details region with animation and ARIA updates.
       * @param {HTMLElement} button
       */
      function closeDetails(button) {
        const id = button.getAttribute('aria-controls');
        const panel = document.getElementById(id);
        if (!panel) return;

        button.setAttribute('aria-expanded', 'false');
        panel.setAttribute('aria-hidden', 'true');

        // To animate from 'none' we must set an explicit maxHeight equal to current height first.
        // If maxHeight is 'none' (no explicit style) set it to current computed height.
        if (panel.style.maxHeight === 'none' || panel.style.maxHeight === '') {
          // compute current height
          const currentHeight = panel.scrollHeight;
          panel.style.maxHeight = currentHeight + 'px';
          // Force a reflow so browser registers the starting height
          // eslint-disable-next-line no-unused-expressions
          panel.offsetHeight;
        }

        // Then set maxHeight to 0 to animate closing
        panel.style.maxHeight = '0px';
        panel.classList.remove('open');
      }

      // Initialize all examples
      document.querySelectorAll('.example').forEach(example => {
        // Find all buttons in this example that have aria-controls
        const buttons = Array.from(example.querySelectorAll('button[aria-controls]'));

        // Set initial collapsed state for each linked panel
        buttons.forEach(button => {
          const id = button.getAttribute('aria-controls');
          const panel = document.getElementById(id);
          if (!panel) return;

          // Ensure panels start collapsed unless aria-expanded="true"
          const expanded = button.getAttribute('aria-expanded') === 'true';
          if (expanded) {
            // If expanded by initial markup, set to open without jump
            panel.style.maxHeight = 'none';
            panel.setAttribute('aria-hidden', 'false');
            panel.classList.add('open');
            button.setAttribute('aria-expanded', 'true');
          } else {
            panel.style.maxHeight = '0px';
            panel.setAttribute('aria-hidden', 'true');
            panel.classList.remove('open');
            button.setAttribute('aria-expanded', 'false');
          }

          // Click toggles
          button.addEventListener('click', (ev) => {
            const isExpanded = button.getAttribute('aria-expanded') === 'true';

            // If the example is an accordion, close others before opening this one
            if (!isExpanded && example.classList.contains('accordion')) {
              buttons.forEach(b => {
                if (b !== button) closeDetails(b);
              });
            }

            if (isExpanded) {
              closeDetails(button);
            } else {
              openDetails(button);
            }
          });

          // Allow Escape key to close the panel when using keyboard
          button.addEventListener('keydown', (ev) => {
            if (ev.key === 'Escape' || ev.key === 'Esc') {
              closeDetails(button);
            }
          });
        });
      });

      // Optional: ensure that when window resizes, open panels that set max-height to 'none' remain correct.
      window.addEventListener('resize', () => {
        document.querySelectorAll('.details').forEach(panel => {
          // If panel is open but has a numeric maxHeight (was opened but not yet set to none),
          // do nothing. If panel is open and maxHeight is 'none', nothing needed.
          // If it is open but has maxHeight 'none', leave as is.
          if (panel.classList.contains('open') && panel.style.maxHeight === 'none') {
            // nothing
          } else if (panel.classList.contains('open')) {
            // adjust to new scrollHeight
            panel.style.maxHeight = panel.scrollHeight + 'px';
          }
        });
      });
    })();
  </script>
</body>
</html>