<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent: #2563eb;
      --bg: #f8fafc;
      --panel-bg: #ffffff;
      --border: #e6eefb;
      --muted: #6b7280;
      --radius: 8px;
      --duration: 260ms;
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      margin: 28px;
      background: radial-gradient(circle at 10% 10%, #f1f5f9 0%, #ffffff 40%), var(--bg);
      color: #0f172a;
    }

    h1{
      margin: 0 0 18px 0;
      font-size: 20px;
      letter-spacing: -0.2px;
    }

    p.lead{
      margin: 0 0 22px 0;
      color: var(--muted);
      font-size: 14px;
    }

    /* Example wrapper */
    .example{
      background: var(--panel-bg);
      border: 1px solid var(--border);
      padding: 12px;
      border-radius: var(--radius);
      margin: 14px 0;
      box-shadow: 0 1px 2px rgba(12,18,40,0.03);
    }

    /* Toggle button */
    .toggle{
      -webkit-appearance: none;
      appearance: none;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      background: transparent;
      border: 1px solid transparent;
      border-radius: 6px;
      font-size: 15px;
      cursor: pointer;
      color: #071133;
      width: 100%;
      text-align: left;
    }
    .toggle:focus{
      outline: 3px solid rgba(37,99,235,0.12);
      outline-offset: 2px;
    }
    .toggle[aria-expanded="true"]{
      background: linear-gradient(180deg, rgba(37,99,235,0.04), transparent);
    }

    .toggle .title{
      flex: 1 1 auto;
      font-weight: 600;
    }
    .toggle .summary{
      font-size: 13px;
      color: var(--muted);
      margin-left: 6px;
    }

    /* Chevron */
    .toggle .chev{
      width: 18px;
      height: 18px;
      display: inline-block;
      transition: transform var(--duration) ease;
      flex: 0 0 18px;
      color: var(--accent);
      transform-origin: center;
    }
    .toggle[aria-expanded="true"] .chev{
      transform: rotate(180deg);
    }

    /* Details (controlled content) */
    .details{
      overflow: hidden;
      height: 0;
      opacity: 0;
      margin-top: 10px;
      border-top: 1px solid var(--border);
      padding-top: 10px;
      transition: opacity var(--duration) ease;
      will-change: height, opacity;
    }
    .details.open{
      opacity: 1;
    }

    .details > *:first-child{
      margin-top: 0;
    }

    .panel-row{
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 8px;
      align-items: center;
    }

    .small{
      font-size: 13px;
      color: var(--muted);
    }

    /* Reduced motion handling */
    @media (prefers-reduced-motion: reduce){
      .details{
        transition: none;
      }
      .toggle .chev{
        transition: none;
      }
    }

    /* Demo - nested visualization */
    .nested{
      border-left: 3px dashed rgba(37,99,235,0.06);
      padding-left: 10px;
      margin-top: 8px;
    }

    .note{
      font-size: 13px;
      color: var(--muted);
      margin-top: 8px;
    }
  </style>
</head>
<body>
  <h1>Expand / Collapse Widgets</h1>
  <p class="lead">Each widget below is wrapped in a container with the class "example". The content that is shown/hidden has the class "details". Click the heading to toggle.</p>

  <!-- Example 1: Basic collapsed -->
  <div class="example" data-example="1">
    <button class="toggle" aria-expanded="false" aria-controls="details-1" id="toggle-1">
      <span class="title">Basic info</span>
      <span class="summary">Click to reveal details</span>
      <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path fill="currentColor" d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"/>
      </svg>
    </button>

    <div class="details" id="details-1" role="region" aria-labelledby="toggle-1">
      <div class="panel-row">
        <div>
          <strong>What you'll find here</strong>
          <div class="note">Short explanation and links.</div>
        </div>
        <div class="small">Updated today</div>
      </div>
      <p style="margin-top:10px">
        This is a simple, collapsible panel that contains a brief paragraph. Use this pattern to keep interfaces concise and progressive.
      </p>
      <p class="note">Tip: Use aria-controls on the toggle and aria-labelledby on the details for assistive technology.</p>
    </div>
  </div>

  <!-- Example 2: Initially expanded -->
  <div class="example" data-example="2">
    <button class="toggle" aria-expanded="true" aria-controls="details-2" id="toggle-2">
      <span class="title">Expanded by default</span>
      <span class="summary">Shows how to initialize open</span>
      <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path fill="currentColor" d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"/>
      </svg>
    </button>

    <div class="details open" id="details-2" role="region" aria-labelledby="toggle-2">
      <p>
        This example starts expanded. The script will respect the aria-expanded attribute when the page loads and open the details section accordingly, animating it if allowed by user preferences.
      </p>
      <div class="nested">
        <strong>Nested content</strong>
        <p class="small">You can place additional controls or nested panels here.</p>
      </div>
    </div>
  </div>

  <!-- Example 3: Longer content -->
  <div class="example" data-example="3">
    <button class="toggle" aria-expanded="false" aria-controls="details-3" id="toggle-3">
      <span class="title">More (long content)</span>
      <span class="summary">Expandable area with more text</span>
      <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path fill="currentColor" d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"/>
      </svg>
    </button>

    <div class="details" id="details-3" role="region" aria-labelledby="toggle-3">
      <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse tincidunt, nisl vitae pharetra fermentum, tortor lorem hendrerit nunc, vitae feugiat velit augue nec nibh. Integer non lectus ipsum. Phasellus a arcu ut neque pharetra fermentum.
      </p>
      <p>
        Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Cras porttitor, justo at malesuada feugiat, lectus est porttitor massa, id vehicula urna lacus ut orci. Donec ultricies dui et volutpat dapibus.
      </p>
      <p class="note">Good for FAQs, long descriptions, or code examples that you want to hide by default.</p>
    </div>
  </div>

  <script>
    (function(){
      // Helper: animate open/close using height transitions. Respects prefers-reduced-motion.
      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      function openDetails(details){
        // set explicit height to enable smooth transition
        const startHeight = details.getBoundingClientRect().height;
        details.classList.add('open');
        const targetHeight = details.scrollHeight;

        if(prefersReduced){
          details.style.height = 'auto';
        } else {
          details.style.height = startHeight + 'px';
          // force style to apply
          details.getBoundingClientRect();
          details.style.transition = 'height var(--duration) ease';
          requestAnimationFrame(() => {
            details.style.height = targetHeight + 'px';
            // when transition ends, clear height to allow natural growth
            const cleanup = () => {
              details.style.height = 'auto';
              details.style.transition = '';
              details.removeEventListener('transitionend', cleanup);
            };
            details.addEventListener('transitionend', cleanup);
          });
        }

        details.setAttribute('aria-hidden', 'false');
      }

      function closeDetails(details){
        const startHeight = details.getBoundingClientRect().height;
        if(prefersReduced){
          details.classList.remove('open');
          details.style.height = '0';
        } else {
          details.style.height = startHeight + 'px';
          // force
          details.getBoundingClientRect();
          details.style.transition = 'height var(--duration) ease, opacity var(--duration) ease';
          requestAnimationFrame(() => {
            details.style.height = '0';
            // after transition, remove open class
            const cleanup = () => {
              details.classList.remove('open');
              details.style.transition = '';
              details.removeEventListener('transitionend', cleanup);
            };
            details.addEventListener('transitionend', cleanup);
          });
        }
        details.setAttribute('aria-hidden', 'true');
      }

      // Initialize based on aria-expanded
      document.querySelectorAll('.example').forEach((example, index) => {
        const toggle = example.querySelector('.toggle');
        const details = example.querySelector('.details');

        if(!toggle || !details) return;

        // Ensure ids exist
        if(!toggle.id) toggle.id = 'toggle-auto-' + index;
        if(!details.id) details.id = 'details-auto-' + index;

        toggle.setAttribute('aria-controls', details.id);
        details.setAttribute('role', details.getAttribute('role') || 'region');
        details.setAttribute('aria-labelledby', toggle.id);

        const expandedAttr = toggle.getAttribute('aria-expanded');
        const isExpanded = expandedAttr === 'true';

        if(isExpanded){
          details.classList.add('open');
          details.style.height = 'auto';
          details.setAttribute('aria-hidden','false');
        } else {
          details.classList.remove('open');
          details.style.height = '0';
          details.setAttribute('aria-hidden','true');
        }

        toggle.addEventListener('click', () => {
          const currently = toggle.getAttribute('aria-expanded') === 'true';
          if(currently){
            // collapse
            toggle.setAttribute('aria-expanded','false');
            closeDetails(details);
          } else {
            toggle.setAttribute('aria-expanded','true');
            openDetails(details);
          }
        });

        // keyboard: support Home/End to open/close quickly (optional)
        toggle.addEventListener('keydown', (ev) => {
          if(ev.key === 'Home'){
            ev.preventDefault();
            toggle.setAttribute('aria-expanded','true');
            openDetails(details);
            toggle.focus();
          } else if(ev.key === 'End'){
            ev.preventDefault();
            toggle.setAttribute('aria-expanded','false');
            closeDetails(details);
            toggle.focus();
          }
        });

      });
    })();
  </script>
</body>
</html>