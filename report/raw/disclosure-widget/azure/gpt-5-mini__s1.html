<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Expand/Collapse Widget Examples</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg:#f7f9fb;
      --card:#ffffff;
      --border:#e1e6ea;
      --accent:#0b69ff;
      --muted:#55636d;
      --radius:8px;
      --shadow: 0 6px 18px rgba(11,105,255,0.06);
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,var(--bg),#ffffff 60%);
      color: #202a2f;
      margin: 0;
      padding: 32px;
      line-height: 1.45;
    }

    h1{
      margin: 0 0 12px 0;
      font-size: 20px;
    }

    p.lead{
      margin: 0 0 20px 0;
      color: var(--muted);
      font-size: 14px;
    }

    /* Example wrapper */
    .example{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 16px;
      margin: 16px 0;
      box-shadow: var(--shadow);
      max-width: 760px;
    }

    /* Toggle button */
    .toggle{
      display: flex;
      align-items: center;
      gap: 12px;
      width: 100%;
      padding: 12px 14px;
      font-size: 16px;
      font-weight: 600;
      color: #0f2330;
      background: linear-gradient(180deg, #ffffff, #fbfdff);
      border: 1px solid var(--border);
      border-radius: 8px;
      cursor: pointer;
      text-align: left;
      transition: box-shadow .18s ease, transform .08s ease;
    }

    .toggle:focus{
      outline: none;
      box-shadow: 0 0 0 4px rgba(11,105,255,0.12);
    }

    .toggle:active{
      transform: translateY(1px);
    }

    .toggle .icon{
      display: inline-grid;
      place-items: center;
      width: 28px;
      height: 28px;
      border-radius: 6px;
      background: linear-gradient(180deg,#f4f8ff,#eef6ff);
      color: var(--accent);
      font-weight: 700;
    }

    .toggle .label{
      flex: 1;
    }

    .toggle .chev{
      width: 18px;
      height: 18px;
      transform-origin: center;
      transition: transform .22s cubic-bezier(.2,.9,.3,1);
      color: var(--muted);
      display: inline-block;
    }

    .toggle[aria-expanded="true"] .chev{
      transform: rotate(90deg);
      color: var(--accent);
    }

    /* Details area (controlled content) */
    .details{
      overflow: hidden;
      max-height: 0;
      transition: max-height .34s cubic-bezier(.2,.9,.3,1);
      margin-top: 12px;
      border-radius: 8px;
      border: 1px solid var(--border);
      padding: 0 12px;
      background: #fcfeff;
    }

    .details.open{
      /* max-height is controlled inline by JS to allow auto height transitions */
      padding-top: 12px;
      padding-bottom: 12px;
    }

    .details .content{
      color: #263238;
      font-size: 15px;
    }

    /* Small helper note */
    .hint{
      font-size: 12px;
      color: var(--muted);
      margin-top: 8px;
    }

    /* For non-JS users: show details if <noscript> toggles a helper */
    .no-js-show .details{
      max-height: none;
      overflow: visible;
      padding: 12px;
    }
  </style>
</head>
<body>
  <h1>Expand / Collapse Widget (Accessible Examples)</h1>
  <p class="lead">Each widget below demonstrates a fully accessible expand/collapse control. The interactive content container uses the class "details".</p>

  <!-- Example 1 -->
  <div class="example" id="example-1">
    <button id="toggle-1" class="toggle" aria-expanded="false" aria-controls="details-1">
      <span class="icon" aria-hidden="true">+</span>
      <span class="label">More information about the product</span>
      <span class="chev" aria-hidden="true">▸</span>
    </button>

    <div id="details-1" class="details" role="region" aria-labelledby="toggle-1" aria-hidden="true">
      <div class="content">
        <p><strong>Product overview:</strong> This product is designed to be efficient and easy to use. It supports multiple modes and integrates with your existing workflow seamlessly.</p>
        <ul>
          <li>Fast setup — ready in minutes</li>
          <li>Secure by design — encrypted storage</li>
          <li>Extensible — plugin architecture</li>
        </ul>
        <p class="hint">Tip: Press Enter or Space when the button is focused to toggle the section.</p>
      </div>
    </div>
  </div>

  <!-- Example 2 (initially open) -->
  <div class="example" id="example-2">
    <button id="toggle-2" class="toggle" aria-expanded="true" aria-controls="details-2">
      <span class="icon" aria-hidden="true">i</span>
      <span class="label">Release notes — Version 2.4.1</span>
      <span class="chev" aria-hidden="true">▸</span>
    </button>

    <div id="details-2" class="details" role="region" aria-labelledby="toggle-2" aria-hidden="false">
      <div class="content">
        <p><strong>What's new:</strong></p>
        <ol>
          <li>Improved performance for large datasets.</li>
          <li>Bug fixes for import/export features.</li>
          <li>Added keyboard shortcuts for quick actions.</li>
        </ol>
        <p class="hint">This example starts opened to show the expanded state.</p>
      </div>
    </div>
  </div>

  <noscript>
    <style>
      /* If JavaScript is disabled, make sure details are visible so content isn't hidden. */
      .example { outline: 2px dashed #ffd33d; }
      .no-js-show .details { max-height: none !important; overflow: visible !important; padding: 12px !important; }
    </style>
    <div style="margin-top:12px;padding:12px;border-radius:8px;background:#fff8e1;border:1px solid #ffe0a3;">
      JavaScript is disabled — details are shown by default for accessibility.
    </div>
  </noscript>

  <script>
    (function(){
      // Utility to set up one widget
      function setup(widgetRoot) {
        var button = widgetRoot.querySelector('.toggle');
        if (!button) return;
        var controlsId = button.getAttribute('aria-controls');
        var details = document.getElementById(controlsId);
        if (!details) return;

        // Ensure unique ids/labels are preserved
        // Initialize visual state based on aria-expanded
        var expanded = button.getAttribute('aria-expanded') === 'true';
        details.classList.toggle('open', expanded);
        details.setAttribute('aria-hidden', (!expanded).toString());

        // If initially expanded, set maxHeight to allow transition-ready state
        if (expanded) {
          // set maxHeight to content height to allow smooth collapse later
          details.style.maxHeight = details.scrollHeight + 'px';
        } else {
          details.style.maxHeight = '0px';
        }

        // Toggle function with height animation
        function toggle() {
          var isOpen = button.getAttribute('aria-expanded') === 'true';
          if (isOpen) {
            // close
            // set maxHeight to current scrollHeight so transition can start
            details.style.maxHeight = details.scrollHeight + 'px';
            // force reflow
            void details.offsetHeight;
            // then set to 0
            details.style.maxHeight = '0px';
            details.classList.remove('open');
            button.setAttribute('aria-expanded', 'false');
            details.setAttribute('aria-hidden', 'true');
          } else {
            // open
            details.classList.add('open');
            // set to full height
            details.style.maxHeight = details.scrollHeight + 'px';
            button.setAttribute('aria-expanded', 'true');
            details.setAttribute('aria-hidden', 'false');

            // After transition, clear max-height so content can grow naturally
            var clearMax = function(ev){
              if (ev && ev.target !== details) return;
              details.style.maxHeight = '';
              details.removeEventListener('transitionend', clearMax);
            };
            details.addEventListener('transitionend', clearMax);
          }
        }

        // Attach events
        button.addEventListener('click', function(e){
          e.preventDefault();
          toggle();
        });

        // If user toggles layout (e.g., window resize), adjust maxHeight when open
        var resizeObserver = null;
        if ('ResizeObserver' in window) {
          resizeObserver = new ResizeObserver(function(){
            if (button.getAttribute('aria-expanded') === 'true') {
              details.style.maxHeight = details.scrollHeight + 'px';
              // clear after next transitionend
              setTimeout(function(){ details.style.maxHeight = ''; }, 350);
            }
          });
          resizeObserver.observe(details);
        } else {
          window.addEventListener('resize', function(){
            if (button.getAttribute('aria-expanded') === 'true') {
              details.style.maxHeight = details.scrollHeight + 'px';
              setTimeout(function(){ details.style.maxHeight = ''; }, 350);
            }
          });
        }
      }

      // Initialize all .example widgets on the page
      document.addEventListener('DOMContentLoaded', function(){
        var examples = document.querySelectorAll('.example');
        examples.forEach(setup);

        // If JS is running, ensure noscript fallback styling isn't needed
        // Remove potential .no-js-show class on body
        document.body.classList.remove('no-js-show');
      });
    })();
  </script>
</body>
</html>