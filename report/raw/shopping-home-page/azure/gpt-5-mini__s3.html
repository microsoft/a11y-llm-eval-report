<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ShopNow — Home</title>
  <meta name="description" content="ShopNow — Popular items, limited-time deals, and curated blog posts." />
  <style>
    :root{
      --bg:#f6f7fb;
      --card:#ffffff;
      --muted:#7b8a99;
      --accent:#0b76ef;
      --accent-2:#ff6b6b;
      --success:#20c997;
      --glass: rgba(255,255,255,0.6);
      --radius:12px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color-scheme: light;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background: linear-gradient(180deg,var(--bg),#eef3fb 60%);
      color:#0f1724;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.4;
      padding-bottom:60px;
    }

    header.site-header{
      position:sticky; top:0; z-index:60;
      background:rgba(255,255,255,0.9);
      backdrop-filter: blur(6px);
      border-bottom:1px solid rgba(15,23,36,0.06);
    }
    .header-inner{
      max-width:1200px; margin:0 auto; padding:12px 20px; display:flex; gap:16px; align-items:center;
    }
    .logo{
      display:flex; gap:10px; align-items:center; text-decoration:none; color:inherit;
      font-weight:700; letter-spacing:-0.02em;
    }
    .logo .mark{
      width:44px; height:44px; border-radius:10px;
      background:linear-gradient(135deg,var(--accent),#6bc6ff);
      display:flex; align-items:center; justify-content:center; color:white; font-weight:800;
      box-shadow: 0 6px 18px rgba(11,118,239,0.14);
      flex:0 0 44px;
    }
    nav.topnav{
      margin-left:6px; display:flex; gap:12px; align-items:center;
    }
    nav.topnav a{font-size:14px; color:var(--muted); text-decoration:none; padding:8px 10px; border-radius:8px}
    nav.topnav a:hover{background:rgba(11,118,239,0.06); color:var(--accent)}
    .search{
      flex:1; display:flex; align-items:center; gap:12px; margin-left:18px; max-width:640px;
      background:var(--card); border-radius:12px; padding:8px 12px; box-shadow:0 6px 18px rgba(18,38,63,0.03);
    }
    .search input{
      border:0; outline:0; font-size:14px; background:transparent; width:100%;
    }
    .actions{display:flex; gap:8px; align-items:center; margin-left:auto}
    .icon-btn{
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      border-radius:10px; padding:8px 10px; background:transparent; border:0; cursor:pointer;
      font-size:14px; color:var(--muted);
    }
    .icon-btn .badge{background:var(--accent-2); color:white; font-weight:700; font-size:12px; padding:4px 7px; border-radius:999px; margin-left:6px}
    main{max-width:1200px; margin:22px auto; padding:0 20px 40px}

    /* Hero */
    .hero{
      display:grid; grid-template-columns: 1.1fr .9fr; gap:18px; align-items:stretch; margin-bottom:22px;
    }
    .hero-card{
      background:linear-gradient(180deg,white, #fbfdff);
      border-radius:var(--radius); padding:24px; box-shadow:0 10px 30px rgba(15,23,36,0.06);
      display:flex; flex-direction:column; justify-content:space-between;
    }
    .hero-card h1{margin:0 0 8px; font-size:28px}
    .hero-card p{margin:0 0 18px; color:var(--muted)}
    .hero-cta{display:flex; gap:12px}
    .btn{
      border:0; padding:12px 16px; border-radius:10px; cursor:pointer; font-weight:600; font-size:14px;
    }
    .btn.primary{background:linear-gradient(90deg,var(--accent),#6bc6ff); color:white; box-shadow:0 8px 24px rgba(11,118,239,0.12)}
    .btn.ghost{background:transparent; color:var(--muted); border:1px solid rgba(15,23,36,0.06)}

    .deal-strip{
      display:flex; flex-direction:column; gap:12px;
    }
    .deal-slide{
      background:linear-gradient(135deg,#fff7f6,#fff); border-radius:12px; padding:14px; display:flex; align-items:center; gap:12px;
      box-shadow:0 8px 22px rgba(255,107,107,0.06);
    }
    .deal-badge{background:linear-gradient(90deg,var(--accent-2),#ff9a9a); color:white; padding:6px 10px; border-radius:999px; font-weight:700}

    /* Sections */
    .section{margin-top:18px}
    .section-header{display:flex; justify-content:space-between; align-items:end; gap:12px; margin-bottom:12px}
    .section-header h2{margin:0; font-size:18px}
    .section-header p{margin:0; color:var(--muted); font-size:13px}

    /* Products grid */
    .products-grid{
      display:grid; grid-template-columns:repeat(4,1fr); gap:14px;
    }
    .product-card{
      background:var(--card); border-radius:14px; padding:12px; box-shadow:0 8px 20px rgba(8,22,56,0.04);
      position:relative; overflow:hidden; display:flex; flex-direction:column; gap:10px;
    }
    .product-image{
      height:160px; border-radius:10px; display:flex; align-items:flex-end; justify-content:flex-start; padding:12px; color:white;
      font-weight:700; font-size:14px; background-size:cover; background-position:center; box-shadow: inset 0 -30px 60px rgba(0,0,0,0.12);
    }
    .product-meta{display:flex; justify-content:space-between; align-items:center}
    .product-meta .title{font-weight:700}
    .price{font-weight:800; color:#0f1724}
    .price .old{font-weight:600; color:var(--muted); text-decoration:line-through; font-size:13px; margin-left:8px}
    .card-actions{display:flex; gap:8px; margin-top:auto}
    .small-btn{padding:8px 10px; border-radius:10px; border:0; cursor:pointer; font-weight:600}
    .wishlist{background:transparent; color:var(--muted)}
    .addcart{background:var(--accent); color:white}

    /* Deals carousel */
    .carousel{
      display:flex; gap:12px; overflow-x:auto; padding-bottom:6px; scroll-snap-type:x mandatory;
    }
    .deal-card{
      min-width:220px; flex:0 0 auto; scroll-snap-align:start; border-radius:12px; padding:14px; background:linear-gradient(180deg,#fff, #f8fdff); box-shadow:0 8px 22px rgba(11,118,239,0.06);
      display:flex; flex-direction:column; gap:10px;
    }
    .deal-card .tag{font-weight:700; color:var(--accent-2)}
    .countdown{font-weight:700; color:#1f2937; font-size:14px}

    /* Blog */
    .blogs{display:grid; grid-template-columns:repeat(3,1fr); gap:14px}
    .blog-card{background:var(--card); border-radius:12px; overflow:hidden; box-shadow:0 8px 20px rgba(8,22,56,0.04)}
    .blog-image{height:140px; background:linear-gradient(135deg,#6b9cff,#9be7ff); color:white; display:flex; align-items:flex-end; padding:12px; font-weight:700}
    .blog-body{padding:12px}

    /* Footer */
    footer{max-width:1200px; margin:28px auto; padding:20px; display:flex; gap:18px; justify-content:space-between; align-items:center}
    .newsletter{display:flex; gap:8px; align-items:center}
    .newsletter input{padding:10px 12px; border-radius:10px; border:1px solid rgba(11,118,239,0.08)}
    .socials{display:flex; gap:8px}

    /* Responsive */
    @media (max-width:980px){
      .hero{grid-template-columns:1fr; }
      .products-grid{grid-template-columns:repeat(2,1fr)}
      .blogs{grid-template-columns:1fr}
    }
    @media (max-width:560px){
      .header-inner{padding:10px}
      .search{display:none}
      .products-grid{grid-template-columns:repeat(1,1fr)}
      .deal-card{min-width:180px}
    }

    /* Modal */
    .overlay{position:fixed; inset:0; background:rgba(2,6,23,0.45); display:none; align-items:center; justify-content:center; z-index:80}
    .overlay.open{display:flex}
    .modal{width:min(920px,96%); background:var(--card); border-radius:14px; padding:18px; display:grid; grid-template-columns:1fr 1fr; gap:14px}
    .qty{display:flex; gap:6px; align-items:center}
    .snackbar{position:fixed; left:50%; transform:translateX(-50%); bottom:24px; background: #111827; color:white; padding:10px 16px; border-radius:10px; display:none; z-index:100}
    .snackbar.show{display:block}
    .stars{color:#fbbf24}
  </style>
</head>
<body>
  <header class="site-header" role="banner">
    <div class="header-inner">
      <a href="#" class="logo" aria-label="ShopNow home">
        <div class="mark">SN</div>
        <div>
          <div style="font-size:15px">ShopNow</div>
          <div style="font-size:12px; color:var(--muted); margin-top:2px">Smart shopping everyday</div>
        </div>
      </a>

      <nav class="topnav" aria-label="Main navigation">
        <a href="#" aria-current="page">Home</a>
        <a href="#">Shop</a>
        <a href="#">Deals</a>
        <a href="#">Blog</a>
        <a href="#">Contact</a>
      </nav>

      <div class="search" role="search" aria-label="Search products">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21l-4.35-4.35" stroke="#94a3b8" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/><circle cx="11" cy="11" r="6" stroke="#94a3b8" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <input id="searchInput" placeholder="Search for products, brands, categories..." />
        <button class="btn ghost" id="searchBtn" aria-label="Search">Search</button>
      </div>

      <div class="actions" role="region" aria-label="User actions">
        <button class="icon-btn" title="Favorites" id="wishlistBtn">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M20.8 7.6c0 7.1-8.2 11.7-8.2 11.7S4.4 14.7 4.4 7.6A4.4 4.4 0 019.2 3.2c2 0 3.6 1.6 3.6 1.6s1.6-1.6 3.6-1.6a4.4 4.4 0 014.4 4.4z" stroke="currentColor" stroke-width="0.8" fill="none"/></svg>
        </button>
        <button class="icon-btn" id="cartBtn" aria-haspopup="dialog" aria-controls="cartPanel" title="Cart">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M6 6h15l-1.5 9h-12z" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="9" cy="19" r="1" fill="currentColor"/><circle cx="18" cy="19" r="1" fill="currentColor"/></svg>
          <span class="badge" id="cartCount">0</span>
        </button>
      </div>
    </div>
  </header>

  <main role="main">
    <section class="hero" aria-label="Featured deals and promotions">
      <div class="hero-card" aria-hidden="false">
        <div>
          <h1>Flash Deals — Up to 60% off</h1>
          <p>Handpicked daily deals across electronics, home, and fashion. Limited time and quantities.</p>
          <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap">
            <div class="hero-cta">
              <button class="btn primary" id="shopAllBtn">Shop Deals</button>
              <button class="btn ghost" id="learnBtn">How it works</button>
            </div>
          </div>
        </div>
        <div style="display:flex; gap:10px; align-items:center; margin-top:16px">
          <div class="deal-strip" id="heroDeals" aria-hidden="false">
            <div class="deal-slide">
              <div style="flex:1">
                <div style="font-weight:800">Smart Watch Pro</div>
                <div style="color:var(--muted); font-size:13px">Now 40% off</div>
              </div>
              <div style="text-align:right">
                <div class="deal-badge">-40%</div>
                <div style="font-size:12px; color:var(--muted); margin-top:6px">Ends in <span style="font-weight:700">4h</span></div>
              </div>
            </div>
            <div class="deal-slide">
              <div style="flex:1">
                <div style="font-weight:800">Noise Cancelling Headphones</div>
                <div style="color:var(--muted); font-size:13px">Free shipping</div>
              </div>
              <div style="text-align:right">
                <div class="deal-badge">Top pick</div>
                <div style="font-size:12px; color:var(--muted); margin-top:6px">&amp; Limited</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <aside class="hero-card" aria-label="Daily limited-time deals">
        <div style="display:flex; justify-content:space-between; align-items:center">
          <div>
            <div style="font-size:15px; font-weight:800">Today's Highlights</div>
            <div style="color:var(--muted); font-size:13px">Grab before they're gone</div>
          </div>
          <button class="btn ghost" id="viewAllDeals">View all</button>
        </div>

        <div style="margin-top:12px;">
          <div class="carousel" id="dealsCarousel" aria-live="polite">
            <!-- dynamic -->
          </div>
        </div>
      </aside>
    </section>

    <section class="section" aria-labelledby="popularHeading">
      <div class="section-header">
        <div>
          <h2 id="popularHeading">Popular Items</h2>
          <p>Best sellers across categories</p>
        </div>
        <div style="display:flex; gap:8px; align-items:center">
          <label for="sortSelect" style="color:var(--muted); font-size:13px">Sort</label>
          <select id="sortSelect" style="padding:8px 10px; border-radius:8px; border:1px solid rgba(15,23,36,0.06)">
            <option value="popular">Most popular</option>
            <option value="new">Newest</option>
            <option value="price-asc">Price: Low to High</option>
            <option value="price-desc">Price: High to Low</option>
          </select>
        </div>
      </div>

      <div class="products-grid" id="productsGrid" aria-live="polite">
        <!-- product cards injected -->
      </div>
    </section>

    <section class="section" aria-labelledby="dealsHeading">
      <div class="section-header">
        <div>
          <h2 id="dealsHeading">Limited-time Deals</h2>
          <p>Hot deals that end soon — countdown included</p>
        </div>
        <div style="display:flex; gap:8px; align-items:center">
          <button class="btn ghost" id="seeMoreDeals">See more deals</button>
        </div>
      </div>

      <div class="carousel" id="dealsGrid" aria-live="polite">
        <!-- deal cards -->
      </div>
    </section>

    <section class="section" aria-labelledby="blogHeading">
      <div class="section-header">
        <div>
          <h2 id="blogHeading">From our blog</h2>
          <p>Trends, guides, and tips</p>
        </div>
        <div>
          <a href="#" style="color:var(--muted); font-size:13px">All posts →</a>
        </div>
      </div>

      <div class="blogs" id="blogsList">
        <article class="blog-card" aria-labelledby="b1">
          <div class="blog-image">Sustainable Picks</div>
          <div class="blog-body">
            <h3 id="b1" style="margin:0 0 6px">Sustainable shopping — how to choose</h3>
            <p style="margin:0 0 10px; color:var(--muted)">Small changes make a big impact. A quick guide to buying responsibly.</p>
            <a class="btn ghost" href="#">Read article</a>
          </div>
        </article>

        <article class="blog-card" aria-labelledby="b2">
          <div class="blog-image" style="background:linear-gradient(135deg,#ff9a9a,#ffd6d6)">Gift Guides</div>
          <div class="blog-body">
            <h3 id="b2" style="margin:0 0 6px">Gift ideas under $50</h3>
            <p style="margin:0 0 10px; color:var(--muted)">Curated gifts that look luxe without breaking the bank.</p>
            <a class="btn ghost" href="#">Read article</a>
          </div>
        </article>

        <article class="blog-card" aria-labelledby="b3">
          <div class="blog-image" style="background:linear-gradient(135deg,#a8ff78,#78ffd6)">How-to</div>
          <div class="blog-body">
            <h3 id="b3" style="margin:0 0 6px">Buying electronics: what to look for</h3>
            <p style="margin:0 0 10px; color:var(--muted)">A simple checklist to help you compare models confidently.</p>
            <a class="btn ghost" href="#">Read article</a>
          </div>
        </article>
      </div>
    </section>
  </main>

  <footer role="contentinfo">
    <div style="max-width:1200px; margin:0 auto; display:flex; justify-content:space-between; align-items:center; padding:12px 20px;">
      <div style="display:flex; gap:18px; align-items:center">
        <div style="font-weight:800">ShopNow</div>
        <div style="color:var(--muted); font-size:13px">© <span id="year"></span> All rights reserved</div>
      </div>

      <div style="display:flex; gap:18px; align-items:center">
        <div class="newsletter" aria-label="Subscribe to newsletter">
          <input id="emailInput" type="email" placeholder="Your email" aria-label="Email address" />
          <button class="btn primary" id="subscribeBtn">Subscribe</button>
        </div>
        <div class="socials" aria-hidden="false">
          <a href="#" class="icon-btn" title="Twitter">T</a>
          <a href="#" class="icon-btn" title="Instagram">I</a>
          <a href="#" class="icon-btn" title="Facebook">F</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- Quick view modal -->
  <div class="overlay" id="modalOverlay" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal" role="document">
      <div style="display:flex; flex-direction:column; gap:10px">
        <div id="quickImage" style="height:320px; border-radius:8px; background-size:cover; background-position:center; color:white; display:flex; align-items:flex-end; padding:14px; font-weight:800"></div>
      </div>
      <div style="display:flex; flex-direction:column; gap:8px">
        <div style="display:flex; justify-content:space-between; align-items:start">
          <div>
            <h3 id="modalTitle" style="margin:0">Product name</h3>
            <div style="color:var(--muted); font-size:13px" id="modalCategory">Category</div>
          </div>
          <button class="icon-btn" id="closeModal" aria-label="Close">✕</button>
        </div>

        <div style="color:var(--muted)" id="modalDesc">Product description placeholder. Highlights, features and quick specs.</div>

        <div style="display:flex; gap:10px; align-items:center; margin-top:6px">
          <div style="font-size:20px; font-weight:800" id="modalPrice">$99.99</div>
          <div style="color:var(--muted); text-decoration:line-through" id="modalOld">$129</div>
        </div>

        <div style="display:flex; gap:8px; align-items:center;">
          <div class="qty" aria-label="Quantity selector">
            <button class="small-btn" id="decQty">−</button>
            <div id="qtyVal" style="min-width:32px; text-align:center; font-weight:700">1</div>
            <button class="small-btn" id="incQty">+</button>
          </div>
          <button class="btn addcart" id="modalAddToCart">Add to cart</button>
        </div>

      </div>
    </div>
  </div>

  <div class="snackbar" id="snackbar" role="status" aria-live="polite">Added to cart</div>

  <script>
    // Sample data
    const products = [
      {id:1, name:"Smart Watch Pro", category:"Wearables", price:119.99, old:199.99, rating:4.6, color:["#0b76ef","#6bc6ff"]},
      {id:2, name:"NoiseX Headphones", category:"Audio", price:79.99, old:129.99, rating:4.4, color:["#ff6b6b","#ffb3b3"]},
      {id:3, name:"Ultra Blender", category:"Home", price:49.99, old:89.99, rating:4.2, color:["#a8ff78","#78ffd6"]},
      {id:4, name:"Running Sneakers", category:"Fashion", price:69.99, old:99.99, rating:4.5, color:["#ffd166","#ffb86b"]},
      {id:5, name:"Compact Camera", category:"Photography", price:249.99, old:349.99, rating:4.7, color:["#c4b5fd","#7c3aed"]},
      {id:6, name:"LED Desk Lamp", category:"Home", price:29.99, old:49.99, rating:4.1, color:["#6b9cff","#9be7ff"]},
      {id:7, name:"Travel Backpack", category:"Travel", price:39.99, old:69.99, rating:4.3, color:["#f3a683","#f7d794"]},
      {id:8, name:"Wireless Charger", category:"Accessories", price:19.99, old:39.99, rating:4.0, color:["#ff9a9a","#ffddd2"]}
    ];

    const deals = [
      {id:"d1", title:"Smart Watch Pro", price:119.99, old:199.99, endsInMinutes:240, tag:"Hot"},
      {id:"d2", title:"NoiseX Headphones", price:79.99, old:129.99, endsInMinutes:180, tag:"Limited"},
      {id:"d3", title:"Compact Camera", price:249.99, old:349.99, endsInMinutes:420, tag:"Top Pick"},
      {id:"d4", title:"Running Sneakers", price:69.99, old:99.99, endsInMinutes:90, tag:"Flash"}
    ];

    // Utilities
    const el = sel => document.querySelector(sel);
    const elAll = sel => Array.from(document.querySelectorAll(sel));

    // Render product cards
    function renderProducts(list){
      const grid = el('#productsGrid');
      grid.innerHTML = '';
      list.forEach(p=>{
        const card = document.createElement('article');
        card.className = 'product-card';
        card.setAttribute('data-id', p.id);
        card.innerHTML = `
          <div class="product-image" style="background:linear-gradient(135deg, ${p.color[0]}, ${p.color[1]});">
            <div style="font-size:12px; padding:8px; border-radius:8px; background:rgba(0,0,0,0.12); margin-bottom:auto">${p.category}</div>
          </div>
          <div class="product-meta">
            <div>
              <div class="title">${p.name}</div>
              <div style="font-size:12px; color:var(--muted)">${p.rating} <span class="stars">★</span></div>
            </div>
            <div class="price">$${p.price.toFixed(2)} <span class="old">$${p.old.toFixed(2)}</span></div>
          </div>
          <div class="card-actions">
            <button class="small-btn wishlist" data-action="wish" title="Add to wishlist">♡</button>
            <button class="small-btn" data-action="view">Quick view</button>
            <button class="btn addcart" data-action="add">Add to cart</button>
          </div>
        `;
        grid.appendChild(card);
      });
    }

    // Render deals carousel
    function renderDeals(){
      const c = el('#dealsCarousel');
      const grid = el('#dealsGrid');
      c.innerHTML = '';
      grid.innerHTML = '';
      deals.forEach(d=>{
        const slide = document.createElement('div');
        slide.className = 'deal-card';
        slide.innerHTML = `
          <div style="display:flex; justify-content:space-between; align-items:center">
            <div style="font-weight:800">${d.title}</div>
            <div class="tag">${d.tag}</div>
          </div>
          <div style="color:var(--muted)">$${d.price.toFixed(2)} <span style="text-decoration:line-through; color:var(--muted)">$${d.old.toFixed(2)}</span></div>
          <div class="countdown" data-ends="${Date.now() + d.endsInMinutes*60*1000}">--:--:--</div>
          <div style="margin-top:auto; display:flex; gap:8px">
            <button class="btn primary" data-dealid="${d.id}">Buy now</button>
            <button class="btn ghost" data-dealid="${d.id}">Details</button>
          </div>
        `;
        c.appendChild(slide);

        const slide2 = slide.cloneNode(true);
        grid.appendChild(slide2);
      });
    }

    // Countdown ticks
    function tickCountdowns(){
      elAll('.countdown').forEach(span=>{
        const ends = Number(span.getAttribute('data-ends'));
        const rem = Math.max(0, ends - Date.now());
        const hrs = Math.floor(rem / (1000*60*60));
        const mins = Math.floor((rem % (1000*60*60)) / (1000*60));
        const secs = Math.floor((rem % (1000*60)) / 1000);
        span.textContent = `${String(hrs).padStart(2,'0')}:${String(mins).padStart(2,'0')}:${String(secs).padStart(2,'0')}`;
      });
    }

    // Cart state
    let cartCount = 0;
    const cartCountEl = el('#cartCount');
    function updateCartCount(n){
      cartCount = n;
      cartCountEl.textContent = cartCount;
    }

    // Snackbar
    function showSnackbar(msg='Added to cart'){
      const sn = el('#snackbar');
      sn.textContent = msg;
      sn.classList.add('show');
      setTimeout(()=>sn.classList.remove('show'),1800);
    }

    // Quick view modal
    const overlay = el('#modalOverlay');
    let currentQty = 1;
    function openModal(product){
      el('#modalTitle').textContent = product.name;
      el('#modalCategory').textContent = product.category;
      el('#modalDesc').textContent = `${product.name} — key features and highlights. Perfect for everyday use.`;
      el('#modalPrice').textContent = `$${product.price.toFixed(2)}`;
      el('#modalOld').textContent = `$${product.old.toFixed(2)}`;
      el('#quickImage').style.background = `linear-gradient(135deg, ${product.color[0]}, ${product.color[1]})`;
      currentQty = 1; el('#qtyVal').textContent = currentQty;
      overlay.classList.add('open');
      el('#modalAddToCart').dataset.id = product.id;
    }
    function closeModal(){ overlay.classList.remove('open'); }

    // Click handlers
    document.addEventListener('click', (e)=>{
      // Product card actions
      const action = e.target.closest('[data-action]');
      if(action){
        const act = action.getAttribute('data-action');
        const card = e.target.closest('.product-card');
        const id = card && Number(card.getAttribute('data-id'));
        const product = products.find(p=>p.id===id);
        if(act === 'add'){
          updateCartCount(cartCount+1);
          showSnackbar();
        } else if(act === 'view'){
          openModal(product);
        } else if(act === 'wish'){
          showSnackbar('Added to wishlist');
        }
      }

      if(e.target.matches('.btn.primary[data-dealid]')){
        updateCartCount(cartCount+1);
        showSnackbar('Deal added to cart');
      }

      if(e.target.id === 'closeModal' || e.target === overlay){
        closeModal();
      }
    });

    // Qty controls
    el('#incQty').addEventListener('click', ()=>{ currentQty++; el('#qtyVal').textContent = currentQty;});
    el('#decQty').addEventListener('click', ()=>{ if(currentQty>1) currentQty--; el('#qtyVal').textContent = currentQty;});
    el('#modalAddToCart').addEventListener('click', (ev)=>{
      const id = Number(ev.target.dataset.id);
      updateCartCount(cartCount + currentQty);
      showSnackbar('Added to cart');
      closeModal();
    });

    // Search
    el('#searchBtn').addEventListener('click', ()=>{
      const q = el('#searchInput').value.trim().toLowerCase();
      if(!q){ renderProducts(products); return; }
      const res = products.filter(p => p.name.toLowerCase().includes(q) || p.category.toLowerCase().includes(q));
      renderProducts(res);
    });

    // Sorting
    el('#sortSelect').addEventListener('change',(e)=>{
      const v = e.target.value;
      let list = [...products];
      if(v==='price-asc') list.sort((a,b)=>a.price-b.price);
      else if(v==='price-desc') list.sort((a,b)=>b.price-a.price);
      else if(v==='new') list.reverse();
      renderProducts(list);
    });

    // Subscribe
    el('#subscribeBtn').addEventListener('click', ()=>{
      const email = el('#emailInput').value.trim();
      if(!email || !email.includes('@')){ alert('Please enter a valid email'); return; }
      el('#emailInput').value = '';
      showSnackbar('Subscribed');
    });

    // Populate initial UI
    function init(){
      renderProducts(products.slice(0,8));
      renderDeals();
      // set countdown ends for deal elements in carousel
      elAll('.deal-card').forEach((card,i)=>{
        const cd = card.querySelector('.countdown');
        if(!cd){
          // may occur for heroDeals
          const d = deals[i % deals.length];
          const span = document.createElement('div');
          span.className = 'countdown';
          span.setAttribute('data-ends', Date.now() + d.endsInMinutes*60*1000);
          card.appendChild(span);
        }
      });

      // attach ends attribute for each countdown in dealsGrid/carousel
      const cdEls = [];
      document.querySelectorAll('.deal-card .countdown, .carousel .countdown').forEach((el,idx)=>{
        if(!el.getAttribute('data-ends')){
          const d = deals[idx % deals.length];
          el.setAttribute('data-ends', Date.now() + d.endsInMinutes*60*1000);
        }
        cdEls.push(el);
      });
      tickCountdowns();
      setInterval(tickCountdowns,1000);

      el('#year').textContent = new Date().getFullYear();
    }

    // Close modal with Escape
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeModal(); });

    init();
  </script>
</body>
</html>