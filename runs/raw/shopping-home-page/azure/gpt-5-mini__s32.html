<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ShopEase — Home</title>
  <meta name="description" content="ShopEase — curated popular items, hot deals, and the latest from our blog. Shop smart. Shop easy." />
  <style>
    :root{
      --bg:#f6f7fb;
      --card:#ffffff;
      --accent:#0b76ef;
      --muted:#6b7280;
      --success:#10b981;
      --danger:#ef4444;
      --glass: rgba(255,255,255,0.6);
      --radius:12px;
      --max-width:1200px;
      --shadow: 0 6px 20px rgba(13,20,30,0.08);
      --shadow-sm: 0 4px 12px rgba(13,20,30,0.06);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,var(--bg), #eef2f7 60%);
      color:#0f1724;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.38;
      padding:24px;
    }

    .container{
      max-width:var(--max-width);
      margin:0 auto;
    }

    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      margin-bottom:22px;
    }

    .brand{
      display:flex;
      gap:12px;
      align-items:center;
      text-decoration:none;
      color:inherit;
    }

    .logo{
      width:48px;
      height:48px;
      border-radius:10px;
      background: linear-gradient(135deg,var(--accent), #6ee7b7);
      display:flex;
      align-items:center;
      justify-content:center;
      color:white;
      font-weight:700;
      box-shadow: var(--shadow-sm);
      flex-shrink:0;
    }

    nav[role="navigation"]{
      display:flex;
      gap:18px;
      align-items:center;
      margin-left:16px;
      flex:1;
    }

    .nav-links{
      display:flex;
      gap:14px;
      align-items:center;
    }

    .nav-links a{
      color:var(--muted);
      text-decoration:none;
      font-weight:600;
      padding:8px;
      border-radius:8px;
    }

    .nav-links a:hover{color:var(--accent); background:rgba(11,118,239,0.06)}

    .search{
      display:flex;
      align-items:center;
      gap:8px;
      background:var(--card);
      padding:8px 12px;
      border-radius:12px;
      box-shadow: var(--shadow-sm);
      flex:0 0 360px;
      max-width:45%;
    }

    .search input{
      border:0;
      outline:none;
      font-size:14px;
      width:100%;
      background:transparent;
    }

    .actions{
      display:flex;
      align-items:center;
      gap:12px;
    }

    .icon-btn{
      background:var(--card);
      border:0;
      padding:10px 12px;
      border-radius:10px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      box-shadow:var(--shadow-sm);
      cursor:pointer;
    }

    .cart-count{
      min-width:20px;
      height:20px;
      border-radius:10px;
      background:var(--danger);
      color:white;
      font-size:12px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:0 6px;
    }

    main{
      margin-top:18px;
    }

    .hero{
      background:linear-gradient(90deg, rgba(11,118,239,0.06), rgba(16,185,129,0.03));
      border-radius:var(--radius);
      padding:28px;
      display:flex;
      gap:18px;
      align-items:center;
      justify-content:space-between;
      box-shadow:var(--shadow);
    }

    .hero-text{
      max-width:56%;
    }

    .eyebrow{
      color:var(--accent);
      font-weight:700;
      font-size:13px;
      margin-bottom:8px;
    }

    .hero h1{
      margin:0 0 8px 0;
      font-size:28px;
      line-height:1.1;
    }

    .hero p{margin:0;color:var(--muted);}

    .hero-cta{
      margin-top:12px;
      display:flex;
      gap:12px;
    }

    .btn{
      background:var(--accent);
      color:white;
      border:0;
      padding:10px 14px;
      border-radius:10px;
      font-weight:700;
      cursor:pointer;
      box-shadow: 0 8px 30px rgba(11,118,239,0.12);
    }

    .btn.secondary{
      background:transparent;
      color:var(--accent);
      border:1px solid rgba(11,118,239,0.12);
      box-shadow:none;
    }

    .hero-visual{
      width:320px;
      height:160px;
      border-radius:12px;
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:center;
      background:linear-gradient(135deg, #ffffff, rgba(255,255,255,0.6));
      box-shadow:var(--shadow-sm);
      padding:12px;
    }

    .section{
      margin-top:22px;
      background:transparent;
    }

    .section-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:12px;
    }

    .section-title{
      font-size:18px;
      font-weight:800;
    }

    .section-sub{
      color:var(--muted);
      font-size:13px;
    }

    .grid{
      display:grid;
      gap:14px;
    }

    /* Popular grid */
    .popular-grid{
      grid-template-columns: repeat(4, 1fr);
    }

    .card{
      background:var(--card);
      border-radius:12px;
      padding:12px;
      box-shadow:var(--shadow-sm);
      transition:transform 180ms ease, box-shadow 180ms ease;
      display:flex;
      gap:12px;
      align-items:center;
    }

    .card:hover{transform:translateY(-6px); box-shadow:var(--shadow)}

    .thumb{
      width:96px;
      height:96px;
      border-radius:10px;
      flex-shrink:0;
      display:grid;
      place-items:center;
      color:white;
      font-weight:700;
      font-size:14px;
    }

    .product-info{
      display:flex;
      flex-direction:column;
      gap:6px;
      width:100%;
    }

    .product-title{
      font-weight:700;
      font-size:15px;
      margin:0;
    }

    .product-meta{
      display:flex;
      gap:8px;
      align-items:center;
      color:var(--muted);
      font-size:13px;
    }

    .price{
      font-weight:800;
      font-size:16px;
      color:#062f4f;
    }

    .rating{
      display:inline-flex;
      gap:6px;
      align-items:center;
      color:#f59e0b;
      font-weight:700;
      font-size:13px;
    }

    .muted{color:var(--muted); font-size:13px}

    .card-actions{
      display:flex;
      gap:8px;
      margin-left:auto;
    }

    .small-btn{
      border:0;
      background:rgba(6,47,79,0.04);
      padding:8px 10px;
      border-radius:8px;
      cursor:pointer;
    }

    /* Deals carousel */
    .deals-wrap{
      position:relative;
    }

    .carousel{
      display:flex;
      gap:12px;
      overflow-x:auto;
      padding-bottom:6px;
      scroll-behavior:smooth;
    }

    .deal-card{
      min-width:260px;
      background:var(--card);
      padding:12px;
      border-radius:12px;
      box-shadow:var(--shadow-sm);
      display:flex;
      gap:10px;
      align-items:center;
    }

    .deal-badge{
      background:linear-gradient(90deg,#ef4444,#fb923c);
      color:white;
      font-weight:800;
      padding:6px 8px;
      border-radius:8px;
      font-size:12px;
      margin-left:auto;
    }

    .timer{
      background:#0f1724;
      color:white;
      padding:6px 8px;
      border-radius:8px;
      font-weight:700;
      font-size:13px;
      margin-left:6px;
    }

    .carousel-nav{
      position:absolute;
      top:50%;
      transform:translateY(-50%);
      width:100%;
      display:flex;
      justify-content:space-between;
      pointer-events:none;
    }

    .carousel-nav button{
      pointer-events:all;
      border:0;
      background:var(--card);
      padding:8px;
      border-radius:999px;
      box-shadow:var(--shadow-sm);
      cursor:pointer;
      margin:0 6px;
    }

    /* Blog grid */
    .blog-grid{
      grid-template-columns: repeat(3, 1fr);
    }

    .post{
      background:linear-gradient(180deg, rgba(255,255,255,0.8), var(--card));
      border-radius:12px;
      padding:12px;
      box-shadow:var(--shadow-sm);
    }

    .post h3{margin:0 0 8px 0;font-size:16px}
    .post p{margin:0;color:var(--muted);font-size:14px}

    footer{
      margin-top:28px;
      color:var(--muted);
      display:flex;
      gap:18px;
      justify-content:space-between;
      align-items:center;
      flex-wrap:wrap;
    }

    .newsletter{
      display:flex;
      gap:8px;
      align-items:center;
      background:var(--card);
      padding:8px 10px;
      border-radius:10px;
      box-shadow:var(--shadow-sm);
    }

    .newsletter input{
      border:0; outline:none; background:transparent;
    }

    /* Responsive */
    @media (max-width:1100px){
      .popular-grid{grid-template-columns:repeat(3,1fr)}
      .hero-text{max-width:60%}
      .search{flex:1; max-width:unset}
    }
    @media (max-width:880px){
      .popular-grid{grid-template-columns:repeat(2,1fr)}
      .blog-grid{grid-template-columns:repeat(2,1fr)}
      .hero{flex-direction:column; align-items:flex-start}
      .hero-visual{width:100%}
      header{flex-direction:column;align-items:flex-start; gap:12px}
      nav[role="navigation"]{flex-wrap:wrap}
    }
    @media (max-width:560px){
      .popular-grid{grid-template-columns:1fr}
      .blog-grid{grid-template-columns:1fr}
      .search{display:none}
      .hero-text{max-width:100%}
      .actions{margin-left:auto}
    }

    /* subtle accessibility focus styles */
    a:focus, button:focus, input:focus {outline:3px solid rgba(11,118,239,0.14); outline-offset:2px; border-radius:8px}
    .sr-only {position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0}
  </style>
</head>
<body>
  <div class="container" id="page">
    <header>
      <a class="brand" href="#" aria-label="ShopEase home">
        <div class="logo" aria-hidden="true">SE</div>
        <div>
          <div style="font-weight:800">ShopEase</div>
          <div style="font-size:12px;color:var(--muted)">Curated shopping made simple</div>
        </div>
      </a>

      <nav role="navigation" aria-label="Main navigation">
        <div class="nav-links" role="menubar" aria-label="Primary">
          <a href="#" role="menuitem">Home</a>
          <a href="#" role="menuitem">Shop</a>
          <a href="#" role="menuitem">Deals</a>
          <a href="#" role="menuitem">Blog</a>
        </div>

        <div class="search" role="search" aria-label="Search products">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M21 21l-4.35-4.35" stroke="#6B7280" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
            <circle cx="11" cy="11" r="5" stroke="#6B7280" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <input id="searchInput" placeholder="Search popular items, e.g. headphones" aria-label="Search products"/>
        </div>
      </nav>

      <div class="actions" aria-hidden="false">
        <button class="icon-btn" id="wishlistBtn" title="Wishlist">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78L12 21.23l8.84-8.84a5.5 5.5 0 0 0 0-7.78z" stroke="#0f1724" stroke-width="0.6" fill="rgba(11,118,239,0.06)"/>
          </svg>
          <span style="font-weight:700;color:var(--muted)">Wishlist</span>
        </button>

        <button class="icon-btn" id="cartBtn" aria-label="Shopping cart" title="View cart">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M6 6h15l-1.5 9h-12L6 6z" stroke="#0f1724" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="rgba(11,118,239,0.04)"/>
            <circle cx="10" cy="20" r="1" fill="#0f1724"/><circle cx="18" cy="20" r="1" fill="#0f1724"/>
          </svg>
          <span class="cart-count" id="cartCount" aria-live="polite">0</span>
        </button>
      </div>
    </header>

    <main>
      <section class="hero" aria-labelledby="heroTitle">
        <div class="hero-text">
          <div class="eyebrow">Weekly picks</div>
          <h1 id="heroTitle">Handpicked deals on items people love</h1>
          <p>Discover trending products, limited-time offers, and shopping guides from our team.</p>
          <div class="hero-cta">
            <button class="btn" id="shopNow">Shop Now</button>
            <button class="btn secondary" id="learnMore">How it works</button>
          </div>
        </div>

        <div class="hero-visual" aria-hidden="true">
          <svg width="280" height="140" viewBox="0 0 280 140" fill="none" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Illustration of shopping items">
            <rect x="12" y="12" width="116" height="116" rx="12" fill="#0b76ef" opacity="0.12" />
            <rect x="152" y="24" width="116" height="92" rx="12" fill="#10b981" opacity="0.12"/>
            <circle cx="86" cy="86" r="24" fill="#0b76ef" opacity="0.2"/>
            <circle cx="196" cy="62" r="20" fill="#10b981" opacity="0.2"/>
            <text x="28" y="54" font-size="18" font-weight="700" fill="#08334f">Top picks</text>
            <text x="28" y="78" font-size="12" fill="#0f1724" opacity="0.7">Curated just for you</text>
          </svg>
        </div>
      </section>

      <section class="section" aria-labelledby="popularTitle">
        <div class="section-header">
          <div>
            <div class="section-title" id="popularTitle">Popular Items</div>
            <div class="section-sub">Trending products shoppers are loving</div>
          </div>
          <div style="display:flex;gap:8px;align-items:center">
            <label for="sortSelect" class="sr-only">Sort products</label>
            <select id="sortSelect" aria-label="Sort products" style="padding:8px;border-radius:8px;border:1px solid rgba(11,118,239,0.06);background:white">
              <option value="trending">Trending</option>
              <option value="price-asc">Price — Low to High</option>
              <option value="price-desc">Price — High to Low</option>
              <option value="rating">Top Rated</option>
            </select>
            <button class="small-btn" id="refreshBtn" title="Refresh list">Refresh</button>
          </div>
        </div>

        <div class="grid popular-grid" id="popularGrid" role="list" aria-label="Popular products">
          <!-- Product cards injected by JS -->
        </div>
      </section>

      <section class="section deals-wrap" aria-labelledby="dealsTitle">
        <div class="section-header">
          <div>
            <div class="section-title" id="dealsTitle">Hot Deals</div>
            <div class="section-sub">Limited-time discounts — act fast</div>
          </div>
          <div class="muted">Ends in: <span id="dealsEnds" class="muted">—</span></div>
        </div>

        <div style="position:relative">
          <div class="carousel" id="dealsCarousel" tabindex="0" aria-label="Deals carousel">
            <!-- Deal cards injected by JS -->
          </div>

          <div class="carousel-nav" aria-hidden="false">
            <button id="prevDeal" aria-label="Previous deals">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M15 18l-6-6 6-6" stroke="#0f1724" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
            <button id="nextDeal" aria-label="Next deals">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M9 6l6 6-6 6" stroke="#0f1724" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
        </div>
      </section>

      <section class="section" aria-labelledby="blogTitle">
        <div class="section-header">
          <div>
            <div class="section-title" id="blogTitle">From the Blog</div>
            <div class="section-sub">Guides, reviews, and shopping tips</div>
          </div>
          <a href="#" class="muted" id="viewAllBlog">View all posts →</a>
        </div>

        <div class="grid blog-grid" id="blogGrid" aria-label="Latest blog posts">
          <!-- Blog posts injected by JS -->
        </div>
      </section>
    </main>

    <footer>
      <div style="display:flex;gap:12px;align-items:center">
        <div style="font-weight:800">Stay in the loop</div>
        <form id="newsletterForm" class="newsletter" aria-label="Subscribe to newsletter">
          <label for="newsletterEmail" class="sr-only">Email address</label>
          <input id="newsletterEmail" type="email" placeholder="you@domain.com" required />
          <button class="btn" type="submit">Subscribe</button>
        </form>
      </div>

      <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
        <div class="muted">© <span id="year"></span> ShopEase</div>
        <a href="#" class="muted">Privacy</a>
        <a href="#" class="muted">Terms</a>
        <a href="#" class="muted">Contact</a>
      </div>
    </footer>
  </div>

  <!-- Modal for blog post -->
  <div id="modal" role="dialog" aria-modal="true" aria-hidden="true" style="display:none;position:fixed;inset:0;align-items:center;justify-content:center;background:rgba(5,10,20,0.5);z-index:40;padding:20px">
    <div role="document" id="modalContent" style="background:white;border-radius:12px;max-width:720px;width:100%;padding:18px;box-shadow:var(--shadow)">
      <button id="modalClose" aria-label="Close" style="border:0;background:transparent;float:right;padding:6px;cursor:pointer">&times;</button>
      <h2 id="modalTitle" style="margin-top:4px"></h2>
      <p id="modalMeta" style="color:var(--muted);margin-top:2px;font-size:13px"></p>
      <div id="modalBody" style="margin-top:12px;color:var(--muted);line-height:1.6"></div>
    </div>
  </div>

  <script>
    (function(){
      // Sample data
      const products = [
        {id:1,name:'Wireless Noise-Canceling Headphones',price:169.99,rating:4.8,category:'Electronics',color:'#0b76ef',badge:'Bestseller',description:'Industry-leading noise cancellation with superior comfort.'},
        {id:2,name:'Eco Bamboo Coffee Mug',price:14.95,rating:4.6,category:'Home',color:'#10b981',badge:'Popular',description:'Double-walled, keeps drinks hot and eco-friendly.'},
        {id:3,name:'Smart Home Camera 2K',price:59.00,rating:4.4,category:'Smart Home',color:'#ff7ab6',badge:'Trending',description:'Crystal clear 2K video with AI detection.'},
        {id:4,name:'Compact Power Bank 20k',price:34.50,rating:4.7,category:'Accessories',color:'#fb923c',badge:'Hot',description:'High capacity, fast charge for multiple devices.'},
        {id:5,name:'Ergonomic Office Chair',price:249.00,rating:4.5,category:'Furniture',color:'#7c3aed',badge:'Limited',description:'Breathable mesh, lumbar support, and adjustable height.'},
        {id:6,name:'Running Shoes — Blaze',price:89.00,rating:4.3,category:'Apparel',color:'#06b6d4',badge:'New',description:'Lightweight comfort for daily runs.'},
        {id:7,name:'Portable Bluetooth Speaker',price:45.99,rating:4.6,category:'Audio',color:'#f97316',badge:'Deal',description:'Rich bass, waterproof, 12hr playtime.'},
        {id:8,name:'Minimalist Wallet',price:24.00,rating:4.2,category:'Accessories',color:'#0ea5a4',badge:'Favorite',description:'Slim design with RFID protection.'}
      ];

      // Deals: pick some and set end times
      const now = Date.now();
      const deals = [
        {id:4, discount:30, endsAt: now + 1000*60*60*6}, // 6h
        {id:1, discount:20, endsAt: now + 1000*60*45},  // 45m
        {id:7, discount:25, endsAt: now + 1000*60*60*24}, // 24h
        {id:3, discount:15, endsAt: now + 1000*60*60*3}, // 3h
      ];

      const blogPosts = [
        {id:101, title:'How to Choose the Right Headphones',date:'2025-10-20',author:'Ava Thompson',excerpt:'A practical guide to choosing noise-canceling headphones, what specs matter, and how to get the best fit.',body:'Choosing the right headphones comes down to three things: sound, comfort, and battery life. Start by deciding whether you want over-ear, on-ear, or in-ear models. Over-ear typically offers better noise isolation…'},
        {id:102, title:'5 Ways to Make Your Workspace Productive',date:'2025-09-30',author:'Liam Garcia',excerpt:'Simple changes that can lead to major gains in productivity — from ergonomics to lighting and routine.',body:'Small improvements in your workspace can create a big impact. Begin with ergonomic adjustments: seat height, monitor level, and keyboard position can reduce strain…'},
        {id:103, title:'The Rise of Sustainable Products',date:'2025-08-18',author:'Maya Patel',excerpt:'Sustainable shopping is more than a trend. Here’s how brands are doing it and what to look for as a conscious buyer.',body:'Sustainability in retail spans from materials and production methods to packaging and lifecycle management. Look for certifications like FSC, GOTS, and transparent supply-chain reporting…'}
      ];

      // Utilities
      function el(tag, attrs={}, ...children){
        const node = document.createElement(tag);
        for(const k in attrs){
          if(k==='class') node.className = attrs[k];
          else if(k==='html') node.innerHTML = attrs[k];
          else node.setAttribute(k, attrs[k]);
        }
        children.forEach(c=>{
          if(typeof c === 'string') node.appendChild(document.createTextNode(c));
          else if(c) node.appendChild(c);
        });
        return node;
      }

      // Render popular products
      const popularGrid = document.getElementById('popularGrid');
      function renderProducts(list){
        popularGrid.innerHTML='';
        list.forEach(p=>{
          const card = el('article',{class:'card', role:'listitem', 'aria-label':p.name});
          const thumb = el('div',{class:'thumb', style:`background:linear-gradient(135deg, ${p.color}, rgba(0,0,0,0.05));`});
          thumb.innerHTML = `<svg width="64" height="64" viewBox="0 0 64 64" aria-hidden="true"><rect width="64" height="64" rx="8" fill="rgba(255,255,255,0.18)"></rect><text x="50%" y="52%" text-anchor="middle" font-size="10" font-weight="700" fill="#fff">${(p.name.split(' ')[0]||'P').slice(0,3)}</text></svg>`;
          const info = el('div',{class:'product-info'});
          const title = el('h3',{class:'product-title'}, p.name);
          const meta = el('div',{class:'product-meta'});
          meta.innerHTML = `<div class="price">$${p.price.toFixed(2)}</div><div class="rating" aria-hidden="true">★ ${p.rating}</div><div class="muted">${p.category}</div>`;
          const desc = el('div',{class:'muted'}, p.description);
          info.appendChild(title);
          info.appendChild(meta);
          info.appendChild(desc);

          const actions = el('div',{class:'card-actions'});
          const addBtn = el('button',{class:'small-btn', 'aria-label':'Add to cart', title:'Add to cart'}, 'Add');
          addBtn.addEventListener('click', ()=>addToCart(p.id));
          const favBtn = el('button',{class:'small-btn', 'aria-label':'Add to wishlist', title:'Add to wishlist'}, '♡');
          actions.appendChild(addBtn);
          actions.appendChild(favBtn);

          card.appendChild(thumb);
          card.appendChild(info);
          card.appendChild(actions);

          popularGrid.appendChild(card);
        });
      }

      // Initial sort: trending by rating + price
      function initialSort(list){
        return [...list].sort((a,b)=> (b.rating - a.rating) || (a.price - b.price));
      }

      renderProducts(initialSort(products));

      // Deals
      const dealsCarousel = document.getElementById('dealsCarousel');
      function renderDeals(){
        dealsCarousel.innerHTML='';
        deals.forEach(d=>{
          const p = products.find(x=>x.id===d.id);
          const saved = Math.round(p.price * (d.discount/100));
          const newPrice = (p.price - saved).toFixed(2);
          const card = el('div',{class:'deal-card', tabindex:'0', 'aria-label': `${p.name} — ${d.discount}% off`});
          const thumb = el('div',{class:'thumb', style:`background:linear-gradient(135deg, ${p.color}, rgba(0,0,0,0.06));min-width:72px;width:72px;height:72px;border-radius:8px;`});
          thumb.innerHTML = `<svg width="48" height="48" viewBox="0 0 64 64" aria-hidden="true"><rect width="64" height="64" rx="8" fill="rgba(255,255,255,0.12)"></rect></svg>`;
          const info = el('div',{style:'display:flex;flex-direction:column;gap:6px;'});
          const title = el('div',{style:'font-weight:800'}, p.name);
          const priceRow = el('div',{}, el('div',{class:'price'}, `$${newPrice}`), el('div',{class:'muted', style:'margin-left:8px;text-decoration:line-through;color:#9ca3af'},`$${p.price.toFixed(2)}`));
          const bottom = el('div',{style:'display:flex;align-items:center;gap:8px;margin-top:6px'});
          const badge = el('div',{class:'deal-badge'}, `${d.discount}% OFF`);
          const timer = el('div',{class:'timer', 'data-ends': d.endsAt}, '00:00:00');
          bottom.appendChild(badge); bottom.appendChild(timer);
          info.appendChild(title); info.appendChild(priceRow); info.appendChild(bottom);
          card.appendChild(thumb); card.appendChild(info);

          card.querySelector('.timer') && (card.querySelector('.timer').id = `timer-${d.id}`);
          dealsCarousel.appendChild(card);
        });
      }

      renderDeals();

      // Update timers
      function formatTime(ms){
        if(ms<=0) return '00:00:00';
        const s = Math.floor(ms/1000);
        const hh = String(Math.floor(s/3600)).padStart(2,'0');
        const mm = String(Math.floor((s%3600)/60)).padStart(2,'0');
        const ss = String(s%60).padStart(2,'0');
        return `${hh}:${mm}:${ss}`;
      }

      function updateTimers(){
        const timers = dealsCarousel.querySelectorAll('.timer');
        let nearest = Infinity;
        timers.forEach(t=>{
          const ends = Number(t.getAttribute('data-ends'));
          const remaining = ends - Date.now();
          t.textContent = formatTime(remaining);
          if(remaining < nearest) nearest = remaining;
        });
        const dealsEnds = document.getElementById('dealsEnds');
        dealsEnds.textContent = nearest===Infinity ? '—' : formatTime(nearest);
      }
      updateTimers();
      setInterval(updateTimers, 1000);

      // Carousel nav
      document.getElementById('prevDeal').addEventListener('click', ()=> {
        dealsCarousel.scrollBy({left:-280,behavior:'smooth'});
      });
      document.getElementById('nextDeal').addEventListener('click', ()=> {
        dealsCarousel.scrollBy({left:280,behavior:'smooth'});
      });

      // Blog posts
      const blogGrid = document.getElementById('blogGrid');
      function renderBlog(){
        blogGrid.innerHTML='';
        blogPosts.forEach(b=>{
          const post = el('article',{class:'post', tabindex:0, 'aria-labelledby':`post-${b.id}-title`});
          const title = el('h3',{id:`post-${b.id}-title`}, b.title);
          const meta = el('div',{class:'muted'}, `${b.author} • ${b.date}`);
          const excerpt = el('p',{}, b.excerpt);
          const read = el('button',{class:'small-btn', style:'margin-top:10px'}, 'Read more');
          read.addEventListener('click', ()=>openModal(b));
          post.appendChild(title);
          post.appendChild(meta);
          post.appendChild(excerpt);
          post.appendChild(read);
          blogGrid.appendChild(post);
        });
      }
      renderBlog();

      // Add to cart functionality
      const cartCountEl = document.getElementById('cartCount');
      let cartCount = 0;
      function addToCart(id){
        cartCount += 1;
        cartCountEl.textContent = cartCount;
        cartCountEl.animate([{transform:'scale(1.15)'},{transform:'scale(1)'}],{duration:220});
      }
      window.addToCart = addToCart;

      document.getElementById('shopNow').addEventListener('click', ()=> {
        window.scrollTo({top:document.getElementById('popularGrid').offsetTop - 40, behavior:'smooth'});
      });

      // Sorting & search
      const sortSelect = document.getElementById('sortSelect');
      const searchInput = document.getElementById('searchInput');
      document.getElementById('refreshBtn').addEventListener('click', ()=>{
        renderProducts(initialSort(products));
      });

      sortSelect.addEventListener('change', ()=>{
        const v = sortSelect.value;
        let list = [...products];
        if(v==='trending') list = initialSort(list);
        else if(v==='price-asc') list.sort((a,b)=>a.price-b.price);
        else if(v==='price-desc') list.sort((a,b)=>b.price-a.price);
        else if(v==='rating') list.sort((a,b)=>b.rating-a.rating);
        renderProducts(list);
      });

      searchInput.addEventListener('input', (e)=>{
        const q = e.target.value.trim().toLowerCase();
        const filtered = products.filter(p=> p.name.toLowerCase().includes(q) || p.category.toLowerCase().includes(q));
        renderProducts(filtered.length ? filtered : products);
      });

      // Modal
      const modal = document.getElementById('modal');
      const modalTitle = document.getElementById('modalTitle');
      const modalMeta = document.getElementById('modalMeta');
      const modalBody = document.getElementById('modalBody');
      const modalClose = document.getElementById('modalClose');

      function openModal(post){
        modalTitle.textContent = post.title;
        modalMeta.textContent = `${post.author} • ${post.date}`;
        modalBody.textContent = post.body;
        modal.style.display = 'flex';
        modal.setAttribute('aria-hidden','false');
        modalClose.focus();
      }
      function closeModal(){
        modal.style.display = 'none';
        modal.setAttribute('aria-hidden','true');
      }
      modalClose.addEventListener('click', closeModal);
      modal.addEventListener('click', (e)=>{ if(e.target===modal) closeModal(); });
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeModal(); });

      // Newsletter
      document.getElementById('newsletterForm').addEventListener('submit', (e)=>{
        e.preventDefault();
        const email = document.getElementById('newsletterEmail').value;
        if(!email || !email.includes('@')) {
          alert('Please enter a valid email address.');
          return;
        }
        alert('Thanks! ' + email + ' has been subscribed.');
        e.target.reset();
      });

      // Initial page states
      document.getElementById('year').textContent = new Date().getFullYear();

      // Accessible focus for carousel using arrow keys
      dealsCarousel.addEventListener('keydown', (e)=>{
        if(e.key === 'ArrowLeft') dealsCarousel.scrollBy({left:-260, behavior:'smooth'});
        if(e.key === 'ArrowRight') dealsCarousel.scrollBy({left:260, behavior:'smooth'});
      });

      // Simple deep-link handlers (demo)
      document.getElementById('viewAllBlog').addEventListener('click', (e)=>{
        e.preventDefault();
        document.getElementById('blogTitle').scrollIntoView({behavior:'smooth'});
      });

      // Small gesture: when clicking a product card title, show quick preview (demo)
      popularGrid.addEventListener('click', (e)=>{
        const article = e.target.closest('.card');
        if(!article) return;
        const titleEl = article.querySelector('.product-title');
        if(e.target === titleEl){
          const name = titleEl.textContent;
          const p = products.find(x=>x.name===name);
          if(p){
            alert(`${p.name}\n\n${p.description}\n\n$${p.price.toFixed(2)}`);
          }
        }
      });

      // Slightly staggered reveal on load
      document.querySelectorAll('.card, .deal-card, .post').forEach((el, i)=>{
        el.style.opacity = 0;
        el.style.transform = 'translateY(8px)';
        setTimeout(()=>{ el.style.transition = 'opacity 380ms ease, transform 380ms ease'; el.style.opacity=1; el.style.transform='translateY(0)'; }, 80*i);
      });
    })();
  </script>
</body>
</html>