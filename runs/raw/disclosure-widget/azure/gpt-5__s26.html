<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Expand/Collapse Widgets Demo</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    :root {
      --bg: #f9fafb;
      --border: #d0d7de;
      --text: #1f2937;
      --muted: #6b7280;
      --accent: #2563eb;
      --accent-bg: #eef2ff;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      padding: 2rem;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      color: var(--text);
      background: var(--bg);
      line-height: 1.5;
    }

    h1 {
      margin: 0 0 1rem;
      font-size: 1.75rem;
    }

    .intro {
      margin: 0 0 2rem;
      color: var(--muted);
    }

    .example {
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 1rem;
      margin: 0 0 1rem;
      box-shadow: 0 1px 2px rgba(0,0,0,0.04);
    }

    .example h2 {
      font-size: 1.125rem;
      margin: 0 0 .75rem;
    }

    .toggle {
      appearance: none;
      border: 1px solid var(--border);
      background: #fff;
      color: var(--text);
      padding: .5rem .75rem;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: .5rem;
    }
    .toggle:hover { border-color: #c6cbd2; background: #fcfcfc; }
    .toggle:focus { outline: 2px solid var(--accent); outline-offset: 2px; }

    .chevron {
      display: inline-block;
      transition: transform 160ms ease;
      width: 1em;
      height: 1em;
    }
    .toggle[aria-expanded="true"] .chevron { transform: rotate(180deg); }

    .details {
      margin-top: .75rem;
      border: 1px dashed var(--border);
      border-radius: 8px;
      padding: .75rem;
      background: #fff;
    }
    .details p { margin: 0 0 .5rem; }
    .details code {
      background: #f3f4f6;
      border: 1px solid var(--border);
      padding: .125rem .25rem;
      border-radius: 4px;
    }

    details.details {
      padding: 0;
      border-style: solid;
    }
    details.details summary {
      cursor: pointer;
      list-style: none;
      padding: .75rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: .5rem;
      background: var(--accent-bg);
      border-bottom: 1px solid var(--border);
      border-radius: 8px 8px 0 0;
      user-select: none;
    }
    details.details summary::-webkit-details-marker { display: none; }
    details.details[open] summary { border-radius: 8px 8px 0 0; }
    details.details .content {
      padding: .75rem;
    }

    .muted { color: var(--muted); font-size: .925rem; }

    @media (prefers-reduced-motion: reduce) {
      .chevron { transition: none; }
    }
  </style>
</head>
<body>
  <h1>Expand/Collapse Widgets</h1>
  <p class="intro">Two accessible patterns: the native details/summary element and a button-controlled panel. Each widget is wrapped in a container with the "example" class, and the content container uses the "details" class.</p>

  <div class="example">
    <h2>Native details/summary</h2>
    <details class="details">
      <summary>
        <svg class="chevron" viewBox="0 0 20 20" aria-hidden="true">
          <path d="M5.22 7.22a.75.75 0 0 1 1.06 0L10 10.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 8.28a.75.75 0 0 1 0-1.06z" fill="currentColor"></path>
        </svg>
        Learn more about cookies
      </summary>
      <div class="content">
        <p>Cookies help websites remember you. They store small pieces of data in your browser, such as your preferences and login state.</p>
        <p class="muted">Tip: Use your browserâ€™s settings to clear cookies or block third-party cookies for more privacy.</p>
      </div>
    </details>
  </div>

  <div class="example">
    <h2>Button-controlled panel</h2>
    <button id="toggle-advanced" class="toggle" aria-expanded="false" aria-controls="advanced-panel">
      <svg class="chevron" viewBox="0 0 20 20" aria-hidden="true">
        <path d="M5.22 7.22a.75.75 0 0 1 1.06 0L10 10.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 8.28a.75.75 0 0 1 0-1.06z" fill="currentColor"></path>
      </svg>
      Show advanced settings
    </button>
    <div id="advanced-panel" class="details" role="region" aria-labelledby="toggle-advanced" hidden>
      <p>Choose how the app behaves:</p>
      <ul>
        <li>Theme: <code>auto</code> | <code>light</code> | <code>dark</code></li>
        <li>Notifications: <code>enabled</code> | <code>muted</code></li>
        <li>Data saver: <code>on</code> | <code>off</code></li>
      </ul>
      <p class="muted">These options are stored in your browser and can be reset anytime.</p>
    </div>
  </div>

  <script>
    // Toggle for button-controlled panels
    function setupButtonToggles() {
      const toggles = document.querySelectorAll('.toggle[aria-controls]');
      toggles.forEach(btn => {
        const panelId = btn.getAttribute('aria-controls');
        const panel = document.getElementById(panelId);
        if (!panel) return;

        // Ensure initial hidden state matches aria-expanded
        const expanded = btn.getAttribute('aria-expanded') === 'true';
        panel.hidden = !expanded;

        btn.addEventListener('click', () => {
          const isExpanded = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!isExpanded));
          panel.hidden = isExpanded;
          // Move focus to panel content when expanding
          if (!isExpanded) {
            panel.setAttribute('tabindex', '-1');
            panel.focus({ preventScroll: true });
            panel.removeAttribute('tabindex');
          }
        });
      });
    }

    // Optional: animate chevron inside native details when open/close
    function setupDetailsChevrons() {
      const nativeDetails = document.querySelectorAll('details.details');
      nativeDetails.forEach(d => {
        const summary = d.querySelector('summary');
        const icon = summary ? summary.querySelector('.chevron') : null;
        if (!summary || !icon) return;

        const updateIcon = () => {
          icon.style.transform = d.hasAttribute('open') ? 'rotate(180deg)' : 'rotate(0deg)';
        };
        updateIcon();
        d.addEventListener('toggle', updateIcon);
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      setupButtonToggles();
      setupDetailsChevrons();
    });
  </script>
</body>
</html>