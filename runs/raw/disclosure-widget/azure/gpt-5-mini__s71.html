<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#0b79d0;
      --bg:#f8f9fb;
      --panel:#ffffff;
      --border:#e1e6ee;
      --radius:8px;
      --gap:12px;
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      margin: 24px;
      background: linear-gradient(180deg, #f5f7fb 0%, var(--bg) 100%);
      color:#1a1f27;
      line-height:1.4;
    }

    h1{
      margin:0 0 18px 0;
      font-size:1.25rem;
      color:var(--accent);
    }

    p.lead{
      margin:0 0 22px 0;
      color:#334155;
      max-width:60ch;
    }

    /* container for each example */
    .example{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:16px;
      margin:18px 0;
      box-shadow: 0 1px 2px rgba(16,24,40,0.03), 0 4px 8px rgba(16,24,40,0.04);
    }

    /* toggle button */
    .toggle {
      display:flex;
      align-items:center;
      gap:12px;
      width:100%;
      background:transparent;
      border:0;
      padding:10px 12px;
      text-align:left;
      cursor:pointer;
      border-radius:8px;
      font-weight:600;
      color:#0f1724;
      transition:background .15s ease;
    }

    .toggle:focus{
      outline:3px solid rgba(11,121,208,0.18);
      outline-offset:2px;
    }

    .toggle:hover{
      background: #f1f5f9;
    }

    .chev {
      width:18px;
      height:18px;
      transform-origin:center;
      transition:transform .18s ease;
      color:var(--accent);
      display:inline-block;
    }

    .toggle[aria-expanded="true"] .chev{
      transform:rotate(90deg);
    }

    .summary {
      display:flex;
      flex-direction:column;
      gap:2px;
      flex:1;
      min-width:0;
    }

    .summary .title{
      font-size:0.98rem;
    }

    .summary .meta{
      font-size:0.82rem;
      color:#475569;
      font-weight:500;
    }

    /* controlled content panel */
    .details{
      margin-top:12px;
      overflow:hidden;
      border-radius:6px;
      background:linear-gradient(180deg,#ffffff,#fbfdff);
      border:1px solid var(--border);
      padding:12px;
      box-sizing:border-box;
      transition: max-height .28s ease, opacity .22s ease, transform .22s ease;
      opacity:1;
      transform:translateY(0);
    }

    /* collapsed state managed with hidden attribute for semantics */
    .details[hidden]{
      padding-top:0;
      padding-bottom:0;
      opacity:0;
      transform:translateY(-6px);
      max-height:0 !important;
      border-color:transparent;
      overflow:hidden;
    }

    /* small helper */
    .note{
      font-size:0.86rem;
      color:#475569;
      margin:8px 0 0 0;
    }

    /* respects reduced motion preference */
    @media (prefers-reduced-motion: reduce) {
      .details{
        transition:none;
      }
      .chev{
        transition:none;
      }
    }

    /* example content styling */
    .details p{
      margin:0 0 10px 0;
      color:#0f1724;
    }

    .details ul{
      margin:6px 0 0 20px;
      color:#0f1724;
    }

    /* compact visual for nested interactive area */
    .panel-actions{
      display:flex;
      gap:10px;
      margin-top:8px;
    }

    .btn{
      padding:8px 12px;
      background:var(--accent);
      color:white;
      border:0;
      border-radius:6px;
      cursor:pointer;
      font-weight:600;
    }

    .btn.secondary{
      background:#e6eef9;
      color:var(--accent);
      font-weight:600;
    }

  </style>
</head>
<body>
  <h1>Expand / Collapse widget</h1>
  <p class="lead">A simple, accessible expand/collapse pattern. Each widget is wrapped with a div.example and the controlled content container uses a details class.</p>

  <!-- Example 1: Basic closed -->
  <div class="example">
    <button class="toggle" id="toggle-1" data-toggle="details" aria-expanded="false" aria-controls="details-1" type="button">
      <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M9 6l6 6-6 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <div class="summary">
        <span class="title">Show details</span>
        <span class="meta">Click to expand this panel and reveal more information.</span>
      </div>
    </button>

    <div id="details-1" class="details" role="region" aria-labelledby="toggle-1" hidden>
      <p>This is the expanded content for the first example. It is initially collapsed. Use the button above to toggle visibility.</p>
      <ul>
        <li>Accessible: button with aria-expanded and aria-controls</li>
        <li>Animated open/close unless user prefers reduced motion</li>
      </ul>
    </div>
  </div>

  <!-- Example 2: Pre-expanded -->
  <div class="example">
    <button class="toggle" id="toggle-2" data-toggle="details" aria-expanded="true" aria-controls="details-2" type="button">
      <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M9 6l6 6-6 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <div class="summary">
        <span class="title">Pre-expanded panel</span>
        <span class="meta">This panel starts expanded (aria-expanded="true").</span>
      </div>
    </button>

    <div id="details-2" class="details" role="region" aria-labelledby="toggle-2">
      <p>Because the toggle button's aria-expanded attribute starts as "true", this details container is visible on load. The script will respect that initial state.</p>
      <div class="panel-actions">
        <button class="btn" type="button" onclick="alert('Primary action clicked')">Primary action</button>
        <button class="btn secondary" type="button" onclick="alert('Secondary clicked')">Secondary</button>
      </div>
    </div>
  </div>

  <!-- Example 3: Nested content and long content -->
  <div class="example">
    <button class="toggle" id="toggle-3" data-toggle="details" aria-expanded="false" aria-controls="details-3" type="button">
      <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M9 6l6 6-6 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <div class="summary">
        <span class="title">More information (long content)</span>
        <span class="meta">Good for FAQs, long descriptions, or nested interactive controls.</span>
      </div>
    </button>

    <div id="details-3" class="details" role="region" aria-labelledby="toggle-3" hidden>
      <p>Here is a larger block of content to demonstrate the animation and layout behavior. The panel supports any HTML content inside, including forms and interactive controls.</p>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio. Praesent libero. Sed cursus ante dapibus diam.</p>
      <form onsubmit="event.preventDefault(); alert('Form submitted');">
        <label>
          Your note:
          <br/>
          <textarea rows="4" style="width:100%; margin-top:6px; box-sizing:border-box; padding:8px; border-radius:6px; border:1px solid var(--border);"></textarea>
        </label>
        <div style="margin-top:8px;">
          <button class="btn" type="submit">Send</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    (function(){
      // Utility to animate open/close using max-height.
      // Select all toggle buttons with data-toggle="details"
      const toggles = Array.from(document.querySelectorAll('[data-toggle="details"]'));

      // Respect reduced motion preference
      const reduceMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      function setPanelState(button, panel, expanded){
        button.setAttribute('aria-expanded', expanded ? 'true' : 'false');

        if (expanded) {
          // Show panel
          panel.removeAttribute('hidden');

          if (!reduceMotion) {
            // Animate from current height to full height
            const start = panel.getBoundingClientRect().height;
            panel.style.maxHeight = start + 'px';
            // Allow style to apply before measuring scrollHeight
            requestAnimationFrame(() => {
              const full = panel.scrollHeight;
              panel.style.transition = 'max-height .28s ease, opacity .22s ease, transform .22s ease';
              panel.style.maxHeight = full + 'px';
              panel.style.opacity = '1';
              panel.style.transform = 'translateY(0)';
              // cleanup after animation
              const cleanup = () => {
                panel.style.maxHeight = '';
                panel.style.transition = '';
                panel.removeEventListener('transitionend', cleanup);
              };
              panel.addEventListener('transitionend', cleanup);
            });
          } else {
            panel.style.maxHeight = '';
            panel.style.opacity = '1';
            panel.style.transform = 'translateY(0)';
          }

        } else {
          // Collapse panel
          if (!reduceMotion) {
            const start = panel.getBoundingClientRect().height;
            panel.style.maxHeight = start + 'px';
            panel.style.opacity = '1';
            // Allow style application
            requestAnimationFrame(() => {
              panel.style.transition = 'max-height .22s ease, opacity .18s ease, transform .18s ease';
              panel.style.maxHeight = '0px';
              panel.style.opacity = '0';
              panel.style.transform = 'translateY(-6px)';
              const after = () => {
                panel.setAttribute('hidden', '');
                panel.style.maxHeight = '';
                panel.style.transition = '';
                panel.removeEventListener('transitionend', after);
              };
              panel.addEventListener('transitionend', after);
            });
          } else {
            panel.setAttribute('hidden', '');
            panel.style.maxHeight = '';
            panel.style.opacity = '0';
            panel.style.transform = 'translateY(-6px)';
          }
        }
      }

      toggles.forEach(button => {
        const panelId = button.getAttribute('aria-controls');
        if (!panelId) return;
        const panel = document.getElementById(panelId);
        if (!panel) return;

        // Initialize panel state to match button's aria-expanded attribute
        const initExpanded = button.getAttribute('aria-expanded') === 'true';
        if (initExpanded) {
          panel.removeAttribute('hidden');
        } else {
          panel.setAttribute('hidden', '');
        }

        // Ensure accessible region labeling
        panel.setAttribute('role', panel.getAttribute('role') || 'region');
        panel.setAttribute('aria-labelledby', panel.getAttribute('aria-labelledby') || button.id);

        button.addEventListener('click', () => {
          const isExpanded = button.getAttribute('aria-expanded') === 'true';
          setPanelState(button, panel, !isExpanded);
        });

        // Optional: close on Escape when focus is inside panel (nice-to-have)
        panel.addEventListener('keydown', (ev) => {
          if (ev.key === 'Escape') {
            setPanelState(button, panel, false);
            button.focus();
          }
        });
      });
    })();
  </script>
</body>
</html>