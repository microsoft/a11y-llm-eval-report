<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Expand/Collapse Widgets Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --border: #e0e0e0;
      --bg: #f9fafb;
      --text: #1f2937;
      --muted: #6b7280;
      --primary: #2563eb;
      --focus: #93c5fd;
      --radius: 12px;
    }

    html, body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background: white;
      line-height: 1.55;
    }

    header {
      padding: 24px;
      border-bottom: 1px solid var(--border);
      background: linear-gradient(180deg, #ffffff 0%, #f7fafc 100%);
    }

    header h1 {
      margin: 0;
      font-size: 1.5rem;
    }

    header p {
      margin: 6px 0 0;
      color: var(--muted);
    }

    main {
      max-width: 880px;
      margin: 0 auto;
      padding: 24px;
    }

    .examples {
      display: grid;
      gap: 20px;
    }

    .example {
      background: var(--bg);
      padding: 16px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: 0 1px 2px rgba(0,0,0,0.04);
    }

    .example h2 {
      margin: 0 0 10px;
      font-size: 1.1rem;
    }

    .example .note {
      margin: 8px 0 14px;
      color: var(--muted);
      font-size: 0.95rem;
    }

    /* Native <details> styling */
    details.details {
      border: 1px solid var(--border);
      border-radius: 10px;
      background: white;
      overflow: clip;
    }

    details.details summary {
      list-style: none;
      cursor: pointer;
      user-select: none;
      padding: 12px 14px 12px 36px;
      position: relative;
      font-weight: 600;
      outline: none;
    }

    details.details summary::marker {
      content: "";
    }

    details.details summary::before {
      content: "▸";
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--muted);
      transition: transform 160ms ease;
      font-size: 1rem;
      line-height: 1;
    }

    details.details[open] summary::before {
      content: "▾";
      transform: translateY(-50%);
    }

    details.details .details-content {
      border-top: 1px solid var(--border);
      padding: 14px;
      animation: reveal 180ms ease;
    }

    @keyframes reveal {
      from { opacity: 0; transform: translateY(-2px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* Custom toggle button controlled content */
    .toggle {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 14px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: white;
      color: var(--text);
      cursor: pointer;
      font-weight: 600;
      transition: border-color 150ms ease, box-shadow 150ms ease, transform 100ms ease;
    }

    .toggle:hover {
      border-color: #cbd5e1;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }

    .toggle:active {
      transform: translateY(1px);
    }

    .toggle:focus-visible {
      outline: none;
      box-shadow: 0 0 0 3px var(--focus);
    }

    .toggle .chevron {
      width: 16px;
      height: 16px;
      display: inline-block;
      transform: rotate(0deg);
      transition: transform 160ms ease;
      color: var(--muted);
    }

    .toggle[aria-expanded="true"] .chevron {
      transform: rotate(180deg);
    }

    .details {
      margin-top: 12px;
      border: 1px solid var(--border);
      border-radius: 10px;
      background: white;
      overflow: hidden;
    }

    .details[hidden] {
      display: none !important;
    }

    .details .details-inner {
      padding: 14px;
      animation: reveal 180ms ease;
    }

    .details .actions {
      display: flex;
      gap: 8px;
      margin-top: 10px;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.875rem;
      color: var(--muted);
      background: #f1f5f9;
      border: 1px solid #e2e8f0;
      border-radius: 999px;
      padding: 4px 10px;
    }

    .link {
      color: var(--primary);
      text-decoration: none;
      font-weight: 600;
    }

    .link:hover {
      text-decoration: underline;
    }

    footer {
      margin: 30px auto 0;
      max-width: 880px;
      padding: 20px 24px 40px;
      color: var(--muted);
      font-size: 0.95rem;
      border-top: 1px solid var(--border);
    }
  </style>
</head>
<body>
  <header>
    <h1>Expand/Collapse Widgets</h1>
    <p>Examples showing native and custom approaches to progressive disclosure.</p>
  </header>

  <main>
    <div class="examples">
      <div class="example">
        <h2>Native details/summary widget</h2>
        <p class="note">Uses the HTML details element with built-in toggle behavior.</p>
        <details class="details">
          <summary>Product specifications</summary>
          <div class="details-content">
            <ul>
              <li>Display: 6.7" OLED, 120Hz</li>
              <li>Processor: Octa-core 3.2 GHz</li>
              <li>RAM: 12 GB</li>
              <li>Storage: 256 GB</li>
              <li>Battery: 5000 mAh</li>
            </ul>
            <div class="chip" aria-hidden="true">Tip: Click the summary to collapse</div>
          </div>
        </details>
      </div>

      <div class="example">
        <h2>Custom button-controlled widget</h2>
        <p class="note">A button toggles a separate container with class "details". Uses ARIA for accessibility.</p>
        <button class="toggle"
                aria-expanded="false"
                aria-controls="details-1"
                id="toggle-1"
                data-collapsed-label="Show shipping details"
                data-expanded-label="Hide shipping details">
          <span class="chevron" aria-hidden="true">⌄</span>
          <span class="label">Show shipping details</span>
        </button>

        <div class="details" id="details-1" hidden>
          <div class="details-inner">
            <h3 style="margin:0 0 8px;">Shipping details</h3>
            <p>
              Orders are processed within 1–2 business days. Estimated delivery times:
            </p>
            <ul>
              <li>Domestic: 3–5 business days</li>
              <li>International: 7–14 business days</li>
              <li>Expedited: 1–2 business days</li>
            </ul>
            <div class="actions">
              <a href="#" class="link" data-action="collapse" aria-label="Collapse shipping details">Collapse</a>
              <span class="chip" aria-hidden="true">ESC closes when focused inside</span>
            </div>
          </div>
        </div>
      </div>

      <div class="example">
        <h2>Multiple independent widgets</h2>
        <p class="note">Each toggle controls its own container so you can open more than one at once.</p>

        <button class="toggle"
                aria-expanded="false"
                aria-controls="details-2"
                id="toggle-2"
                data-collapsed-label="Show FAQs"
                data-expanded-label="Hide FAQs">
          <span class="chevron" aria-hidden="true">⌄</span>
          <span class="label">Show FAQs</span>
        </button>
        <div class="details" id="details-2" hidden>
          <div class="details-inner">
            <h3 style="margin:0 0 8px;">FAQs</h3>
            <p><strong>Q:</strong> Can I return my order?<br><strong>A:</strong> Yes, within 30 days of delivery.</p>
            <p><strong>Q:</strong> Do you ship internationally?<br><strong>A:</strong> Yes, to most countries worldwide.</p>
            <div class="actions">
              <a href="#" class="link" data-action="collapse" aria-label="Collapse FAQs">Collapse</a>
            </div>
          </div>
        </div>

        <button class="toggle"
                aria-expanded="false"
                aria-controls="details-3"
                id="toggle-3"
                data-collapsed-label="Show warranty info"
                data-expanded-label="Hide warranty info"
                style="margin-top:10px;">
          <span class="chevron" aria-hidden="true">⌄</span>
          <span class="label">Show warranty info</span>
        </button>
        <div class="details" id="details-3" hidden>
          <div class="details-inner">
            <h3 style="margin:0 0 8px;">Warranty</h3>
            <p>All devices include a 2-year limited warranty covering manufacturing defects.</p>
            <ul>
              <li>Free repair or replacement</li>
              <li>24/7 support</li>
              <li>Extended coverage available at checkout</li>
            </ul>
            <div class="actions">
              <a href="#" class="link" data-action="collapse" aria-label="Collapse warranty info">Collapse</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer>
    Keyboard notes:
    <ul>
      <li>Buttons are focusable and toggle with Enter/Space.</li>
      <li>Press Escape while focused inside a custom details panel to collapse it.</li>
      <li>Native details/summary supports keyboard and screen readers without extra scripting.</li>
    </ul>
  </footer>

  <script>
    (function () {
      function setButtonState(btn, expanded) {
        btn.setAttribute('aria-expanded', String(expanded));
        var expandedLabel = btn.getAttribute('data-expanded-label') || 'Hide details';
        var collapsedLabel = btn.getAttribute('data-collapsed-label') || 'Show details';
        var labelEl = btn.querySelector('.label');
        if (labelEl) labelEl.textContent = expanded ? expandedLabel : collapsedLabel;
      }

      function toggleControlled(btn) {
        var id = btn.getAttribute('aria-controls');
        if (!id) return;
        var panel = document.getElementById(id);
        if (!panel) return;

        var willExpand = panel.hasAttribute('hidden');
        if (willExpand) {
          panel.removeAttribute('hidden');
        } else {
          panel.setAttribute('hidden', '');
        }
        setButtonState(btn, willExpand);
        if (willExpand) {
          // Move focus into panel for accessibility
          var focusable = panel.querySelector('a, button, input, textarea, select, [tabindex]:not([tabindex="-1"])');
          if (focusable) focusable.focus();
        } else {
          btn.focus();
        }
      }

      document.addEventListener('click', function (e) {
        var btn = e.target.closest('button.toggle');
        if (btn) {
          e.preventDefault();
          toggleControlled(btn);
          return;
        }
        var collapseLink = e.target.closest('[data-action="collapse"]');
        if (collapseLink) {
          e.preventDefault();
          var details = collapseLink.closest('.details');
          if (details && !details.hasAttribute('hidden')) {
            details.setAttribute('hidden', '');
            // Find controlling button by matching aria-controls
            var controller = document.querySelector('button.toggle[aria-controls="' + details.id + '"]');
            if (controller) setButtonState(controller, false);
            if (controller) controller.focus();
          }
        }
      });

      document.addEventListener('keydown', function (e) {
        if (e.key !== 'Escape') return;
        var active = document.activeElement;
        var panel = active ? active.closest('.details') : null;
        if (panel && !panel.hasAttribute('hidden')) {
          panel.setAttribute('hidden', '');
          var controller = document.querySelector('button.toggle[aria-controls="' + panel.id + '"]');
          if (controller) {
            setButtonState(controller, false);
            controller.focus();
          }
        }
      });

      // Initialize button labels to collapsed state for consistency
      document.querySelectorAll('button.toggle').forEach(function (btn) {
        setButtonState(btn, false);
      });
    }());
  </script>
</body>
</html>