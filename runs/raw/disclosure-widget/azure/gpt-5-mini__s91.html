<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#0b82ff;
      --bg:#f8fbff;
      --muted:#6b7280;
      --radius:8px;
      --gap:12px;
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: #fff;
      color: #0f1724;
      line-height: 1.4;
      padding: 28px;
    }

    h1{ margin:0 0 18px 0; font-size:20px; }
    p.lead{ margin:0 0 20px 0; color:var(--muted); }

    .example{
      background: linear-gradient(180deg,var(--bg),#fff);
      border: 1px solid rgba(15,23,36,0.06);
      padding:16px;
      border-radius: var(--radius);
      margin-bottom:18px;
      box-shadow: 0 1px 2px rgba(2,6,23,0.03);
    }

    .toggle{
      display:flex;
      align-items:center;
      width:100%;
      gap:var(--gap);
      background: linear-gradient(180deg,white, #fbfdff);
      border: 1px solid rgba(15,23,36,0.06);
      padding:10px 12px;
      border-radius: 8px;
      font-weight:600;
      color:#072244;
      cursor:pointer;
      transition: box-shadow .12s ease, transform .06s ease;
    }
    .toggle:focus{
      outline: 3px solid rgba(11,130,255,0.18);
      outline-offset:3px;
    }
    .toggle:active{ transform: translateY(1px); }

    .toggle .icon{
      width:18px; height:18px; display:inline-block; flex:0 0 18px;
      transition: transform .22s ease;
      color:var(--accent);
    }
    .toggle[aria-expanded="true"] .icon{
      transform: rotate(90deg);
    }

    /* Controlled content container - must have class "details" per requirement */
    .details{
      overflow: hidden;
      max-height: 0;
      transition: max-height 320ms cubic-bezier(.2,.9,.2,1), opacity 220ms ease;
      opacity: 0;
      margin-top:12px;
      border-left: 3px solid rgba(11,130,255,0.12);
      padding: 0 10px;
      border-radius: 6px;
      background: linear-gradient(180deg,#ffffff,#fbfeff);
    }
    .details.open{
      opacity: 1;
    }

    .details .inner{
      padding:12px 8px 14px 8px;
      color:#0b2438;
      font-size:14px;
    }

    /* Minor layout niceties */
    small.meta{ color:var(--muted); display:block; margin-top:6px; font-weight:500; }

    /* Respect users who prefer reduced motion */
    @media (prefers-reduced-motion: reduce){
      .details{ transition: none; }
      .toggle .icon{ transition: none; }
    }
  </style>
</head>
<body>
  <h1>Expand / Collapse Widget Examples</h1>
  <p class="lead">Each widget is wrapped in a div.example. The controlled content container uses the class "details". Buttons use aria-expanded and aria-controls for accessibility.</p>

  <!-- Example 1: Simple expand/collapse -->
  <div class="example">
    <button class="toggle" id="toggle-1" aria-expanded="false" aria-controls="details-1">
      <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false">
        <path d="M8 5v14l11-7L8 5z" fill="currentColor"/>
      </svg>
      Quick overview
    </button>

    <div id="details-1" class="details" role="region" aria-labelledby="toggle-1" aria-hidden="true">
      <div class="inner">
        <p>This is a short piece of content that is revealed when the button above is activated. It demonstrates a basic expand/collapse interaction using aria-expanded, aria-controls, and a container with the class "details".</p>
        <small class="meta">Click the button again to collapse.</small>
      </div>
    </div>
  </div>

  <!-- Example 2: Expand with longer content -->
  <div class="example">
    <button class="toggle" id="toggle-2" aria-expanded="false" aria-controls="details-2">
      <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false">
        <path d="M8 5v14l11-7L8 5z" fill="currentColor"/>
      </svg>
      More details (long content)
    </button>

    <div id="details-2" class="details" role="region" aria-labelledby="toggle-2" aria-hidden="true">
      <div class="inner">
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Voluptatibus, distinctio, dolore? Doloribus magni nostrum aspernatur totam ducimus veniam corporis officia. Sint, eaque.</p>
        <p>Here is an example list to show multi-line content:</p>
        <ul>
          <li>Point one with some explanation</li>
          <li>Point two with additional notes</li>
          <li>Point three to round things out</li>
        </ul>
        <p>Animations adjust the max-height dynamically so the collapse feels smooth and content size doesn't require fixed values.</p>
      </div>
    </div>
  </div>

  <!-- Example 3: Accordion-like multiple widgets -->
  <div class="example">
    <div style="display:flex;gap:10px;flex-direction:column;">
      <button class="toggle" id="toggle-a" aria-expanded="false" aria-controls="details-a">
        <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false">
          <path d="M8 5v14l11-7L8 5z" fill="currentColor"/>
        </svg>
        Section A
      </button>
      <div id="details-a" class="details" role="region" aria-labelledby="toggle-a" aria-hidden="true">
        <div class="inner">
          <p>Content for Section A.</p>
        </div>
      </div>

      <button class="toggle" id="toggle-b" aria-expanded="false" aria-controls="details-b">
        <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false">
          <path d="M8 5v14l11-7L8 5z" fill="currentColor"/>
        </svg>
        Section B
      </button>
      <div id="details-b" class="details" role="region" aria-labelledby="toggle-b" aria-hidden="true">
        <div class="inner">
          <p>Content for Section B. This setup can be extended to behave like an accordion by closing the other sections when one opens. This demo leaves them independent.</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function(){
      // Toggle behavior for buttons controlling .details containers
      function openDetails(details){
        // measure and animate open
        details.classList.add('open');
        details.setAttribute('aria-hidden','false');

        // remove explicit max-height to allow smooth expansion by setting measured px value
        var full = details.scrollHeight;
        details.style.maxHeight = full + 'px';
      }

      function closeDetails(details){
        // For a smooth closing animation, set max-height to current height then force to 0
        var cur = details.scrollHeight;
        details.style.maxHeight = cur + 'px';
        // Force a reflow before changing to 0
        window.requestAnimationFrame(function(){
          details.style.maxHeight = '0px';
        });

        details.classList.remove('open');
        details.setAttribute('aria-hidden','true');
      }

      function toggle(event){
        var btn = event.currentTarget;
        var controls = btn.getAttribute('aria-controls');
        if(!controls) return;
        var details = document.getElementById(controls);
        if(!details) return;

        var expanded = btn.getAttribute('aria-expanded') === 'true';
        if(expanded){
          btn.setAttribute('aria-expanded','false');
          closeDetails(details);
        } else {
          btn.setAttribute('aria-expanded','true');
          openDetails(details);
        }
      }

      // Initialize: attach handlers to all buttons with aria-controls
      var toggles = document.querySelectorAll('button[aria-controls]');
      toggles.forEach(function(btn){
        var controls = btn.getAttribute('aria-controls');
        var details = document.getElementById(controls);
        // Ensure details has class "details" per requirement (if JS runs, add it if missing)
        if(details && !details.classList.contains('details')){
          details.classList.add('details');
        }

        btn.addEventListener('click', toggle);

        // If server-side / no-js expectation is different, we keep all details collapsed by default.
        // Ensure maxHeight is set initially (0) for consistency.
        if(details){
          details.style.maxHeight = '0px';
          details.setAttribute('aria-hidden','true');
        }
      });

      // Optional: close details when clicking outside (uncomment to enable)
      // document.addEventListener('click', function(e){
      //   if(!e.target.closest('.example')) return;
      // });

      // Handle window resize: when opened, recalculate maxHeight to accommodate content changes
      var resizeTimeout;
      window.addEventListener('resize', function(){
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(function(){
          document.querySelectorAll('.details.open').forEach(function(details){
            details.style.maxHeight = details.scrollHeight + 'px';
          });
        }, 120);
      });

      // Graceful behavior for users preferring reduced motion: remove inline transitions if requested
      try{
        if(window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches){
          document.querySelectorAll('.details').forEach(function(d){
            d.style.transition = 'none';
          });
        }
      }catch(e){}
    })();
  </script>
</body>
</html>