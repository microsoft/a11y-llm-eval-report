<html class="no-js" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root{
      --bg:#f7f9fc;
      --panel:#ffffff;
      --accent:#0366d6;
      --text:#0b1220;
      --muted:#556070;
      --radius:8px;
      --shadow: 0 2px 10px rgba(16,24,40,0.06);
      --transition: 280ms cubic-bezier(.2,.9,.3,1);
    }

    html,body{height:100%}
    body{
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,#eef4fb 0%,var(--bg) 100%);
      color:var(--text);
      margin:0;
      padding:32px;
      line-height:1.45;
    }

    h1{margin:0 0 20px;font-weight:600}
    .container{max-width:820px;margin:0 auto}

    /* Example wrapper */
    .example{
      background:var(--panel);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:16px;
      margin:18px 0;
      border:1px solid rgba(11,18,32,0.04);
    }

    /* Toggle button */
    .toggle{
      display:flex;
      align-items:center;
      gap:12px;
      width:100%;
      background:transparent;
      border:0;
      padding:8px 12px;
      text-align:left;
      cursor:pointer;
      border-radius:6px;
      font-size:16px;
      font-weight:600;
      color:var(--text);
      transition:background var(--transition);
    }
    .toggle:focus{
      outline:3px solid rgba(3,102,214,0.15);
      outline-offset:2px;
    }
    .toggle:hover{background:rgba(3,102,214,0.04)}
    .toggle .label{flex:1}
    .toggle .chev{
      width:20px;height:20px;
      display:inline-block;
      transform-origin:center;
      transition:transform var(--transition);
      color:var(--accent);
    }

    /* controlled content container must have class "details" */
    .details{
      overflow:hidden;
      max-height:0;
      transition:max-height var(--transition), opacity var(--transition);
      opacity:0;
      margin-top:10px;
    }
    .details[aria-hidden="false"]{
      opacity:1;
    }

    /* when example has open class rotate chevron */
    .example.open .chev{ transform:rotate(90deg) }

    /* internal content */
    .details .content{
      padding:8px 4px 4px 4px;
      color:var(--muted);
      font-size:15px;
    }

    /* small demo variants */
    .meta{display:block;font-size:13px;color:var(--muted);margin-top:6px}
    .example.small .toggle{font-size:14px;padding:6px 10px}
    .example.small .details .content{font-size:14px}

    /* accessibility: if JS is disabled, show details */
    .no-js .details{max-height:none;opacity:1}
    @media (prefers-reduced-motion:reduce){
      .details{transition:none}
      .chev{transition:none}
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Expand / Collapse Widgets</h1>

    <!-- Example 1: simple closed by default -->
    <div class="example" id="example-1">
      <button class="toggle" id="toggle-1" aria-expanded="false" aria-controls="details-1">
        <span class="label">More about this feature</span>
        <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path fill="currentColor" d="M9 6l6 6-6 6"/>
        </svg>
      </button>

      <div class="details" id="details-1" role="region" aria-labelledby="toggle-1" aria-hidden="true">
        <div class="content">
          This section contains additional information related to the feature. Use the button above to expand or collapse this content. The widget manages aria-expanded on the button and aria-hidden on this container for assistive technology.
        </div>
      </div>
    </div>

    <!-- Example 2: open by default -->
    <div class="example open" id="example-2">
      <button class="toggle" id="toggle-2" aria-expanded="true" aria-controls="details-2">
        <span class="label">Configuration details (open by default)</span>
        <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path fill="currentColor" d="M9 6l6 6-6 6"/>
        </svg>
      </button>

      <div class="details" id="details-2" role="region" aria-labelledby="toggle-2" aria-hidden="false">
        <div class="content">
          Here are configuration options you can review immediately. This widget starts open to show how content appears when expanded. The script will animate opening/closing smoothly.
        </div>
      </div>
    </div>

    <!-- Example 3: small variant with longer content -->
    <div class="example small" id="example-3">
      <button class="toggle" id="toggle-3" aria-expanded="false" aria-controls="details-3">
        <span class="label">Release notes â€” what's new</span>
        <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path fill="currentColor" d="M9 6l6 6-6 6"/>
        </svg>
      </button>

      <div class="details" id="details-3" role="region" aria-labelledby="toggle-3" aria-hidden="true">
        <div class="content">
          <ul>
            <li>Improved accessibility for keyboard and screen reader users.</li>
            <li>Performance enhancements for faster toggling and smoother animations.</li>
            <li>Bug fixes and polish across multiple UI components.</li>
            <li>Updated documentation and examples for developers implementing the widget.</li>
          </ul>
        </div>
      </div>
    </div>

  </div>

  <script>
    // Remove no-js class so CSS can treat no-JS case separately
    document.documentElement.classList.remove('no-js');

    (function initExpandCollapse(){
      // Find all widgets
      const examples = document.querySelectorAll('.example');

      examples.forEach(example => {
        const btn = example.querySelector('.toggle');
        const details = example.querySelector('.details');

        if (!btn || !details) return;

        // Ensure IDs exist for aria relations
        if (!btn.id) btn.id = 'toggle-' + Math.random().toString(36).slice(2,9);
        if (!details.id) details.id = 'details-' + Math.random().toString(36).slice(2,9);

        // Sync initial state from example.open class or attributes
        const isOpenByClass = example.classList.contains('open');
        const ariaExpanded = btn.getAttribute('aria-expanded');
        const shouldBeOpen = (ariaExpanded === 'true') || isOpenByClass;

        btn.setAttribute('aria-expanded', shouldBeOpen ? 'true' : 'false');
        details.setAttribute('aria-hidden', shouldBeOpen ? 'false' : 'true');

        // Set initial max-height if open
        if (shouldBeOpen) {
          details.style.maxHeight = details.scrollHeight + 'px';
        } else {
          details.style.maxHeight = '0px';
        }

        // Toggle function
        function toggle(explicit){
          const currentlyExpanded = btn.getAttribute('aria-expanded') === 'true';
          const willExpand = explicit !== undefined ? explicit : !currentlyExpanded;

          btn.setAttribute('aria-expanded', willExpand ? 'true' : 'false');
          details.setAttribute('aria-hidden', willExpand ? 'false' : 'true');

          if (willExpand) {
            // Set maxHeight to content height to animate
            const height = details.scrollHeight;
            details.style.maxHeight = height + 'px';
            example.classList.add('open');
          } else {
            // Collapse
            details.style.maxHeight = details.scrollHeight + 'px';
            // Force reflow to ensure transition
            // eslint-disable-next-line no-unused-expressions
            details.offsetHeight;
            details.style.maxHeight = '0px';
            example.classList.remove('open');
          }
        }

        // Click handler
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          toggle();
        });

        // Also allow Enter/Space behavior is default for buttons

        // After transition ends, if expanded keep max-height none to allow dynamic content,
        // otherwise keep at 0.
        details.addEventListener('transitionend', (e) => {
          if (e.propertyName !== 'max-height') return;
          if (details.getAttribute('aria-hidden') === 'false') {
            // Remove fixed max-height to allow the content to grow naturally
            details.style.maxHeight = 'none';
          }
        });

        // If user expands while maxHeight is none (after transition), update it on next collapse
        // No additional code needed; scrollHeight will be used on collapse.

      });
    })();
  </script>
</body>
</html>