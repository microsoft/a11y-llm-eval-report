<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --bg:#f7f8fa;
      --card:#ffffff;
      --accent:#0366d6;
      --muted:#6b7280;
      --radius:8px;
      --transition:250ms cubic-bezier(.2,.8,.2,1);
    }

    body{
      margin:24px;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
      background:linear-gradient(180deg,#eef2f7 0%,var(--bg) 100%);
      color:#0f172a;
      line-height:1.45;
    }

    h1{
      margin:0 0 18px 0;
      font-size:20px;
    }

    p.lead{
      margin:0 0 18px 0;
      color:var(--muted);
      font-size:14px;
    }

    .example{
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:0 1px 2px rgba(16,24,40,0.04), 0 6px 24px rgba(16,24,40,0.06);
      padding:12px;
      margin:16px 0;
      max-width:760px;
    }

    .header-row{
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
    }

    .expander{
      display:inline-flex;
      align-items:center;
      gap:10px;
      background:transparent;
      border:1px solid rgba(2,6,23,0.06);
      padding:10px 12px;
      border-radius:8px;
      cursor:pointer;
      font-weight:600;
      color:#04263b;
      transition:box-shadow var(--transition), transform var(--transition);
      user-select:none;
    }

    .expander:focus{
      outline:3px solid rgba(3,102,214,0.12);
      outline-offset:3px;
    }

    .expander:hover{
      box-shadow:0 6px 18px rgba(2,6,23,0.06);
      transform:translateY(-1px);
    }

    .expander .icon{
      width:18px;
      height:18px;
      display:inline-block;
      transition:transform var(--transition);
      will-change:transform;
      flex:0 0 18px;
    }

    .expander[aria-expanded="true"] .icon{
      transform:rotate(180deg);
    }

    /* Controlled content (.details) */
    .details{
      overflow:hidden;
      max-height:0;
      transition:max-height var(--transition), opacity var(--transition);
      opacity:0;
      margin-top:10px;
      padding:0 2px;
      border-top:1px dashed rgba(2,6,23,0.06);
    }

    .details.open{
      opacity:1;
      /* max-height will be set inline for smooth animation; this rule is a fallback */
    }

    .details > .content{
      padding:14px 6px 6px 6px;
      font-size:14px;
      color:#0f172a;
      background:linear-gradient(180deg, rgba(3,102,214,0.02), transparent 40%);
      border-radius:6px;
    }

    /* small helper for nested content example */
    .panel{
      background:linear-gradient(180deg,#fff 0%,#fbfdff 100%);
      border:1px solid rgba(2,6,23,0.04);
      padding:10px;
      border-radius:6px;
      margin-bottom:8px;
    }

    /* Respect prefers-reduced-motion */
    @media (prefers-reduced-motion: reduce){
      .details, .expander .icon, .expander{
        transition:none;
      }
    }

    /* small responsive */
    @media (max-width:520px){
      .expander{
        width:100%;
        justify-content:space-between;
      }
    }

  </style>
</head>
<body>
  <h1>Expand / Collapse Widget Examples</h1>
  <p class="lead">Three examples show accessible expand/collapse controls. Each widget is wrapped with a container having class="example", and each controlled content area uses class="details".</p>

  <!-- Example 1: Simple description -->
  <div class="example" id="example-1">
    <div class="header-row">
      <div>
        <strong>Example 1:</strong>
        <div style="color:var(--muted);font-size:13px;">Simple toggle to reveal a short description.</div>
      </div>
      <button
        class="expander"
        id="toggle-1"
        aria-expanded="false"
        aria-controls="details-1"
        type="button"
      >
        <span>Show details</span>
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
        </svg>
      </button>
    </div>

    <div
      id="details-1"
      class="details"
      role="region"
      aria-labelledby="toggle-1"
      aria-hidden="true"
    >
      <div class="content">
        This is a concise description that is hidden by default. The expand/collapse control updates aria-expanded and aria-hidden for accessibility and animates open/close smoothly.
      </div>
    </div>
  </div>

  <!-- Example 2: Multiple paragraphs -->
  <div class="example" id="example-2">
    <div class="header-row">
      <div>
        <strong>Example 2:</strong>
        <div style="color:var(--muted);font-size:13px;">Reveal multi-paragraph content.</div>
      </div>
      <button
        class="expander"
        id="toggle-2"
        aria-expanded="false"
        aria-controls="details-2"
        type="button"
      >
        <span>Read more</span>
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
        </svg>
      </button>
    </div>

    <div
      id="details-2"
      class="details"
      role="region"
      aria-labelledby="toggle-2"
      aria-hidden="true"
    >
      <div class="content">
        <p style="margin-top:0;">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec lacinia, nisl in dictum tristique, arcu nibh pulvinar felis, sit amet sodales metus justo a risus.</p>
        <p style="margin-bottom:0;">Suspendisse potenti. Integer pretium, erat in facilisis blandit, sem urna feugiat lectus, eu faucibus metus nibh quis arcu. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.</p>
      </div>
    </div>
  </div>

  <!-- Example 3: Nested panels inside details -->
  <div class="example" id="example-3">
    <div class="header-row">
      <div>
        <strong>Example 3:</strong>
        <div style="color:var(--muted);font-size:13px;">A larger content area with nested panels.</div>
      </div>
      <button
        class="expander"
        id="toggle-3"
        aria-expanded="false"
        aria-controls="details-3"
        type="button"
      >
        <span>Expand content</span>
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
        </svg>
      </button>
    </div>

    <div
      id="details-3"
      class="details"
      role="region"
      aria-labelledby="toggle-3"
      aria-hidden="true"
    >
      <div class="content">
        <div class="panel">
          <strong>Panel A</strong>
          <div style="color:var(--muted);margin-top:6px;">Curabitur non nulla sit amet nisl tempus convallis quis ac lectus. Vivamus magna justo, lacinia eget consectetur sed, convallis at tellus.</div>
        </div>
        <div class="panel">
          <strong>Panel B</strong>
          <div style="color:var(--muted);margin-top:6px;">Praesent sapien massa, convallis a pellentesque nec, egestas non nisi. Curabitur aliquet quam id dui posuere blandit.</div>
        </div>
        <div class="panel">
          <strong>Panel C</strong>
          <div style="color:var(--muted);margin-top:6px;">Donec sollicitudin molestie malesuada. Nulla porttitor accumsan tincidunt.</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function(){
      // Initialize toggles
      const toggles = document.querySelectorAll('button[aria-controls]');

      toggles.forEach(button => {
        const detailsId = button.getAttribute('aria-controls');
        const details = document.getElementById(detailsId);

        // Ensure the details container has class 'details' per requirement
        if (!details || !details.classList.contains('details')) {
          console.warn('Controlled element', detailsId, 'is missing or does not have class="details"');
        }

        // Set initial state based on aria-expanded
        const expanded = button.getAttribute('aria-expanded') === 'true';
        if (expanded) {
          open(details, false);
          details.classList.add('open');
          details.setAttribute('aria-hidden', 'false');
        } else {
          details.style.maxHeight = '0px';
          details.setAttribute('aria-hidden', 'true');
          details.classList.remove('open');
        }

        // Click toggles
        button.addEventListener('click', () => {
          const isExpanded = button.getAttribute('aria-expanded') === 'true';
          if (isExpanded) {
            button.setAttribute('aria-expanded', 'false');
            close(details);
            details.setAttribute('aria-hidden', 'true');
            details.classList.remove('open');
            button.querySelector('span')?.textContent && setButtonLabel(button, false);
          } else {
            button.setAttribute('aria-expanded', 'true');
            open(details, true);
            details.setAttribute('aria-hidden', 'false');
            details.classList.add('open');
            button.querySelector('span')?.textContent && setButtonLabel(button, true);
          }
        });

        // Optional: animate height on resize if open
        window.addEventListener('resize', () => {
          if (button.getAttribute('aria-expanded') === 'true') {
            // update max-height to current scrollHeight
            details.style.maxHeight = details.scrollHeight + 'px';
          }
        });
      });

      function setButtonLabel(button, expanded){
        // Keep simple, change the visible label text to reflect state
        const span = button.querySelector('span');
        if (!span) return;
        const base = span.textContent.trim();
        // If original text contains "Show"/"Hide" patterns, swap; otherwise use generic labels
        if (/show|read|expand/i.test(base)){
          span.textContent = expanded ? base.replace(/show|read|expand/i, (m)=> {
            if (/read/i.test(m)) return 'Hide';
            if (/show/i.test(m)) return 'Hide';
            if (/expand/i.test(m)) return 'Collapse';
            return 'Hide';
          }) : base.replace(/hide|collapse/i, (m)=> {
            if (/hide/i.test(m)) return 'Show';
            if (/collapse/i.test(m)) return 'Expand';
            return 'Show';
          });
        } else {
          span.textContent = expanded ? 'Hide details' : 'Show details';
        }
      }

      function open(detailsEl, animate = true){
        // Remove any display:none (we don't use hidden) and set maxHeight to scrollHeight for animation
        if (!detailsEl) return;
        const startHeight = detailsEl.scrollHeight;
        if (!animate){
          detailsEl.style.maxHeight = startHeight + 'px';
          return;
        }
        // Set to the measured height to trigger transition
        detailsEl.style.maxHeight = startHeight + 'px';

        // After transition, clear maxHeight so content can grow/shrink naturally
        const onTransitionEnd = function(e){
          // Only care about max-height transition
          if (e.propertyName !== 'max-height') return;
          detailsEl.style.maxHeight = detailsEl.scrollHeight + 'px';
          detailsEl.removeEventListener('transitionend', onTransitionEnd);
        };
        detailsEl.addEventListener('transitionend', onTransitionEnd);
      }

      function close(detailsEl){
        if (!detailsEl) return;
        // To animate from current height to 0, first set explicit maxHeight to current scrollHeight,
        // then in the next frame set it to 0.
        const currentHeight = detailsEl.scrollHeight;
        detailsEl.style.maxHeight = currentHeight + 'px';
        // Force layout
        detailsEl.getBoundingClientRect();
        requestAnimationFrame(() => {
          detailsEl.style.maxHeight = '0px';
        });
      }
    })();
  </script>
</body>
</html>