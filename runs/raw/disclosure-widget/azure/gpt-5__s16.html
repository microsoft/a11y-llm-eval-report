<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Expand/Collapse Widgets Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --bg: #0f172a;
      --panel: #111827;
      --border: #1f2937;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #60a5fa;
      --accent-2: #a78bfa;
      --focus: #f59e0b;
    }
    html, body {
      background: linear-gradient(180deg, #0a0f1f, #0b1022 60%, #0a0f1f);
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      margin: 0;
      padding: 0;
    }
    body {
      padding: 2rem;
      display: grid;
      gap: 1.25rem;
    }
    h1 {
      margin: 0 0 0.25rem 0;
      font-weight: 700;
      letter-spacing: 0.2px;
    }
    .lead {
      margin: 0 0 1rem 0;
      color: var(--muted);
    }
    .example {
      border: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius: 12px;
      padding: 1rem;
      box-shadow: 0 1px 0 rgba(255,255,255,0.04) inset, 0 10px 25px rgba(0,0,0,0.35);
    }

    /* Common details content styling */
    .details {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 0.75rem 0.9rem;
      margin-top: 0.75rem;
      box-shadow: 0 1px 0 rgba(255,255,255,0.05) inset;
    }
    .details p { margin: 0.5rem 0; }
    .details ul { margin: 0.5rem 0 0.5rem 1.25rem; }
    .details code {
      background: rgba(255,255,255,0.06);
      padding: 0.1rem 0.35rem;
      border-radius: 6px;
      border: 1px solid rgba(255,255,255,0.08);
    }

    /* Native <details> styling */
    details.details {
      padding: 0;
    }
    details.details > summary {
      list-style: none;
      cursor: pointer;
      padding: 0.75rem 1rem;
      user-select: none;
      font-weight: 600;
      color: var(--text);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      border-bottom: 1px solid var(--border);
      border-radius: 10px 10px 0 0;
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
    }
    details.details[open] > summary {
      border-bottom-color: transparent;
    }
    details.details > summary:focus {
      outline: 2px solid var(--focus);
      outline-offset: 3px;
      border-radius: 10px;
    }
    details.details > summary::before {
      content: "▶";
      color: var(--accent);
      transition: transform 200ms ease;
      display: inline-block;
      width: 1em;
      text-align: center;
    }
    details.details[open] > summary::before {
      content: "▼";
      color: var(--accent-2);
    }
    details.details > .panel {
      padding: 0.75rem 1rem;
      background: var(--panel);
      border-radius: 0 0 10px 10px;
    }

    /* Toggle button styles */
    button.toggle, button.acc-toggle {
      appearance: none;
      border: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      color: var(--text);
      font-weight: 600;
      border-radius: 10px;
      padding: 0.6rem 0.9rem 0.6rem 2rem;
      cursor: pointer;
      position: relative;
      transition: transform 80ms ease, border-color 150ms ease, background 150ms ease;
    }
    button.toggle::before, button.acc-toggle::before {
      content: attr(data-icon);
      content: "▶";
      color: var(--accent);
      position: absolute;
      left: 0.75rem;
      top: 50%;
      transform: translateY(-50%);
      transition: transform 200ms ease, color 200ms ease;
    }
    button.toggle[aria-expanded="true"]::before,
    button.acc-toggle[aria-expanded="true"]::before {
      content: "▼";
      color: var(--accent-2);
    }
    button.toggle:hover, button.acc-toggle:hover {
      border-color: #334155;
      background: linear-gradient(180deg, rgba(255,255,255,0.09), rgba(255,255,255,0.04));
    }
    button.toggle:active, button.acc-toggle:active {
      transform: translateY(1px);
    }
    button.toggle:focus, button.acc-toggle:focus {
      outline: 2px solid var(--focus);
      outline-offset: 3px;
    }

    /* Accordion layout */
    .accordion {
      display: grid;
      gap: 0.5rem;
    }
    .accordion .details {
      margin-top: 0;
    }

    /* Helper small text */
    .hint {
      color: var(--muted);
      font-size: 0.9rem;
      margin-top: 0.25rem;
    }

    /* Smooth show/hide for JS-driven panels */
    .details[hidden] { display: none !important; }
    .fade-enter {
      animation: fadeIn 180ms ease-out forwards;
    }
    .fade-exit {
      animation: fadeOut 140ms ease-in forwards;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-2px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeOut {
      from { opacity: 1; transform: translateY(0); }
      to   { opacity: 0; transform: translateY(-2px); }
    }
  </style>
</head>
<body>
  <h1>Expand/Collapse Widgets</h1>
  <p class="lead">Three approaches: native details/summary, a JS-powered toggle, and an accordion. Each widget is wrapped in an element with class "example", and the container for the controlled content has class "details".</p>

  <div class="example">
    <details class="details">
      <summary>Native details/summary</summary>
      <div class="panel">
        <p>This uses the built-in HTML <code>details</code> and <code>summary</code> elements. It's accessible, keyboard-friendly, and doesn’t require JavaScript.</p>
        <ul>
          <li>Click or press Space/Enter on the summary to toggle.</li>
          <li>Works across modern browsers.</li>
          <li>Supports nested content and styling.</li>
        </ul>
      </div>
    </details>
    <p class="hint">Tip: Use this when you want the simplest solution.</p>
  </div>

  <div class="example">
    <button class="toggle" aria-controls="custom-1" aria-expanded="false">Show details</button>
    <div id="custom-1" class="details" hidden>
      <h3 style="margin-top:0">Custom toggle (JS-driven)</h3>
      <p>This panel is controlled via a button using <code>aria-expanded</code> and <code>aria-controls</code>. It’s flexible and works anywhere you need custom behavior.</p>
      <ul>
        <li>Updates button text and ARIA attributes on toggle.</li>
        <li>Press Escape inside the panel to collapse.</li>
        <li>Easily adapt for animations and more complex logic.</li>
      </ul>
    </div>
    <p class="hint">This pattern is useful when you need to control multiple panels or coordinate with other UI states.</p>
  </div>

  <div class="example">
    <div class="accordion" role="region" aria-label="Accordion example">
      <button class="acc-toggle" aria-controls="acc-panel-1" aria-expanded="false">Accordion Section A</button>
      <div id="acc-panel-1" class="details" hidden>
        <p>Only one accordion section opens at a time. Opening A closes B and C automatically.</p>
        <ul>
          <li>Good for FAQs or segmented content.</li>
          <li>Improves scanning by reducing clutter.</li>
        </ul>
      </div>

      <button class="acc-toggle" aria-controls="acc-panel-2" aria-expanded="false">Accordion Section B</button>
      <div id="acc-panel-2" class="details" hidden>
        <p>Section B content goes here. You can include any markup, lists, and even images.</p>
        <ul>
          <li>ARIA attributes keep state in sync.</li>
          <li>Focus remains on the button that controls the panel.</li>
        </ul>
      </div>

      <button class="acc-toggle" aria-controls="acc-panel-3" aria-expanded="false">Accordion Section C</button>
      <div id="acc-panel-3" class="details" hidden>
        <p>Section C wraps up the examples. Try toggling quickly to see the smooth transitions.</p>
        <ul>
          <li>Fine-tune animations via CSS classes.</li>
          <li>Adapt logic to allow multiple panels open if desired.</li>
        </ul>
      </div>
    </div>
    <p class="hint">This accordion ensures only one panel is open at a time for a compact layout.</p>
  </div>

  <script>
    (function () {
      function animateShow(el) {
        el.hidden = false;
        el.classList.remove('fade-exit');
        el.classList.add('fade-enter');
        el.addEventListener('animationend', () => {
          el.classList.remove('fade-enter');
        }, { once: true });
      }
      function animateHide(el) {
        el.classList.remove('fade-enter');
        el.classList.add('fade-exit');
        el.addEventListener('animationend', () => {
          el.classList.remove('fade-exit');
          el.hidden = true;
        }, { once: true });
      }

      // Setup for custom toggle button(s)
      document.querySelectorAll('button.toggle').forEach(btn => {
        const targetId = btn.getAttribute('aria-controls');
        const panel = document.getElementById(targetId);
        if (!panel) return;

        function update(expanded) {
          btn.setAttribute('aria-expanded', String(expanded));
          btn.textContent = expanded ? 'Hide details' : 'Show details';
          if (expanded) animateShow(panel); else animateHide(panel);
        }

        // Initialize state
        const isExpanded = btn.getAttribute('aria-expanded') === 'true';
        panel.hidden = !isExpanded;
        btn.textContent = isExpanded ? 'Hide details' : 'Show details';

        btn.addEventListener('click', () => {
          update(!(btn.getAttribute('aria-expanded') === 'true'));
        });

        // Escape key inside panel collapses it
        panel.addEventListener('keydown', (e) => {
          if (e.key === 'Escape') {
            update(false);
            btn.focus();
          }
        });
      });

      // Setup for accordion
      document.querySelectorAll('.accordion').forEach(acc => {
        const buttons = acc.querySelectorAll('button.acc-toggle');
        const panels = Array.from(buttons).map(b => document.getElementById(b.getAttribute('aria-controls'))).filter(Boolean);

        function openOnly(index) {
          buttons.forEach((btn, i) => {
            const panel = panels[i];
            const shouldOpen = i === index;
            btn.setAttribute('aria-expanded', String(shouldOpen));
            if (panel) {
              if (shouldOpen) animateShow(panel); else animateHide(panel);
            }
          });
        }

        // Initialize all to closed
        buttons.forEach((btn, i) => {
          const panel = panels[i];
          btn.setAttribute('aria-expanded', 'false');
          if (panel) panel.hidden = true;

          btn.addEventListener('click', () => {
            const expanded = btn.getAttribute('aria-expanded') === 'true';
            if (expanded) {
              // Collapse if clicking an open section
              btn.setAttribute('aria-expanded', 'false');
              animateHide(panels[i]);
            } else {
              openOnly(i);
            }
          });

          // Keyboard support: Enter/Space on button already triggers click
          // Escape inside panel collapses it and returns focus
          if (panel) {
            panel.addEventListener('keydown', (e) => {
              if (e.key === 'Escape') {
                btn.setAttribute('aria-expanded', 'false');
                animateHide(panel);
                btn.focus();
              }
            });
          }
        });
      });
    })();
  </script>
</body>
</html>