<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --bg:#f7f9fc;
      --card:#ffffff;
      --muted:#6b7280;
      --accent:#0ea5a4;
      --radius:8px;
      --gap:12px;
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg, #eef2f7 0%, #fbfdff 100%);
      color:#0f172a;
      margin:24px;
      line-height:1.45;
    }

    h1{
      font-size:1.25rem;
      margin:0 0 16px 0;
    }

    .wrap{
      max-width:880px;
      margin:0 auto;
    }

    /* Example wrapper required by the task */
    .example{
      background:var(--card);
      border:1px solid rgba(15,23,42,0.06);
      border-radius:var(--radius);
      padding:16px;
      margin-bottom:16px;
      box-shadow: 0 2px 6px rgba(15,23,42,0.04);
    }

    .meta{
      display:flex;
      align-items:center;
      gap:12px;
      margin-bottom:10px;
    }

    .toggle{
      appearance:none;
      -webkit-appearance:none;
      border:1px solid rgba(15,23,42,0.06);
      background:linear-gradient(180deg,#ffffff,#fbfdff);
      padding:8px 12px;
      border-radius:8px;
      font-weight:600;
      color:var(--accent);
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:8px;
      transition:box-shadow .18s ease, transform .08s ease;
    }

    .toggle:active{ transform:translateY(1px); }
    .toggle:focus{ outline:3px solid rgba(14,165,164,0.12); }

    .toggle .arrow{
      width:12px; height:12px;
      display:inline-block;
      transition:transform .22s ease;
      transform-origin:center;
    }

    /* rotate arrow when expanded using aria-expanded attribute on the button */
    .toggle[aria-expanded="true"] .arrow{ transform:rotate(180deg); }

    /* The controlled content container required by the task: class="details" */
    .details{
      overflow:hidden;
      margin-top:12px;
      border-radius:8px;
      border:1px solid rgba(15,23,42,0.03);
      background:linear-gradient(180deg,#fbfdff,#ffffff);
      padding:12px;
    }

    /* When the container is marked as hidden via aria-hidden="true" we'll visually collapse it.
       The script below also uses inline styles to animate height. */
    .details[aria-hidden="true"]{
      padding-top:0;
      padding-bottom:0;
      border:0;
    }

    .note{
      color:var(--muted);
      font-size:0.95rem;
    }

    /* small code-styled panel for demonstration content */
    .demo-content{
      background:#f8fafc;
      border-radius:6px;
      padding:12px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
      font-size:0.95rem;
      color:#0b1220;
    }

    footer{
      margin-top:18px;
      color:var(--muted);
      font-size:0.9rem;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Expand / Collapse Widget Examples</h1>
    <p class="note">Each widget below is wrapped in a div.example and the controlled content container uses the class details.</p>

    <div class="example" id="ex-1">
      <div class="meta">
        <strong>Simple disclosure</strong>
        <button class="toggle" id="toggle-1" aria-controls="details-1" aria-expanded="false" type="button">
          <span class="arrow" aria-hidden="true">▾</span>
          Show details
        </button>
      </div>
      <div id="details-1" class="details" aria-hidden="true">
        <div class="demo-content">
          <p><strong>What you'll see:</strong> This content is hidden by default. Clicking the button expands this panel where you can put any information — text, images, code, or other controls.</p>
          <ul>
            <li>Accessible: the button has aria-expanded and aria-controls.</li>
            <li>Animated: smooth expand/collapse using height animation.</li>
            <li>Wrapped: the widget is inside a div.example and the content has class details.</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="example" id="ex-2">
      <div class="meta">
        <strong>Initially open</strong>
        <button class="toggle" id="toggle-2" aria-controls="details-2" aria-expanded="true" type="button">
          <span class="arrow" aria-hidden="true">▾</span>
          Hide content
        </button>
      </div>
      <div id="details-2" class="details" aria-hidden="false">
        <div class="demo-content">
          <p>This example starts expanded. The script will honor the initial aria-hidden value on page load.</p>
          <p>Try collapsing and re-opening — the animation should be consistent.</p>
        </div>
      </div>
    </div>

    <div class="example" id="ex-3">
      <div class="meta">
        <strong>Multiple paragraphs</strong>
        <button class="toggle" id="toggle-3" aria-controls="details-3" aria-expanded="false" type="button">
          <span class="arrow" aria-hidden="true">▾</span>
          Read more
        </button>
      </div>
      <div id="details-3" class="details" aria-hidden="true">
        <div class="demo-content">
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Nisi, magni?</p>
          <p>Aliquid, rerum. Dolorum, quae iste. Porro, similique soluta nostrum modi dolores, sunt temporibus debitis accusantium quam.</p>
          <p>Keyboard users: press Space or Enter on the button to toggle. The button is a native &lt;button&gt; element which provides correct semantics.</p>
        </div>
      </div>
    </div>

    <footer>
      Tip: you can inspect the button's aria-expanded and the details' aria-hidden attributes to see the state changes.
    </footer>
  </div>

  <script>
    (function(){
      // Utility to smoothly expand/collapse .details elements while keeping ARIA attributes in sync.
      function animateOpen(details){
        details.style.removeProperty('display');
        let display = window.getComputedStyle(details).display;
        if (display === 'none') display = 'block';
        details.style.display = display;

        const startHeight = details.clientHeight; // normally 0
        details.style.overflow = 'hidden';
        details.style.maxHeight = startHeight + 'px';

        // force a reflow to pick up the starting maxHeight
        details.getBoundingClientRect();

        const targetHeight = details.scrollHeight + 'px';
        details.style.transition = 'max-height 260ms cubic-bezier(.2,.9,.2,1)';
        details.style.maxHeight = targetHeight;

        function done(){
          details.style.removeProperty('max-height');
          details.style.removeProperty('overflow');
          details.style.removeProperty('transition');
          details.removeEventListener('transitionend', done);
        }
        details.addEventListener('transitionend', done);
      }

      function animateClose(details){
        // set fixed height then animate to 0
        details.style.overflow = 'hidden';
        details.style.maxHeight = details.scrollHeight + 'px';

        // force reflow
        details.getBoundingClientRect();

        details.style.transition = 'max-height 220ms cubic-bezier(.2,.9,.2,1)';
        details.style.maxHeight = '0px';

        function done(){
          details.style.display = 'none';
          details.style.removeProperty('max-height');
          details.style.removeProperty('overflow');
          details.style.removeProperty('transition');
          details.removeEventListener('transitionend', done);
        }
        details.addEventListener('transitionend', done);
      }

      function toggle(event){
        const btn = event.currentTarget;
        const controls = btn.getAttribute('aria-controls');
        if (!controls) return;
        const details = document.getElementById(controls);
        if (!details) return;

        const expanded = btn.getAttribute('aria-expanded') === 'true';
        if (expanded){
          // close
          btn.setAttribute('aria-expanded','false');
          details.setAttribute('aria-hidden','true');
          animateClose(details);
          btn.querySelector('.arrow')?.setAttribute('aria-hidden','true');
          // update button label if desired
          if (btn.dataset.closeLabel) btn.textContent = btn.dataset.openLabel || 'Show details';
          else {
            // try to keep the arrow and text pattern
            const arrow = document.createElement('span'); arrow.className='arrow'; arrow.textContent='▾'; arrow.setAttribute('aria-hidden','true');
            btn.innerHTML = '';
            btn.appendChild(arrow);
            btn.appendChild(document.createTextNode(' Show details'));
          }
        } else {
          // open
          btn.setAttribute('aria-expanded','true');
          details.setAttribute('aria-hidden','false');
          animateOpen(details);
          // update button label if desired
          if (btn.dataset.openLabel) btn.textContent = btn.dataset.closeLabel || 'Hide details';
          else {
            const arrow = document.createElement('span'); arrow.className='arrow'; arrow.textContent='▾'; arrow.setAttribute('aria-hidden','true');
            btn.innerHTML = '';
            btn.appendChild(arrow);
            btn.appendChild(document.createTextNode(' Hide details'));
          }
        }
      }

      // Attach handlers to all buttons with class .toggle
      document.addEventListener('DOMContentLoaded', function(){
        const toggles = document.querySelectorAll('button.toggle[aria-controls]');
        toggles.forEach(function(btn){
          const controls = btn.getAttribute('aria-controls');
          const details = document.getElementById(controls);
          if (!details) return;

          // Ensure the details element has the required class (defensive)
          if (!details.classList.contains('details')) details.classList.add('details');

          // Normalize initial display based on aria-hidden
          const hidden = details.getAttribute('aria-hidden') === 'true';
          if (hidden){
            details.style.display = 'none';
            // keep collapses visually minimal via CSS (some padding adjustments handled in CSS)
          } else {
            details.style.display = '';
          }

          // Wire click
          btn.addEventListener('click', toggle);
        });
      });
    })();
  </script>
</body>
</html>