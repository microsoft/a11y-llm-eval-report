<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#2563eb;
      --bg:#ffffff;
      --muted:#6b7280;
      --radius:8px;
      --gap:12px;
    }
    body{
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: #f8fafc;
      color:#0f172a;
      margin:32px;
      line-height:1.45;
    }

    h1{
      margin:0 0 18px 0;
      font-size:20px;
    }
    p.lead {
      margin:0 0 18px 0;
      color:var(--muted);
      font-size:14px;
    }

    /* Example container wrapper requirement */
    .example{
      background:var(--bg);
      border:1px solid #e6edf8;
      padding:16px;
      border-radius:var(--radius);
      box-shadow: 0 1px 0 rgba(15,23,42,0.02);
      margin-bottom:18px;
      max-width:700px;
    }

    /* Toggle button */
    .toggle{
      display:flex;
      align-items:center;
      gap:var(--gap);
      width:100%;
      padding:10px 12px;
      font-size:15px;
      background:linear-gradient(180deg, #ffffff, #fbfdff);
      border:1px solid #e6eefc;
      border-radius:8px;
      cursor:pointer;
      color:var(--accent);
      text-align:left;
      outline: none;
      transition:box-shadow .12s, transform .06s;
    }
    .toggle:hover{ box-shadow: 0 4px 14px rgba(37,99,235,0.08); }
    .toggle:active{ transform:translateY(1px); }

    .toggle .title {
      flex:1;
      font-weight:600;
      color: #0f172a;
    }
    .toggle .meta {
      color:var(--muted);
      font-size:13px;
    }

    /* caret icon using pseudo element, rotates when expanded */
    .toggle::after{
      content: "â–¾";
      display:inline-block;
      margin-left:8px;
      transition: transform .18s ease;
      color:var(--muted);
      font-size:14px;
    }
    .toggle[aria-expanded="true"]::after{
      transform: rotate(180deg);
      color:var(--accent);
    }

    /* Content area required to have class "details" */
    .details{
      overflow:hidden;
      max-height:0;
      transition: max-height .28s cubic-bezier(.2,.9,.2,1);
      margin-top:12px;
      border-radius:6px;
      padding:0 6px; /* small padding so inner spacing is consistent when closed */
    }
    .details .inner{
      padding:12px 6px 18px 6px;
      background: linear-gradient(180deg, #fbfdff, #ffffff);
      border:1px solid #eef6ff;
      border-radius:6px;
      color:#0b1220;
      box-shadow: inset 0 0 0 1px rgba(14,165,233,0.02);
    }
    .details p{ margin:0 0 10px 0; color: #334155; font-size:14px; }
    .details ul{ margin:6px 0 0 18px; color:#334155; }

    /* Small helper styles */
    .muted { color:var(--muted); font-size:13px; }
    .kbd{
      background:#f1f5f9;
      border:1px solid #e2e8f0;
      padding:2px 6px;
      border-radius:6px;
      font-size:12px;
      margin-left:8px;
    }

    /* Focus styles */
    .toggle:focus{
      box-shadow: 0 0 0 4px rgba(37,99,235,0.12);
    }
  </style>
</head>
<body>
  <h1>Expand / Collapse Widget Examples</h1>
  <p class="lead">Each widget is wrapped with a div.example. The controlled content container uses the class "details". Use Enter or Space to toggle.</p>

  <div class="example">
    <button class="toggle" id="toggle-1" aria-expanded="false" aria-controls="details-1">
      <span class="title">What is the refund policy?</span>
      <span class="meta">Quick answer</span>
    </button>

    <div class="details" id="details-1" role="region" aria-labelledby="toggle-1" aria-hidden="true">
      <div class="inner">
        <p>We offer a 30-day refund policy on most purchases. If you are unsatisfied, contact support and we'll help process your return.</p>
        <ul>
          <li>Request within 30 days of purchase.</li>
          <li>Provide order number and reason for return.</li>
          <li>Refunds processed within 5-7 business days after approval.</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="example">
    <button class="toggle" id="toggle-2" aria-expanded="false" aria-controls="details-2">
      <span class="title">How do I change my password?</span>
      <span class="meta">Step-by-step</span>
    </button>

    <div class="details" id="details-2" role="region" aria-labelledby="toggle-2" aria-hidden="true">
      <div class="inner">
        <p>Follow these steps to update your password from the account settings page:</p>
        <ol>
          <li>Open Account &gt; Settings.</li>
          <li>Choose "Security" then "Change password".</li>
          <li>Enter your current password and the new password twice, then save.</li>
        </ol>
        <p class="muted">Tip: Use a strong, unique password and consider enabling two-factor authentication.</p>
      </div>
    </div>
  </div>

  <div class="example">
    <button class="toggle" id="toggle-3" aria-expanded="false" aria-controls="details-3">
      <span class="title">Accessibility notes</span>
      <span class="meta">ARIA-friendly</span>
    </button>

    <div class="details" id="details-3" role="region" aria-labelledby="toggle-3" aria-hidden="true">
      <div class="inner">
        <p>This widget uses a button with aria-expanded and aria-controls. The content container has role="region" and aria-labelledby to help screen reader users navigate.</p>
        <p class="muted">Keyboard: focus the button and press Enter or Space to toggle the content.</p>
      </div>
    </div>
  </div>

  <script>
    (function () {
      // Initialize all toggle buttons
      var toggles = document.querySelectorAll('.toggle');

      toggles.forEach(function (btn) {
        var detailsId = btn.getAttribute('aria-controls');
        var details = document.getElementById(detailsId);
        if (!details) return;

        // Ensure initial collapsed state (in case markup changed)
        details.style.maxHeight = '0px';
        details.setAttribute('aria-hidden', 'true');
        details.classList.remove('open');

        // Click handler
        btn.addEventListener('click', function (e) {
          toggle(btn, details);
        });

        // Keyboard support (space/enter)
        btn.addEventListener('keydown', function (e) {
          var code = e.key;
          if (code === ' ' || code === 'Spacebar' || code === 'Enter') {
            e.preventDefault();
            toggle(btn, details);
          }
        });

        // Make sure transitionend leaves the element flexible when opened
        details.addEventListener('transitionend', function (e) {
          if (e.propertyName !== 'max-height') return;
          if (btn.getAttribute('aria-expanded') === 'true') {
            // Remove explicit maxHeight to allow the content to grow/shrink naturally
            details.style.maxHeight = 'none';
            details.classList.add('open');
            details.setAttribute('aria-hidden', 'false');
          } else {
            details.classList.remove('open');
            // keep maxHeight 0
            details.style.maxHeight = '0px';
            details.setAttribute('aria-hidden', 'true');
          }
        });
      });

      function toggle(button, details){
        var expanded = button.getAttribute('aria-expanded') === 'true';

        if (!expanded) {
          // OPEN
          // If maxHeight is 'none' currently, set it to scrollHeight first
          // set explicit height to current scrollHeight and then let transition expand
          details.style.maxHeight = details.scrollHeight + 'px';
          // Mark button expanded immediately for assistive tech
          button.setAttribute('aria-expanded', 'true');
          // ensure aria-hidden is false so screen readers can access content while it animates
          details.setAttribute('aria-hidden', 'false');

          // After the next frame the transitionend handler will set maxHeight to none
        } else {
          // CLOSE
          // If the element had maxHeight 'none', set it to its current height to animate from
          if (details.style.maxHeight === 'none' || details.style.maxHeight === '') {
            details.style.maxHeight = details.scrollHeight + 'px';
          }
          // Force a reflow so the next change to maxHeight will animate
          // eslint-disable-next-line no-unused-expressions
          details.offsetHeight;
          // Begin collapse
          details.style.maxHeight = '0px';
          // Mark button collapsed immediately
          button.setAttribute('aria-expanded', 'false');
          // We will set aria-hidden to true after transition completes (see handler)
        }
      }
    })();
  </script>
</body>
</html>