<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root {
      --border: #d1d5db;
      --bg: #f9fafb;
      --fg: #111827;
      --accent: #2563eb;
      --muted: #6b7280;
    }

    html, body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--fg);
      background: white;
      line-height: 1.5;
    }

    .page {
      max-width: 960px;
      margin: 0 auto;
      padding: 24px;
    }

    h1 {
      font-size: 1.75rem;
      margin: 0 0 16px;
    }
    p.lead {
      color: var(--muted);
      margin: 0 0 24px;
    }

    .examples {
      display: grid;
      gap: 20px;
    }

    .example {
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 16px;
      background: var(--bg);
    }

    .example h2 {
      margin: 0 0 12px;
      font-size: 1.25rem;
    }
    .example .desc {
      margin: 0 0 12px;
      color: var(--muted);
      font-size: 0.95rem;
    }

    /* Native <details> styling */
    details.details {
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 8px 12px;
    }
    details.details summary {
      cursor: pointer;
      list-style: none;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
      outline: none;
    }
    details.details summary::-webkit-details-marker {
      display: none;
    }
    details.details summary::before {
      content: "▸";
      display: inline-block;
      transition: transform 160ms ease;
      color: var(--accent);
      font-size: 1rem;
    }
    details.details[open] summary::before {
      transform: rotate(90deg);
    }
    details.details .content {
      margin-top: 10px;
      color: var(--fg);
    }

    /* Custom toggle */
    .toggle-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }
    .toggle-row .label {
      font-weight: 600;
    }
    .toggle-btn {
      appearance: none;
      border: 1px solid var(--border);
      border-radius: 999px;
      background: #fff;
      color: var(--fg);
      font-size: 0.95rem;
      padding: 6px 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .toggle-btn:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }
    .toggle-btn .icon {
      width: 18px;
      height: 18px;
      display: inline-grid;
      place-items: center;
      color: var(--accent);
      font-weight: 700;
    }

    .details {
      margin-top: 12px;
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 12px;
    }

    /* Accordion */
    .accordion {
      display: grid;
      gap: 8px;
    }
    .accordion-item {
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 6px;
      overflow: hidden;
    }
    .accordion-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding: 10px 12px;
    }
    .accordion-header .title {
      font-weight: 600;
    }
    .accordion-btn {
      appearance: none;
      border: 0;
      background: transparent;
      cursor: pointer;
      color: var(--fg);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-weight: 600;
    }
    .accordion-btn:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
      border-radius: 4px;
    }
    .accordion-btn .chev {
      width: 18px;
      height: 18px;
      display: inline-grid;
      place-items: center;
      color: var(--accent);
      transition: transform 160ms ease;
    }
    .accordion-btn[aria-expanded="true"] .chev {
      transform: rotate(90deg);
    }
    .accordion-panel.details {
      border: 0;
      border-top: 1px solid var(--border);
      border-radius: 0;
      margin: 0;
    }

    code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.95em;
      background: #f3f4f6;
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 2px 4px;
    }
  </style>
</head>
<body>
  <main class="page">
    <h1>Expand/Collapse Widgets</h1>
    <p class="lead">This page demonstrates several expand/collapse widgets. Each widget is wrapped in a div with the class "example", and each controlled content container uses the "details" class.</p>

    <section class="examples">
      <div class="example">
        <h2>Example 1: Native details/summary</h2>
        <p class="desc">Uses the built-in HTML <code>&lt;details&gt;</code> element with a <code>&lt;summary&gt;</code> for accessible expand/collapse behavior.</p>

        <details class="details">
          <summary id="native-summary">Click to expand native details</summary>
          <div class="content" aria-labelledby="native-summary">
            <p>This content is inside a native details element. It is accessible and requires no JavaScript to expand or collapse.</p>
            <ul>
              <li>It supports keyboard and screen readers out of the box.</li>
              <li>The disclosure arrow rotates to indicate open/closed state.</li>
              <li>You can nest content, such as lists and links.</li>
            </ul>
          </div>
        </details>
      </div>

      <div class="example" id="custom-toggle-example">
        <h2>Example 2: Button-controlled panel</h2>
        <p class="desc">A button with <code>aria-expanded</code> toggles a region identified by <code>aria-controls</code>.</p>

        <div class="toggle-row">
          <span class="label">Project Notes</span>
          <button class="toggle-btn" id="notes-toggle" aria-expanded="false" aria-controls="notes-panel">
            <span class="icon" aria-hidden="true">▸</span>
            <span>Expand</span>
          </button>
        </div>

        <div class="details" id="notes-panel" role="region" aria-labelledby="notes-toggle" hidden>
          <p>Here are some notes about the project:</p>
          <ol>
            <li>Define objectives and success metrics.</li>
            <li>Gather requirements from stakeholders.</li>
            <li>Plan milestones and resources.</li>
          </ol>
          <p>When you click the button, this section is shown or hidden, and the button's <code>aria-expanded</code> updates accordingly.</p>
        </div>
      </div>

      <div class="example" id="accordion-example" data-accordion="true">
        <h2>Example 3: Multi-section accordion</h2>
        <p class="desc">Only one section stays open at a time within this accordion.</p>

        <div class="accordion" role="group" aria-label="FAQ">
          <div class="accordion-item">
            <div class="accordion-header">
              <span class="title">What is an accordion?</span>
              <button class="accordion-btn" id="acc-btn-1" aria-expanded="false" aria-controls="acc-panel-1">
                <span class="chev" aria-hidden="true">▸</span>
                <span>Expand</span>
              </button>
            </div>
            <div class="accordion-panel details" id="acc-panel-1" role="region" aria-labelledby="acc-btn-1" hidden>
              <p>An accordion is a vertically stacked set of expandable items. Selecting a header reveals its associated content area.</p>
            </div>
          </div>

          <div class="accordion-item">
            <div class="accordion-header">
              <span class="title">Why use accordions?</span>
              <button class="accordion-btn" id="acc-btn-2" aria-expanded="false" aria-controls="acc-panel-2">
                <span class="chev" aria-hidden="true">▸</span>
                <span>Expand</span>
              </button>
            </div>
            <div class="accordion-panel details" id="acc-panel-2" role="region" aria-labelledby="acc-btn-2" hidden>
              <p>They save space and help organize content. They allow users to focus on one section at a time without being overwhelmed.</p>
            </div>
          </div>

          <div class="accordion-item">
            <div class="accordion-header">
              <span class="title">Accessibility considerations</span>
              <button class="accordion-btn" id="acc-btn-3" aria-expanded="false" aria-controls="acc-panel-3">
                <span class="chev" aria-hidden="true">▸</span>
                <span>Expand</span>
              </button>
            </div>
            <div class="accordion-panel details" id="acc-panel-3" role="region" aria-labelledby="acc-btn-3" hidden>
              <ul>
                <li>Use a button for the trigger to ensure keyboard operability.</li>
                <li>Update <code>aria-expanded</code> to reflect state.</li>
                <li>Use <code>aria-controls</code> and <code>aria-labelledby</code> to link triggers and panels.</li>
                <li>Ensure focus remains logical when opening and closing panels.</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script>
    // Initialize toggles across all .example blocks
    (function() {
      function togglePanel(btn, panel, forceOpen, container) {
        const isOpen = forceOpen ?? btn.getAttribute('aria-expanded') === 'false';
        btn.setAttribute('aria-expanded', String(isOpen));
        const labelSpan = btn.querySelector('span:not([aria-hidden])');
        if (labelSpan) labelSpan.textContent = isOpen ? 'Collapse' : 'Expand';
        if (panel) {
          panel.hidden = !isOpen;
        }
      }

      function closeSiblings(container, excludeBtnId) {
        const buttons = container.querySelectorAll('button[aria-controls]');
        buttons.forEach(b => {
          if (b.id !== excludeBtnId) {
            const pid = b.getAttribute('aria-controls');
            const p = pid ? container.querySelector('#' + CSS.escape(pid)) : null;
            b.setAttribute('aria-expanded', 'false');
            const labelSpan = b.querySelector('span:not([aria-hidden])');
            if (labelSpan) labelSpan.textContent = 'Expand';
            if (p) p.hidden = true;
          }
        });
      }

      document.querySelectorAll('.example').forEach(example => {
        const isAccordion = example.dataset.accordion === 'true';
        example.querySelectorAll('button[aria-controls]').forEach(btn => {
          const panelId = btn.getAttribute('aria-controls');
          const panel = panelId ? example.querySelector('#' + CSS.escape(panelId)) : null;

          btn.addEventListener('click', () => {
            const willOpen = btn.getAttribute('aria-expanded') === 'false';
            if (isAccordion && willOpen) {
              closeSiblings(example, btn.id);
            }
            togglePanel(btn, panel, willOpen, example);

            if (willOpen && panel) {
              const focusable = panel.querySelector('a, button, input, textarea, select, [tabindex]:not([tabindex="-1"])');
              if (focusable) {
                focusable.focus({ preventScroll: true });
              }
            }
          });

          btn.addEventListener('keydown', (e) => {
            if (!isAccordion) return;
            if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {
              e.preventDefault();
              const buttons = Array.from(example.querySelectorAll('button[aria-controls]'));
              const idx = buttons.indexOf(btn);
              const nextIdx = e.key === 'ArrowDown'
                ? (idx + 1) % buttons.length
                : (idx - 1 + buttons.length) % buttons.length;
              buttons[nextIdx].focus();
            }
            if (e.key === 'Home') {
              e.preventDefault();
              const buttons = example.querySelectorAll('button[aria-controls]');
              buttons[0]?.focus();
            }
            if (e.key === 'End') {
              e.preventDefault();
              const buttons = example.querySelectorAll('button[aria-controls]');
              buttons[buttons.length - 1]?.focus();
            }
          });
        });
      });

      // Optional: update icons for toggle buttons based on expanded state
      function syncIcons() {
        document.querySelectorAll('.toggle-btn, .accordion-btn').forEach(btn => {
          const icon = btn.querySelector('.icon, .chev');
          if (!icon) return;
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          icon.textContent = '▸';
          icon.style.transform = expanded ? 'rotate(90deg)' : 'none';
        });
      }
      document.addEventListener('click', syncIcons);
      document.addEventListener('DOMContentLoaded', syncIcons);
    })();
  </script>
</body>
</html>