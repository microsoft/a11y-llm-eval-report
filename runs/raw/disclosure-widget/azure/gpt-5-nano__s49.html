<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Expand/Collapse Widget Demo</title>
  <style>
    :root {
      --bg: #f6f8fa;
      --card: #ffffff;
      --text: #1f2937;
      --muted: #6b7280;
      --border: #e5e7eb;
      --accent: #0f62fe;
      --soft: #eef2ff;
    }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.4;
    }
    header {
      padding: 2rem 1rem;
      text-align: center;
      background: white;
      border-bottom: 1px solid var(--border);
      margin-bottom: 1rem;
    }
    h1 {
      margin: 0 0 .25rem;
      font-size: 1.75rem;
    }
    p.subtitle {
      margin: 0;
      color: var(--muted);
    }

    .container {
      width: min(860px);
      margin: 0 auto;
      padding: 0 1rem;
    }

    .example {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1rem;
      margin: 1rem 0;
      box-shadow: 0 2px 6px rgba(0,0,0,.04);
    }

    .example h3 {
      margin: 0 0 .5rem;
      font-size: 1rem;
      font-weight: 600;
    }

    .toggle {
      display: inline-flex;
      align-items: center;
      gap: .5rem;
      padding: .5rem 1rem;
      border: 1px solid var(--border);
      border-radius: 6px;
      background: #f8fafc;
      color: var(--text);
      cursor: pointer;
      font-size: 0.95rem;
      transition: background .2s ease;
    }
    .toggle:hover {
      background: #eef2f7;
    }
    .toggle:focus {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }
    .toggle[aria-expanded="true"] {
      background: #eaf2ff;
      border-color: #c7ddff;
    }

    /* Container for controlled content must have class "details" */
    .details {
      overflow: hidden;
      max-height: 0;
      opacity: 0;
      padding: 0;
      transition: max-height 0.32s ease-out, opacity 0.32s ease-out, padding 0.32s ease-out;
      will-change: max-height, opacity;
    }
    .details.expanded {
      max-height: 500px; /* generous limit to accommodate content */
      opacity: 1;
      padding: 8px 0 0;
    }
    .details-content {
      padding: 0.25rem 0;
      color: #374151;
    }

    /* Simple responsive niceties */
    @media (max-width: 640px) {
      .example { padding: .75rem; }
    }
  </style>
  <script>
    // Expand/collapse logic
    function toggleDetails(detailsId, btn) {
      const panel = document.getElementById(detailsId);
      const isOpen = panel.classList.contains('expanded');

      // If opening
      if (!isOpen) {
        panel.style.display = 'block';
        // Trigger reflow so the transition runs
        void panel.offsetWidth;
        panel.classList.add('expanded');
        btn.setAttribute('aria-expanded', 'true');
      } else {
        // Collapsing
        panel.classList.remove('expanded');
        btn.setAttribute('aria-expanded', 'false');
        // After transition, hide from layout
        panel.addEventListener('transitionend', function onEnd(e) {
          if (e.propertyName === 'max-height') {
            panel.style.display = 'none';
            panel.removeEventListener('transitionend', onEnd);
          }
        });
      }
    }

    // Initialize states on load
    document.addEventListener('DOMContentLoaded', function() {
      document.querySelectorAll('.details').forEach(function(panel) {
        // If starting expanded, ensure visible
        if (panel.classList.contains('expanded')) {
          panel.style.display = 'block';
        } else {
          panel.style.display = 'none';
        }
      });
    });
  </script>
</head>
<body>
  <header>
    <h1>Expand/Collapse Widget Demo</h1>
    <p class="subtitle">Wrap each widget with a div that has an "example" class. The container for controlled content uses the "details" class.</p>
  </header>

  <main class="container" aria-label="Expand/Collapse examples">
    <!-- Example 1 -->
    <div class="example" aria-label="Example 1">
      <h3>Example 1: Simple toggle</h3>
      <button class="toggle" aria-expanded="false" aria-controls="details-1" onclick="toggleDetails('details-1', this)">Show details</button>
      <div id="details-1" class="details" role="region" aria-label="Details 1">
        <div class="details-content">
          <p>This is a simple expand/collapse widget. The content is contained within a container that has the class "details". The button above toggles its visibility with a smooth transition.</p>
          <ul>
            <li>Accessible with ARIA attributes</li>
            <li>Animated content reveal</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Example 2 -->
    <div class="example" aria-label="Example 2">
      <h3>Example 2: Nested toggle</h3>
      <button class="toggle" aria-expanded="false" aria-controls="details-2" onclick="toggleDetails('details-2', this)">Show more</button>
      <div id="details-2" class="details" role="region" aria-label="Details 2">
        <div class="details-content">
          <p>This demonstrates multiple widgets on the same page. Each widget controls its own "details" container independently.</p>
          <p>You can expand or collapse this section without affecting the others.</p>
        </div>
      </div>
    </div>

    <!-- Example 3 (Pre-expanded) -->
    <div class="example" aria-label="Example 3">
      <h3>Example 3: Pre-expanded</h3>
      <button class="toggle" aria-expanded="true" aria-controls="details-3" onclick="toggleDetails('details-3', this)">Hide details</button>
      <div id="details-3" class="details expanded" role="region" aria-label="Details 3" style="display:block;">
        <div class="details-content">
          <p>This example starts expanded to demonstrate the transition from visible to hidden state. Click the button to collapse.</p>
        </div>
      </div>
    </div>
  </main>
</body>
</html>