<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#0066cc;
      --bg:#f7f9fc;
      --panel:#ffffff;
      --muted:#6b7280;
      --duration:300ms;
      --easing:cubic-bezier(.2,.8,.2,1);
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      margin: 2rem;
      background: linear-gradient(180deg,var(--bg),#ffffff 40%);
      color:#111827;
      line-height:1.5;
    }

    h1{
      margin:0 0 1rem 0;
      font-size:1.25rem;
    }

    .example{
      max-width:700px;
      margin-bottom:1.25rem;
      border-radius:8px;
      box-shadow: 0 1px 0 rgba(16,24,40,0.02), 0 6px 18px rgba(16,24,40,0.06);
      background:var(--panel);
      overflow:visible;
    }

    /* header / control */
    .example .expander{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:1rem;
      width:100%;
      padding:0.9rem 1rem;
      border:0;
      background:transparent;
      cursor:pointer;
      font-size:1rem;
      text-align:left;
      transition:background-color var(--duration) var(--easing);
      border-radius:8px;
    }

    .expander:focus{
      outline:3px solid color-mix(in srgb, var(--accent) 20%, transparent);
      outline-offset:3px;
    }

    .expander .label{
      display:flex;
      flex-direction:column;
      align-items:flex-start;
      gap:0.15rem;
    }

    .expander .title{
      font-weight:600;
      color: #0f172a;
    }

    .expander .subtitle{
      font-size:0.875rem;
      color:var(--muted);
    }

    .expander .arrow{
      display:inline-block;
      width:1.1rem;
      height:1.1rem;
      transform-origin:center;
      transition:transform var(--duration) var(--easing);
      color:var(--accent);
      flex:0 0 auto;
    }

    /* details (controlled area) */
    .details{
      padding:0 1rem;
      overflow:hidden;
      max-height:0;
      transition: max-height var(--duration) var(--easing), opacity var(--duration) var(--easing);
      opacity:0;
      will-change: max-height, opacity;
      border-top:1px solid rgba(15,23,42,0.04);
      background:linear-gradient(180deg, rgba(0,0,0,0.01), transparent);
      border-bottom-left-radius:8px;
      border-bottom-right-radius:8px;
    }

    .details.open{
      opacity:1;
    }

    .details .content{
      padding:0.9rem 0;
    }

    /* rotate arrow when open */
    .expander[aria-expanded="true"] .arrow{
      transform:rotate(180deg);
    }

    /* small meta examples */
    .meta{
      font-size:0.875rem;
      color:var(--muted);
      margin-top:0.25rem;
    }

    /* make sure content is visible when JS disabled */
    noscript + style[data-noscript]{}
  </style>
  <noscript>
    <style data-noscript>
      /* If JS is disabled, show the details content */
      .details{max-height:none!important;opacity:1!important;}
    </style>
  </noscript>
</head>
<body>
  <h1>Expand / Collapse Widget Examples</h1>

  <div class="example">
    <button class="expander" aria-expanded="false" aria-controls="details-1" id="expander-1">
      <span class="label">
        <span class="title">What's included in the plan</span>
        <span class="subtitle">Click to expand for more details</span>
      </span>
      <svg class="arrow" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path fill="currentColor" d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"/>
      </svg>
    </button>
    <div id="details-1" class="details" role="region" aria-labelledby="expander-1">
      <div class="content">
        <p>
          Our Standard plan includes access to all basic features, email support, and a 50 GB storage allocation.
          It's designed for individuals and small teams who need reliable core functionality without advanced collaboration tools.
        </p>
        <ul>
          <li>Unlimited projects</li>
          <li>Email support with 24–48 hour SLA</li>
          <li>50 GB secure storage</li>
        </ul>
        <p class="meta">Pro tip: Upgrade anytime to unlock priority support and team management features.</p>
      </div>
    </div>
  </div>

  <div class="example">
    <button class="expander" aria-expanded="false" aria-controls="details-2" id="expander-2">
      <span class="label">
        <span class="title">Release notes — version 2.4.0</span>
        <span class="subtitle">Bug fixes, performance improvements, and a new editor toolbar</span>
      </span>
      <svg class="arrow" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path fill="currentColor" d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"/>
      </svg>
    </button>
    <div id="details-2" class="details" role="region" aria-labelledby="expander-2">
      <div class="content">
        <p>
          This release focuses on stability and UX polish. Highlights include:
        </p>
        <ol>
          <li>Improved autosave reliability during network interruptions.</li>
          <li>Reduced memory usage in the rendering pipeline.</li>
          <li>New editor toolbar with quick-format buttons and improved accessibility.</li>
        </ol>
        <p class="meta">Released: 2025-10-20</p>
      </div>
    </div>
  </div>

  <script>
    (function(){
      // Utility to animate opening/closing by toggling max-height to scrollHeight.
      function openDetails(details) {
        details.classList.add('open');
        details.setAttribute('aria-hidden', 'false');
        // Set explicit max-height to enable transition to the content height.
        const contentHeight = details.scrollHeight;
        details.style.maxHeight = contentHeight + 'px';

        // Remove the explicit max-height after transition to allow natural height changes.
        const onEnd = function(e){
          if (e.propertyName === 'max-height') {
            details.style.maxHeight = 'none';
            details.removeEventListener('transitionend', onEnd);
          }
        };
        details.addEventListener('transitionend', onEnd);
      }

      function closeDetails(details) {
        // To animate closing, set max-height to current computed height (if 'none', measure)
        let currentHeight = details.scrollHeight;
        details.style.maxHeight = currentHeight + 'px';
        // Force a reflow so the starting max-height is taken
        // eslint-disable-next-line no-unused-expressions
        details.offsetHeight;
        // Then set to 0 to animate
        details.style.maxHeight = '0px';
        details.classList.remove('open');
        details.setAttribute('aria-hidden', 'true');
      }

      // Initialize all expanders
      const expanders = Array.from(document.querySelectorAll('.expander'));
      expanders.forEach(function(btn, idx){
        const id = btn.getAttribute('aria-controls');
        const details = document.getElementById(id);
        if (!details) return;

        // initial ARIA state
        btn.setAttribute('aria-expanded', 'false');
        details.setAttribute('aria-hidden', 'true');
        // Ensure details has no inline max-height initially (so JS controls it)
        details.style.maxHeight = '0px';

        btn.addEventListener('click', function(){
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          if (expanded) {
            btn.setAttribute('aria-expanded', 'false');
            closeDetails(details);
          } else {
            btn.setAttribute('aria-expanded', 'true');
            openDetails(details);
          }
        });

        // Allow Enter and Space activate (buttons handle it by default),
        // but also support toggling when focus is on the expander and user presses Escape to close.
        btn.addEventListener('keydown', function(event){
          if (event.key === 'Escape') {
            const expanded = btn.getAttribute('aria-expanded') === 'true';
            if (expanded) {
              btn.setAttribute('aria-expanded', 'false');
              closeDetails(details);
              btn.focus();
            }
          }
        });

        // If the user navigates focus into the details area with keyboard and presses Escape, close.
        details.addEventListener('keydown', function(event){
          if (event.key === 'Escape') {
            btn.setAttribute('aria-expanded', 'false');
            closeDetails(details);
            btn.focus();
          }
        });

        // Ensure that if the details contains focusable elements, the max-height is removed while focused.
        details.addEventListener('focusin', function(){
          // if currently open, ensure maxHeight is none so internal changes don't get clipped
          if (details.classList.contains('open')) {
            details.style.maxHeight = 'none';
          }
        });

        details.addEventListener('focusout', function(){
          // If still open after focus leaves, restore no inline max-height (let transition manage when toggled)
          if (details.classList.contains('open')) {
            details.style.maxHeight = 'none';
          }
        });
      });
    })();
  </script>
</body>
</html>