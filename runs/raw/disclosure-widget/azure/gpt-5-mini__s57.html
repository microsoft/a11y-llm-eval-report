<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent: #0b6efd;
      --bg: #f7f9fc;
      --surface: #ffffff;
      --muted: #6b7280;
      --radius: 8px;
      --shadow: 0 6px 18px rgba(11,110,253,0.06);
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      margin: 24px;
      background: linear-gradient(180deg, #f3f6fb 0%, #ffffff 100%);
      color: #111827;
    }

    h1{
      font-size: 20px;
      margin: 0 0 18px 0;
    }

    p.lead{
      margin: 0 0 22px 0;
      color: var(--muted);
      font-size: 14px;
    }

    .example{
      background: var(--surface);
      border-radius: var(--radius);
      padding: 16px;
      box-shadow: var(--shadow);
      margin-bottom: 18px;
      border: 1px solid rgba(16,24,40,0.04);
    }

    .widget{
      display: grid;
      gap: 8px;
    }

    .toggle{
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
      background: linear-gradient(180deg, #ffffff, #fbfdff);
      border: 1px solid rgba(16,24,40,0.06);
      padding: 10px 12px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 15px;
      color: #0f172a;
    }

    .toggle:focus{
      outline: 3px solid rgba(11,110,253,0.12);
      outline-offset: 2px;
    }

    .toggle .label{
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .toggle svg{
      width: 18px;
      height: 18px;
      transition: transform .2s ease;
      flex: 0 0 18px;
    }

    .toggle[aria-expanded="true"] svg{
      transform: rotate(90deg);
    }

    .summary{
      color: var(--muted);
      font-size: 13px;
      margin-top: 6px;
      margin-left: 2px;
    }

    .details{
      overflow: hidden;
      max-height: 0;
      transition: max-height 280ms cubic-bezier(.2,.9,.2,1);
      will-change: max-height;
      padding: 0 2px;
    }

    .details-content{
      padding: 12px;
      background: var(--bg);
      border-radius: 6px;
      margin-top: 8px;
      border: 1px dashed rgba(15,23,42,0.04);
      color: #111827;
      line-height: 1.45;
    }

    /* simple demo-only styles */
    small.note{
      display:block;
      color: var(--muted);
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>Expand / Collapse Widget Examples</h1>
  <p class="lead">Each widget is wrapped with a div.example. The controlled content container uses the class "details". Buttons manage aria-expanded and aria-controls for accessibility.</p>

  <div class="example">
    <div class="widget" id="widget-1">
      <button class="toggle" id="toggle-1" aria-expanded="false" aria-controls="details-1" type="button">
        <span class="label">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M8.5 5.75L15.5 12l-7 6.25" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Quick settings
        </span>
        <span class="meta">Show</span>
      </button>

      <div id="details-1" class="details" role="region" aria-labelledby="toggle-1" aria-hidden="true">
        <div class="details-content">
          <p><strong>Adjust your quick settings:</strong></p>
          <ul>
            <li>Enable email notifications</li>
            <li>Set profile visibility to public</li>
            <li>Switch to compact layout</li>
          </ul>
          <small class="note">Tip: these settings apply immediately.</small>
        </div>
      </div>
    </div>
  </div>

  <div class="example">
    <div class="widget" id="widget-2">
      <button class="toggle" id="toggle-2" aria-expanded="false" aria-controls="details-2" type="button">
        <span class="label">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M8.5 5.75L15.5 12l-7 6.25" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Release notes
        </span>
        <span class="meta">Expand</span>
      </button>

      <div id="details-2" class="details" role="region" aria-labelledby="toggle-2" aria-hidden="true">
        <div class="details-content">
          <p><strong>Version 2.4.0</strong> â€” Released Oct 2025</p>
          <ol>
            <li>Improved performance for large datasets.</li>
            <li>Added bulk export feature.</li>
            <li>Minor bug fixes and UI improvements.</li>
          </ol>
          <p>For a full changelog, visit the <a href="#">changelog page</a>.</p>
        </div>
      </div>
    </div>
  </div>

  <div class="example">
    <div class="widget" id="widget-3">
      <button class="toggle" id="toggle-3" aria-expanded="false" aria-controls="details-3" type="button">
        <span class="label">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M8.5 5.75L15.5 12l-7 6.25" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          More about accessibility
        </span>
        <span class="meta">Read</span>
      </button>

      <div id="details-3" class="details" role="region" aria-labelledby="toggle-3" aria-hidden="true">
        <div class="details-content">
          <p>This example demonstrates a custom expand/collapse pattern:</p>
          <ul>
            <li>The button toggles aria-expanded (true / false).</li>
            <li>aria-controls points to the container with class "details".</li>
            <li>The region uses role="region" and aria-labelledby for association.</li>
          </ul>
          <p>Keyboard behavior: use Space or Enter to toggle the button (native to button element).</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function () {
      // Initialize all toggle buttons inside examples
      function initToggle(btn) {
        var detailsId = btn.getAttribute('aria-controls');
        if (!detailsId) return;
        var details = document.getElementById(detailsId);
        if (!details) return;

        // Ensure the region has role and initial aria-hidden if not set
        if (!details.hasAttribute('role')) details.setAttribute('role', 'region');
        if (!details.hasAttribute('aria-hidden')) details.setAttribute('aria-hidden', 'true');

        // Helper to open
        function open() {
          btn.setAttribute('aria-expanded', 'true');
          details.setAttribute('aria-hidden', 'false');

          // Set explicit maxHeight for smooth transition to the content height
          var contentHeight = details.scrollHeight;
          details.style.maxHeight = contentHeight + 'px';

          // When transition ends, remove maxHeight to allow content to grow naturally
          var onTransitionEnd = function (e) {
            if (e.target !== details) return;
            details.style.maxHeight = 'none';
            details.removeEventListener('transitionend', onTransitionEnd);
          };
          details.addEventListener('transitionend', onTransitionEnd);
        }

        // Helper to close
        function close() {
          btn.setAttribute('aria-expanded', 'false');
          details.setAttribute('aria-hidden', 'true');

          // To animate from current height to 0, set maxHeight to current scrollHeight then to 0
          var contentHeight = details.scrollHeight;

          // If maxHeight is 'none', compute current height
          if (getComputedStyle(details).maxHeight === 'none') {
            details.style.maxHeight = contentHeight + 'px';
          }

          // Force reflow to apply the starting maxHeight
          void details.offsetHeight;

          // Then set to 0 to animate
          details.style.maxHeight = '0px';
        }

        // Toggle handler
        function toggle() {
          var expanded = btn.getAttribute('aria-expanded') === 'true';
          if (expanded) close(); else open();

          // Optional: update the inline meta text
          var meta = btn.querySelector('.meta');
          if (meta) meta.textContent = expanded ? 'Show' : 'Hide';
        }

        // Attach click
        btn.addEventListener('click', toggle);

        // Also allow closing when clicking outside (optional, gentle behavior)
        document.addEventListener('click', function (e) {
          if (!btn.contains(e.target) && !details.contains(e.target)) {
            if (btn.getAttribute('aria-expanded') === 'true') {
              close();
            }
          }
        });
      }

      // Find all toggle buttons inside .example containers
      var examples = document.querySelectorAll('.example');
      examples.forEach(function (ex) {
        var buttons = ex.querySelectorAll('.toggle');
        buttons.forEach(initToggle);
      });
    })();
  </script>
</body>
</html>