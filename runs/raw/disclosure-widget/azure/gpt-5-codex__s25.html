<html lang="en">
<head>
<meta charset="UTF-8">
<title>Expand/Collapse Widget Demo</title>
<style>
    :root {
        color-scheme: light dark;
        font-family: "Segoe UI", system-ui, -apple-system, sans-serif;
    }

    body {
        margin: 0;
        padding: 2rem;
        background: linear-gradient(135deg, #f5f7fa, #e4ecff 60%, #f8f9ff);
        min-height: 100vh;
    }

    h1 {
        text-align: center;
        margin-bottom: 2rem;
        color: #2f3c7e;
    }

    .example {
        background: rgba(255, 255, 255, 0.85);
        border-radius: 16px;
        padding: 1.5rem;
        margin: 0 auto 2rem auto;
        max-width: 720px;
        box-shadow: 0 16px 32px rgba(47, 60, 126, 0.15);
        border: 1px solid rgba(47, 60, 126, 0.1);
    }

    .example h2 {
        margin-top: 0;
        color: #25325d;
    }

    .toggle {
        appearance: none;
        border: none;
        background: linear-gradient(135deg, #536dfe, #4154ff);
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 999px;
        font-size: 1rem;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
    }

    .toggle:focus-visible {
        outline: 3px solid rgba(83, 109, 254, 0.4);
        outline-offset: 4px;
    }

    .toggle:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 24px rgba(83, 109, 254, 0.3);
    }

    .toggle[data-state="expanded"] {
        background: linear-gradient(135deg, #ff8a65, #ff7043);
    }

    .details {
        margin-top: 1rem;
        padding: 1rem 1.25rem;
        border-radius: 12px;
        background: rgba(83, 109, 254, 0.08);
        border: 1px solid rgba(83, 109, 254, 0.15);
        line-height: 1.6;
    }

    .details[data-animated="true"] {
        overflow: hidden;
        transition: max-height 0.35s ease, opacity 0.35s ease;
        max-height: 0;
        opacity: 0;
    }

    .details[data-animated="true"][data-visible="true"] {
        max-height: 600px;
        opacity: 1;
    }

    .faq-item {
        margin-bottom: 1.5rem;
    }

    .faq-question {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-weight: 600;
        cursor: pointer;
        padding: 0.75rem 1rem;
        border-radius: 10px;
        background: rgba(64, 87, 217, 0.1);
        transition: background 0.2s ease;
    }

    .faq-question:hover,
    .faq-question:focus-visible {
        background: rgba(64, 87, 217, 0.18);
        outline: none;
    }

    .faq-answer {
        margin-top: 0.75rem;
        padding-left: 0.5rem;
    }

    code {
        font-family: "Fira Code", "Courier New", monospace;
        background: rgba(0, 0, 0, 0.08);
        padding: 0.15rem 0.35rem;
        border-radius: 6px;
    }

    .icon {
        font-size: 1.1rem;
        transition: transform 0.3s ease;
        display: inline-block;
    }

    .icon[data-rotated="true"] {
        transform: rotate(180deg);
    }

    .grid {
        display: grid;
        gap: 1rem;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    }

    @media (prefers-reduced-motion: reduce) {
        .toggle,
        .details[data-animated="true"],
        .icon {
            transition: none;
        }
    }
</style>
</head>
<body>
<h1>Expand/Collapse Widgets</h1>

<div class="example">
    <h2>Basic Expand/Collapse</h2>
    <button class="toggle" id="toggle-basic" aria-expanded="false" aria-controls="details-basic" data-state="collapsed">
        <span class="icon" aria-hidden="true">▼</span>
        Show more
    </button>
    <div class="details" id="details-basic" hidden>
        <p>This simple widget uses a button to toggle the visibility of the content. The button’s <code>aria-expanded</code> attribute and the content’s <code>hidden</code> attribute stay synchronized to keep things accessible.</p>
        <ul>
            <li>Keyboard users can tab to the button and press Enter or Space.</li>
            <li>Screen readers announce the expanded state automatically.</li>
            <li>The layout adjusts smoothly without animation.</li>
        </ul>
    </div>
</div>

<div class="example">
    <h2>Animated Panel</h2>
    <button class="toggle" id="toggle-animated" aria-expanded="false" aria-controls="details-animated" data-state="collapsed">
        <span class="icon" aria-hidden="true">▼</span>
        View panel
    </button>
    <div class="details" id="details-animated" data-animated="true" data-visible="false" hidden>
        <p>This panel adds a touch of animation by transitioning the maximum height and opacity. The JavaScript calculates the natural height when expanding to ensure the animation is smooth.</p>
        <div class="grid">
            <div>
                <h3>Highlights</h3>
                <ul>
                    <li>Smooth transition</li>
                    <li>Accessible toggling</li>
                    <li>No layout shift</li>
                </ul>
            </div>
            <div>
                <h3>Usage Tips</h3>
                <p>Use transitions sparingly and respect the <code>prefers-reduced-motion</code> media feature for users who opt out of animations.</p>
            </div>
        </div>
    </div>
</div>

<div class="example">
    <h2>FAQ Accordion</h2>
    <div class="faq-item">
        <button class="faq-question" id="toggle-faq-1" aria-expanded="false" aria-controls="details-faq-1">
            What is an expand/collapse widget?
            <span class="icon" aria-hidden="true">▼</span>
        </button>
        <div class="details" id="details-faq-1" hidden>
            <div class="faq-answer">
                An expand/collapse widget reveals or hides additional information when a control—usually a button—is activated. It helps manage dense content and keeps interfaces tidy.
            </div>
        </div>
    </div>
    <div class="faq-item">
        <button class="faq-question" id="toggle-faq-2" aria-expanded="false" aria-controls="details-faq-2">
            How do I keep it accessible?
            <span class="icon" aria-hidden="true">▼</span>
        </button>
        <div class="details" id="details-faq-2" hidden>
            <div class="faq-answer">
                Tie the button to the controlled region via <code>aria-controls</code>, update <code>aria-expanded</code> as the state changes, and toggle the <code>hidden</code> attribute (or <code>aria-hidden</code>) on the content.
            </div>
        </div>
    </div>
    <div class="faq-item">
        <button class="faq-question" id="toggle-faq-3" aria-expanded="false" aria-controls="details-faq-3">
            Can multiple answers stay open?
            <span class="icon" aria-hidden="true">▼</span>
        </button>
        <div class="details" id="details-faq-3" hidden>
            <div class="faq-answer">
                Yes. This example allows each item to toggle independently. If you want a true accordion where only one panel is open at a time, close the others when a new one is expanded.
            </div>
        </div>
    </div>
</div>

<script>
    const toggleButtons = document.querySelectorAll('.toggle');
    const faqButtons = document.querySelectorAll('.faq-question');

    const toggleContent = (button, content, options = {}) => {
        const isExpanded = button.getAttribute('aria-expanded') === 'true';
        const newState = !isExpanded;

        button.setAttribute('aria-expanded', String(newState));
        button.dataset.state = newState ? 'expanded' : 'collapsed';

        const icon = button.querySelector('.icon');
        if (icon) {
            icon.dataset.rotated = newState ? 'true' : 'false';
        }

        if (options.animated) {
            if (newState) {
                content.hidden = false;
                requestAnimationFrame(() => {
                    content.dataset.visible = 'true';
                });
            } else {
                content.dataset.visible = 'false';
                content.addEventListener('transitionend', function handleTransitionEnd(event) {
                    if (event.propertyName === 'max-height') {
                        content.hidden = true;
                        content.removeEventListener('transitionend', handleTransitionEnd);
                    }
                });
            }
        } else {
            content.hidden = !newState;
        }
    };

    toggleButtons.forEach((button) => {
        const content = document.getElementById(button.getAttribute('aria-controls'));
        const animated = content?.dataset.animated === 'true';

        button.addEventListener('click', () => {
            if (animated) {
                const isClosing = content.dataset.visible === 'true';
                if (!isClosing) {
                    content.hidden = false;
                    const scrollHeight = content.scrollHeight;
                    content.style.maxHeight = `${scrollHeight}px`;
                }
            }
            toggleContent(button, content, { animated });
        });
    });

    faqButtons.forEach((button) => {
        const content = document.getElementById(button.getAttribute('aria-controls'));
        const icon = button.querySelector('.icon');

        button.addEventListener('click', () => {
            const isExpanded = button.getAttribute('aria-expanded') === 'true';
            button.setAttribute('aria-expanded', String(!isExpanded));
            if (icon) {
                icon.dataset.rotated = !isExpanded ? 'true' : 'false';
            }
            content.hidden = isExpanded;
        });

        button.addEventListener('keydown', (event) => {
            if (event.key === 'Enter' || event.key === ' ') {
                event.preventDefault();
                button.click();
            }
        });
    });
</script>
</body>
</html>