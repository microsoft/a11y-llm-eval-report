<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#1e88e5;
      --bg:#f7fbff;
      --border:#dfeefe;
      --radius:8px;
    }
    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      margin: 32px;
      color:#0b2540;
      background: #fff;
      line-height:1.45;
    }

    h1{font-size:1.25rem;margin:0 0 18px 0;}
    p.lead{margin:0 0 18px 0;color:#334b66;}

    .example{
      border: 1px solid var(--border);
      background: linear-gradient(180deg,var(--bg),#fff);
      padding: 14px;
      border-radius: var(--radius);
      margin: 14px 0;
      box-shadow: 0 1px 3px rgba(12,35,61,0.04);
    }

    .toggle{
      display:flex;
      align-items:center;
      gap:12px;
      width:100%;
      background:transparent;
      border:0;
      padding:8px 10px;
      text-align:left;
      cursor:pointer;
      border-radius:6px;
      font-weight:600;
      color:var(--accent);
    }
    .toggle:focus{
      outline:3px solid rgba(30,136,229,0.15);
      outline-offset:3px;
    }
    .chev{
      width:18px;height:18px;transform-origin:center;
      transition: transform 180ms ease;
      display:inline-block;
    }
    .chev.open{ transform: rotate(180deg); }

    /* controlled content: class "details" required by the prompt */
    .details{
      overflow: hidden;
      max-height: 0;
      transition: max-height 260ms ease;
      margin-top: 10px;
      border-top: 1px dashed rgba(11,37,64,0.06);
      padding-top: 10px;
    }
    .details p{margin:0 0 10px 0;color:#0f2b44;}
    .details .card{
      background:#fff;
      border:1px solid rgba(11,37,64,0.04);
      padding:10px;
      border-radius:6px;
      box-shadow: 0 1px 2px rgba(11,37,64,0.02);
    }

    /* small helper visuals */
    .meta{font-size:0.9rem;color:#48657f;margin-top:8px;}
    .small{font-size:0.9rem;color:#6b8396;}
  </style>
</head>
<body>
  <main>
    <h1>Expand / Collapse Widget</h1>
    <p class="lead">Two accessible examples demonstrating an expand/collapse widget. Each widget is wrapped in a container with class="example". The controlled content containers have class="details".</p>

    <div class="example">
      <button id="toggle-1" class="toggle" type="button" aria-expanded="false" aria-controls="details-1">
        <span class="chev" aria-hidden="true">
          <!-- simple chevron -->
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </span>
        Quick summary: What this does
      </button>

      <div id="details-1" class="details" role="region" aria-labelledby="toggle-1" aria-hidden="true">
        <p class="card">This is the expanded content for the first example. It demonstrates a short informational panel that can be revealed or hidden by activating the button above. The button updates <code>aria-expanded</code> and controls visibility via <code>aria-controls</code>.</p>
        <p class="small">Tip: Use Enter or Space to toggle the button when focused.</p>
      </div>
    </div>

    <div class="example">
      <button id="toggle-2" class="toggle" type="button" aria-expanded="false" aria-controls="details-2">
        <span class="chev" aria-hidden="true">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </span>
        More options: Account settings
      </button>

      <div id="details-2" class="details" role="region" aria-labelledby="toggle-2" aria-hidden="true">
        <div class="card">
          <label style="display:block;margin-bottom:8px;font-weight:600;color:#0f2b44;">Notifications</label>
          <div style="display:flex;gap:10px;align-items:center;margin-bottom:10px;">
            <input id="email-enable" type="checkbox" />
            <label for="email-enable" class="small">Email notifications</label>
          </div>
          <div style="display:flex;gap:10px;align-items:center;">
            <input id="sms-enable" type="checkbox" />
            <label for="sms-enable" class="small">SMS notifications</label>
          </div>
        </div>
      </div>

      <div class="meta">This example contains interactive elements inside the controlled region (checkboxes).</div>
    </div>

  </main>

  <script>
    (function(){
      // Initialize all toggle buttons within .example
      const toggles = document.querySelectorAll('.example button[aria-controls]');

      toggles.forEach(button => {
        const targetId = button.getAttribute('aria-controls');
        const content = document.getElementById(targetId);
        const chevron = button.querySelector('.chev');

        // Ensure required element exists
        if (!content) return;

        // Initialize state: closed
        button.setAttribute('aria-expanded', 'false');
        content.setAttribute('aria-hidden', 'true');
        content.style.maxHeight = '0px';

        // Toggle function
        const toggle = () => {
          const expanded = button.getAttribute('aria-expanded') === 'true';
          if (expanded) {
            // close
            button.setAttribute('aria-expanded', 'false');
            content.setAttribute('aria-hidden', 'true');
            // animate collapse using scrollHeight trick
            content.style.maxHeight = content.scrollHeight + 'px'; // set to current height to enable transition
            requestAnimationFrame(() => {
              content.style.maxHeight = '0px';
            });
            chevron.classList.remove('open');
          } else {
            // open
            button.setAttribute('aria-expanded', 'true');
            content.setAttribute('aria-hidden', 'false');
            // set to the scrollHeight to animate open
            const targetHeight = content.scrollHeight;
            content.style.maxHeight = targetHeight + 'px';
            chevron.classList.add('open');

            // after transition ends, clear max-height so content can grow naturally (optional)
            const clearMax = () => {
              // keep if still expanded
              if (button.getAttribute('aria-expanded') === 'true') {
                content.style.maxHeight = 'none';
              }
              content.removeEventListener('transitionend', clearMax);
            };
            content.addEventListener('transitionend', clearMax);
          }
        };

        button.addEventListener('click', toggle);

        // For accessibility: if content is resized while open, adjust maxHeight to 'none' already handled.
        // Ensure that if content had been opened and maxHeight was set to 'none', resizing still shows content.
        // On window resize, if open, clear inline maxHeight so layout can adapt.
        window.addEventListener('resize', () => {
          if (button.getAttribute('aria-expanded') === 'true') {
            content.style.maxHeight = 'none';
          }
        });
      });
    })();
  </script>
</body>
</html>