<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#2563eb;
      --bg:#f8fafc;
      --card:#ffffff;
      --muted:#6b7280;
      --radius:10px;
    }
    body{
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:linear-gradient(180deg,#eef2ff 0%, #f8fafc 100%);
      color:#0f172a;
      padding:36px;
      line-height:1.5;
    }
    h1{font-size:20px;margin:0 0 18px 0}
    .example{
      background:var(--card);
      border:1px solid rgba(15,23,42,0.06);
      border-radius:var(--radius);
      padding:16px;
      margin-bottom:18px;
      box-shadow:0 1px 2px rgba(2,6,23,0.04);
      max-width:760px;
    }

    .toggle {
      display:flex;
      align-items:center;
      gap:12px;
      width:100%;
      background:transparent;
      border:0;
      padding:8px 12px;
      font-size:16px;
      text-align:left;
      cursor:pointer;
      border-radius:8px;
      color:inherit;
      transition:background 0.12s ease;
    }
    .toggle:focus{
      outline:2px solid rgba(37,99,235,0.18);
      outline-offset:2px;
    }
    .toggle:hover{
      background:rgba(15,23,42,0.03);
    }

    .chev {
      width:36px;
      height:36px;
      display:inline-grid;
      place-items:center;
      border-radius:8px;
      background:linear-gradient(180deg,rgba(37,99,235,0.08),rgba(37,99,235,0.02));
      color:var(--accent);
      flex-shrink:0;
      transition:transform 0.18s ease;
    }
    .chev svg{display:block}

    /* rotate when expanded */
    .toggle[aria-expanded="true"] .chev{
      transform:rotate(90deg);
    }

    .summary-text{
      display:flex;
      flex-direction:column;
      gap:2px;
    }
    .summary-title{font-weight:600}
    .summary-sub{font-size:13px;color:var(--muted)}

    /* controlled content container must have class "details" per instructions */
    .details{
      overflow:hidden;
      max-height:0;
      transition:max-height 260ms cubic-bezier(.2,.8,.2,1);
      margin-top:10px;
    }
    .details-content{
      padding:12px;
      background:linear-gradient(180deg,rgba(2,6,23,0.01),transparent);
      border-radius:8px;
      border:1px solid rgba(2,6,23,0.03);
    }
    .details p{margin:0 0 10px 0;color:#0f172a}
    .details ul{margin:0 0 10px 18px;color:#0f172a}
    .muted{color:var(--muted);font-size:13px}

    /* Reduced motion: disable animation */
    @media (prefers-reduced-motion: reduce){
      .details{transition:none}
      .chev{transition:none}
    }

    /* small helper for demo */
    .meta{font-size:13px;color:var(--muted);margin-top:8px}
  </style>
</head>
<body>
  <h1>Expand / Collapse Widget Examples</h1>

  <div class="example">
    <button class="toggle" id="toggle-1" aria-controls="details-1" aria-expanded="false" type="button">
      <span class="chev" aria-hidden="true">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 5v14l11-7L8 5z" fill="currentColor"/>
        </svg>
      </span>
      <span class="summary-text">
        <span class="summary-title">Account settings</span>
        <span class="summary-sub">Manage your profile, security options, and connected apps</span>
      </span>
    </button>

    <div class="details" id="details-1" aria-hidden="true">
      <div class="details-content">
        <p class="muted">Here are a few of the things you can do from your account settings:</p>
        <ul>
          <li>Update your display name and profile photo</li>
          <li>Enable two-factor authentication for increased security</li>
          <li>Review and revoke connected applications</li>
        </ul>
        <p>Changes are saved automatically. If you need help, visit our help center or contact support.</p>
      </div>
    </div>
    <div class="meta">Example 1 • Controlled content has class="details"</div>
  </div>

  <div class="example">
    <button class="toggle" id="toggle-2" aria-controls="details-2" aria-expanded="false" type="button">
      <span class="chev" aria-hidden="true">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 5v14l11-7L8 5z" fill="currentColor"/>
        </svg>
      </span>
      <span class="summary-text">
        <span class="summary-title">Release notes</span>
        <span class="summary-sub">What's new in the latest update (v2.4.0)</span>
      </span>
    </button>

    <div class="details" id="details-2" aria-hidden="true">
      <div class="details-content">
        <p><strong>Version 2.4.0</strong> — Released Nov 2025</p>
        <ul>
          <li>Improved sync performance for large datasets</li>
          <li>New keyboard shortcuts for power users</li>
          <li>Bug fixes and accessibility improvements</li>
        </ul>
        <p class="muted">Tip: Press the same header again to collapse this panel. The button updates aria-expanded and the details container updates aria-hidden for screen readers.</p>
      </div>
    </div>
    <div class="meta">Example 2 • Reusable widget</div>
  </div>

  <script>
    (function(){
      // Find all toggle buttons that reference a details container via aria-controls
      var toggles = document.querySelectorAll('.toggle[aria-controls]');

      function setOpenState(button, detailsEl, open) {
        button.setAttribute('aria-expanded', open ? 'true' : 'false');
        detailsEl.setAttribute('aria-hidden', open ? 'false' : 'true');
        if (open) {
          // For smooth animation: set explicit maxHeight to scrollHeight
          var prevMax = detailsEl.style.maxHeight;
          detailsEl.style.maxHeight = detailsEl.scrollHeight + 'px';
          // After transition ends, remove maxHeight so content can grow naturally
          var cleanup = function(e){
            if (e && e.target !== detailsEl) return;
            detailsEl.style.maxHeight = 'none';
            detailsEl.removeEventListener('transitionend', cleanup);
          };
          detailsEl.addEventListener('transitionend', cleanup);
        } else {
          // For closing: from current height to 0
          // Ensure maxHeight is an explicit pixel value to animate from
          detailsEl.style.maxHeight = detailsEl.scrollHeight + 'px';
          // force layout so the starting height is applied
          void detailsEl.offsetHeight;
          detailsEl.style.maxHeight = '0px';
        }
      }

      toggles.forEach(function(btn){
        var id = btn.getAttribute('aria-controls');
        var detailsEl = document.getElementById(id);
        if (!detailsEl) return;

        // Initialize (ensure aria-hidden and collapsed)
        if (btn.getAttribute('aria-expanded') === 'true') {
          detailsEl.setAttribute('aria-hidden','false');
          detailsEl.style.maxHeight = 'none';
        } else {
          detailsEl.setAttribute('aria-hidden','true');
          detailsEl.style.maxHeight = '0px';
        }

        btn.addEventListener('click', function(){
          var expanded = btn.getAttribute('aria-expanded') === 'true';
          setOpenState(btn, detailsEl, !expanded);
        });

        // Keep toggle in sync if details are resized (optional)
        // If content changes size while open, update maxHeight to none after transition; we already remove it.
        // No additional handlers needed here.
      });

      // Optional: support keyboard accessible "Enter" / "Space" handled natively by <button>
    })();
  </script>
</body>
</html>