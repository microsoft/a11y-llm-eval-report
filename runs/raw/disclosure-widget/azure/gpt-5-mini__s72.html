<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#005fcc;
      --bg:#f8fafc;
      --panel:#ffffff;
      --radius:10px;
      --shadow: 0 6px 18px rgba(2,6,23,0.08);
    }
    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg, var(--bg), #ffffff 60%);
      color:#09203f;
      margin:0;
      padding:32px;
      line-height:1.4;
    }

    h1{font-size:1.25rem;margin:0 0 18px 0;}
    p.lead{margin:0 0 24px 0;color:#334155}

    .wrap{
      max-width:760px;
      margin:0 auto;
    }

    .example{
      background:var(--panel);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:16px;
      margin-bottom:18px;
      border:1px solid rgba(8,20,48,0.04);
    }

    .header{
      display:flex;
      align-items:center;
      gap:12px;
      margin-bottom:8px;
    }

    .toggle{
      appearance:none;
      -webkit-appearance:none;
      background:linear-gradient(180deg,var(--accent),#0047b3);
      color:white;
      border:0;
      padding:8px 12px;
      border-radius:8px;
      font-weight:600;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:8px;
      box-shadow:0 6px 12px rgba(0,80,190,0.12);
      transition:transform 180ms ease, box-shadow 180ms ease;
      font-size:0.95rem;
    }

    .toggle:active{ transform:translateY(1px) }
    .toggle:focus{ outline:3px solid rgba(0,95,255,0.18); outline-offset:3px }

    .toggle .chev{
      width:18px;height:18px;display:inline-block;transform:rotate(0deg);transition:transform 220ms ease;
    }
    /* rotated when expanded */
    .toggle[aria-expanded="true"] .chev{ transform:rotate(90deg) }

    /* details container (controlled content) */
    .details{
      overflow:hidden;
      max-height:0;
      transition:max-height 260ms cubic-bezier(.2,.9,.3,1);
      will-change:max-height;
      margin-top:12px;
      border-radius:8px;
      background:linear-gradient(180deg,#fbfdff,#ffffff);
      padding:0 12px;
      box-sizing:border-box;
    }

    /* inner padding to make content look nice */
    .details .inner{
      padding:12px 0;
    }

    /* When using reduced motion, disable transitions */
    @media (prefers-reduced-motion: reduce){
      .details{ transition:none; }
      .toggle{ transition:none; }
      .toggle .chev{ transition:none; }
    }

    /* small utility styles */
    .meta{font-size:0.85rem;color:#61748a;margin-left:auto}
    code{background:#f1f6fb;padding:2px 6px;border-radius:6px;font-family:monospace;font-size:0.92em}
    ul{margin:0;padding-left:1.1rem}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Expand / Collapse Widget - Examples</h1>
    <p class="lead">Each widget is wrapped with a container that has the class <code>example</code>. The controlled content container uses the class <code>details</code>.</p>

    <!-- Example 1: Simple paragraph -->
    <div class="example">
      <div class="header">
        <button class="toggle" aria-expanded="false" aria-controls="details-1" id="toggle-1">
          <span class="chev" aria-hidden="true">▶</span>
          More information
        </button>
        <div class="meta">Simple</div>
      </div>

      <div id="details-1" class="details" role="region" aria-labelledby="toggle-1" aria-hidden="true">
        <div class="inner">
          <p>The expand/collapse widget reveals additional content without leaving the current page. It uses <code>aria-expanded</code> on the trigger and controls a container with the class <code>details</code>.</p>
        </div>
      </div>
    </div>

    <!-- Example 2: Nested content with list -->
    <div class="example">
      <div class="header">
        <button class="toggle" aria-expanded="false" aria-controls="details-2" id="toggle-2">
          <span class="chev" aria-hidden="true">▶</span>
          View features
        </button>
        <div class="meta">With list</div>
      </div>

      <div id="details-2" class="details" role="region" aria-labelledby="toggle-2" aria-hidden="true">
        <div class="inner">
          <p>Key features included:</p>
          <ul>
            <li>Accessible ARIA attributes (aria-expanded, aria-controls, aria-hidden).</li>
            <li>Smooth open/close animation with max-height.</li>
            <li>Reduced-motion support.</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Example 3: Longer content -->
    <div class="example">
      <div class="header">
        <button class="toggle" aria-expanded="false" aria-controls="details-3" id="toggle-3">
          <span class="chev" aria-hidden="true">▶</span>
          Read the long note
        </button>
        <div class="meta">Long text</div>
      </div>

      <div id="details-3" class="details" role="region" aria-labelledby="toggle-3" aria-hidden="true">
        <div class="inner">
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas vitae risus vel justo volutpat cursus. Sed dapibus, nibh non faucibus luctus, dui augue dictum ligula, a feugiat nibh tellus a lacus. Vivamus pharetra, quam vitae luctus consequat, nisl sem faucibus nunc, vitae hendrerit ex justo vel lorem.</p>
          <p>Curabitur blandit sem et lectus facilisis, in eleifend lacus fermentum. Integer posuere orci ac ante suscipit, id volutpat nisi iaculis.</p>
        </div>
      </div>
    </div>

  </div>

  <script>
    (function(){
      // Utility to toggle a details panel with animation and ARIA updates.
      const reducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      function openPanel(detailsEl, btn){
        if (!detailsEl || btn.getAttribute('aria-expanded') === 'true') return;

        btn.setAttribute('aria-expanded', 'true');
        detailsEl.setAttribute('aria-hidden', 'false');

        // If reduced motion, just show immediately
        if (reducedMotion){
          detailsEl.style.maxHeight = 'none';
          return;
        }

        // Prepare for animation: remove display none if present and measure
        detailsEl.style.display = 'block';
        const startHeight = detailsEl.scrollHeight;
        // From 0 to measured height
        detailsEl.style.maxHeight = '0px';
        // Force reflow so the transition occurs
        detailsEl.getBoundingClientRect();
        detailsEl.style.maxHeight = startHeight + 'px';

        // When transition ends, clear max-height so content can grow naturally
        const onEnd = function(e){
          if (e.target !== detailsEl) return;
          detailsEl.style.maxHeight = 'none';
          detailsEl.removeEventListener('transitionend', onEnd);
        };
        detailsEl.addEventListener('transitionend', onEnd);
      }

      function closePanel(detailsEl, btn){
        if (!detailsEl || btn.getAttribute('aria-expanded') === 'false') return;

        btn.setAttribute('aria-expanded', 'false');
        detailsEl.setAttribute('aria-hidden', 'true');

        if (reducedMotion){
          detailsEl.style.maxHeight = '0px';
          detailsEl.style.display = 'none';
          return;
        }

        // To animate from current height -> 0, first set explicit maxHeight to current height
        const currentHeight = detailsEl.scrollHeight;
        detailsEl.style.maxHeight = currentHeight + 'px';
        // Force reflow
        detailsEl.getBoundingClientRect();
        // Then animate to 0
        requestAnimationFrame(() => {
          detailsEl.style.maxHeight = '0px';
        });

        const onEnd = function(e){
          if (e.target !== detailsEl) return;
          // hide completely to remove from flow
          detailsEl.style.display = 'none';
          detailsEl.removeEventListener('transitionend', onEnd);
        };
        detailsEl.addEventListener('transitionend', onEnd);
      }

      // Wire up all toggle buttons on the page
      document.querySelectorAll('.toggle[aria-controls]').forEach(btn => {
        const controlledId = btn.getAttribute('aria-controls');
        const detailsEl = document.getElementById(controlledId);
        // Initialize display state: closed
        if (detailsEl){
          detailsEl.style.display = 'none';
          detailsEl.style.maxHeight = '0px';
          detailsEl.setAttribute('aria-hidden', 'true');
        }

        btn.addEventListener('click', function(){
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          if (expanded) closePanel(detailsEl, btn);
          else openPanel(detailsEl, btn);
        });

        // Buttons already have native keyboard activation (Space/Enter),
        // so no additional key handling is necessary.
      });

      // Optional: allow toggling via the keys Enter/Space when the control is focused (handled by button)
      // Also support toggling when user clicks the chevron icon (it's part of the button).

      // Expose methods for debugging/testing (not required)
      window._expandCollapse = {
        open: (id) => {
          const el = document.getElementById(id);
          const btn = document.querySelector('.toggle[aria-controls="'+id+'"]');
          openPanel(el, btn);
        },
        close: (id) => {
          const el = document.getElementById(id);
          const btn = document.querySelector('.toggle[aria-controls="'+id+'"]');
          closePanel(el, btn);
        }
      };
    })();
  </script>
</body>
</html>