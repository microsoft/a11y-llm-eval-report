<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#0b84ff;
      --bg:#fff;
      --muted:#6b7280;
      --radius:8px;
      --shadow: 0 2px 10px rgba(2,6,23,0.06);
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: #f7f9fc;
      color: #0f1724;
      margin: 32px;
      line-height:1.4;
    }

    h1{
      margin:0 0 18px 0;
      font-size:20px;
    }

    p.lead{
      margin:0 0 20px 0;
      color:var(--muted);
      font-size:14px;
    }

    .example{
      background:var(--bg);
      border-radius:var(--radius);
      padding:12px;
      box-shadow:var(--shadow);
      margin-bottom:16px;
      max-width:760px;
    }

    .toggle{
      display:flex;
      align-items:center;
      width:100%;
      gap:12px;
      background:transparent;
      border:0;
      padding:10px;
      text-align:left;
      cursor:pointer;
      font-size:16px;
      border-radius:8px;
    }

    .toggle:focus{
      outline:3px solid rgba(11,132,255,0.18);
      outline-offset:2px;
    }

    .toggle .title{
      flex:1;
      font-weight:600;
    }

    .toggle .meta{
      font-size:13px;
      color:var(--muted);
    }

    .chev{
      width:20px;
      height:20px;
      display:inline-block;
      flex:0 0 20px;
      transform-origin:center;
      transition:transform 180ms ease;
    }

    /* rotate when expanded via [aria-expanded="true"] on the button */
    .toggle[aria-expanded="true"] .chev{
      transform:rotate(90deg);
    }

    /* controlled content container */
    .details{
      overflow:hidden;
      max-height:0;
      opacity:0;
      transition: max-height 280ms cubic-bezier(.2,.9,.2,1), opacity 200ms linear;
    }

    .details.open{
      opacity:1;
    }

    .details .content{
      padding:12px 10px 16px 10px;
      border-top:1px solid #eef2f7;
      margin-top:8px;
      color:#0b1724;
      background:linear-gradient(180deg, rgba(240,246,255,0.6), transparent);
      border-radius:6px;
    }

    small.hint{
      display:block;
      margin-top:6px;
      color:var(--muted);
      font-size:13px;
    }

    /* small helper to limit width of example controls */
    .meta-row{
      display:flex;
      gap:12px;
      align-items:center;
      color:var(--muted);
      font-size:13px;
    }

  </style>
</head>
<body>
  <h1>Expand / Collapse Widget Examples</h1>
  <p class="lead">Two examples of an accessible expand/collapse widget. Each widget is wrapped in a div.example. The content container for each widget uses the class "details".</p>

  <div class="example">
    <button class="toggle" id="toggle-1" aria-expanded="false" aria-controls="details-1">
      <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false">
        <path d="M8 5v14l11-7z" fill="currentColor"/>
      </svg>
      <span class="title">More information</span>
      <span class="meta">Overview &raquo;</span>
    </button>

    <div class="details" id="details-1" role="region" aria-labelledby="toggle-1" aria-hidden="true">
      <div class="content">
        <p>
          This panel contains additional information that you can reveal or hide.
          Use the button above to toggle visibility. The control uses aria-expanded and aria-controls
          to communicate state to assistive technologies.
        </p>
        <p>
          Keyboard users: the toggle is a native button element, so it supports Enter and Space automatically.
        </p>
        <small class="hint">Example 1: initially collapsed</small>
      </div>
    </div>
  </div>

  <div class="example">
    <button class="toggle" id="toggle-2" aria-expanded="true" aria-controls="details-2">
      <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false">
        <path d="M8 5v14l11-7z" fill="currentColor"/>
      </svg>
      <span class="title">Product specifications</span>
      <span class="meta">Technical details</span>
    </button>

    <div class="details" id="details-2" role="region" aria-labelledby="toggle-2" aria-hidden="false">
      <div class="content">
        <ul>
          <li>Dimensions: 220 × 140 × 12 mm</li>
          <li>Weight: 480 g</li>
          <li>Battery: 4,000 mAh</li>
          <li>Connectivity: Wi‑Fi, Bluetooth 5.2, USB‑C</li>
        </ul>
        <p>Example 2: initially expanded.</p>
        <small class="hint">Try collapsing and expanding to see the animated height transition.</small>
      </div>
    </div>
  </div>

  <script>
    (function(){
      // Initialize all example widgets
      document.querySelectorAll('.example').forEach(function(example, index){
        var btn = example.querySelector('.toggle');
        var details = example.querySelector('.details');

        if (!btn || !details) return;

        // Ensure details have an id (if missing)
        if (!details.id){
          details.id = 'details-' + (index + 1) + '-' + Math.random().toString(36).slice(2,8);
          btn.setAttribute('aria-controls', details.id);
        }

        // Ensure button has an id (for aria-labelledby)
        if (!btn.id){
          btn.id = 'toggle-' + (index + 1) + '-' + Math.random().toString(36).slice(2,8);
          details.setAttribute('aria-labelledby', btn.id);
        }

        // Determine initial state from aria-expanded (or aria-hidden)
        var expanded = btn.getAttribute('aria-expanded') === 'true' || details.getAttribute('aria-hidden') === 'false';

        // Setup initial visuals
        if (expanded){
          details.classList.add('open');
          details.style.maxHeight = details.scrollHeight + 'px';
          details.setAttribute('aria-hidden','false');
          btn.setAttribute('aria-expanded','true');
          // After next frame remove maxHeight so the element can size naturally if content changes
          window.requestAnimationFrame(function(){
            // use a timeout to allow transition to settle before clearing style
            setTimeout(function(){
              details.style.maxHeight = '';
            }, 300);
          });
        } else {
          details.classList.remove('open');
          details.style.maxHeight = '0px';
          details.setAttribute('aria-hidden','true');
          btn.setAttribute('aria-expanded','false');
        }

        // Toggle behavior
        btn.addEventListener('click', function(){
          var isOpen = btn.getAttribute('aria-expanded') === 'true';
          if (isOpen){
            // close
            // set explicit height to current scrollHeight to enable transition
            details.style.maxHeight = details.scrollHeight + 'px';
            // force reflow so the starting height is taken
            void details.offsetHeight;
            details.style.maxHeight = '0px';
            details.classList.remove('open');
            btn.setAttribute('aria-expanded','false');
            details.setAttribute('aria-hidden','true');
          } else {
            // open
            // remove any 'none' value and compute scrollHeight
            details.classList.add('open');
            details.setAttribute('aria-hidden','false');
            btn.setAttribute('aria-expanded','true');

            // set to scrollHeight to animate from current (0) to full height
            details.style.maxHeight = details.scrollHeight + 'px';

            // When finished expanding, clear the maxHeight to allow natural resizing
            var once = function(e){
              if (e.target !== details) return;
              details.style.maxHeight = '';
              details.removeEventListener('transitionend', once);
            };
            details.addEventListener('transitionend', once);
          }
        });

        // Ensure that when closing finished, the inline style is at 0 and event removed
        details.addEventListener('transitionend', function(e){
          if (e.target !== details) return;
          // If closed, ensure max-height is 0 to stay collapsed
          if (btn.getAttribute('aria-expanded') === 'false'){
            details.style.maxHeight = '0px';
          }
        });

        // Allow toggling via Enter/Space handled by native button; no extra key handling necessary.
      });
    })();
  </script>
</body>
</html>