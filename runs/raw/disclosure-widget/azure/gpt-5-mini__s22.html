<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#0366d6;
      --bg:#f8f9fa;
      --surface:#fff;
      --border:#e1e4e8;
      --radius:8px;
      --ease:cubic-bezier(.2,.9,.3,1);
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color:#0b1220;
    }

    body{
      margin:24px;
      background:linear-gradient(180deg,var(--bg),#ffffff 40%);
      line-height:1.4;
    }

    h1{font-size:1.25rem;margin:0 0 16px 0}
    p.lead{margin:0 0 18px 0;color:#334155;font-size:.95rem}

    .example{
      background:var(--surface);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:16px;
      margin:18px 0;
      box-shadow:0 1px 2px rgba(16,24,40,.03);
      max-width:720px;
    }

    /* Common toggle button */
    .toggle-btn{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:8px 12px;
      background:transparent;
      border:1px solid var(--border);
      border-radius:6px;
      color:var(--accent);
      cursor:pointer;
      font-weight:600;
      transition:all 180ms var(--ease);
    }
    .toggle-btn:focus{
      outline:3px solid rgba(3,102,214,.12);
      outline-offset:3px;
    }
    .toggle-btn .chev{
      width:14px;height:14px;display:inline-block;transition:transform 240ms var(--ease);
      transform-origin:center;
    }
    .toggle-btn[aria-expanded="true"] .chev{
      transform:rotate(90deg);
    }

    /* Controlled content container */
    .details{
      overflow:hidden;
      max-height:0;
      transition:max-height 300ms var(--ease),opacity 200ms var(--ease);
      opacity:0;
      margin-top:12px;
      border-top:1px dashed var(--border);
      padding-top:12px;
    }
    .details.open{
      opacity:1;
    }

    /* Native details styling */
    details.details{
      padding:12px 0 0 0;
      border-top:none;
      max-height:none; /* native details uses its own disclosure */
      overflow:visible;
    }
    details.details summary{
      list-style:none;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:8px 12px;
      border:1px solid var(--border);
      border-radius:6px;
      color:var(--accent);
      font-weight:600;
    }
    details.details[open] summary .chev{ transform:rotate(90deg); }
    details.details .inner{
      margin-top:12px;
      padding:12px;
      background:linear-gradient(180deg, rgba(3,102,214,.02), transparent);
      border-radius:6px;
    }

    /* small content styles */
    .sample-contents{
      padding:8px;
      background:#fff;
      border:1px solid rgba(16,24,40,.03);
      border-radius:6px;
      font-size:0.95rem;
      color:#102a43;
    }

    footer{font-size:12px;color:#475569;margin-top:20px;}
  </style>
</head>
<body>
  <h1>Expand / Collapse Widget Examples</h1>
  <p class="lead">Two accessible patterns: a JavaScript-controlled disclosure and the native &lt;details&gt; element. Content containers use the class "details". Each widget is wrapped in a div.example.</p>

  <!-- Example 1: JS-controlled disclosure -->
  <div class="example" id="example-js">
    <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;">
      <div>
        <strong>JavaScript-controlled disclosure</strong>
        <div style="color:#475569;font-size:.92rem">Button toggles a content region. Uses aria-expanded and aria-controls.</div>
      </div>
      <div>
        <button class="toggle-btn"
                id="toggle1"
                aria-expanded="false"
                aria-controls="details1"
                data-toggle>
          <svg class="chev" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polyline points="6 9 12 15 18 9"></polyline></svg>
          Show details
        </button>
      </div>
    </div>

    <div id="details1"
         class="details"
         role="region"
         aria-labelledby="toggle1"
         aria-hidden="true">
      <div class="sample-contents">
        <p><strong>Responsive content:</strong> This section is controlled by the button. It can include any content â€” text, lists, forms, or images. The script animates the container's max-height for a smooth open/close transition while keeping ARIA attributes in sync for assistive technologies.</p>
        <ul>
          <li>Accessible: aria-expanded on the button.</li>
          <li>ARIA: aria-hidden on the content region when collapsed.</li>
          <li>Keyboard: focusable button, standard space/enter activation.</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Example 2: Native details element -->
  <div class="example" id="example-native">
    <strong style="display:block;margin-bottom:8px;">Native &lt;details&gt; element</strong>
    <details class="details" id="native1">
      <summary id="summary-native">
        <svg class="chev" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" style="width:14px;height:14px;margin-right:6px;"><polyline points="6 9 12 15 18 9"></polyline></svg>
        Open native details
      </summary>
      <div class="inner">
        <div class="sample-contents">
          <p>The native details element provides built-in disclosure behavior with keyboard support, state persistence (open attribute), and semantics. We still add the "details" class to the element to satisfy the requirement that controlled containers use that class.</p>
          <p>Use the native element when browser behaviors and basic styling suffice; use the JS-controlled approach when you need custom animations or more control over the interaction.</p>
        </div>
      </div>
    </details>
  </div>

  <footer>Examples show content containers with the class "details" and widgets wrapped with a div.example.</footer>

  <script>
    // JS-controlled disclosure: generic handler for elements with data-toggle
    (function(){
      const toggles = document.querySelectorAll('[data-toggle]');
      toggles.forEach(btn => {
        const controlledId = btn.getAttribute('aria-controls');
        if(!controlledId) return;
        const content = document.getElementById(controlledId);
        if(!content) return;

        // Initialize collapsed state
        content.style.maxHeight = '0px';
        content.classList.remove('open');
        content.setAttribute('aria-hidden','true');

        // Toggle function with height animation
        function toggle(){
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          if(expanded){
            // collapse
            const startHeight = content.scrollHeight;
            // set explicit height to allow transition from measured height to 0
            content.style.maxHeight = startHeight + 'px';
            // force repaint
            void content.offsetHeight;
            content.style.transition = 'max-height 300ms cubic-bezier(.2,.9,.3,1), opacity 200ms cubic-bezier(.2,.9,.3,1)';
            content.style.maxHeight = '0px';
            content.classList.remove('open');
            content.setAttribute('aria-hidden','true');
            btn.setAttribute('aria-expanded','false');
            btn.querySelector('.chev')?.setAttribute('aria-hidden','true');
          } else {
            // expand
            content.classList.add('open');
            // measure
            const target = content.scrollHeight;
            content.style.transition = 'max-height 330ms cubic-bezier(.2,.9,.3,1), opacity 220ms cubic-bezier(.2,.9,.3,1)';
            content.style.maxHeight = target + 'px';
            content.setAttribute('aria-hidden','false');
            btn.setAttribute('aria-expanded','true');
            btn.querySelector('.chev')?.setAttribute('aria-hidden','true');

            // after transition, clear max-height to allow internal changes
            const cleanup = () => {
              content.style.maxHeight = 'none';
              content.removeEventListener('transitionend', cleanup);
            };
            content.addEventListener('transitionend', cleanup);
          }
        }

        btn.addEventListener('click', toggle);

        // Allow Enter/Space to toggle when button is focused (button does this by default)
        // Keep behavior simple and semantic by using a native <button>.
      });
    })();
  </script>
</body>
</html>