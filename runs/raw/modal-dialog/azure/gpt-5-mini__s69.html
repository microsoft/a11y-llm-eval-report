<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Accessible Modal Example</title>
  <style>
    :root{
      --overlay-bg: rgba(0,0,0,0.5);
      --modal-bg: #fff;
      --radius: 8px;
      --max-width: 520px;
      --accent: #2468f2;
      --padding: 1.25rem;
      --transition: 180ms cubic-bezier(.2,.9,.3,1);
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      line-height: 1.35;
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(180deg,#f7fbff,#eef6ff);
      color: #0b1220;
      padding: 2rem;
    }

    .container{
      text-align: center;
      max-width: 720px;
      width: 100%;
    }

    button.trigger{
      appearance: none;
      border: none;
      background: linear-gradient(180deg,var(--accent),#1a57d6);
      color: #fff;
      padding: 0.6rem 1rem;
      font-size: 1rem;
      border-radius: 6px;
      cursor: pointer;
      box-shadow: 0 6px 18px rgba(36,104,242,0.18);
    }

    /* Backdrop / overlay */
    .modal-overlay{
      position: fixed;
      inset: 0;
      display: grid;
      place-items: center;
      background: var(--overlay-bg);
      opacity: 0;
      visibility: hidden;
      transition: opacity var(--transition), visibility 0ms linear var(--transition);
      z-index: 1000;
      padding: 1.25rem;
      -webkit-tap-highlight-color: transparent;
    }

    .modal-overlay.open{
      opacity: 1;
      visibility: visible;
      transition: opacity var(--transition);
    }

    /* Modal card */
    .modal {
      background: var(--modal-bg);
      border-radius: var(--radius);
      width: min(100%, var(--max-width));
      box-shadow: 0 8px 24px rgba(12,18,28,0.18);
      transform: translateY(8px) scale(0.98);
      opacity: 0;
      transition: transform var(--transition), opacity var(--transition);
      max-height: calc(100vh - 3rem);
      overflow: auto;
      outline: none;
    }

    .modal-overlay.open .modal {
      transform: translateY(0) scale(1);
      opacity: 1;
    }

    .modal-header{
      padding: var(--padding);
      border-bottom: 1px solid #eef3ff;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
    }

    .modal h2{
      margin: 0;
      font-size: 1.125rem;
      font-weight: 600;
      color: #071233;
    }

    .modal-body{
      padding: var(--padding);
      font-size: 0.98rem;
      color: #273449;
    }

    .modal-footer{
      padding: var(--padding);
      border-top: 1px solid #eef3ff;
      display: flex;
      justify-content: flex-end;
      gap: 0.5rem;
    }

    .btn{
      appearance: none;
      border: none;
      padding: 0.5rem 0.75rem;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.95rem;
    }

    .btn.secondary{
      background: #f3f6ff;
      color: #1b2e5a;
    }

    .btn.primary{
      background: var(--accent);
      color: #fff;
    }

    .btn.icon{
      background: transparent;
      color: #556;
      padding: 0.35rem;
      margin: -0.35rem;
    }

    .close {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.25rem;
    }

    /* Visually hidden (for accessible helper text) */
    .sr-only{
      position: absolute !important;
      height: 1px; width: 1px;
      overflow: hidden;
      clip: rect(1px,1px,1px,1px);
      white-space: nowrap;
      border: 0;
      padding: 0;
      margin: -1px;
    }

    @media (prefers-reduced-motion: reduce) {
      .modal, .modal-overlay { transition: none; }
    }
  </style>
</head>
<body>
  <main class="container" id="page-content">
    <h1>Modal Dialog Component</h1>
    <p>This example shows a modal dialog that is closed by default. Use the button below to open it.</p>
    <button class="trigger" type="button" aria-haspopup="dialog" aria-controls="example-modal">Open Modal</button>
  </main>

  <!-- Modal overlay (hidden by default) -->
  <div class="modal-overlay" id="example-modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="modal-title" aria-describedby="modal-desc">
    <div class="modal" role="document" tabindex="-1">
      <header class="modal-header">
        <h2 id="modal-title">Example Modal</h2>
        <button class="btn icon close" type="button" aria-label="Close dialog">
          <!-- simple "X" icon -->
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </header>

      <div class="modal-body">
        <p id="modal-desc">This modal demonstrates accessible behaviors: focus is moved into the dialog when opened, tab focus is trapped inside, and focus returns to the trigger when closed. You can close the dialog by pressing Escape, clicking the close button, or clicking outside the modal content (the backdrop).</p>

        <form>
          <label for="name">Name</label><br/>
          <input id="name" name="name" type="text" placeholder="Your name" style="margin-top:0.35rem;padding:0.45rem;border:1px solid #dbe7ff;border-radius:6px;width:100%;box-sizing:border-box"/>
          <div style="height:12px"></div>
          <label for="email">Email</label><br/>
          <input id="email" name="email" type="email" placeholder="you@example.com" style="margin-top:0.35rem;padding:0.45rem;border:1px solid #dbe7ff;border-radius:6px;width:100%;box-sizing:border-box"/>
        </form>
      </div>

      <footer class="modal-footer">
        <button class="btn secondary" type="button">Maybe later</button>
        <button class="btn primary" type="button">Save changes</button>
      </footer>
    </div>
  </div>

  <script>
    (function(){
      const overlay = document.getElementById('example-modal');
      const dialog = overlay.querySelector('.modal');
      const openTrigger = document.querySelector('.trigger');
      const closeButtons = overlay.querySelectorAll('.close, .modal-footer .btn.secondary');
      let lastFocused = null;

      const focusableSelector = [
        'a[href]',
        'area[href]',
        'input:not([disabled]):not([type="hidden"])',
        'select:not([disabled])',
        'textarea:not([disabled])',
        'button:not([disabled])',
        'iframe',
        'object',
        'embed',
        '[contenteditable]',
        '[tabindex]:not([tabindex="-1"])'
      ].join(',');

      function getFocusableElements(container){
        return Array.from(container.querySelectorAll(focusableSelector))
          .filter(el => el.offsetWidth > 0 || el.offsetHeight > 0 || el === document.activeElement);
      }

      function openModal(){
        if (overlay.classList.contains('open')) return;
        lastFocused = document.activeElement;
        overlay.classList.add('open');
        overlay.setAttribute('aria-hidden', 'false');
        // prevent page from scrolling behind modal on touch devices
        document.documentElement.style.overflow = 'hidden';
        dialog.focus({preventScroll:true});
        // Move focus to first focusable element inside modal
        const focusable = getFocusableElements(dialog);
        if (focusable.length) focusable[0].focus();
        // add listeners
        document.addEventListener('keydown', onKeyDown);
        document.addEventListener('focus', enforceFocus, true);
      }

      function closeModal(returnFocus = true){
        if (!overlay.classList.contains('open')) return;
        overlay.classList.remove('open');
        overlay.setAttribute('aria-hidden', 'true');
        document.documentElement.style.overflow = '';
        document.removeEventListener('keydown', onKeyDown);
        document.removeEventListener('focus', enforceFocus, true);
        if (returnFocus && lastFocused && typeof lastFocused.focus === 'function') {
          lastFocused.focus();
        }
      }

      // Trap focus inside the dialog
      function onKeyDown(e){
        if (e.key === 'Escape' || e.key === 'Esc') {
          e.preventDefault();
          closeModal();
          return;
        }

        if (e.key === 'Tab') {
          const focusable = getFocusableElements(dialog);
          if (focusable.length === 0) {
            e.preventDefault();
            return;
          }
          const currentIndex = focusable.indexOf(document.activeElement);
          let nextIndex = currentIndex;
          if (e.shiftKey) {
            nextIndex = currentIndex <= 0 ? focusable.length - 1 : currentIndex - 1;
          } else {
            nextIndex = currentIndex === focusable.length - 1 ? 0 : currentIndex + 1;
          }
          e.preventDefault();
          focusable[nextIndex].focus();
        }
      }

      // If focus moves outside the dialog, bring it back.
      function enforceFocus(e){
        if (!overlay.classList.contains('open')) return;
        if (dialog.contains(e.target)) return;
        e.stopPropagation();
        const focusable = getFocusableElements(dialog);
        if (focusable.length) focusable[0].focus();
        else dialog.focus();
      }

      // Open when trigger is clicked
      if (openTrigger) {
        openTrigger.addEventListener('click', openModal);
      }

      // Close when clicking backdrop (overlay) but not when clicking inside modal
      overlay.addEventListener('click', function(e){
        if (e.target === overlay) {
          closeModal();
        }
      });

      // Close buttons
      closeButtons.forEach(btn => {
        btn.addEventListener('click', function(){
          closeModal();
        });
      });

      // Close by pressing Enter or Space on trigger (keyboard activation)
      if (openTrigger) {
        openTrigger.addEventListener('keydown', function(e){
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            openModal();
          }
        });
      }

      // Ensure dialog element is focusable
      dialog.setAttribute('tabindex', '-1');

      // For progressive enhancement: hide overlay from assistive tech by default is already set.
      // A simple demo: close modal if focus moves to a hidden control (edge cases)
    })();
  </script>
</body>
</html>