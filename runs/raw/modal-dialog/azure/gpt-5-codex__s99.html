<html lang="en">
<head>
<meta charset="UTF-8">
<title>Modal Dialog Example</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
    :root {
        color-scheme: light dark;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    body {
        margin: 0;
        min-height: 100vh;
        display: grid;
        place-items: center;
        background: #f0f2f5;
    }
    button {
        font: inherit;
        border: none;
        border-radius: 0.5rem;
        padding: 0.75rem 1.5rem;
        cursor: pointer;
        background: #2563eb;
        color: #fff;
        transition: transform 0.15s ease, box-shadow 0.15s ease;
    }
    button:hover {
        transform: translateY(-1px);
        box-shadow: 0 8px 16px rgba(37, 99, 235, 0.2);
    }
    .modal {
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        background: rgba(17, 24, 39, 0.45);
        backdrop-filter: blur(4px);
        z-index: 1000;
    }
    .modal[aria-hidden="false"] {
        display: flex;
    }
    .modal__dialog {
        width: min(90vw, 420px);
        background: #fff;
        color: #111827;
        padding: 2rem;
        border-radius: 1rem;
        box-shadow: 0 30px 60px rgba(15, 23, 42, 0.2);
        position: relative;
    }
    .modal__dialog h2 {
        margin: 0 0 0.75rem;
        font-size: 1.5rem;
    }
    .modal__dialog p {
        margin: 0 0 1.5rem;
        line-height: 1.5;
    }
    .modal__footer {
        display: flex;
        gap: 0.75rem;
        justify-content: flex-end;
    }
    .modal__close {
        position: absolute;
        top: 0.75rem;
        right: 0.75rem;
        background: transparent;
        color: inherit;
        font-size: 1.5rem;
        padding: 0.25rem;
    }
    .modal__close:hover {
        transform: none;
        box-shadow: none;
        color: #2563eb;
    }
    .modal--closing {
        animation: fadeOut 180ms ease forwards;
    }
    .modal--opening {
        animation: fadeIn 180ms ease forwards;
    }
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(12px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    @keyframes fadeOut {
        from {
            opacity: 1;
            transform: translateY(0);
        }
        to {
            opacity: 0;
            transform: translateY(12px);
        }
    }
    @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
            scroll-behavior: auto !important;
        }
    }
</style>
</head>
<body>
<button class="trigger" aria-haspopup="dialog" aria-expanded="false">Open Modal</button>

<div class="modal" role="presentation" aria-hidden="true">
    <div class="modal__dialog" role="dialog" aria-modal="true" aria-labelledby="modal-title" aria-describedby="modal-description">
        <button class="modal__close" type="button" aria-label="Close dialog" data-close>&times;</button>
        <h2 id="modal-title">Subscribe to updates</h2>
        <p id="modal-description">Stay informed with the latest news and articles. Enter your email to join our newsletter.</p>
        <form>
            <label for="email" style="display:block;margin-bottom:0.5rem;">Email address</label>
            <input id="email" type="email" name="email" required placeholder="you@example.com" style="width:100%;padding:0.75rem;border-radius:0.5rem;border:1px solid #cbd5f5;margin-bottom:1.5rem;font:inherit;">
            <div class="modal__footer">
                <button type="button" data-close style="background:#e5e7eb;color:#1f2937;">Cancel</button>
                <button type="submit">Subscribe</button>
            </div>
        </form>
    </div>
</div>

<script>
    (function () {
        const modal = document.querySelector('.modal');
        const dialog = modal.querySelector('.modal__dialog');
        const openButtons = document.querySelectorAll('.trigger');
        const closeButtons = modal.querySelectorAll('[data-close]');
        let activeTrigger = null;
        let focusableElements = [];
        let firstFocusable, lastFocusable;

        function setFocusableElements() {
            focusableElements = dialog.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])');
            firstFocusable = focusableElements[0];
            lastFocusable = focusableElements[focusableElements.length - 1];
        }

        function trapFocus(event) {
            if (event.key !== 'Tab' || focusableElements.length === 0) return;
            if (event.shiftKey && document.activeElement === firstFocusable) {
                event.preventDefault();
                lastFocusable.focus();
            } else if (!event.shiftKey && document.activeElement === lastFocusable) {
                event.preventDefault();
                firstFocusable.focus();
            }
        }

        function openModal(trigger) {
            activeTrigger = trigger;
            modal.classList.remove('modal--closing');
            modal.setAttribute('aria-hidden', 'false');
            trigger.setAttribute('aria-expanded', 'true');
            requestAnimationFrame(() => modal.classList.add('modal--opening'));
            document.body.style.overflow = 'hidden';
            setFocusableElements();
            if (firstFocusable) firstFocusable.focus();
            document.addEventListener('keydown', handleKeyDown);
            dialog.addEventListener('keydown', trapFocus);
        }

        function closeModal() {
            modal.classList.remove('modal--opening');
            modal.classList.add('modal--closing');
            modal.setAttribute('aria-hidden', 'true');
            document.body.style.overflow = '';
            if (activeTrigger) {
                activeTrigger.setAttribute('aria-expanded', 'false');
                activeTrigger.focus();
            }
            document.removeEventListener('keydown', handleKeyDown);
            dialog.removeEventListener('keydown', trapFocus);
            setTimeout(() => {
                modal.classList.remove('modal--closing');
            }, 180);
        }

        function handleKeyDown(event) {
            if (event.key === 'Escape') {
                closeModal();
            }
        }

        openButtons.forEach(button => {
            button.addEventListener('click', () => openModal(button));
        });

        closeButtons.forEach(button => {
            button.addEventListener('click', closeModal);
        });

        modal.addEventListener('mousedown', event => {
            if (event.target === modal) {
                closeModal();
            }
        });
    })();
</script>
</body>
</html>