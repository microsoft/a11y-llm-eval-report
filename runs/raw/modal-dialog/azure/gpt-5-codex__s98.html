<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Modal Dialog Example</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      color-scheme: light dark;
      font-family: "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: grid;
      place-items: center;
      background: linear-gradient(135deg, #f3f4f6, #d9e2ec);
      color: #1f2933;
    }

    .container {
      text-align: center;
      padding: 2rem;
      background: rgba(255, 255, 255, 0.85);
      border-radius: 1rem;
      box-shadow: 0 20px 45px -25px rgba(15, 23, 42, 0.65);
      backdrop-filter: blur(6px);
    }

    h1 {
      margin-top: 0;
      font-size: clamp(2rem, 3vw, 2.5rem);
      color: #0f172a;
    }

    p {
      margin-bottom: 2rem;
      color: #334155;
    }

    button {
      font: inherit;
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 999px;
      cursor: pointer;
      background: #2563eb;
      color: #ffffff;
      font-weight: 600;
      letter-spacing: 0.02em;
      box-shadow: 0 10px 25px -15px rgba(37, 99, 235, 0.8);
      transition: transform 0.15s ease, box-shadow 0.2s ease, background 0.2s ease;
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 18px 40px -20px rgba(37, 99, 235, 0.75);
      background: #1d4ed8;
    }

    button:active {
      transform: translateY(1px);
      box-shadow: 0 12px 30px -16px rgba(37, 99, 235, 0.75);
    }

    .modal {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      background: rgba(15, 23, 42, 0.4);
      opacity: 0;
      pointer-events: none;
      transition: opacity 250ms ease;
      z-index: 1000;
    }

    .modal.is-visible {
      opacity: 1;
      pointer-events: auto;
    }

    .modal__dialog {
      position: relative;
      width: min(90vw, 420px);
      background: #ffffff;
      color: #0f172a;
      border-radius: 1rem;
      box-shadow: 0 24px 60px -30px rgba(30, 41, 59, 0.8);
      transform: translateY(24px) scale(0.98);
      transition: transform 250ms ease, opacity 250ms ease;
      padding: 1.75rem;
      opacity: 0;
    }

    .modal.is-visible .modal__dialog {
      transform: translateY(0) scale(1);
      opacity: 1;
    }

    .modal__header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .modal__title {
      margin: 0;
      font-size: 1.25rem;
      font-weight: 700;
      color: #1e293b;
    }

    .modal__close {
      background: transparent;
      color: inherit;
      border-radius: 999px;
      width: 2.5rem;
      height: 2.5rem;
      display: grid;
      place-items: center;
      box-shadow: none;
    }

    .modal__close:hover {
      background: rgba(148, 163, 184, 0.18);
    }

    .modal__body {
      color: #475569;
      line-height: 1.6;
      margin-bottom: 1.5rem;
    }

    .modal__footer {
      display: flex;
      justify-content: flex-end;
      gap: 0.75rem;
    }

    .modal__footer button.secondary {
      background: #e2e8f0;
      color: #0f172a;
      box-shadow: none;
    }

    .modal__footer button.secondary:hover {
      background: #cbd5f5;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Modal Dialog Demo</h1>
    <p>
      Click the button below to open the modal dialog. It showcases an accessible overlay with focus trapping and keyboard support.
    </p>
    <button type="button" class="trigger">Launch Modal</button>
  </div>

  <div class="modal" id="example-modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="modal-title">
    <div class="modal__dialog" tabindex="-1">
      <header class="modal__header">
        <h2 class="modal__title" id="modal-title">Stay in the loop</h2>
        <button type="button" class="modal__close" aria-label="Close dialog" data-close>
          <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" focusable="false">
            <path d="M18.3 5.71a1 1 0 0 0-1.41 0L12 10.59 7.11 5.7A1 1 0 1 0 5.7 7.11L10.59 12l-4.9 4.89a1 1 0 1 0 1.41 1.42L12 13.41l4.89 4.9a1 1 0 0 0 1.42-1.41L13.41 12l4.89-4.89a1 1 0 0 0 0-1.4Z" fill="currentColor"></path>
          </svg>
        </button>
      </header>
      <div class="modal__body">
        <p>
          Subscribe to receive curated updates on upcoming features, events, and early-access invitations. We promise to send only the good stuff!
        </p>
      </div>
      <footer class="modal__footer">
        <button type="button" class="secondary" data-close>Not now</button>
        <button type="button" data-auto-focus>Subscribe</button>
      </footer>
    </div>
  </div>

  <script>
    (function () {
      const modal = document.getElementById('example-modal');
      const dialog = modal.querySelector('.modal__dialog');
      const triggers = document.querySelectorAll('.trigger');
      const closeControls = modal.querySelectorAll('[data-close]');
      const focusableSelectors = [
        'a[href]',
        'area[href]',
        'input:not([disabled]):not([type="hidden"])',
        'select:not([disabled])',
        'textarea:not([disabled])',
        'button:not([disabled])',
        '[tabindex]:not([tabindex="-1"])'
      ].join(',');

      let focusableElements = [];
      let previouslyFocusedElement = null;

      function handleKeydown(event) {
        if (event.key === 'Escape') {
          event.preventDefault();
          closeModal();
          return;
        }

        if (event.key === 'Tab') {
          trapFocus(event);
        }
      }

      function trapFocus(event) {
        if (!focusableElements.length) {
          event.preventDefault();
          return;
        }

        const first = focusableElements[0];
        const last = focusableElements[focusableElements.length - 1];
        const active = document.activeElement;

        if (event.shiftKey) {
          if (active === first || active === dialog) {
            event.preventDefault();
            last.focus();
          }
        } else {
          if (active === last) {
            event.preventDefault();
            first.focus();
          }
        }
      }

      function openModal() {
        if (modal.classList.contains('is-visible')) return;

        previouslyFocusedElement = document.activeElement instanceof HTMLElement
          ? document.activeElement
          : null;

        modal.classList.add('is-visible');
        modal.setAttribute('aria-hidden', 'false');

        focusableElements = Array.from(dialog.querySelectorAll(focusableSelectors));
        const focusTarget = dialog.querySelector('[data-auto-focus]') || focusableElements[0] || dialog;
        focusTarget.focus({ preventScroll: true });

        document.addEventListener('keydown', handleKeydown);
      }

      function closeModal() {
        if (!modal.classList.contains('is-visible')) return;

        modal.classList.remove('is-visible');
        modal.setAttribute('aria-hidden', 'true');

        document.removeEventListener('keydown', handleKeydown);

        requestAnimationFrame(() => {
          if (previouslyFocusedElement && previouslyFocusedElement.focus) {
            previouslyFocusedElement.focus({ preventScroll: true });
          }
        });
      }

      triggers.forEach(trigger =>
        trigger.addEventListener('click', openModal)
      );

      closeControls.forEach(control =>
        control.addEventListener('click', closeModal)
      );

      modal.addEventListener('click', event => {
        if (event.target === modal) {
          closeModal();
        }
      });

      window.addEventListener('focus', event => {
        if (!modal.classList.contains('is-visible')) return;
        if (modal.contains(event.target)) return;

        event.stopPropagation();
        const first = focusableElements[0] || dialog;
        first.focus({ preventScroll: true });
      }, true);
    })();
  </script>
</body>
</html>