<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Modal Dialog Example</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      color-scheme: light dark;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    body {
      margin: 0;
      min-height: 100vh;
      display: grid;
      place-items: center;
      background: radial-gradient(circle at top, #f7f7ff, #e1e4ff);
    }
    .container {
      text-align: center;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(6px);
      padding: 3rem 4rem;
      border-radius: 24px;
      box-shadow: 0 20px 45px rgba(32, 36, 70, 0.25);
    }
    h1 {
      margin-bottom: 0.5rem;
    }
    p {
      color: #446;
      margin-bottom: 2rem;
    }
    .trigger {
      appearance: none;
      border: none;
      border-radius: 999px;
      padding: 0.9rem 2.4rem;
      font-size: 1rem;
      font-weight: 600;
      background: linear-gradient(135deg, #637bff, #8757ff);
      color: #fff;
      cursor: pointer;
      transition: transform 0.15s ease, box-shadow 0.15s ease;
      box-shadow: 0 14px 28px rgba(86, 81, 255, 0.26);
    }
    .trigger:focus-visible {
      outline: 3px solid rgba(119, 95, 255, 0.55);
      outline-offset: 4px;
    }
    .trigger:hover {
      transform: translateY(-1px);
      box-shadow: 0 16px 32px rgba(86, 81, 255, 0.32);
    }
    .modal-backdrop {
      position: fixed;
      inset: 0;
      display: grid;
      place-items: center;
      background: rgba(15, 16, 32, 0.45);
      padding: 1.5rem;
      transition: opacity 180ms ease;
      opacity: 0;
      pointer-events: none;
    }
    .modal-backdrop.is-open {
      opacity: 1;
      pointer-events: auto;
    }
    .modal {
      width: min(420px, 100%);
      background: #fff;
      color: #111;
      border-radius: 20px;
      box-shadow: 0 30px 80px rgba(25, 32, 72, 0.35);
      padding: 2.4rem;
      display: grid;
      gap: 1.3rem;
      transform: translateY(24px);
      transition: transform 180ms ease;
    }
    .modal-backdrop.is-open .modal {
      transform: translateY(0);
    }
    [data-close] {
      justify-self: end;
      border: none;
      background: none;
      font-size: 1.4rem;
      cursor: pointer;
      color: #536;
      line-height: 1;
      padding: 0.25rem;
    }
    [data-close]:focus-visible {
      outline: 2px solid rgba(83, 94, 255, 0.55);
      border-radius: 6px;
    }
    .modal__actions {
      display: flex;
      gap: 0.75rem;
      justify-content: flex-end;
      margin-top: 0.5rem;
    }
    .modal__actions button {
      border: none;
      border-radius: 10px;
      padding: 0.7rem 1.4rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 160ms ease, transform 160ms ease;
    }
    .modal__actions button.primary {
      background: #6a71ff;
      color: white;
    }
    .modal__actions button.secondary {
      background: #eef0ff;
      color: #475;
    }
    .modal__actions button:hover {
      transform: translateY(-1px);
    }
    .modal__actions button:focus-visible {
      outline: 2px solid rgba(105, 110, 255, 0.65);
      outline-offset: 2px;
    }
    @media (max-width: 600px) {
      .container {
        padding: 2.5rem 2rem;
      }
      .modal {
        padding: 2rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Modal Dialog Demo</h1>
    <p>Click the button below to open an accessible modal dialog example.</p>
    <button class="trigger" type="button">Open Modal</button>
  </div>

  <div class="modal-backdrop" data-modal-backdrop hidden>
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      <button type="button" aria-label="Close modal" data-close>&times;</button>
      <h2 id="modal-title">Subscribe to our newsletter</h2>
      <p>Stay up to date with the latest tutorials, guides, and resources delivered straight to your inbox.</p>
      <form>
        <label for="email">Email address</label>
        <input id="email" name="email" type="email" placeholder="you@example.com" required style="width:100%;padding:0.75rem;border-radius:10px;border:1px solid #ccd0ff;font-size:1rem;">
        <div class="modal__actions">
          <button type="button" class="secondary" data-close>Cancel</button>
          <button type="submit" class="primary">Subscribe</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const triggerButton = document.querySelector(".trigger");
      const backdrop = document.querySelector("[data-modal-backdrop]");
      const dialog = backdrop.querySelector("[role='dialog']");
      const closeButtons = backdrop.querySelectorAll("[data-close]");
      let previousActiveElement = null;

      const focusableSelectors = [
        "a[href]",
        "area[href]",
        "input:not([disabled]):not([type='hidden'])",
        "select:not([disabled])",
        "textarea:not([disabled])",
        "button:not([disabled])",
        "iframe",
        "object",
        "embed",
        "[tabindex]:not([tabindex='-1'])",
        "[contenteditable='true']"
      ];

      const getFocusableElements = () =>
        Array.from(dialog.querySelectorAll(focusableSelectors.join(","))).filter(el => el.offsetParent !== null);

      const trapFocus = event => {
        const focusable = getFocusableElements();
        if (focusable.length === 0) {
          event.preventDefault();
          return;
        }
        const first = focusable[0];
        const last = focusable[focusable.length - 1];
        if (event.key === "Tab") {
          if (event.shiftKey && document.activeElement === first) {
            event.preventDefault();
            last.focus();
          } else if (!event.shiftKey && document.activeElement === last) {
            event.preventDefault();
            first.focus();
          }
        }
      };

      const openModal = () => {
        if (backdrop.classList.contains("is-open")) return;
        previousActiveElement = document.activeElement;
        backdrop.removeAttribute("hidden");
        requestAnimationFrame(() => {
          backdrop.classList.add("is-open");
          const focusable = getFocusableElements();
          (focusable[0] || dialog).focus();
        });
        document.addEventListener("keydown", handleKeydown);
        dialog.addEventListener("keydown", trapFocus);
      };

      const closeModal = () => {
        if (!backdrop.classList.contains("is-open")) return;
        backdrop.classList.remove("is-open");
        backdrop.setAttribute("hidden", "");
        document.removeEventListener("keydown", handleKeydown);
        dialog.removeEventListener("keydown", trapFocus);
        if (previousActiveElement && typeof previousActiveElement.focus === "function") {
          previousActiveElement.focus();
        } else {
          triggerButton.focus();
        }
      };

      const handleKeydown = event => {
        if (event.key === "Escape") {
          event.preventDefault();
            closeModal();
        }
      };

      triggerButton.addEventListener("click", openModal);
      backdrop.addEventListener("click", event => {
        if (event.target === backdrop) {
          closeModal();
        }
      });
      closeButtons.forEach(button => button.addEventListener("click", closeModal));
    });
  </script>
</body>
</html>