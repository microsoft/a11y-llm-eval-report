<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Modal Dialog Example</title>
  <style>
    :root {
      --overlay: rgba(0, 0, 0, 0.6);
      --bg: #fff;
      --radius: 12px;
      --shadow: 0 20px 40px rgba(0, 0, 0, 0.25);
    }

    /* Basic reset for demonstration */
    * { box-sizing: border-box; }

    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif; margin: 0; padding: 2rem; }

    /* Backdrop modal container */
    .modal {
      position: fixed;
      inset: 0;
      display: none; /* closed by default */
      align-items: center;
      justify-content: center;
      background: var(--overlay);
      z-index: 1000;
    }
    .modal.open {
      display: flex;
    }

    /* Modal content panel */
    .modal-content {
      background: var(--bg);
      border-radius: var(--radius);
      padding: 1.25rem;
      width: min(92vw, 520px);
      box-shadow: var(--shadow);
      transform: translateY(8px);
      transition: transform 0.2s ease-out;
    }

    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 0.75rem;
    }

    .modal-title {
      font-size: 1.25rem;
      margin: 0;
    }

    .modal-close {
      background: transparent;
      border: none;
      font-size: 1.5rem;
      line-height: 1;
      cursor: pointer;
      padding: 0.25rem 0.5rem;
    }

    .modal-close:hover,
    .button:hover {
      opacity: 0.9;
    }

    .button {
      display: inline-block;
      padding: 0.5rem 0.75rem;
      border-radius: 6px;
      border: 1px solid #ccc;
      background: #f5f5f5;
      cursor: pointer;
    }

    .button.primary {
      background: #007bff;
      color: #fff;
      border-color: #007bff;
    }

    /* Utility for when modal is open (optional like locking background scroll) */
    body.modal-open {
      overflow: hidden;
    }
  </style>
</head>
<body>

  <main>
    <h1>Modal Dialog Example</h1>
    <p>Click the button below to open the modal. The trigger button has a class of "trigger".</p>
    <button class="trigger" data-modal-target="#myModal">Open Modal</button>

    <!-- Modal -->
    <div id="myModal" class="modal" role="dialog" aria-labelledby="modal-title" aria-modal="true" aria-hidden="true">
      <div class="modal-content" role="document">
        <header class="modal-header">
          <h2 id="modal-title" class="modal-title">Example Modal</h2>
          <button class="modal-close" data-close aria-label="Close modal">&times;</button>
        </header>
        <section>
          <p>This is an accessible modal dialog. It is closed by default and can be opened by a button with the class "trigger".</p>
          <p>Try pressing Escape or clicking outside the dialog to close it.</p>
        </section>
        <footer style="margin-top: 1rem; text-align: right;">
          <button class="button" data-close>Cancel</button>
          <button class="button primary" data-close style="margin-left: 0.5rem;">Okay</button>
        </footer>
      </div>
    </div>
  </main>

  <script>
    (function() {
      var triggers = document.querySelectorAll('.trigger');
      var modals = document.querySelectorAll('.modal');
      var lastFocused = null;

      function openModal(modal) {
        if (!modal) return;
        lastFocused = document.activeElement;

        modal.classList.add('open');
        modal.setAttribute('aria-hidden', 'false');
        document.body.classList.add('modal-open');
        // Focus the first focusable element inside the modal
        var focusables = modal.querySelectorAll(
          'button,[href],input,select,textarea,[tabindex]:not([tabindex="-1"])'
        );
        var first = focusables[0];
        setTimeout(function() {
          if (first) first.focus();
        }, 0);

        // Event listeners for closing and focus trapping
        document.addEventListener('keydown', onKeyDown);
        modal.addEventListener('mousedown', onBackdropMouseDown);
      }

      function closeModal(modal) {
        if (!modal) return;
        modal.classList.remove('open');
        modal.setAttribute('aria-hidden', 'true');
        document.body.classList.remove('modal-open');
        document.removeEventListener('keydown', onKeyDown);
        modal.removeEventListener('mousedown', onBackdropMouseDown);
        // Return focus to the element that opened the modal
        if (lastFocused && typeof lastFocused.focus === 'function') {
          lastFocused.focus();
        }
      }

      // Close on Escape
      function onKeyDown(e) {
        if (e.key === 'Escape' || e.key === 'Esc') {
          var modal = document.querySelector('.modal.open');
          if (modal) closeModal(modal);
        }
        // Simple focus trap within modal when Tab is pressed
        if (e.key === 'Tab') {
          var modal = document.querySelector('.modal.open');
          if (!modal) return;
          var focusables = modal.querySelectorAll(
            'button,[href],input,select,textarea,[tabindex]:not([tabindex="-1"])'
          );
          var focusArray = Array.prototype.slice.call(focusables).filter(function(el) {
            return !el.hasAttribute('disabled') && el.offsetParent !== null;
          });
          if (focusArray.length === 0) {
            e.preventDefault();
            return;
          }
          var first = focusArray[0];
          var last = focusArray[focusArray.length - 1];
          if (e.shiftKey) {
            if (document.activeElement === first) {
              e.preventDefault();
              last.focus();
            }
          } else {
            if (document.activeElement === last) {
              e.preventDefault();
              first.focus();
            }
          }
        }
      }

      // Click on backdrop to close
      function onBackdropMouseDown(e) {
        if (e.target === e.currentTarget) {
          closeModal(e.currentTarget);
        }
      }

      // Wire up triggers
      triggers.forEach(function(btn) {
        var targetSel = btn.getAttribute('data-modal-target');
        btn.addEventListener('click', function() {
          var modal = document.querySelector(targetSel);
          if (modal) {
            modal.setAttribute('aria-hidden', 'false');
            openModal(modal);
          }
        });
      });

      // Wire up close controls inside modals
      document.querySelectorAll('[data-close]').forEach(function(el) {
        el.addEventListener('click', function() {
          var modal = el.closest('.modal');
          if (modal) closeModal(modal);
        });
      });

      // Ensure modals are hidden by default on load
      modals.forEach(function(m) {
        m.setAttribute('aria-hidden', 'true');
        m.classList.remove('open');
      });
    })();
  </script>
</body>
</html>