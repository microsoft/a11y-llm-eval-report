<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ShopEase — Home</title>
  <meta name="description" content="ShopEase — curated deals, popular items, and insightful blog posts to help you shop smarter." />
  <style>
    :root{
      --bg:#f6f7fb;
      --card:#ffffff;
      --accent:#ff6b35;
      --muted:#6b7280;
      --glass: rgba(255,255,255,0.6);
      --success:#16a34a;
      --danger:#ef4444;
      --shadow: 0 6px 18px rgba(15,23,42,0.08);
      --radius:12px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:linear-gradient(180deg,#f6f7fb 0%, #eef2ff 100%);
      color:#0f172a;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.45;
      padding-bottom:60px;
    }

    header{
      position:sticky;
      top:0;
      z-index:40;
      backdrop-filter: blur(6px);
      background: rgba(255,255,255,0.7);
      box-shadow: 0 2px 8px rgba(15,23,42,0.04);
      border-bottom: 1px solid rgba(15,23,42,0.02);
    }
    .container{max-width:1180px;margin:0 auto;padding:18px 20px;display:flex;align-items:center;gap:18px}
    .logo{display:flex;align-items:center;gap:12px;font-weight:700;font-size:18px;color:var(--accent)}
    .logo svg{width:36px;height:36px}
    nav{margin-left:8px;display:flex;gap:12px;align-items:center}
    nav a{color:#063; text-decoration:none;color:#0f172a;padding:8px 10px;border-radius:8px;font-size:14px}
    nav a:hover{background:rgba(2,6,23,0.04)}
    .search{flex:1;display:flex;align-items:center;gap:8px}
    .search input{
      width:100%;padding:10px 12px;border-radius:10px;border:1px solid rgba(15,23,42,0.06);background:white;font-size:14px;
      box-shadow:var(--shadow);
    }
    .actions{display:flex;align-items:center;gap:12px}
    .icon-btn{background:var(--card);border:1px solid rgba(15,23,42,0.04);padding:8px 10px;border-radius:10px;display:inline-flex;gap:8px;align-items:center;cursor:pointer}
    .icon-btn:hover{box-shadow:var(--shadow)}
    .cart-count{background:var(--accent);color:white;padding:4px 7px;border-radius:999px;font-weight:600;font-size:12px;margin-left:6px}

    main.container{display:block;padding-top:26px}
    .hero{
      display:flex;gap:22px;align-items:center;padding:30px;border-radius:16px;background:
      linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.4));
      box-shadow: var(--shadow);
      margin-bottom:20px;
    }
    .hero-left{flex:1}
    .hero h1{margin:0;font-size:28px;letter-spacing:-0.01em}
    .hero p{margin:10px 0 16px;color:var(--muted)}
    .cta-row{display:flex;gap:12px;align-items:center}
    .btn{
      background:var(--accent);color:white;padding:10px 14px;border-radius:10px;border:none;font-weight:700;cursor:pointer;
      box-shadow: 0 8px 18px rgba(255,107,53,0.12);
    }
    .btn.secondary{background:transparent;border:1px solid rgba(15,23,42,0.06);color:#0f172a}
    .hero-right{width:300px;height:160px;display:flex;align-items:center;justify-content:center;border-radius:12px;background:
      linear-gradient(135deg,#fff 0%, #fff0 50%);border:1px solid rgba(15,23,42,0.03);box-shadow:var(--shadow)}
    .hero-badges{display:flex;gap:10px;margin-top:12px}

    section{margin-top:28px}
    .section-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px}
    .section-header h2{margin:0;font-size:18px}
    .filters{display:flex;gap:8px;align-items:center}
    .chip{padding:8px 12px;border-radius:999px;background:white;border:1px solid rgba(15,23,42,0.04);cursor:pointer;font-size:13px}
    .chip.active{background:linear-gradient(90deg,#fff6f2,#fff);border-color:rgba(255,107,53,0.12);box-shadow:0 8px 24px rgba(255,107,53,0.06)}

    /* product grid */
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    @media (max-width:980px){.grid{grid-template-columns:repeat(2,1fr)} .hero-right{display:none}}
    @media (max-width:640px){.grid{grid-template-columns:1fr} .container{padding:14px} header .container{padding:10px}}
    .card{background:var(--card);border-radius:12px;padding:14px;border:1px solid rgba(15,23,42,0.03);box-shadow:var(--shadow);display:flex;gap:12px;align-items:center}
    .thumb{width:96px;height:96px;border-radius:10px;background:linear-gradient(135deg,#f8fafc,#fff);display:flex;align-items:center;justify-content:center;border:1px dashed rgba(15,23,42,0.03)}
    .meta{flex:1}
    .meta h3{margin:0;font-size:16px}
    .meta p{margin:6px 0 10px;color:var(--muted);font-size:13px}
    .price-row{display:flex;align-items:center;gap:10px}
    .price{font-weight:800;color:#071442}
    .old{color:var(--muted);text-decoration:line-through;font-size:13px}
    .rating{color: #f59e0b;font-size:13px}
    .card-actions{display:flex;gap:8px}
    .wishlist{background:transparent;border:none;color:var(--muted);cursor:pointer;padding:8px;border-radius:8px}
    .wishlist.active{color:var(--danger);transform:scale(1.03)}
    .add{background:linear-gradient(90deg,#ff7a4d,#ff6b35);color:white;border:none;padding:9px 12px;border-radius:10px;cursor:pointer}

    /* deals */
    .deals-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
    @media (max-width:980px){.deals-grid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:640px){.deals-grid{grid-template-columns:1fr}}
    .deal-card{padding:14px;border-radius:12px;background:linear-gradient(180deg,#fff,#fff);box-shadow:var(--shadow);border:1px solid rgba(15,23,42,0.03)}
    .deal-head{display:flex;justify-content:space-between;align-items:center}
    .deal-price{font-weight:800;font-size:20px}
    .countdown{font-weight:700;color:var(--accent)}
    .progress{height:8px;background:rgba(15,23,42,0.04);border-radius:999px;margin-top:10px;overflow:hidden}
    .progress > i{display:block;height:100%;background:linear-gradient(90deg,#ffb4a2,#ff6b35);width:50%}

    /* blog */
    .blog-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    @media (max-width:980px){.blog-grid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:640px){.blog-grid{grid-template-columns:1fr}}
    .post{background:var(--card);padding:14px;border-radius:12px;border:1px solid rgba(15,23,42,0.03);box-shadow:var(--shadow)}
    .post img{width:100%;height:140px;object-fit:cover;border-radius:8px}
    .post h4{margin:10px 0 6px}
    .post p{margin:0;color:var(--muted);font-size:14px}
    .read{display:inline-block;margin-top:10px;color:var(--accent);font-weight:700}

    /* footer */
    footer{margin-top:34px;padding:28px 20px;background:transparent}
    .footer-inner{max-width:1180px;margin:0 auto;display:flex;gap:20px;align-items:flex-start;flex-wrap:wrap}
    .newsletter{flex:1;min-width:240px;padding:18px;border-radius:12px;background:linear-gradient(90deg,#fff,#fff);border:1px solid rgba(15,23,42,0.03);box-shadow:var(--shadow)}
    .socials{display:flex;gap:8px;margin-top:12px}
    .small{font-size:13px;color:var(--muted)}

    /* modal */
    .overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(2,6,23,0.5);display:none;align-items:center;justify-content:center;padding:20px;z-index:60}
    .overlay.open{display:flex}
    .modal{background:white;border-radius:12px;padding:20px;max-width:860px;width:100%;box-shadow:0 18px 44px rgba(2,6,23,0.32);max-height:90vh;overflow:auto}
    .close{background:transparent;border:none;font-size:16px;padding:6px;cursor:pointer}

    /* tiny toast */
    .toast{position:fixed;right:18px;bottom:18px;background:var(--success);color:white;padding:12px 16px;border-radius:10px;box-shadow:0 8px 24px rgba(22,163,74,0.16);display:none;z-index:80}
    .toast.show{display:block;animation:pop .28s ease}
    @keyframes pop{from{transform:translateY(8px);opacity:0}to{transform:none;opacity:1}}
  </style>
</head>
<body>
  <header>
    <div class="container" role="navigation" aria-label="Main">
      <div class="logo" aria-hidden="true">
        <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <rect width="48" height="48" rx="10" fill="#FFF6F2"/>
          <path d="M13 30c4-6 14-10 20-4" stroke="#FF6B35" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
          <circle cx="16" cy="18" r="3" fill="#FFB59A"/>
        </svg>
        ShopEase
      </div>

      <nav aria-label="Primary">
        <a href="#" data-link="home">Home</a>
        <a href="#products" data-link="shop">Shop</a>
        <a href="#deals" data-link="deals">Deals</a>
        <a href="#blog" data-link="blog">Blog</a>
        <a href="#contact" data-link="contact">Contact</a>
      </nav>

      <div class="search" role="search">
        <input id="searchInput" aria-label="Search products" placeholder="Search for items, brands, or categories..." />
      </div>

      <div class="actions" aria-hidden="false">
        <button class="icon-btn" id="btnWishlist" title="Wishlist">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M12 21s-7-4.35-9.2-6.645C.93 11.92 3.63 6 8.01 6c2.1 0 3.49 1.04 3.99 1.72.5-.69 1.9-1.72 3.99-1.72 4.38 0 7.08 5.92 5.2 8.355C19 16.65 12 21 12 21z" stroke="#0f172a" stroke-width="1.1" stroke-linecap="round" stroke-linejoin="round"></path></svg>
        </button>

        <button class="icon-btn" id="btnCart" title="Cart" aria-haspopup="true" aria-expanded="false">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M3 3h2l.9 2M7 13h10l3-8H6.2" stroke="#0f172a" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="9" cy="20" r="1" fill="#0f172a"/><circle cx="18" cy="20" r="1" fill="#0f172a"/></svg>
          <span class="cart-count" id="cartCount" aria-live="polite">0</span>
        </button>

        <button class="icon-btn" title="Account">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M20 21v-2a4 4 0 0 0-3-3.874" stroke="#0f172a" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 7a4 4 0 1 0 0-8 4 4 0 0 0 0 8z" transform="translate(0 6)" stroke="#0f172a" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>
      </div>
    </div>
  </header>

  <main class="container" id="main">
    <section class="hero" aria-label="Featured">
      <div class="hero-left">
        <h1>Find the everyday essentials — fast.</h1>
        <p>Curated picks, limited-time deals, and helpful guides — all in one place. Free shipping on orders over $50.</p>
        <div class="cta-row">
          <button class="btn" id="heroShop">Shop Now</button>
          <button class="btn secondary" id="heroDeals">See Deals</button>
        </div>
        <div class="hero-badges">
          <span class="chip">Free Returns</span>
          <span class="chip">24/7 Support</span>
          <span class="chip">Secure Payments</span>
        </div>
      </div>
      <div class="hero-right" aria-hidden="true">
        <svg width="220" height="120" viewBox="0 0 220 120" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="4" y="18" width="212" height="84" rx="12" fill="#FFF6F2"/>
          <g transform="translate(18,28)">
            <rect width="60" height="60" rx="10" fill="#fff" stroke="#FFE6DA"/>
            <rect x="72" y="6" width="120" height="12" rx="6" fill="#FFEDE6"/>
            <rect x="72" y="28" width="80" height="12" rx="6" fill="#FFF0E6"/>
            <rect x="72" y="50" width="40" height="12" rx="6" fill="#FFF6F2"/>
          </g>
        </svg>
      </div>
    </section>

    <section id="products" aria-labelledby="popular-heading">
      <div class="section-header">
        <h2 id="popular-heading">Popular Items</h2>
        <div class="filters" role="tablist" aria-label="Product categories">
          <button class="chip active" data-cat="">All</button>
          <button class="chip" data-cat="home">Home</button>
          <button class="chip" data-cat="tech">Tech</button>
          <button class="chip" data-cat="outdoors">Outdoors</button>
        </div>
      </div>

      <div class="grid" id="productGrid" aria-live="polite">
        <!-- product cards injected by JS -->
      </div>
    </section>

    <section id="deals" aria-labelledby="deals-heading">
      <div class="section-header">
        <h2 id="deals-heading">Hot Deals</h2>
        <div class="small">Limited time offers — while stocks last</div>
      </div>

      <div class="deals-grid" id="dealsGrid">
        <!-- deals injected by JS -->
      </div>
    </section>

    <section id="blog" aria-labelledby="blog-heading">
      <div class="section-header">
        <h2 id="blog-heading">From Our Blog</h2>
        <div class="small">Tips, trends, and product roundups</div>
      </div>

      <div class="blog-grid" id="blogGrid">
        <!-- posts injected by JS -->
      </div>
    </section>

    <footer id="contact" aria-label="Footer">
      <div class="footer-inner">
        <div class="newsletter">
          <strong>Sign up for exclusive offers</strong>
          <p class="small">Get early access to sales, curated guides, and personalized recommendations.</p>
          <div style="display:flex;gap:8px;margin-top:12px">
            <input id="emailInput" placeholder="Your email address" style="flex:1;padding:10px;border-radius:10px;border:1px solid rgba(15,23,42,0.06)"/>
            <button class="btn" id="subscribeBtn">Subscribe</button>
          </div>
          <div class="socials" role="list" aria-label="Social links">
            <a class="chip" role="listitem" href="#" aria-label="Twitter">Twitter</a>
            <a class="chip" role="listitem" href="#" aria-label="Instagram">Instagram</a>
            <a class="chip" role="listitem" href="#" aria-label="Facebook">Facebook</a>
          </div>
        </div>

        <div style="flex:1;min-width:220px">
          <strong>Customer Care</strong>
          <p class="small" style="margin-top:8px">Help center · Shipping · Returns · Gift cards</p>
        </div>

        <div style="flex:1;min-width:220px">
          <strong>About</strong>
          <p class="small" style="margin-top:8px">About us · Careers · Press · Sustainability</p>
        </div>
      </div>
    </footer>
  </main>

  <div class="overlay" id="modal" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document">
      <button class="close" id="closeModal" aria-label="Close">✕</button>
      <div id="modalContent"></div>
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite">Added to cart</div>

  <script>
    // Sample data
    const products = [
      {id:1,name:"Comfy Cotton Tee",category:"home",price:24.00,old:34.00,rating:4.6,tag:"Popular"},
      {id:2,name:"Noise-Cancelling Headphones",category:"tech",price:129.00,old:199.00,rating:4.8,tag:"Top Pick"},
      {id:3,name:"Insulated Water Bottle",category:"outdoors",price:22.00,old:null,rating:4.4,tag:"Eco"},
      {id:4,name:"Smart LED Lamp",category:"tech",price:45.00,old:59.00,rating:4.3,tag:"Trending"},
      {id:5,name:"Plush Throw Blanket",category:"home",price:39.00,old:49.00,rating:4.7,tag:"Cozy"},
      {id:6,name:"Compact Camping Stove",category:"outdoors",price:79.00,old:99.00,rating:4.5,tag:"Adventure"},
    ];

    const deals = [
      {id:'d1',title:"Weekend Flash — 30% off Headphones",price:89,old:129,expiresInSec:60*60*12,stock:18},
      {id:'d2',title:"Morning Deal — 20% off Lamp",price:36,old:45,expiresInSec:60*60*6,stock:7},
      {id:'d3',title:"Limited — Insulated Bottle 40% off",price:13,old:22,expiresInSec:60*60*36,stock:24},
    ];

    const posts = [
      {id:'p1',title:"How to Choose the Perfect Headphones",date:"2026-01-09",author:"Dana Reed",excerpt:"A quick guide to match your listening style, budget, and comfort needs.",content:"Full article content about selecting headphones. Discusses types, drivers, ANC, battery life, comfort, and recommendations."},
      {id:'p2',title:"5 Outdoor Essentials for Spring",date:"2026-02-01",author:"J. Patel",excerpt:"Pack smart with lightweight, durable gear that adds convenience to every adventure.",content:"Full article content covering water bottles, stoves, layers, shelters, and first aid."},
      {id:'p3',title:"Styling Your Home on a Budget",date:"2026-01-21",author:"M. Alvarez",excerpt:"Small updates that give big impact — textiles, lighting, and decluttering tips.",content:"Full write-up with practical tips, DIYs, and shopping lists to refresh a room affordably."},
    ];

    // Utilities
    const el = sel => document.querySelector(sel);
    const elAll = sel => Array.from(document.querySelectorAll(sel));
    const formatPrice = v => "$" + v.toFixed(2);

    // Render products
    function renderProducts(filter=""){
      const grid = el('#productGrid');
      grid.innerHTML = "";
      const list = products.filter(p => !filter || p.category === filter);
      list.forEach(p => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <div class="thumb" aria-hidden="true">${svgThumb(p)}</div>
          <div class="meta">
            <h3>${escapeHtml(p.name)}</h3>
            <p class="small">${escapeHtml(p.tag)} · ${capitalize(p.category)}</p>
            <div class="price-row">
              <div>
                <div class="price">${formatPrice(p.price)}</div>
                ${p.old ? `<div class="old">${formatPrice(p.old)}</div>` : ''}
              </div>
              <div style="margin-left:auto;text-align:right">
                <div class="rating" aria-hidden="true">${stars(p.rating)} <span style="color:var(--muted);font-size:12px;margin-left:6px">${p.rating.toFixed(1)}</span></div>
              </div>
            </div>
          </div>
          <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px">
            <button class="wishlist" title="Add to wishlist" data-id="${p.id}" aria-pressed="false">♡</button>
            <button class="add" data-id="${p.id}">Add</button>
          </div>
        `;
        grid.appendChild(card);
      });
    }

    // Render deals
    function renderDeals(){
      const grid = el('#dealsGrid');
      grid.innerHTML = "";
      const now = Date.now();
      deals.forEach(d => {
        const expiresAt = now + d.expiresInSec*1000;
        const card = document.createElement('div');
        card.className = 'deal-card';
        card.innerHTML = `
          <div class="deal-head">
            <div>
              <div style="font-size:14px;color:var(--muted)">${escapeHtml(d.title)}</div>
              <div class="deal-price">${formatPrice(d.price)} <span class="old" style="font-size:13px;margin-left:8px">${formatPrice(d.old)}</span></div>
            </div>
            <div style="text-align:right">
              <div class="countdown" data-expires="${expiresAt}" id="count-${d.id}">--:--:--</div>
              <div class="small" style="color:var(--muted);margin-top:4px">${d.stock} left</div>
            </div>
          </div>
          <div class="progress" aria-hidden="true"><i style="width:${Math.max(8, Math.min(96, Math.round((d.stock/30)*100)))}%"></i></div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">
            <button class="btn" data-deal="${d.id}">Buy Now</button>
            <button class="chip" style="background:#fff6f2;border-color:rgba(255,107,53,0.08)">Save</button>
          </div>
        `;
        grid.appendChild(card);
      });
      startCountdowns();
    }

    // Render blog
    function renderPosts(){
      const grid = el('#blogGrid');
      grid.innerHTML = "";
      posts.forEach(p => {
        const post = document.createElement('article');
        post.className = 'post';
        post.innerHTML = `
          <img alt="${escapeHtml(p.title)}" src="${placeholderImg(p.title)}" />
          <h4>${escapeHtml(p.title)}</h4>
          <p class="small">By ${escapeHtml(p.author)} · ${escapeHtml(p.date)}</p>
          <p>${escapeHtml(p.excerpt)}</p>
          <a href="#" class="read" data-id="${p.id}">Read more →</a>
        `;
        grid.appendChild(post);
      });
    }

    // Helper functions
    function svgThumb(p){
      const color = pickColor(p.category);
      return `
        <svg width="80" height="80" viewBox="0 0 80 80" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="${escapeHtml(p.name)}">
          <rect width="80" height="80" rx="12" fill="${color}"/>
          <g transform="translate(12,12)" fill="#fff">
            <rect width="56" height="36" rx="6" opacity="0.18"/>
            <rect y="44" width="40" height="8" rx="4" opacity="0.18"/>
          </g>
        </svg>
      `;
    }
    function pickColor(cat){
      switch(cat){
        case 'tech': return '#eef2ff';
        case 'home': return '#fff6f2';
        case 'outdoors': return '#ecfdf5';
        default: return '#fff';
      }
    }
    function stars(r){
      const full = Math.floor(r);
      const half = r - full >= 0.5;
      let s = '';
      for(let i=0;i<full;i++) s += '★';
      if(half) s += '☆';
      while(s.length<3){ s += '☆'; } // keep small
      return s;
    }
    function capitalize(s){ return s.charAt(0).toUpperCase()+s.slice(1) }
    function escapeHtml(s){ return String(s).replace(/[&<>"']/g, function(m){ return { '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[m] }) }
    function placeholderImg(text){
      const bg = encodeURIComponent('#f8fafc');
      const fg = encodeURIComponent('#0f172a');
      const escaped = encodeURIComponent(text);
      return `data:image/svg+xml;utf8,${encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' width='600' height='300'><rect width='100%' height='100%' fill='${bg}'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' fill='${fg}' font-family='Arial' font-size='20'>${escaped}</text></svg>`)}`;
    }

    // Countdown
    let countdownInterval = null;
    function startCountdowns(){
      if(countdownInterval) clearInterval(countdownInterval);
      countdownInterval = setInterval(()=> {
        const els = elAll('[id^="count-"]');
        const now = Date.now();
        els.forEach(c => {
          const expiresAt = Number(c.getAttribute('data-expires'));
          const remaining = Math.max(0, expiresAt - now);
          c.textContent = formatRemaining(remaining);
        });
      }, 1000);
      // run immediately
      const ev = new Event('init'); window.dispatchEvent(ev);
    }
    function formatRemaining(ms){
      const s = Math.floor(ms/1000);
      const h = Math.floor(s/3600);
      const m = Math.floor((s%3600)/60);
      const sec = s%60;
      return `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(sec).padStart(2,'0')}`;
    }

    // Interactivity
    document.addEventListener('DOMContentLoaded', function(){
      renderProducts();
      renderDeals();
      renderPosts();

      // categories
      elAll('.chip[data-cat]').forEach(chip => {
        chip.addEventListener('click', function(){
          elAll('.chip[data-cat]').forEach(c => c.classList.remove('active'));
          this.classList.add('active');
          const cat = this.getAttribute('data-cat');
          renderProducts(cat);
        });
      });

      // search
      el('#searchInput').addEventListener('input', function(){
        const q = this.value.trim().toLowerCase();
        const grid = el('#productGrid');
        grid.innerHTML = '';
        const list = products.filter(p => p.name.toLowerCase().includes(q) || p.tag.toLowerCase().includes(q) || p.category.toLowerCase().includes(q));
        list.forEach(p => {
          const card = document.createElement('div');
          card.className = 'card';
          card.innerHTML = `
            <div class="thumb" aria-hidden="true">${svgThumb(p)}</div>
            <div class="meta">
              <h3>${escapeHtml(p.name)}</h3>
              <p class="small">${escapeHtml(p.tag)} · ${capitalize(p.category)}</p>
              <div class="price-row">
                <div>
                  <div class="price">${formatPrice(p.price)}</div>
                  ${p.old ? `<div class="old">${formatPrice(p.old)}</div>` : ''}
                </div>
                <div style="margin-left:auto;text-align:right">
                  <div class="rating" aria-hidden="true">${stars(p.rating)} <span style="color:var(--muted);font-size:12px;margin-left:6px">${p.rating.toFixed(1)}</span></div>
                </div>
              </div>
            </div>
            <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px">
              <button class="wishlist" title="Add to wishlist" data-id="${p.id}" aria-pressed="false">♡</button>
              <button class="add" data-id="${p.id}">Add</button>
            </div>
          `;
          grid.appendChild(card);
        });
      });

      // delegate add to cart & wishlist
      document.body.addEventListener('click', function(e){
        const addBtn = e.target.closest('.add');
        if(addBtn){
          const id = addBtn.getAttribute('data-id');
          addToCart(id);
          return;
        }
        const wishBtn = e.target.closest('.wishlist');
        if(wishBtn){
          const state = wishBtn.classList.toggle('active');
          wishBtn.setAttribute('aria-pressed', state ? 'true' : 'false');
          wishBtn.textContent = state ? '♥' : '♡';
          return;
        }
        const read = e.target.closest('.read');
        if(read){
          e.preventDefault();
          const id = read.getAttribute('data-id');
          openPostModal(id);
          return;
        }
        const buy = e.target.closest('button[data-deal]');
        if(buy){
          const id = buy.getAttribute('data-deal');
          addToCart('deal-'+id);
          return;
        }
      });

      // hero buttons
      el('#heroShop').addEventListener('click', ()=> location.hash = '#products');
      el('#heroDeals').addEventListener('click', ()=> location.hash = '#deals');

      // blog modal
      el('#closeModal').addEventListener('click', closeModal);
      el('#modal').addEventListener('click', function(e){ if(e.target === this) closeModal(); });

      // subscribe
      el('#subscribeBtn').addEventListener('click', function(){
        const email = el('#emailInput').value.trim();
        if(!email || !/@/.test(email)){ alert('Please enter a valid email'); return; }
        this.textContent = 'Subscribed';
        this.disabled = true;
        el('#emailInput').value = '';
        setTimeout(()=>{ this.textContent = 'Subscribe'; this.disabled = false; }, 2000);
      });

      // cart persistence
      const stored = Number(localStorage.getItem('cartCount') || 0);
      setCartCount(stored);
    });

    function addToCart(id){
      const count = Number(localStorage.getItem('cartCount') || 0) + 1;
      localStorage.setItem('cartCount', count);
      setCartCount(count);
      showToast('Added to cart');
    }
    function setCartCount(n){
      el('#cartCount').textContent = String(n);
    }

    function showToast(txt){
      const t = el('#toast');
      t.textContent = txt;
      t.classList.add('show');
      setTimeout(()=> t.classList.remove('show'), 2200);
    }

    function openPostModal(id){
      const post = posts.find(p=>p.id===id); if(!post) return;
      el('#modalContent').innerHTML = `<h2>${escapeHtml(post.title)}</h2><p class="small">By ${escapeHtml(post.author)} · ${escapeHtml(post.date)}</p><div style="margin-top:12px">${escapeHtml(post.content)}</div>`;
      const modal = el('#modal');
      modal.classList.add('open');
      modal.setAttribute('aria-hidden','false');
    }
    function closeModal(){
      const modal = el('#modal');
      modal.classList.remove('open');
      modal.setAttribute('aria-hidden','true');
    }

    // small helpers
    function capitalize(s){ return s.charAt(0).toUpperCase()+s.slice(1) }

    // initialize countdowns immediately
    window.addEventListener('init', ()=> {
      const ev = new Event('update');
      window.dispatchEvent(ev);
    });

    // cleanup when unload
    window.addEventListener('beforeunload', ()=> {
      if(countdownInterval) clearInterval(countdownInterval);
    });
  </script>
</body>
</html>