<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="description" content="ShopSmart — Popular items, curated deals, and helpful shopping guides. Discover top products, limited-time offers, and the latest from our blog.">
  <title>ShopSmart — Home</title>
  <style>
    :root{
      --bg:#f6f7fb; --card:#ffffff; --muted:#6b7280; --accent:#0ea5a4; --accent-2:#0f766e;
      --radius:12px; --shadow: 0 6px 18px rgba(15,23,42,0.08);
      --max-width:1200px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:linear-gradient(180deg,#f6f7fb 0%, #eef2f6 100%); color:#0f1724;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      line-height:1.4;
    }
    .container{max-width:var(--max-width); margin:28px auto; padding:0 20px;}
    header{
      display:flex; align-items:center; gap:20px; justify-content:space-between;
    }
    .brand{display:flex; gap:12px; align-items:center; text-decoration:none; color:inherit;}
    .logo{
      width:54px; height:54px; border-radius:12px; display:flex; align-items:center; justify-content:center;
      background:linear-gradient(135deg,var(--accent),var(--accent-2)); color:#fff; font-weight:700; font-size:18px;
      box-shadow: 0 6px 18px rgba(14,165,164,0.18);
    }
    nav{display:flex; gap:14px; align-items:center;}
    nav a{color:var(--muted); text-decoration:none; padding:8px 12px; border-radius:8px; font-weight:600; font-size:13px}
    nav a:hover{background:rgba(15,23,42,0.04); color:inherit}
    .actions{display:flex; gap:12px; align-items:center;}
    .icon-btn{
      background:transparent; border:1px solid rgba(15,23,42,0.06); padding:8px 10px; border-radius:10px; display:inline-flex;
      gap:8px; align-items:center; cursor:pointer;
    }
    .searchbar{flex:1; margin:20px 0; display:flex; gap:12px; align-items:center;}
    .search-input{
      flex:1; display:flex; gap:8px; align-items:center; padding:12px 14px; border-radius:12px; background:var(--card);
      border:1px solid rgba(15,23,42,0.06); box-shadow:var(--shadow);
    }
    .search-input input{
      border:0; outline:0; font-size:15px; width:100%; background:transparent;
    }
    .hero{
      display:grid; grid-template-columns:1fr 320px; gap:18px; margin-bottom:26px;
    }
    .promo{
      background:linear-gradient(90deg,#ffffff 0%, rgba(255,255,255,0.9) 100%); border-radius:16px; padding:22px;
      box-shadow:var(--shadow); display:flex; gap:18px; align-items:center;
    }
    .promo-visual{width:160px; height:120px; border-radius:12px; background:linear-gradient(135deg,#ffe8e0,#ffd2cc); display:flex; align-items:center; justify-content:center; color:#7f1d1d; font-weight:700; font-size:22px}
    .promo h2{margin:0 0 6px 0; font-size:20px}
    .promo p{margin:0; color:var(--muted); font-size:14px}
    .promo .cta{margin-top:10px; display:inline-block; padding:10px 14px; background:var(--accent); color:white; border-radius:10px; text-decoration:none; font-weight:600}
    .side-cards{display:flex; flex-direction:column; gap:12px; }
    .card-small{background:var(--card); border-radius:12px; padding:12px; box-shadow:var(--shadow); display:flex; gap:12px; align-items:center;}
    .stat{font-weight:700; font-size:18px}
    .muted{color:var(--muted)}
    main{margin-top:12px}
    section{margin-bottom:28px;}
    .section-head{display:flex; align-items:center; justify-content:space-between; margin-bottom:12px;}
    .section-head h3{margin:0; font-size:18px}
    .controls{display:flex; gap:10px; align-items:center;}
    .select, .btn{padding:8px 12px; border-radius:10px; border:1px solid rgba(15,23,42,0.06); background:var(--card); cursor:pointer}
    .grid{
      display:grid; gap:14px;
      grid-template-columns: repeat(4, 1fr);
    }
    .product{
      background:var(--card); border-radius:14px; padding:12px; box-shadow:var(--shadow); display:flex; flex-direction:column; gap:10px;
    }
    .product-visual{height:160px; border-radius:10px; background:linear-gradient(135deg,#f3f7fb,#fff); display:flex; align-items:center; justify-content:center; color:var(--muted); font-weight:700; font-size:20px}
    .product .title{font-weight:700; font-size:15px}
    .price-row{display:flex; align-items:center; gap:10px; justify-content:space-between}
    .price{font-weight:800; color:#081a1a}
    .old{color:var(--muted); text-decoration:line-through; font-size:13px}
    .rating{color:#f59e0b; font-weight:700; font-size:13px; display:flex; gap:6px; align-items:center}
    .card-actions{display:flex; gap:8px; align-items:center}
    .add-btn{flex:1; padding:10px; border-radius:10px; background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:white; border:0; cursor:pointer; font-weight:700}
    .view-btn{padding:9px 12px; background:transparent; border:1px solid rgba(15,23,42,0.06); border-radius:10px; cursor:pointer}
    .deals-slider{display:flex; gap:12px; overflow:auto; padding-bottom:6px}
    .deal-card{min-width:240px; background:linear-gradient(180deg,#0ea5a4 0%, #0f766e 100%); color:white; padding:14px; border-radius:12px; box-shadow:0 12px 30px rgba(15,118,110,0.14)}
    .deal-card h4{margin:0 0 6px 0}
    .deal-card .deal-price{font-weight:800; font-size:20px}
    .timer{font-weight:700; margin-top:8px; background:rgba(255,255,255,0.12); padding:6px 8px; border-radius:8px; display:inline-block}
    .blog-list{display:grid; gap:12px; grid-template-columns:repeat(3,1fr)}
    .post{background:var(--card); border-radius:12px; padding:12px; box-shadow:var(--shadow); display:flex; gap:12px; flex-direction:column}
    .post-thumb{height:140px; border-radius:8px; background:linear-gradient(135deg,#e0ecff,#eaf7ff); display:flex; align-items:center; justify-content:center; font-weight:700; color:#0f1724}
    .footer{margin-top:30px; padding:18px; border-radius:12px; background:linear-gradient(180deg,#fff,#fbfdff); display:flex; gap:18px; align-items:center; justify-content:space-between; box-shadow:var(--shadow)}
    /* small screens */
    @media (max-width:980px){
      .grid{grid-template-columns:repeat(3,1fr)}
      .hero{grid-template-columns:1fr; }
      .promo-visual{display:none}
      .searchbar{flex-direction:column; align-items:stretch}
      .blog-list{grid-template-columns:repeat(2,1fr)}
    }
    @media (max-width:640px){
      .grid{grid-template-columns:repeat(2,1fr)}
      nav{display:none}
      .brand{gap:8px}
      header{align-items:flex-start; gap:10px}
      .container{padding:12px}
      .blog-list{grid-template-columns:1fr}
      .deals-slider{padding-left:2px}
    }
    /* tiny utility */
    .sr-only{position:absolute; left:-10000px; top:auto; width:1px; height:1px; overflow:hidden}
  </style>
</head>
<body>
  <div class="container" id="app">
    <header>
      <a class="brand" href="#" aria-label="ShopSmart home">
        <div class="logo">SS</div>
        <div>
          <div style="font-weight:800">ShopSmart</div>
          <div style="font-size:12px; color:var(--muted)">Smart picks, better prices</div>
        </div>
      </a>

      <nav aria-label="Primary">
        <a href="#">Home</a>
        <a href="#">Categories</a>
        <a href="#">Deals</a>
        <a href="#">Blog</a>
        <a href="#">Support</a>
      </nav>

      <div class="actions" aria-hidden="false">
        <button class="icon-btn" id="wishlistBtn" title="Wishlist">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 21s-7-4.35-9-7.5C-0.12 7.36 7.5 3 12 8c4.5-5 12.12-0.64 9 5.5C19 16.65 12 21 12 21z" fill="rgba(15,23,42,0.12)"/></svg>
        </button>
        <button class="icon-btn" id="cartBtn" aria-haspopup="dialog" aria-controls="cart" title="Open cart">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M3 3h2l.4 2M7 13h10l4-8H5.4" stroke="rgba(15,23,42,0.6)" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/></svg>
          <span id="cartCount" style="background:var(--accent); color:#fff; padding:4px 8px; border-radius:999px; font-weight:700; font-size:13px; display:inline-block; min-width:28px; text-align:center">0</span>
        </button>
      </div>
    </header>

    <div class="searchbar" role="search" aria-label="Product search">
      <div class="search-input" style="flex:1">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21l-4.35-4.35" stroke="rgba(15,23,42,0.5)" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/><circle cx="11" cy="11" r="6" stroke="rgba(15,23,42,0.5)" stroke-width="1.6"/></svg>
        <input type="search" id="search" placeholder="Search for products, brands, or categories..." aria-label="Search products">
        <select id="categoryFilter" aria-label="Filter by category" style="border:0;background:transparent; font-weight:700; color:var(--muted)">
          <option value="">All categories</option>
          <option value="Electronics">Electronics</option>
          <option value="Home">Home</option>
          <option value="Fashion">Fashion</option>
          <option value="Fitness">Fitness</option>
          <option value="Beauty">Beauty</option>
        </select>
      </div>
      <div style="display:flex; gap:8px;">
        <button class="btn" id="clearFilters">Clear</button>
        <button class="btn" id="searchBtn">Search</button>
      </div>
    </div>

    <div class="hero" role="region" aria-label="Featured promotions">
      <div class="promo">
        <div style="flex:1">
          <h2>Spring Refresh — Up to 40% off selected categories</h2>
          <p>New season picks across home, fashion, and electronics. Curated by our team for quality and value.</p>
          <a class="cta" href="#deals">Shop deals</a>
        </div>
        <div class="promo-visual" aria-hidden="true">Top Picks</div>
      </div>

      <div class="side-cards">
        <div class="card-small" role="article" aria-label="Free shipping">
          <div style="width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,#fff8e6,#fff1d0);display:flex;align-items:center;justify-content:center;color:#874d00;font-weight:800">F</div>
          <div>
            <div class="stat">Free shipping</div>
            <div class="muted">On orders over $50</div>
          </div>
        </div>
        <div class="card-small" role="article" aria-label="30-day returns">
          <div style="width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,#eefcf6,#e6fff7);display:flex;align-items:center;justify-content:center;color:#065f46;font-weight:800">R</div>
          <div>
            <div class="stat">30-day returns</div>
            <div class="muted">Hassle-free returns</div>
          </div>
        </div>
      </div>
    </div>

    <main>
      <section aria-labelledby="popular-heading">
        <div class="section-head">
          <h3 id="popular-heading">Popular items</h3>
          <div class="controls">
            <label class="muted" for="sort">Sort</label>
            <select id="sort" class="select" aria-label="Sort products">
              <option value="featured">Featured</option>
              <option value="price-asc">Price: low to high</option>
              <option value="price-desc">Price: high to low</option>
              <option value="rating">Top rated</option>
            </select>
            <button class="btn" id="viewAll">View all</button>
          </div>
        </div>

        <div id="products" class="grid" role="list" aria-live="polite"></div>
      </section>

      <section id="deals" aria-labelledby="deals-heading">
        <div class="section-head">
          <h3 id="deals-heading">Limited-time deals</h3>
          <div class="controls">
            <span class="muted">Hurry — while stocks last</span>
          </div>
        </div>

        <div class="deals-slider" id="dealsSlider" role="list"></div>
      </section>

      <section aria-labelledby="blog-heading">
        <div class="section-head">
          <h3 id="blog-heading">From our blog</h3>
          <div class="controls">
            <a class="muted" href="#">See all posts</a>
          </div>
        </div>

        <div id="blogList" class="blog-list" role="list"></div>
        <div style="margin-top:12px; text-align:center">
          <button class="btn" id="loadMore">Load more posts</button>
        </div>
      </section>
    </main>

    <div class="footer" role="contentinfo">
      <div>
        <div style="font-weight:800">Stay in the loop</div>
        <div class="muted" style="font-size:13px">Subscribe for special offers and product highlights</div>
      </div>
      <form id="newsletter" style="display:flex; gap:8px; align-items:center;">
        <input type="email" id="email" placeholder="Your email" aria-label="Email address" style="padding:10px 12px; border-radius:10px; border:1px solid rgba(15,23,42,0.06);">
        <button class="btn" type="submit">Subscribe</button>
      </form>
    </div>

    <!-- Cart Modal -->
    <dialog id="cart" aria-label="Shopping cart" style="border-radius:12px; padding:0; border:0; width:min(720px,96vw)">
      <div style="padding:14px; border-bottom:1px solid rgba(15,23,42,0.04); display:flex; justify-content:space-between; align-items:center;">
        <strong>Cart</strong>
        <button id="closeCart" class="icon-btn" aria-label="Close cart">Close</button>
      </div>
      <div id="cartContent" style="padding:14px; max-height:60vh; overflow:auto"></div>
      <div style="padding:14px; border-top:1px solid rgba(15,23,42,0.04); display:flex; justify-content:space-between; align-items:center;">
        <div>
          <div class="muted">Total</div>
          <div id="cartTotal" style="font-weight:800; font-size:18px">$0.00</div>
        </div>
        <div>
          <button class="btn" id="clearCartBtn">Clear</button>
          <button class="add-btn" id="checkoutBtn">Checkout</button>
        </div>
      </div>
    </dialog>
  </div>

  <script>
    // Sample data
    const productsData = [
      {id:1,name:"Wireless Noise-Cancel Headphones",category:"Electronics",price:129.99,old:199.99,rating:4.7},
      {id:2,name:"Ceramic Coffee Maker",category:"Home",price:49.95,old:79.95,rating:4.4},
      {id:3,name:"Men's Lightweight Jacket",category:"Fashion",price:69.00,old:0,rating:4.5},
      {id:4,name:"Smart Fitness Band",category:"Fitness",price:39.99,old:59.99,rating:4.2},
      {id:5,name:"Organic Skin Care Set",category:"Beauty",price:29.99,old:49.00,rating:4.8},
      {id:6,name:"4K Action Camera",category:"Electronics",price:99.00,old:149.00,rating:4.3},
      {id:7,name:"Memory Foam Pillow",category:"Home",price:24.99,old:39.99,rating:4.6},
      {id:8,name:"Wireless Charger Stand",category:"Electronics",price:19.99,old:29.99,rating:4.1}
    ];

    const dealsData = [
      {id:'d1',name:"Robot Vacuum — Refurbished",price:149.99,save:"30%",endsInHours:36},
      {id:'d2',name:"Smartwatch Series 5",price:89.99,save:"45%",endsInHours:8},
      {id:'d3',name:"Air Purifier",price:79.99,save:"25%",endsInHours:72},
      {id:'d4',name:"Noise-Isolating Earbuds",price:24.99,save:"60%",endsInHours:4},
      {id:'d5',name:"Stainless Cookware Set",price:129.00,save:"35%",endsInHours:48}
    ];

    const blogData = [
      {id:'b1',title:"How to pick the perfect headphones",excerpt:"From drivers to comfort — a short guide to find the right headphones for your needs.",date:"Feb 20, 2026"},
      {id:'b2',title:"Refresh your home on a budget",excerpt:"Small changes that make a big difference — organizing, lighting, and textile swaps.",date:"Mar 02, 2026"},
      {id:'b3',title:"Top 7 fitness trackers for beginners",excerpt:"Affordable, accurate, and easy-to-use devices to keep you motivated.",date:"Mar 15, 2026"},
      {id:'b4',title:"Sustainable beauty routines",excerpt:"Minimal ingredient lists and eco-friendly packaging — what to look for.",date:"Apr 01, 2026"},
      {id:'b5',title:"Packing tech for travel",excerpt:"Keep your devices charged and protected with this simple checklist.",date:"Apr 10, 2026"},
      {id:'b6',title:"Quick recipes for busy weeknights",excerpt:"Nutritious meals that come together in 30 minutes or less.",date:"Apr 18, 2026"}
    ];

    // Utilities
    const $ = (s, el=document) => el.querySelector(s);
    const $$ = (s, el=document) => Array.from(el.querySelectorAll(s));

    // Render products
    const productsEl = $('#products');
    const searchInput = $('#search');
    const categoryFilter = $('#categoryFilter');
    const sortSelect = $('#sort');
    const cartCountEl = $('#cartCount');

    let cart = JSON.parse(localStorage.getItem('ss_cart')||'[]');

    function saveCart(){ localStorage.setItem('ss_cart', JSON.stringify(cart)) }

    function updateCartCount(){
      const total = cart.reduce((s,i)=>s+i.qty,0);
      cartCountEl.textContent = total;
    }

    function formatMoney(n){ return '$' + n.toFixed(2) }

    function renderProducts(list){
      productsEl.innerHTML = '';
      if(!list.length){
        productsEl.innerHTML = '<div style="grid-column:1/-1; padding:18px; border-radius:10px; background:linear-gradient(90deg,#fff,#fbfbff); text-align:center">No products found.</div>';
        return;
      }
      list.forEach(p=>{
        const card = document.createElement('div');
        card.className = 'product';
        card.setAttribute('role','listitem');
        card.innerHTML = `
          <div class="product-visual" aria-hidden="true">${escapeInitials(p.name)}</div>
          <div style="display:flex; justify-content:space-between; gap:12px; align-items:start">
            <div style="flex:1">
              <div class="title">${p.name}</div>
              <div class="muted" style="font-size:13px">${p.category}</div>
            </div>
            <div style="text-align:right">
              <div class="rating">★ ${p.rating}</div>
            </div>
          </div>
          <div class="price-row">
            <div>
              <div class="price">${formatMoney(p.price)}</div>
              ${p.old ? `<div class="old">${formatMoney(p.old)}</div>` : ''}
            </div>
            <div class="card-actions">
              <button class="view-btn" data-id="${p.id}" aria-label="View ${p.name}">View</button>
              <button class="add-btn" data-id="${p.id}" aria-label="Add ${p.name} to cart">Add</button>
            </div>
          </div>
        `;
        productsEl.appendChild(card);
      });
    }

    function escapeInitials(name){
      const words = name.split(' ').filter(Boolean);
      const initials = (words[0] ? words[0][0] : '') + (words[1] ? words[1][0] : '');
      return initials.toUpperCase();
    }

    function filterAndSort(){
      const q = searchInput.value.trim().toLowerCase();
      const cat = categoryFilter.value;
      let list = productsData.filter(p=>{
        const matchQ = !q || p.name.toLowerCase().includes(q) || p.category.toLowerCase().includes(q);
        const matchCat = !cat || p.category === cat;
        return matchQ && matchCat;
      });

      const sort = sortSelect.value;
      if(sort === 'price-asc') list.sort((a,b)=>a.price-b.price);
      else if(sort === 'price-desc') list.sort((a,b)=>b.price-a.price);
      else if(sort === 'rating') list.sort((a,b)=>b.rating-a.rating);
      // else featured default ordering
      renderProducts(list);
    }

    // Event Delegation for product actions
    productsEl.addEventListener('click', (e)=>{
      const viewBtn = e.target.closest('.view-btn');
      const addBtn = e.target.closest('.add-btn');
      if(viewBtn){
        const id = Number(viewBtn.dataset.id);
        const p = productsData.find(x=>x.id===id);
        openProductDialog(p);
      } else if(addBtn){
        const id = Number(addBtn.dataset.id);
        addToCart(id);
      }
    });

    function addToCart(id){
      const p = productsData.find(x=>x.id===id);
      if(!p) return;
      const existing = cart.find(i=>i.id===id);
      if(existing) existing.qty++;
      else cart.push({id:p.id,name:p.name,price:p.price,qty:1});
      saveCart();
      updateCartCount();
      flashMessage(`${p.name} added to cart`);
    }

    function flashMessage(text){
      const el = document.createElement('div');
      el.textContent = text;
      el.style.position = 'fixed';
      el.style.right = '18px';
      el.style.bottom = '18px';
      el.style.background = 'rgba(15,23,42,0.9)';
      el.style.color = 'white';
      el.style.padding = '10px 14px';
      el.style.borderRadius = '10px';
      el.style.boxShadow = '0 8px 30px rgba(2,6,23,0.2)';
      document.body.appendChild(el);
      setTimeout(()=>el.style.opacity='0',1700);
      setTimeout(()=>el.remove(),2200);
    }

    // Product dialog
    function openProductDialog(p){
      const dlg = document.createElement('dialog');
      dlg.style.borderRadius='12px';
      dlg.style.padding='0';
      dlg.innerHTML = `
        <div style="padding:18px; border-bottom:1px solid rgba(15,23,42,0.04); display:flex; gap:12px; align-items:center;">
          <div style="width:110px; height:110px; border-radius:12px; background:linear-gradient(135deg,#f3f7fb,#fff); display:flex; align-items:center; justify-content:center; font-weight:800">${escapeInitials(p.name)}</div>
          <div style="flex:1">
            <div style="font-weight:800; font-size:18px">${p.name}</div>
            <div class="muted">${p.category}</div>
            <div style="margin-top:8px; font-size:18px; font-weight:800">${formatMoney(p.price)}</div>
          </div>
          <button class="icon-btn" id="closeProd">Close</button>
        </div>
        <div style="padding:18px;">
          <p class="muted">Short product description: High-quality, carefully selected items to suit everyday needs. Read reviews and compare features.</p>
          <div style="display:flex; gap:8px; margin-top:12px;">
            <button class="add-btn" id="dlgAdd">Add to cart</button>
            <button class="btn" id="dlgFav">Add to wishlist</button>
          </div>
        </div>
      `;
      document.body.appendChild(dlg);
      dlg.showModal();
      dlg.querySelector('#closeProd').addEventListener('click',()=>dlg.close());
      dlg.querySelector('#dlgAdd').addEventListener('click',()=>{
        addToCart(p.id);
        dlg.close();
      });
      dlg.addEventListener('close', ()=>dlg.remove());
    }

    // Deals slider & timers
    const dealsEl = $('#dealsSlider');

    function renderDeals(){
      dealsEl.innerHTML = '';
      dealsData.forEach(d=>{
        const endsAt = Date.now() + d.endsInHours*3600*1000;
        const card = document.createElement('div');
        card.className = 'deal-card';
        card.setAttribute('role','listitem');
        card.innerHTML = `
          <h4>${d.name}</h4>
          <div style="display:flex; align-items:center; justify-content:space-between; gap:12px">
            <div>
              <div class="deal-price">${formatMoney(d.price)}</div>
              <div class="muted" style="font-size:13px">Save ${d.save}</div>
            </div>
            <div style="text-align:right">
              <div class="muted" style="font-size:13px">Ends in</div>
              <div class="timer" data-ends="${endsAt}" id="timer-${d.id}">--:--:--</div>
            </div>
          </div>
          <div style="margin-top:10px; display:flex; gap:8px">
            <button class="add-btn" data-dealid="${d.id}">Grab deal</button>
            <button class="view-btn" data-dealid="${d.id}">Details</button>
          </div>
        `;
        dealsEl.appendChild(card);
      });
    }

    function startDealTimers(){
      function tick(){
        const timers = $$('[data-ends]');
        timers.forEach(t=>{
          const ends = Number(t.dataset.ends);
          const diff = Math.max(0, ends - Date.now());
          const hrs = Math.floor(diff/3600000);
          const mins = Math.floor(diff%3600000/60000);
          const secs = Math.floor(diff%60000/1000);
          t.textContent = `${String(hrs).padStart(2,'0')}:${String(mins).padStart(2,'0')}:${String(secs).padStart(2,'0')}`;
        });
      }
      tick();
      setInterval(tick,1000);
    }

    // Deals actions
    dealsEl.addEventListener('click', (e)=>{
      const grab = e.target.closest('[data-dealid]');
      if(!grab) return;
      const id = grab.dataset.dealid;
      const deal = dealsData.find(d=>d.id===id);
      // simulate adding first matching product or create cart item
      cart.push({id:`deal_${id}`,name:deal.name,price:deal.price,qty:1});
      saveCart();
      updateCartCount();
      flashMessage(`${deal.name} added to cart`);
    });

    // Blog list
    const blogListEl = $('#blogList');
    let blogShown = 3;
    function renderBlog(){
      blogListEl.innerHTML = '';
      blogData.slice(0,blogShown).forEach(p=>{
        const div = document.createElement('article');
        div.className = 'post';
        div.innerHTML = `
          <div class="post-thumb">${escapeInitials(p.title)}</div>
          <div style="flex:1">
            <div style="font-weight:800">${p.title}</div>
            <div class="muted" style="font-size:13px">${p.date}</div>
            <p class="muted" style="margin-top:8px">${p.excerpt}</p>
          </div>
          <div style="display:flex; gap:8px;">
            <button class="btn">Read</button>
            <button class="icon-btn">Share</button>
          </div>
        `;
        blogListEl.appendChild(div);
      });
      $('#loadMore').style.display = blogShown < blogData.length ? 'inline-block' : 'none';
    }

    $('#loadMore').addEventListener('click', ()=>{
      blogShown = Math.min(blogData.length, blogShown + 3);
      renderBlog();
    });

    // Cart modal
    const cartDialog = $('#cart');
    const cartContent = $('#cartContent');
    const cartTotalEl = $('#cartTotal');

    function openCart(){
      renderCart();
      cartDialog.showModal();
    }

    function renderCart(){
      cartContent.innerHTML = '';
      if(!cart.length){
        cartContent.innerHTML = '<div style="padding:18px; text-align:center; color:var(--muted)">Your cart is empty.</div>';
        cartTotalEl.textContent = '$0.00';
        return;
      }
      cart.forEach(item=>{
        const row = document.createElement('div');
        row.style.display='flex';
        row.style.justifyContent='space-between';
        row.style.alignItems='center';
        row.style.marginBottom='10px';
        row.innerHTML = `
          <div style="display:flex; gap:10px; align-items:center">
            <div style="width:58px;height:58px;border-radius:8px;background:linear-gradient(135deg,#fff,#f6f6fb);display:flex;align-items:center;justify-content:center;font-weight:800">${typeof item.id==='number'?escapeInitials(item.name):'DL'}</div>
            <div>
              <div style="font-weight:700">${item.name}</div>
              <div class="muted" style="font-size:13px">${item.qty} × ${formatMoney(item.price)}</div>
            </div>
          </div>
          <div style="display:flex; gap:8px; align-items:center">
            <div style="font-weight:800">${formatMoney(item.price * item.qty)}</div>
            <button class="icon-btn" data-remove="${item.id}">Remove</button>
          </div>
        `;
        cartContent.appendChild(row);
      });
      const total = cart.reduce((s,i)=>s + i.price * i.qty,0);
      cartTotalEl.textContent = formatMoney(total);
    }

    cartContent.addEventListener('click', (e)=>{
      const btn = e.target.closest('[data-remove]');
      if(!btn) return;
      const key = btn.dataset.remove;
      const idx = cart.findIndex(i=>String(i.id) === String(key));
      if(idx>-1){
        cart.splice(idx,1);
        saveCart();
        renderCart();
        updateCartCount();
      }
    });

    $('#clearCartBtn').addEventListener('click', ()=>{
      cart = [];
      saveCart();
      renderCart();
      updateCartCount();
    });

    $('#cartBtn').addEventListener('click', openCart);
    $('#closeCart').addEventListener('click', ()=>cartDialog.close());
    $('#checkoutBtn').addEventListener('click', ()=>{
      cart = [];
      saveCart();
      renderCart();
      updateCartCount();
      cartDialog.close();
      flashMessage('Order placed — thank you!');
    });

    // Filters and search
    $('#searchBtn').addEventListener('click', filterAndSort);
    $('#clearFilters').addEventListener('click', ()=>{ searchInput.value=''; categoryFilter.value=''; sortSelect.value='featured'; filterAndSort(); });
    [searchInput, categoryFilter, sortSelect].forEach(el=>el.addEventListener('change', filterAndSort));
    searchInput.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') filterAndSort(); });

    // Newsletter submit
    $('#newsletter').addEventListener('submit', (e)=>{
      e.preventDefault();
      const email = $('#email').value.trim();
      if(!email) { flashMessage('Please enter an email'); return; }
      $('#email').value = '';
      flashMessage('Thanks for subscribing!');
    });

    // View all button jump
    $('#viewAll').addEventListener('click', ()=>{ window.scrollTo({top:document.body.scrollHeight, behavior:'smooth'}); });

    // Save state and initial render
    updateCartCount();
    renderProducts(productsData.slice(0,8));
    renderDeals();
    startDealTimers();
    renderBlog();

    // Simple autosave of shown items and sort to URL hash (optional)
    window.addEventListener('hashchange', ()=>{ /* placeholder for deep-linking */ });

    // tiny accessibility: close modal on Escape
    document.addEventListener('keydown', (e)=>{
      if(e.key === 'Escape'){
        if(document.querySelector('dialog[open]')) document.querySelectorAll('dialog[open]').forEach(d=>d.close());
      }
    });

    // quick sort/search on load if any
    filterAndSort();
  </script>
</body>
</html>