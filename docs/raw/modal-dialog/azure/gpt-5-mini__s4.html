<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Accessible Modal Example</title>
  <style>
    :root{
      --overlay: rgba(0,0,0,.5);
      --bg: #fff;
      --radius: 8px;
      --maxw: 640px;
      --accent: #0b7cff;
      --z: 1000;
    }
    body{font-family: system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; margin:0; line-height:1.4;}
    main{padding:2rem; max-width:900px; margin:0 auto;}
    .trigger{background:var(--accent); color:#fff; border:0; padding:.6rem .9rem; border-radius:6px; cursor:pointer; font-weight:600}
    .note{margin-top:1rem; color:#555;}

    /* Modal base */
    .modal{
      position:fixed;
      inset:0;
      display:none; /* closed by default */
      align-items:center;
      justify-content:center;
      background:var(--overlay);
      z-index:var(--z);
      padding:1.5rem;
      box-sizing:border-box;
    }
    .modal[aria-hidden="false"]{
      display:flex;
    }

    /* Dialog panel */
    .modal__panel{
      background:var(--bg);
      width:100%;
      max-width:var(--maxw);
      border-radius:var(--radius);
      box-shadow:0 10px 30px rgba(0,0,0,.2);
      overflow:hidden;
      transform:translateY(8px) scale(.995);
      opacity:0;
      transition:transform .18s ease, opacity .18s ease;
    }
    .modal[aria-hidden="false"] .modal__panel{
      transform:translateY(0) scale(1);
      opacity:1;
    }

    .modal__header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:1rem 1.25rem;
      border-bottom:1px solid #eee;
      background:linear-gradient(180deg,#fafafa,#fff);
    }
    .modal__title{margin:0; font-size:1.05rem;}
    .modal__close{
      background:transparent;
      border:0;
      font-size:1rem;
      padding:.35rem;
      cursor:pointer;
      color:#333;
      border-radius:6px;
    }
    .modal__close:focus{outline:2px solid rgba(11,124,255,.25);}

    .modal__body{padding:1rem 1.25rem 1.5rem; color:#222;}
    .modal__footer{
      display:flex;
      gap:.5rem;
      justify-content:flex-end;
      padding: .75rem 1.25rem;
      border-top:1px solid #eee;
      background:#fafafa;
    }
    .btn{padding:.5rem .8rem; border-radius:6px; border:1px solid #ccc; background:#fff; cursor:pointer;}
    .btn.primary{background:var(--accent); color:#fff; border-color:transparent;}

    /* Prevent background scroll when modal open */
    .no-scroll{overflow:hidden; touch-action:none;}

    /* Small utilities */
    .sr-only{
      position:absolute;
      width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0 0 0 0);white-space:nowrap;border:0;
    }
  </style>
</head>
<body>
  <main id="page">
    <h1>Modal Dialog Component Example</h1>
    <p>
      This example shows a modal that is closed by default. Click the button below to open it.
    </p>

    <button class="trigger" id="open-modal">Open modal</button>

    <p class="note">The open button has the class "trigger". Modal supports ESC to close, clicking the overlay to close, and focus trapping.</p>

    <section aria-label="Example content">
      <h2>Page content</h2>
      <p>Some page content behind the modal. When the modal opens, keyboard focus is moved into it and returned to the trigger when it closes.</p>
      <a href="#">Example link</a>
    </section>
  </main>

  <!-- Modal component (closed by default) -->
  <div class="modal" id="modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="modal-title" tabindex="-1">
    <div class="modal__panel" role="document">
      <div class="modal__header">
        <h2 id="modal-title" class="modal__title">Sample Modal</h2>
        <button class="modal__close" id="modal-close" aria-label="Close modal">&times;</button>
      </div>

      <div class="modal__body">
        <p>This is an accessible modal dialog example. Try tabbing through the controls â€” focus will be trapped inside. Press ESC to close or click outside the dialog.</p>

        <form>
          <label for="name">Name</label><br/>
          <input id="name" name="name" type="text" style="margin-top:.25rem;padding:.4rem;width:100%;box-sizing:border-box" />

          <p style="margin-top:.75rem">Some choices:</p>
          <label><input type="radio" name="choice" value="a" checked> Option A</label><br/>
          <label><input type="radio" name="choice" value="b"> Option B</label>
        </form>
      </div>

      <div class="modal__footer">
        <button class="btn" id="cancel">Cancel</button>
        <button class="btn primary" id="confirm">Confirm</button>
      </div>
    </div>
  </div>

  <script>
    (function(){
      const modal = document.getElementById('modal');
      const modalPanel = modal.querySelector('.modal__panel');
      const closeButtons = modal.querySelectorAll('#modal-close, #cancel');
      const confirm = document.getElementById('confirm');
      const triggers = Array.from(document.querySelectorAll('.trigger'));
      const page = document.getElementById('page');

      let lastFocused = null;

      // Utility: focusable selector
      const FOCUSABLE = 'a[href], area[href], input:not([disabled]):not([type="hidden"]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, [tabindex]:not([tabindex="-1"])';

      function openModal(triggerEl){
        if (modal.getAttribute('aria-hidden') === 'false') return;
        lastFocused = triggerEl || document.activeElement;
        modal.setAttribute('aria-hidden','false');
        document.documentElement.classList.add('no-scroll'); // prevent background scroll
        // hide rest of page for screen readers
        page.setAttribute('aria-hidden','true');

        // Wait a tick so focusable elements are reachable
        window.setTimeout(() => {
          const focusable = getFocusable();
          if (focusable.length) {
            focusable[0].focus();
          } else {
            modal.focus();
          }
        }, 10);

        document.addEventListener('keydown', onKeyDown, true);
      }

      function closeModal(returnFocus = true){
        if (modal.getAttribute('aria-hidden') === 'true') return;
        modal.setAttribute('aria-hidden','true');
        document.documentElement.classList.remove('no-scroll');
        page.removeAttribute('aria-hidden');
        document.removeEventListener('keydown', onKeyDown, true);
        if (returnFocus && lastFocused && typeof lastFocused.focus === 'function') {
          lastFocused.focus();
        }
      }

      function getFocusable(){
        return Array.from(modal.querySelectorAll(FOCUSABLE)).filter(el => el.offsetWidth > 0 || el.offsetHeight > 0 || el === document.activeElement);
      }

      function onKeyDown(e){
        if (e.key === 'Escape' || e.key === 'Esc') {
          e.preventDefault();
          closeModal(true);
          return;
        }

        if (e.key === 'Tab') {
          // Focus trapping
          const focusable = getFocusable();
          if (focusable.length === 0) {
            e.preventDefault();
            return;
          }
          const first = focusable[0];
          const last = focusable[focusable.length -1];
          if (e.shiftKey) {
            if (document.activeElement === first || document.activeElement === modal) {
              e.preventDefault();
              last.focus();
            }
          } else {
            if (document.activeElement === last) {
              e.preventDefault();
              first.focus();
            }
          }
        }
      }

      // Openers
      triggers.forEach(btn => {
        btn.addEventListener('click', (ev) => {
          ev.preventDefault();
          openModal(btn);
        });
      });

      // Close via buttons
      closeButtons.forEach(btn => btn.addEventListener('click', (ev) => {
        ev.preventDefault();
        closeModal(true);
      }));

      // Confirm button example
      confirm.addEventListener('click', (ev) => {
        ev.preventDefault();
        // perform some action...
        alert('Confirmed!');
        closeModal(true);
      });

      // Click on overlay closes (but not clicks inside the dialog panel)
      modal.addEventListener('click', (ev) => {
        if (ev.target === modal) {
          closeModal(true);
        }
      });

      // Ensure focus stays within modal when clicked inside panel (helpful for some screen readers)
      modalPanel.addEventListener('mousedown', () => {
        const focusable = getFocusable();
        if (focusable.length) focusable[0].focus();
      });

      // Ensure modal is initially hidden and inert to assistive tech
      modal.setAttribute('aria-hidden','true');

      // Optional: open modal with hash for demo (not required)
      // if(location.hash === '#open') openModal(document.querySelector('.trigger'));

    })();
  </script>
</body>
</html>