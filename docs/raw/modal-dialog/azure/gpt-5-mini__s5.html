<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Modal Dialog Example</title>
  <style>
    :root{
      --overlay-bg: rgba(0,0,0,0.5);
      --panel-bg: #fff;
      --radius: 8px;
      --max-width: 600px;
      --transition: 180ms cubic-bezier(.2,.9,.3,1);
      --shadow: 0 10px 30px rgba(0,0,0,0.15);
      --accent: #0366d6;
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      margin:0;
      line-height:1.4;
      padding:48px;
      background: linear-gradient(180deg,#f7fbff,#fff);
      color:#0b1220;
    }

    .container{
      max-width:900px;
      margin:0 auto;
      display:flex;
      gap:16px;
      align-items:center;
      justify-content:flex-start;
      flex-wrap:wrap;
    }

    .trigger{
      appearance:none;
      border:0;
      padding:10px 16px;
      background:var(--accent);
      color:white;
      border-radius:6px;
      font-weight:600;
      cursor:pointer;
      box-shadow: 0 6px 18px rgba(3,102,214,0.18);
    }

    .trigger:focus{
      outline:3px solid rgba(3,102,214,0.18);
      outline-offset:2px;
    }

    /* Modal wrapper - closed by default with aria-hidden="true" */
    .modal{
      position:fixed;
      inset:0;
      display:grid;
      place-items:center;
      z-index:1200;
      /* visible state handled by [aria-hidden] */
    }

    .modal[aria-hidden="true"]{
      display:none;
    }

    /* overlay/backdrop */
    .modal__backdrop{
      position:absolute;
      inset:0;
      background:var(--overlay-bg);
      backdrop-filter: blur(2px);
      opacity:0;
      transition:opacity var(--transition);
    }
    .modal[aria-hidden="false"] .modal__backdrop{
      opacity:1;
    }

    /* panel */
    .modal__panel{
      position:relative;
      z-index:1;
      width:min(92%, var(--max-width));
      background:var(--panel-bg);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      transform:translateY(8px) scale(.98);
      opacity:0;
      transition: transform var(--transition), opacity var(--transition);
      max-height:85vh;
      overflow:auto;
    }
    .modal[aria-hidden="false"] .modal__panel{
      transform:translateY(0) scale(1);
      opacity:1;
    }

    .modal__header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:16px 18px;
      border-bottom:1px solid #f0f2f6;
    }

    .modal__title{
      margin:0;
      font-size:18px;
      font-weight:700;
    }

    .modal__close{
      background:transparent;
      border:0;
      padding:6px;
      border-radius:6px;
      cursor:pointer;
      color:#374151;
    }
    .modal__close:focus{
      outline:3px solid rgba(55,65,81,0.12);
      outline-offset:2px;
    }

    .modal__body{
      padding:16px 18px;
      color:#263238;
    }

    .modal__footer{
      display:flex;
      gap:8px;
      padding:14px 18px;
      justify-content:flex-end;
      border-top:1px solid #f0f2f6;
    }

    .btn{
      padding:8px 12px;
      border-radius:6px;
      border:0;
      cursor:pointer;
    }
    .btn.ghost{
      background:#f3f5f9;
      color:#0b1220;
    }
    .btn.primary{
      background:var(--accent);
      color:white;
    }

    /* small helper to show focus ring inside modal */
    .focusable:focus { outline:3px solid rgba(3,102,214,0.18); outline-offset:2px; }
  </style>
</head>
<body>
  <main class="container" id="main">
    <h1 style="width:100%; margin:0 0 8px 0; font-size:20px;">Modal dialog example</h1>
    <p style="margin:0 0 16px 0; color:#4b5563; width:100%;">Click the button to open the modal. The button that opens it has the class "trigger".</p>

    <button class="trigger" id="openModalBtn">Open modal</button>
  </main>

  <!-- Modal (closed by default) -->
  <div class="modal" id="exampleModal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-hidden="true">
    <div class="modal__backdrop" data-backdrop></div>

    <div class="modal__panel" role="document" tabindex="-1">
      <header class="modal__header">
        <h2 id="modalTitle" class="modal__title">Example Modal Dialog</h2>
        <button class="modal__close focusable" aria-label="Close dialog" data-close>&times;</button>
      </header>

      <div class="modal__body">
        <p>This is a simple accessible modal dialog example. It is closed by default. It supports:</p>
        <ul>
          <li>Opening via a button with the class "trigger".</li>
          <li>Closing with the close button, pressing Escape, or clicking outside (the overlay).</li>
          <li>Focus is trapped inside the dialog while open and restored to the opener when closed.</li>
        </ul>
        <form>
          <label style="display:block; margin-top:8px;">
            Name
            <input class="focusable" type="text" name="name" placeholder="Your name" style="display:block; margin-top:6px; padding:8px; width:100%; box-sizing:border-box;">
          </label>
          <label style="display:block; margin-top:8px;">
            Email
            <input class="focusable" type="email" name="email" placeholder="you@example.com" style="display:block; margin-top:6px; padding:8px; width:100%; box-sizing:border-box;">
          </label>
        </form>
      </div>

      <footer class="modal__footer">
        <button class="btn ghost focusable" data-close>Cancel</button>
        <button class="btn primary focusable">Save</button>
      </footer>
    </div>
  </div>

  <script>
    (function(){
      const modal = document.getElementById('exampleModal');
      const panel = modal.querySelector('.modal__panel');
      const triggers = document.querySelectorAll('.trigger');
      const closeButtons = modal.querySelectorAll('[data-close]');
      const backdrop = modal.querySelector('[data-backdrop]');
      let lastFocused = null;

      // Utility: collect focusable elements within modal
      function getFocusableElements(root){
        const selectors = [
          'a[href]:not([tabindex^="-"]):not([inert])',
          'area[href]',
          'input:not([disabled]):not([type="hidden"])',
          'select:not([disabled])',
          'textarea:not([disabled])',
          'button:not([disabled])',
          'iframe',
          'object',
          'embed',
          '[contenteditable]',
          '[tabindex]:not([tabindex^="-"])'
        ];
        return Array.from(root.querySelectorAll(selectors.join(','))).filter(el => el.offsetParent !== null || el === document.activeElement);
      }

      function openModal(trigger){
        lastFocused = trigger || document.activeElement;
        modal.setAttribute('aria-hidden','false');
        // prevent background scroll
        document.documentElement.style.overflow = 'hidden';
        document.body.style.overflow = 'hidden';

        // Move focus into the panel; prefer first focusable element
        const focusable = getFocusableElements(panel);
        (focusable[0] || panel).focus();

        // attach event listeners
        document.addEventListener('keydown', onKeyDown, true);
      }

      function closeModal(){
        modal.setAttribute('aria-hidden','true');
        document.documentElement.style.overflow = '';
        document.body.style.overflow = '';
        // restore focus
        try { if (lastFocused && typeof lastFocused.focus === 'function') lastFocused.focus(); } catch(e){}
        document.removeEventListener('keydown', onKeyDown, true);
      }

      function onKeyDown(e){
        if (e.key === 'Escape'){
          e.preventDefault();
          closeModal();
          return;
        }
        if (e.key === 'Tab'){
          // trap focus within modal
          const focusable = getFocusableElements(modal);
          if (focusable.length === 0){
            e.preventDefault();
            return;
          }
          const first = focusable[0];
          const last = focusable[focusable.length - 1];
          if (e.shiftKey){
            if (document.activeElement === first || modal === document.activeElement){
              e.preventDefault();
              last.focus();
            }
          } else {
            if (document.activeElement === last){
              e.preventDefault();
              first.focus();
            }
          }
        }
      }

      // Open triggers
      triggers.forEach(btn => {
        btn.addEventListener('click', (e) => {
          openModal(btn);
        });
      });

      // Close controls
      closeButtons.forEach(btn => {
        btn.addEventListener('click', () => closeModal());
      });

      // Click outside to close (click on backdrop)
      modal.addEventListener('click', (e) => {
        if (e.target === modal || e.target === backdrop){
          closeModal();
        }
      });

      // Prevent focus from escaping when clicking inside panel (helpful for screen readers)
      panel.addEventListener('keydown', (e) => {
        if (e.key === 'Tab') {
          onKeyDown(e);
        }
      });

      // Ensure modal is hidden by default on load
      document.addEventListener('DOMContentLoaded', () => {
        modal.setAttribute('aria-hidden','true');
      });
    })();
  </script>
</body>
</html>