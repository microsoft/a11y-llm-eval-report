<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Modal Dialog Component Example</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      color-scheme: light dark;
      --surface: #ffffff;
      --on-surface: #1a1a1a;
      --muted: #666;
      --overlay: rgba(0, 0, 0, 0.6);
      --primary: #2d6cdf;
      --primary-contrast: #fff;
      --border: #ddd;
      --radius: 12px;
      --shadow: 0 10px 25px rgba(0,0,0,0.15);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.5;
      color: var(--on-surface);
      background: #f6f8fb;
    }

    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 2rem 1rem 4rem;
    }

    h1 { margin: 0 0 0.5rem; font-size: 2rem; }
    p { margin: 0 0 1rem; color: var(--muted); }

    .demo-actions {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
      margin: 1rem 0 2rem;
    }

    button {
      appearance: none;
      border: 1px solid var(--border);
      background: var(--surface);
      color: var(--on-surface);
      padding: 0.6rem 1rem;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: transform 0.08s ease, box-shadow 0.2s ease, background 0.2s ease, border-color 0.2s ease;
    }
    button:hover { box-shadow: 0 6px 16px rgba(0,0,0,0.12); }
    button:active { transform: translateY(1px); }
    .primary {
      background: var(--primary);
      color: var(--primary-contrast);
      border-color: transparent;
    }
    .secondary {
      background: var(--surface);
      color: var(--on-surface);
    }

    /* Modal */
    .modal[hidden] { display: none; }
    .modal {
      position: fixed;
      inset: 0;
      z-index: 1000;
      display: grid;
      align-items: center;
      justify-items: center;
    }
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: var(--overlay);
    }
    .modal-content {
      position: relative;
      z-index: 1;
      background: var(--surface);
      color: var(--on-surface);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      width: min(92vw, 640px);
      max-height: 82vh;
      overflow: auto;
      display: grid;
      grid-template-rows: auto 1fr auto;
    }

    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.5rem;
      padding: 1rem 1rem 0.75rem;
      border-bottom: 1px solid var(--border);
    }
    .modal-header h2 {
      margin: 0;
      font-size: 1.25rem;
    }
    .close-btn {
      border: none;
      background: transparent;
      font-size: 1.5rem;
      line-height: 1;
      width: 2.25rem;
      height: 2.25rem;
      border-radius: 8px;
    }
    .close-btn:hover { background: rgba(0,0,0,0.06); }

    .modal-body {
      padding: 1rem;
      display: grid;
      gap: 0.75rem;
    }

    .modal-footer {
      display: flex;
      justify-content: flex-end;
      gap: 0.5rem;
      padding: 0.75rem 1rem 1rem;
      border-top: 1px solid var(--border);
      background: linear-gradient(to top, rgba(0,0,0,0.02), transparent);
    }

    .field {
      display: grid;
      gap: 0.35rem;
    }
    .field label {
      font-size: 0.9rem;
      color: var(--muted);
    }
    .field input, .field select {
      padding: 0.6rem 0.7rem;
      border: 1px solid var(--border);
      border-radius: 8px;
      font-size: 1rem;
      background: var(--surface);
      color: var(--on-surface);
    }
    .field input:focus, .field select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px color-mix(in oklab, var(--primary) 40%, transparent);
    }

    .no-scroll { overflow: hidden; }

    @media (prefers-reduced-motion: no-preference) {
      .modal-content {
        transform: translateY(10px);
        opacity: 0;
        animation: modalIn 200ms ease-out forwards;
      }
      @keyframes modalIn {
        to { transform: translateY(0); opacity: 1; }
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Modal Dialog Component</h1>
    <p>Click the button below to open the modal. The dialog is closed by default and uses a button with the "trigger" class to open.</p>
    <div class="demo-actions">
      <button class="trigger primary" type="button">Open Modal</button>
      <button class="trigger secondary" type="button">Open Modal (Alt Trigger)</button>
    </div>

    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse commodo, tellus quis luctus aliquet, nisi nulla fermentum mauris, vel gravida mauris ipsum eu neque. Vivamus non aliquet augue. Integer in dui maximus, volutpat sem id, ullamcorper tortor.</p>
    <p>Curabitur at interdum justo. Sed lacinia feugiat nunc, non convallis justo ultrices vitae. Phasellus dui urna, convallis sed lobortis at, tempor a sem. Donec vel fermentum nibh. Cras fringilla a eros non tristique.</p>
  </div>

  <div id="modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title" hidden>
    <div class="modal-overlay" data-close aria-hidden="true"></div>
    <div class="modal-content" role="document">
      <header class="modal-header">
        <h2 id="modal-title">Example Modal</h2>
        <button class="close-btn" type="button" aria-label="Close dialog" title="Close" data-close>&times;</button>
      </header>
      <div class="modal-body">
        <p>This is a modal dialog. It traps focus while open, closes on overlay click or Escape, and returns focus to the trigger when closed.</p>
        <div class="field">
          <label for="name">Your name</label>
          <input id="name" name="name" type="text" placeholder="Jane Doe">
        </div>
        <div class="field">
          <label for="plan">Choose a plan</label>
          <select id="plan" name="plan">
            <option value="">Select oneâ€¦</option>
            <option>Starter</option>
            <option>Pro</option>
            <option>Enterprise</option>
          </select>
        </div>
        <a href="#" onclick="return false">A focusable link inside the dialog</a>
      </div>
      <footer class="modal-footer">
        <button class="secondary" type="button" data-close>Cancel</button>
        <button class="primary" type="button">Confirm</button>
      </footer>
    </div>
  </div>

  <script>
    (function() {
      const modal = document.getElementById('modal');
      const modalContent = modal.querySelector('.modal-content');
      const triggers = document.querySelectorAll('.trigger');
      const overlay = modal.querySelector('.modal-overlay');
      const closers = modal.querySelectorAll('[data-close]');
      let lastFocused = null;

      const focusableSelector = [
        'a[href]',
        'area[href]',
        'input:not([disabled]):not([type="hidden"])',
        'select:not([disabled])',
        'textarea:not([disabled])',
        'button:not([disabled])',
        'details',
        'summary',
        'iframe',
        '[tabindex]:not([tabindex="-1"])',
        '[contenteditable="true"]'
      ].join(',');

      function getFocusable() {
        return Array.from(modalContent.querySelectorAll(focusableSelector))
          .filter(el => !el.closest('[hidden]') && (el.offsetParent !== null || el === document.activeElement));
      }

      function openModal() {
        if (!modal.hidden) return;
        lastFocused = document.activeElement;
        modal.hidden = false;
        document.body.classList.add('no-scroll');

        // Ensure the container can receive focus if needed
        if (!modalContent.hasAttribute('tabindex')) {
          modalContent.setAttribute('tabindex', '-1');
        }

        const focusables = getFocusable();
        const toFocus = focusables[0] || modalContent;
        toFocus.focus();

        document.addEventListener('keydown', onKeyDown);
      }

      function closeModal() {
        if (modal.hidden) return;
        modal.hidden = true;
        document.body.classList.remove('no-scroll');
        document.removeEventListener('keydown', onKeyDown);

        if (lastFocused && typeof lastFocused.focus === 'function') {
          lastFocused.focus();
        }
      }

      function onKeyDown(e) {
        if (e.key === 'Escape') {
          e.preventDefault();
          closeModal();
          return;
        }
        if (e.key === 'Tab') {
          const focusables = getFocusable();
          if (focusables.length === 0) {
            e.preventDefault();
            modalContent.focus();
            return;
          }
          const first = focusables[0];
          const last = focusables[focusables.length - 1];
          const active = document.activeElement;

          if (e.shiftKey) {
            if (active === first || active === modalContent) {
              e.preventDefault();
              last.focus();
            }
          } else {
            if (active === last) {
              e.preventDefault();
              first.focus();
            }
          }
        }
      }

      triggers.forEach(btn => btn.addEventListener('click', openModal));
      closers.forEach(btn => btn.addEventListener('click', closeModal));
      overlay.addEventListener('click', closeModal);

      // Optional: close when pressing Alt+F4 or browser attempts? Not needed here.
    }());
  </script>
</body>
</html>