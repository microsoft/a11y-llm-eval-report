<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Modal Dialog Example</title>
  <style>
    :root {
      color-scheme: light dark;
      --bg: #ffffff;
      --fg: #111111;
      --muted: #666;
      --overlay: rgba(0, 0, 0, 0.55);
      --border: rgba(0, 0, 0, 0.15);
      --shadow: 0 20px 50px rgba(0, 0, 0, 0.25);
      --radius: 12px;
      --focus: #2b6cff;
      --btn: #111;
      --btnfg: #fff;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #141414;
        --fg: #f2f2f2;
        --muted: #b6b6b6;
        --overlay: rgba(0, 0, 0, 0.7);
        --border: rgba(255, 255, 255, 0.14);
        --shadow: 0 20px 50px rgba(0, 0, 0, 0.6);
        --btn: #f2f2f2;
        --btnfg: #111;
      }
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--fg);
      min-height: 100svh;
      display: grid;
      place-items: center;
      padding: 24px;
    }

    .card {
      max-width: 720px;
      width: 100%;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
    }

    .card h1 {
      margin: 0 0 8px;
      font-size: 20px;
      line-height: 1.2;
    }

    .card p {
      margin: 0 0 16px;
      color: var(--muted);
    }

    button {
      font: inherit;
      border-radius: 10px;
      border: 1px solid var(--border);
      padding: 10px 14px;
      cursor: pointer;
      background: transparent;
      color: var(--fg);
    }

    button.primary {
      background: var(--btn);
      color: var(--btnfg);
      border-color: transparent;
    }

    button:focus-visible {
      outline: 3px solid color-mix(in srgb, var(--focus), transparent 40%);
      outline-offset: 2px;
    }

    /* Modal */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: var(--overlay);
      display: none; /* closed by default */
      align-items: center;
      justify-content: center;
      padding: 18px;
      z-index: 1000;
    }

    .modal-overlay[aria-hidden="false"] {
      display: flex;
    }

    .modal {
      width: min(560px, 100%);
      background: var(--bg);
      color: var(--fg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: clip;
    }

    .modal-header,
    .modal-footer {
      padding: 14px 16px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .modal-header {
      border-bottom: 1px solid var(--border);
      justify-content: space-between;
    }

    .modal-title {
      margin: 0;
      font-size: 16px;
      font-weight: 650;
    }

    .modal-body {
      padding: 16px;
      color: var(--muted);
      line-height: 1.45;
    }

    .modal-footer {
      border-top: 1px solid var(--border);
      justify-content: flex-end;
    }

    .close-btn {
      padding: 8px 10px;
      line-height: 1;
    }
  </style>
</head>
<body>
  <main class="card">
    <h1>Modal Dialog Example</h1>
    <p>The modal is closed by default. Click the trigger button to open it.</p>
    <button class="trigger primary" type="button" aria-haspopup="dialog" aria-controls="example-modal-overlay">
      Open modal
    </button>
  </main>

  <div
    id="example-modal-overlay"
    class="modal-overlay"
    aria-hidden="true"
  >
    <section
      class="modal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="example-modal-title"
      tabindex="-1"
    >
      <header class="modal-header">
        <h2 class="modal-title" id="example-modal-title">Example Modal</h2>
        <button class="close-btn" type="button" data-modal-close aria-label="Close dialog">
          âœ•
        </button>
      </header>

      <div class="modal-body">
        <p>
          This is a basic modal dialog. It closes when you click the close button,
          press <kbd>Esc</kbd>, or click outside the dialog.
        </p>
      </div>

      <footer class="modal-footer">
        <button type="button" data-modal-close>Cancel</button>
        <button type="button" class="primary" data-modal-close>OK</button>
      </footer>
    </section>
  </div>

  <script>
    (function () {
      const trigger = document.querySelector(".trigger");
      const overlay = document.getElementById("example-modal-overlay");
      const dialog = overlay.querySelector('[role="dialog"]');
      const closeButtons = overlay.querySelectorAll("[data-modal-close]");

      let lastFocused = null;

      function getFocusable(container) {
        return Array.from(
          container.querySelectorAll(
            'a[href], button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])'
          )
        ).filter(el => !el.hasAttribute("disabled") && !el.getAttribute("aria-hidden"));
      }

      function openModal() {
        lastFocused = document.activeElement;
        overlay.setAttribute("aria-hidden", "false");
        document.documentElement.style.overflow = "hidden";

        const focusables = getFocusable(dialog);
        (focusables[0] || dialog).focus();
      }

      function closeModal() {
        overlay.setAttribute("aria-hidden", "true");
        document.documentElement.style.overflow = "";
        if (lastFocused && typeof lastFocused.focus === "function") {
          lastFocused.focus();
        }
      }

      trigger.addEventListener("click", openModal);

      closeButtons.forEach(btn => btn.addEventListener("click", closeModal));

      overlay.addEventListener("click", (e) => {
        if (e.target === overlay) closeModal();
      });

      document.addEventListener("keydown", (e) => {
        if (overlay.getAttribute("aria-hidden") === "true") return;

        if (e.key === "Escape") {
          e.preventDefault();
          closeModal();
          return;
        }

        if (e.key === "Tab") {
          const focusables = getFocusable(dialog);
          if (focusables.length === 0) {
            e.preventDefault();
            dialog.focus();
            return;
          }

          const first = focusables[0];
          const last = focusables[focusables.length - 1];

          if (e.shiftKey && document.activeElement === first) {
            e.preventDefault();
            last.focus();
          } else if (!e.shiftKey && document.activeElement === last) {
            e.preventDefault();
            first.focus();
          }
        }
      });
    })();
  </script>
</body>
</html>