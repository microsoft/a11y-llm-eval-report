<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Modal Dialog Example</title>
  <style>
    :root {
      color-scheme: light dark;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    body {
      margin: 0;
      min-height: 100vh;
      display: grid;
      place-items: center;
      background: radial-gradient(circle at top, #eef1ff, #d5dbf8, #c3c9f0);
    }
    button {
      cursor: pointer;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 999px;
      font-size: 1rem;
      background: linear-gradient(135deg, #4d61ff, #506bff, #5b79ff);
      color: white;
      box-shadow: 0 10px 25px rgba(77, 97, 255, 0.3);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 30px rgba(77, 97, 255, 0.25);
    }
    button:focus-visible {
      outline: 3px solid rgba(77, 97, 255, 0.8);
      outline-offset: 3px;
    }
    dialog {
      border: none;
      border-radius: 20px;
      padding: 2.5rem;
      max-width: 420px;
      width: 90vw;
      box-shadow: 0 30px 60px rgba(25, 33, 81, 0.35);
      background: #ffffff;
      color: #1f2546;
      position: relative;
    }
    dialog::backdrop {
      background: rgba(16, 24, 63, 0.55);
      backdrop-filter: blur(3px);
    }
    dialog h2 {
      margin: 0 0 0.75rem;
      font-size: 1.75rem;
      letter-spacing: -0.02em;
    }
    dialog p {
      margin: 0 0 1.5rem;
      line-height: 1.6;
      color: #46507b;
    }
    .close {
      position: absolute;
      top: 14px;
      right: 14px;
      background: none;
      color: #5f6ea4;
      padding: 0.35rem;
      border-radius: 999px;
      box-shadow: none;
    }
    .close:hover {
      color: #384176;
      transform: none;
      box-shadow: none;
      background: rgba(95, 110, 164, 0.12);
    }
    .dialog-actions {
      display: flex;
      gap: 0.75rem;
      justify-content: flex-end;
      margin-top: 1.5rem;
    }
    .dialog-actions button {
      border-radius: 12px;
      padding: 0.65rem 1.25rem;
      box-shadow: none;
      background: #4d61ff;
    }
    .dialog-actions button.secondary {
      background: rgba(77, 97, 255, 0.12);
      color: #39427c;
    }
    .dialog-actions button.secondary:hover {
      background: rgba(77, 97, 255, 0.2);
    }
  </style>
</head>
<body>
  <button class="trigger" aria-haspopup="dialog" aria-controls="modal-example">Open modal dialog</button>

  <dialog id="modal-example" aria-modal="true" aria-labelledby="modal-title">
    <button class="close" type="button" title="Close dialog" aria-label="Close dialog">&times;</button>
    <h2 id="modal-title">Join the Aurora beta</h2>
    <p>
      Experience a new way to stay organized. Aurora keeps your ideas, tasks, and goals aligned across every device.
    </p>
    <div class="dialog-actions">
      <button type="button" class="secondary">Maybe later</button>
      <button type="button">Request invite</button>
    </div>
  </dialog>

  <script>
    const modal = document.getElementById('modal-example');
    const triggerButton = document.querySelector('.trigger');
    const closeButton = modal.querySelector('.close');
    const focusableSelectors = 'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';
    let lastFocusedElement = null;

    function openModal() {
      if (typeof modal.showModal === 'function') {
        lastFocusedElement = document.activeElement;
        modal.showModal();
        trapFocus();
      } else {
        alert('Your browser does not support the <dialog> element.');
      }
    }

    function closeModal() {
      modal.close();
      releaseFocus();
      if (lastFocusedElement) {
        lastFocusedElement.focus();
      }
    }

    function trapFocus() {
      const focusableItems = Array.from(modal.querySelectorAll(focusableSelectors)).filter(el => !el.hasAttribute('disabled'));
      if (!focusableItems.length) return;

      const firstElement = focusableItems[0];
      const lastElement = focusableItems[focusableItems.length - 1];

      function handleKeydown(event) {
        if (event.key === 'Tab') {
          if (event.shiftKey && document.activeElement === firstElement) {
            event.preventDefault();
            lastElement.focus();
          } else if (!event.shiftKey && document.activeElement === lastElement) {
            event.preventDefault();
            firstElement.focus();
          }
        } else if (event.key === 'Escape') {
          closeModal();
        }
      }

      modal.addEventListener('keydown', handleKeydown);
      modal.addEventListener('close', () => modal.removeEventListener('keydown', handleKeydown), { once: true });

      window.requestAnimationFrame(() => {
        firstElement.focus();
      });
    }

    function releaseFocus() {
      // placeholder for future cleanup if needed
    }

    triggerButton.addEventListener('click', openModal);
    closeButton.addEventListener('click', closeModal);
    modal.addEventListener('click', (event) => {
      const rect = modal.getBoundingClientRect();
      const clickedInDialog = (
        rect.top <= event.clientY && event.clientY <= rect.bottom &&
        rect.left <= event.clientX && event.clientX <= rect.right
      );
      if (!clickedInDialog) {
        closeModal();
      }
    });
  </script>
</body>
</html>