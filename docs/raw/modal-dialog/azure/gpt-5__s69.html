<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Modal Dialog Example</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
      line-height: 1.5;
      color: #1f2937;
      background: #f9fafb;
    }
    .container {
      padding: 2rem;
      max-width: 800px;
      margin: 0 auto;
    }
    .trigger {
      appearance: none;
      border: none;
      background: #2563eb;
      color: white;
      padding: 0.75rem 1rem;
      border-radius: 0.5rem;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.12);
    }
    .trigger:hover { background: #1d4ed8; }
    .trigger:focus-visible {
      outline: 3px solid #93c5fd;
      outline-offset: 2px;
    }

    /* Modal */
    .modal[hidden] { display: none; }
    .modal {
      position: fixed;
      inset: 0;
      display: grid;
      place-items: center;
      background: rgba(17, 24, 39, 0.6);
      z-index: 1000;
      padding: 1rem;
    }
    .modal__dialog {
      position: relative;
      width: min(650px, 100%);
      background: white;
      border-radius: 0.75rem;
      box-shadow: 0 20px 40px rgba(0,0,0,0.25);
      overflow: hidden;
    }
    .modal__header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem 1rem 0.75rem;
      border-bottom: 1px solid #e5e7eb;
    }
    .modal__title {
      margin: 0;
      font-size: 1.25rem;
      font-weight: 700;
    }
    .modal__close {
      appearance: none;
      border: none;
      background: transparent;
      line-height: 0;
      border-radius: 0.375rem;
      color: #6b7280;
      cursor: pointer;
      padding: 0.375rem;
    }
    .modal__close:hover { background: #f3f4f6; color: #111827; }
    .modal__close:focus-visible {
      outline: 3px solid #93c5fd;
      outline-offset: 2px;
    }
    .modal__body {
      padding: 1rem;
    }
    .modal__footer {
      display: flex;
      gap: 0.5rem;
      justify-content: flex-end;
      padding: 0.75rem 1rem 1rem;
      border-top: 1px solid #e5e7eb;
    }
    .btn {
      appearance: none;
      border: 1px solid transparent;
      border-radius: 0.5rem;
      padding: 0.6rem 0.9rem;
      font-weight: 600;
      cursor: pointer;
    }
    .btn--secondary {
      background: white;
      border-color: #e5e7eb;
      color: #111827;
    }
    .btn--secondary:hover { background: #f9fafb; }
    .btn--primary {
      background: #2563eb;
      color: white;
      border-color: #1d4ed8;
    }
    .btn--primary:hover { background: #1d4ed8; }
    .btn:focus-visible {
      outline: 3px solid #93c5fd;
      outline-offset: 2px;
    }

    /* Form example */
    .field {
      margin-bottom: 0.75rem;
    }
    .label {
      display: block;
      font-size: 0.9rem;
      color: #374151;
      margin-bottom: 0.25rem;
    }
    .input, .textarea, .select {
      width: 100%;
      padding: 0.6rem 0.7rem;
      border-radius: 0.5rem;
      border: 1px solid #d1d5db;
      outline: none;
      background: white;
      color: #111827;
    }
    .input:focus, .textarea:focus, .select:focus {
      border-color: #93c5fd;
      box-shadow: 0 0 0 3px rgba(147, 197, 253, 0.5);
    }
    .helper {
      font-size: 0.85rem;
      color: #6b7280;
      margin-top: 0.25rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Modal Dialog Component</h1>
    <p>This is an example modal dialog. It is closed by default. Click the button to open it.</p>
    <button class="trigger" type="button">Open Modal</button>
  </div>

  <div class="modal" id="modal" hidden>
    <div class="modal__dialog" role="dialog" aria-modal="true" aria-labelledby="modal-title" aria-describedby="modal-desc" tabindex="-1">
      <div class="modal__header">
        <h2 class="modal__title" id="modal-title">Example Modal</h2>
        <button class="modal__close" type="button" aria-label="Close dialog" data-close>
          <svg width="20" height="20" viewBox="0 0 20 20" aria-hidden="true" focusable="false">
            <path d="M5 5l10 10M15 5L5 15" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
      <div class="modal__body" id="modal-desc">
        <p>Use this modal to capture user input or display information. It traps focus while open and can be closed with the Escape key, by clicking outside, or using the buttons below.</p>

        <div class="field">
          <label class="label" for="name">Name</label>
          <input class="input" id="name" type="text" placeholder="Jane Doe" />
          <div class="helper">Enter your full name.</div>
        </div>

        <div class="field">
          <label class="label" for="email">Email</label>
          <input class="input" id="email" type="email" placeholder="jane@example.com" />
        </div>

        <div class="field">
          <label class="label" for="topic">Topic</label>
          <select class="select" id="topic">
            <option value="general">General question</option>
            <option value="support">Support request</option>
            <option value="feedback">Feedback</option>
          </select>
        </div>

        <div class="field">
          <label class="label" for="message">Message</label>
          <textarea class="textarea" id="message" rows="4" placeholder="Write your message..."></textarea>
        </div>
      </div>
      <div class="modal__footer">
        <button class="btn btn--secondary" type="button" data-close>Cancel</button>
        <button class="btn btn--primary" type="button">Submit</button>
      </div>
    </div>
  </div>

  <script>
    (function() {
      const modal = document.getElementById('modal');
      const dialog = modal.querySelector('.modal__dialog');
      const closeButtons = modal.querySelectorAll('[data-close]');
      const triggers = document.querySelectorAll('.trigger');

      let previouslyFocusedElement = null;

      function getFocusableElements() {
        const selectors = [
          'a[href]',
          'area[href]',
          'button:not([disabled])',
          'input:not([disabled]):not([type="hidden"])',
          'select:not([disabled])',
          'textarea:not([disabled])',
          '[tabindex]:not([tabindex="-1"])'
        ];
        return Array.from(dialog.querySelectorAll(selectors.join(',')))
          .filter(el => el.offsetParent !== null);
      }

      function openModal() {
        if (!modal.hidden) return;
        previouslyFocusedElement = document.activeElement;
        modal.hidden = false;
        document.body.style.overflow = 'hidden';

        // Focus first focusable element, or dialog
        const focusables = getFocusableElements();
        (focusables[0] || dialog).focus();
      }

      function closeModal() {
        if (modal.hidden) return;
        modal.hidden = true;
        document.body.style.overflow = '';
        if (previouslyFocusedElement && typeof previouslyFocusedElement.focus === 'function') {
          previouslyFocusedElement.focus();
        }
      }

      function handleKeydown(e) {
        if (modal.hidden) return;

        if (e.key === 'Escape') {
          e.stopPropagation();
          closeModal();
          return;
        }

        if (e.key === 'Tab') {
          const focusables = getFocusableElements();
          if (focusables.length === 0) {
            e.preventDefault();
            dialog.focus();
            return;
          }
          const first = focusables[0];
          const last = focusables[focusables.length - 1];
          const active = document.activeElement;

          if (e.shiftKey) {
            if (active === first || !dialog.contains(active)) {
              e.preventDefault();
              last.focus();
            }
          } else {
            if (active === last || !dialog.contains(active)) {
              e.preventDefault();
              first.focus();
            }
          }
        }
      }

      // Open on trigger click
      triggers.forEach(btn => btn.addEventListener('click', openModal));

      // Close buttons
      closeButtons.forEach(btn => btn.addEventListener('click', closeModal));

      // Close when clicking outside the dialog (on backdrop)
      modal.addEventListener('mousedown', (e) => {
        if (e.target === modal) {
          closeModal();
        }
      });

      // Global key handling when modal is open
      document.addEventListener('keydown', handleKeydown);

      // Prevent focus from leaving the dialog when using the mouse
      document.addEventListener('focusin', (e) => {
        if (modal.hidden) return;
        if (!dialog.contains(e.target)) {
          const focusables = getFocusableElements();
          (focusables[0] || dialog).focus();
        }
      });
    })();
  </script>
</body>
</html>