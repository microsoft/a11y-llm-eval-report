<html lang="en">
<head>
<meta charset="UTF-8">
<title>Modal Dialog Example</title>
<style>
  :root {
    color-scheme: light dark;
    font-family: system-ui, sans-serif;
  }
  body {
    margin: 0;
    min-height: 100vh;
    display: grid;
    place-items: center;
    background: linear-gradient(135deg, #f0f4ff, #ffe8f6);
  }
  button {
    cursor: pointer;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 999px;
    font-size: 1rem;
    font-weight: 600;
    background: #4c46e5;
    color: white;
    transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
  }
  button:hover {
    transform: translateY(-1px);
    box-shadow: 0 12px 24px rgba(76, 70, 229, 0.25);
    background: #3b37c1;
  }
  button:active {
    transform: translateY(1px);
    box-shadow: none;
  }
  .modal {
    position: fixed;
    inset: 0;
    display: grid;
    place-items: center;
    padding: 1.5rem;
    background: rgba(18, 26, 35, 0.55);
    backdrop-filter: blur(6px);
    transition: opacity 0.3s ease, visibility 0.3s ease;
  }
  .modal[aria-hidden="true"] {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
  }
  .modal-dialog {
    position: relative;
    width: min(420px, 100%);
    padding: 2rem;
    border-radius: 24px;
    box-shadow: 0 20px 45px rgba(17, 19, 43, 0.2);
    background: white;
    color: #232946;
    transform: translateY(20px);
    transition: transform 0.3s ease;
  }
  .modal[aria-hidden="true"] .modal-dialog {
    transform: translateY(40px);
  }
  .modal h2 {
    margin: 0 0 1rem;
    font-size: 1.5rem;
  }
  .modal p {
    margin: 0 0 1.5rem;
    line-height: 1.5;
    color: #4d5671;
  }
  .modal-actions {
    display: flex;
    justify-content: flex-end;
    gap: 0.75rem;
  }
  .modal button.secondary {
    background: #eef0ff;
    color: #3b37c1;
  }
  .modal button.secondary:hover {
    background: #d9dcff;
    color: #2926a0;
  }
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }
</style>
</head>
<body>
<button class="trigger" aria-haspopup="dialog" aria-controls="sample-modal">Show Modal</button>
<div class="modal" id="sample-modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="modal-title">
  <div class="modal-dialog" role="document">
    <h2 id="modal-title">Stay in the Loop</h2>
    <p>Subscribe to receive the latest product updates, tips, and curated resources delivered straight to your inbox.</p>
    <div class="modal-actions">
      <button class="secondary" type="button" data-close>Maybe Later</button>
      <button type="button">Subscribe</button>
    </div>
  </div>
</div>
<script>
  (function () {
    const openButton = document.querySelector('.trigger');
    const modal = document.getElementById(openButton.getAttribute('aria-controls'));
    const focusableSelectors = [
      'a[href]',
      'button:not([disabled])',
      'textarea:not([disabled])',
      'input:not([type="hidden"]):not([disabled])',
      'select:not([disabled])',
      '[tabindex]:not([tabindex="-1"])'
    ];
    let lastFocusedElement = null;

    function trapFocus(event) {
      if (modal.getAttribute('aria-hidden') === 'true') return;
      const focusableElements = modal.querySelectorAll(focusableSelectors);
      if (!focusableElements.length) return;
      const firstElement = focusableElements[0];
      const lastElement = focusableElements[focusableElements.length - 1];

      if (event.key === 'Tab') {
        if (event.shiftKey && document.activeElement === firstElement) {
          lastElement.focus();
          event.preventDefault();
        } else if (!event.shiftKey && document.activeElement === lastElement) {
          firstElement.focus();
          event.preventDefault();
        }
      }
    }

    function openModal() {
      lastFocusedElement = document.activeElement;
      modal.setAttribute('aria-hidden', 'false');
      const focusableElements = modal.querySelectorAll(focusableSelectors);
      if (focusableElements.length) {
        focusableElements[0].focus();
      }
      document.addEventListener('keydown', handleKeydown);
      document.addEventListener('focus', maintainFocus, true);
    }

    function closeModal() {
      modal.setAttribute('aria-hidden', 'true');
      document.removeEventListener('keydown', handleKeydown);
      document.removeEventListener('focus', maintainFocus, true);
      if (lastFocusedElement) {
        lastFocusedElement.focus();
      }
    }

    function handleKeydown(event) {
      if (event.key === 'Escape') {
        closeModal();
      } else if (event.key === 'Tab') {
        trapFocus(event);
      }
    }

    function maintainFocus(event) {
      if (modal.getAttribute('aria-hidden') === 'true') return;
      if (!modal.contains(event.target)) {
        event.stopPropagation();
        const focusableElements = modal.querySelectorAll(focusableSelectors);
        if (focusableElements.length) {
          focusableElements[0].focus();
        }
      }
    }

    openButton.addEventListener('click', openModal);
    modal.addEventListener('click', function (event) {
      if (event.target === modal) {
        closeModal();
      }
    });
    modal.querySelectorAll('[data-close]').forEach(function (closeEl) {
      closeEl.addEventListener('click', closeModal);
    });
  })();
</script>
</body>
</html>