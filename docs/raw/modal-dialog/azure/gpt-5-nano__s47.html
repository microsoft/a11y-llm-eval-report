<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Modal Dialog Example</title>
  <style>
    :root { --overlay: rgba(0,0,0,.6); }
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif; padding: 2rem; }

    /* Trigger button style */
    .trigger {
      padding: 0.75rem 1.25rem;
      font-size: 1rem;
      cursor: pointer;
      border-radius: 6px;
      border: 1px solid #ccc;
      background: #f3f3f3;
    }

    /* Modal base (hidden by default) */
    .modal {
      position: fixed;
      inset: 0;
      display: none; /* hidden by default */
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .modal.open {
      display: flex;
    }

    .modal__overlay {
      position: absolute;
      inset: 0;
      background: var(--overlay);
      z-index: 0;
    }

    .modal__content {
      position: relative;
      background: #fff;
      border-radius: 8px;
      width: min(90vw, 640px);
      max-width: 90vw;
      padding: 1.5rem;
      box-shadow: 0 20px 40px rgba(0,0,0,.25);
      z-index: 1;
    }

    .modal__close {
      position: absolute;
      top: 8px;
      right: 8px;
      border: none;
      background: transparent;
      font-size: 1.25rem;
      line-height: 1;
      cursor: pointer;
      padding: 0.25em 0.5em;
      border-radius: 4px;
    }

    .modal h2 { margin-top: 0; font-size: 1.25rem; }

    /* Focus ring for accessibility */
    :focus { outline: 2px solid #4a90e2; outline-offset: 2px; }

    @media (max-width: 480px) {
      .modal__content { width: calc(100vw - 2rem); padding: 1rem; }
    }
  </style>
</head>
<body>

  <!-- Trigger button (has class "trigger") -->
  <button class="trigger" data-modal="exampleModal" aria-controls="exampleModal">
    Open Modal
  </button>

  <!-- Modal structure -->
  <div id="exampleModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-hidden="true">
    <div class="modal__overlay" data-close="true"></div>

    <div class="modal__content" tabindex="-1" aria-describedby="modalDesc">
      <button class="modal__close" aria-label="Close modal" data-close="true">âœ•</button>
      <h2 id="modalTitle">Example Modal</h2>
      <p id="modalDesc">
        This is a simple accessible modal dialog. It is closed by default. Click the overlay, press Escape, or click the close button to close it.
      </p>
      <p>Tip: The trigger button has a class of "trigger" as requested.</p>
      <p><strong>Action:</strong> You can put any content here, like forms or messages.</p>
      <div style="margin-top: 1rem;">
        <button class="trigger" aria-hidden="true" style="pointer-events:none; background:#eee; border:1px solid #ccc; padding:.4rem .8rem; border-radius:6px;">
          Primary action
        </button>
        <button aria-hidden="true" style="margin-left:.5rem; background:#f6f6f6; border:1px solid #ccc; padding:.4rem .8rem; border-radius:6px;">
          Secondary
        </button>
      </div>
    </div>
  </div>

  <script>
    (function() {
      // Utility to find focusable elements inside a container
      function getFocusable(container) {
        const selectors = 'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, [tabindex]:not([tabindex="-1"]), [contenteditable]';
        return Array.from(container.querySelectorAll(selectors)).filter(el => {
          // Ignore elements that are not visible
          return el.offsetWidth > 0 || el.offsetHeight > 0;
        });
      }

      const triggers = document.querySelectorAll('.trigger');
      let activeModal = null;
      let lastFocused = null;
      let modalKeydownHandler = null;
      let modalCloseHandler = null;

      // Attach click handlers to all triggers
      triggers.forEach(trigger => {
        trigger.addEventListener('click', function() {
          const modalId = trigger.getAttribute('data-modal');
          openModal(modalId, trigger);
        });
      });

      function openModal(modalId, triggerEl) {
        const modal = document.getElementById(modalId);
        if (!modal) return;

        // Save last focused element to restore later
        lastFocused = document.activeElement;

        activeModal = modal;
        modal.classList.add('open');
        modal.setAttribute('aria-hidden', 'false');

        // Focus the first focusable element inside the modal
        const firstFocusable = modal.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
        if (firstFocusable) firstFocusable.focus();

        // Trap focus within the modal
        modalKeydownHandler = function(e) {
          if (e.key === 'Escape' || e.key === 'Esc') {
            e.preventDefault();
            closeModal(modalId, triggerEl);
            return;
          }
          if (e.key === 'Tab') {
            const focusables = getFocusable(modal);
            if (focusables.length === 0) {
              e.preventDefault();
              return;
            }
            const first = focusables[0];
            const last = focusables[focusables.length - 1];
            if (e.shiftKey) {
              if (document.activeElement === first) {
                e.preventDefault();
                last.focus();
              }
            } else {
              if (document.activeElement === last) {
                e.preventDefault();
                first.focus();
              }
            }
          }
        };
        modal.addEventListener('keydown', modalKeydownHandler);

        // Close on elements with data-close
        modalCloseHandler = function() {
          closeModal(modalId, triggerEl);
        };
        const closers = modal.querySelectorAll('[data-close]');
        closers.forEach(el => el.addEventListener('click', modalCloseHandler));
      }

      function closeModal(modalId, triggerEl) {
        const modal = document.getElementById(modalId);
        if (!modal) return;

        // Remove focus trap and close handlers
        if (modalKeydownHandler) {
          modal.removeEventListener('keydown', modalKeydownHandler);
          modalKeydownHandler = null;
        }
        if (modalCloseHandler) {
          const closers = modal.querySelectorAll('[data-close]');
          closers.forEach(el => el.removeEventListener('click', modalCloseHandler));
          modalCloseHandler = null;
        }

        modal.classList.remove('open');
        modal.setAttribute('aria-hidden', 'true');
        activeModal = null;

        // Restore focus to the triggering element or the previously focused element
        if (triggerEl && typeof triggerEl.focus === 'function') {
          triggerEl.focus();
        } else if (lastFocused && typeof lastFocused.focus === 'function') {
          lastFocused.focus();
        }
      }
    })();
  </script>

</body>
</html>