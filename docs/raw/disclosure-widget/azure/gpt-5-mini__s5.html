<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --bg:#f7f9fb;
      --card:#ffffff;
      --muted:#6b7280;
      --accent:#2563eb;
      --radius:10px;
      --shadow:0 6px 18px rgba(16,24,40,0.08);
      --duration:280ms;
    }

    html,body{
      height:100%;
      margin:0;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
      background:linear-gradient(180deg,var(--bg),#ffffff 40%);
      color:#0f172a;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .wrap{
      max-width:840px;
      margin:48px auto;
      padding:24px;
    }

    h1{
      font-size:20px;
      margin:0 0 18px 0;
    }

    p.lead{
      margin:0 0 24px 0;
      color:var(--muted);
      font-size:14px;
    }

    .example{
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:16px;
      margin:16px 0;
      border:1px solid rgba(15,23,42,0.04);
    }

    .example h3{
      margin:0 0 12px 0;
      font-size:14px;
    }

    /* Toggle button */
    .toggle{
      display:flex;
      align-items:center;
      gap:12px;
      width:100%;
      background:#fff;
      border:1px solid rgba(15,23,42,0.06);
      border-radius:8px;
      padding:12px 14px;
      font-size:15px;
      color:#071133;
      text-align:left;
      cursor:pointer;
      transition:box-shadow 160ms ease, transform 160ms ease, border-color 160ms ease;
    }
    .toggle:hover{ box-shadow:0 4px 12px rgba(2,6,23,0.06); transform:translateY(-1px); }
    .toggle:active{ transform:translateY(0); }
    .toggle:focus{ outline:3px solid rgba(37,99,235,0.12); outline-offset:2px; }

    .toggle .label{
      flex:1;
      display:flex;
      flex-direction:column;
    }
    .toggle .title{
      font-weight:600;
      font-size:15px;
      line-height:1;
    }
    .toggle .subtitle{
      font-size:13px;
      color:var(--muted);
      margin-top:4px;
    }

    /* chevron */
    .toggle .chev{
      width:18px;
      height:18px;
      display:inline-block;
      transition:transform var(--duration) cubic-bezier(.2,.9,.2,1);
      color:var(--muted);
      flex-shrink:0;
    }
    .toggle[aria-expanded="true"] .chev{ transform:rotate(180deg); color:var(--accent); }

    /* Controlled content */
    .details{
      overflow:hidden;
      transition: max-height var(--duration) cubic-bezier(.2,.9,.2,1), opacity var(--duration) ease;
      opacity:0;
      max-height:0;
      margin-top:12px;
      border-left:4px solid rgba(37,99,235,0.06);
      padding:12px 14px;
      background:linear-gradient(180deg, rgba(37,99,235,0.02), rgba(37,99,235,0.01));
      border-radius:8px;
    }
    .details.open{
      opacity:1;
    }

    /* small utility */
    .muted{ color:var(--muted); font-size:13px; }

    /* Respect prefers-reduced-motion */
    @media (prefers-reduced-motion:reduce){
      .details{ transition:none; }
      .toggle .chev{ transition:none; }
    }

    /* If JS is disabled we want details to be visible by default for graceful degradation.
       When JS is available a small script adds the 'js' class to <html>; the rule below hides details only in JS mode. */
    html.js .details{ max-height:0; opacity:0; }

    /* Content styles inside details */
    .details p{ margin:0 0 8px 0; color:#0f172a; font-size:14px; }
    .details ul{ margin:8px 0 0 18px; color:var(--muted); font-size:14px; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Expand / Collapse Widget Examples</h1>
    <p class="lead">Each widget below is wrapped with a div.example. The controlled content container uses the class "details". Try clicking or using keyboard to expand/collapse.</p>

    <!-- Example 1: Simple toggle -->
    <div class="example">
      <h3>Simple toggle</h3>
      <button class="toggle" aria-expanded="false" aria-controls="details-1" id="toggle-1" type="button">
        <div class="label">
          <span class="title">Show more information</span>
          <span class="subtitle">A concise summary â€” expand to reveal more.</span>
        </div>
        <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false">
          <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>

      <div class="details" id="details-1" role="region" aria-labelledby="toggle-1">
        <p>This is the expanded content for the simple toggle. It can contain text, links, or any other HTML.</p>
        <ul>
          <li>Point one about the item</li>
          <li>Secondary detail</li>
        </ul>
      </div>
    </div>

    <!-- Example 2: Animated content with longer text -->
    <div class="example">
      <h3>Animated details with longer text</h3>
      <button class="toggle" aria-expanded="false" aria-controls="details-2" id="toggle-2" type="button">
        <div class="label">
          <span class="title">Read the full explanation</span>
          <span class="subtitle">Opens an animated panel that handles dynamic height.</span>
        </div>
        <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false">
          <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>

      <div class="details" id="details-2" role="region" aria-labelledby="toggle-2">
        <p>Here is a longer block of content to demonstrate how the widget animates smoothly between open and closed states. The script measures the content height and animates the max-height property so the transition looks natural even when the content's size varies.</p>
        <p class="muted">Tip: The animation respects your system's "reduce motion" setting.</p>
      </div>
    </div>

    <!-- Example 3: Collapsible FAQ item with initially open state -->
    <div class="example">
      <h3>FAQ item (initially open)</h3>
      <button class="toggle" aria-expanded="true" aria-controls="details-3" id="toggle-3" type="button">
        <div class="label">
          <span class="title">How does this widget ensure accessibility?</span>
          <span class="subtitle">Uses ARIA attributes and a native button element.</span>
        </div>
        <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false">
          <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>

      <div class="details open" id="details-3" role="region" aria-labelledby="toggle-3">
        <p>The toggle uses a <code>button</code> with <code>aria-expanded</code> and <code>aria-controls</code>. The controlled container has role="region" and aria-labelledby pointing back to the button. This allows assistive technologies to announce the relationship and state.</p>
      </div>
    </div>

  </div>

  <script>
    (function () {
      // Indicate JS is available (used to hide details by default for progressive enhancement)
      document.documentElement.classList.add('js');

      // Utility: get all toggle buttons inside examples
      const toggles = Array.from(document.querySelectorAll('.example .toggle'));

      toggles.forEach(initToggle);

      function initToggle(button) {
        const id = button.getAttribute('aria-controls');
        if (!id) return;
        const details = document.getElementById(id);
        if (!details) return;

        // Initialize state based on markup; if not present, default to collapsed
        let expanded = button.getAttribute('aria-expanded') === 'true';
        // If details has class 'open' initially, prefer that
        if (details.classList.contains('open')) expanded = true;

        // Helper to set collapsed/expanded visuals
        function applyState(exp) {
          button.setAttribute('aria-expanded', exp ? 'true' : 'false');
          if (exp) {
            details.classList.add('open');
            details.setAttribute('aria-hidden', 'false');
            // Measure and animate open
            const prevMax = details.style.maxHeight;
            // set explicitly to current height if it was 'none' to enable transition
            if (prevMax === 'none' || !prevMax) {
              details.style.maxHeight = details.scrollHeight + 'px';
            }
            // After transition, clear max-height to allow dynamic growth
            const onEnd = function (e) {
              if (e.target !== details) return;
              details.style.maxHeight = 'none';
              details.removeEventListener('transitionend', onEnd);
            };
            details.addEventListener('transitionend', onEnd);
          } else {
            // Animate close: set max-height to current pixel height, then to 0
            details.style.maxHeight = details.scrollHeight + 'px';
            // Force reflow so the browser registers the starting height
            /* eslint-disable no-unused-expressions */
            details.offsetHeight;
            details.style.maxHeight = '0px';
            details.classList.remove('open');
            details.setAttribute('aria-hidden', 'true');
          }
        }

        // Ensure initial presentation is correct
        if (expanded) {
          // For initial open: set maxHeight to 'none' so it displays fully
          details.classList.add('open');
          details.style.maxHeight = 'none';
          details.setAttribute('aria-hidden', 'false');
          button.setAttribute('aria-expanded', 'true');
        } else {
          details.classList.remove('open');
          details.style.maxHeight = '0px';
          details.setAttribute('aria-hidden', 'true');
          button.setAttribute('aria-expanded', 'false');
        }

        // Click toggles state
        button.addEventListener('click', function () {
          const isExp = button.getAttribute('aria-expanded') === 'true';
          applyState(!isExp);
        });

        // If content changes height while open, keep it flexible
        // We listen for a small set of events that typically change content size.
        const resizeObserver = window.ResizeObserver ? new ResizeObserver(() => {
          if (button.getAttribute('aria-expanded') === 'true') {
            // when expanded and maxHeight is 'none', nothing to do.
            if (details.style.maxHeight === 'none') return;
            // otherwise adjust to new size briefly
            details.style.maxHeight = details.scrollHeight + 'px';
            // after transition, clear to allow growth
            const onEnd = function (e) {
              if (e.target !== details) return;
              details.style.maxHeight = 'none';
              details.removeEventListener('transitionend', onEnd);
            };
            details.addEventListener('transitionend', onEnd);
          }
        }) : null;

        if (resizeObserver) {
          resizeObserver.observe(details);
        } else {
          // Fallback: watch window resize
          window.addEventListener('resize', function () {
            if (button.getAttribute('aria-expanded') === 'true' && details.style.maxHeight !== 'none') {
              details.style.maxHeight = details.scrollHeight + 'px';
            }
          });
        }
      }
    })();
  </script>
</body>
</html>