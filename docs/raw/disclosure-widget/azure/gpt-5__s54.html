<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Expand/Collapse Widgets Demo</title>
<style>
 :root {
   --border: #d0d7de;
   --bg: #f6f8fa;
   --text: #24292f;
   --accent: #0969da;
 }
 html, body {
   margin: 0;
   padding: 0;
   color: var(--text);
   font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
   background: white;
 }
 .container {
   max-width: 900px;
   margin: 40px auto;
   padding: 0 16px 40px;
 }
 h1 {
   font-size: 1.8rem;
   margin: 0 0 16px 0;
 }
 .intro {
   margin-bottom: 24px;
   color: #4b5563;
 }
 .example {
   border: 1px solid var(--border);
   border-radius: 8px;
   padding: 16px;
   margin: 16px 0;
   background: var(--bg);
 }
 .example h2 {
   font-size: 1.1rem;
   margin: 0 0 12px 0;
 }
 .details {
   border: 1px solid var(--border);
   border-radius: 6px;
   background: #fff;
   color: var(--text);
   margin-top: 10px;
   padding: 12px 14px;
 }
 .details[hidden] {
   display: none;
 }
 details.details {
   padding: 0;
 }
 details.details > summary {
   cursor: pointer;
   list-style: none;
   padding: 10px 14px;
   font-weight: 600;
   color: var(--accent);
   outline: none;
 }
 details.details > summary::marker {
   content: "";
 }
 details.details > summary::before {
   content: "▸";
   display: inline-block;
   margin-right: 8px;
   transition: transform 0.2s ease;
 }
 details.details[open] > summary::before {
   transform: rotate(90deg);
 }
 details.details > .content {
   border-top: 1px solid var(--border);
   padding: 12px 14px;
 }
 .toggle {
   appearance: none;
   border: 1px solid var(--border);
   background: #fff;
   color: var(--accent);
   font-weight: 600;
   border-radius: 6px;
   padding: 8px 12px;
   cursor: pointer;
 }
 .toggle:focus-visible {
   outline: 2px solid var(--accent);
   outline-offset: 2px;
 }
 .toggle .caret {
   margin-right: 8px;
   display: inline-block;
   transition: transform 0.2s ease;
 }
 .toggle[aria-expanded="true"] .caret {
   transform: rotate(90deg);
 }
 .details p {
   margin: 0 0 10px 0;
   line-height: 1.5;
 }
 code {
   background: #f0f3f6;
   padding: 0 4px;
   border-radius: 4px;
 }
</style>
</head>
<body>
  <div class="container">
    <h1>Expand/Collapse Widgets</h1>
    <p class="intro">This page demonstrates both the native HTML details/summary and a custom button-controlled expand/collapse. Each widget is wrapped in a container with class "example", and the controlled content container has class "details".</p>

    <div class="example">
      <h2>Native details/summary</h2>
      <details class="details">
        <summary>What is an expand/collapse widget?</summary>
        <div class="content">
          <p>An expand/collapse widget reveals additional content on demand. The native <code>details</code> element provides built‑in keyboard and screen reader support via its <code>summary</code> control.</p>
          <p>Using the native element keeps markup minimal while providing accessible defaults. You can style the summary and the open state as needed.</p>
        </div>
      </details>
    </div>

    <div class="example">
      <h2>Custom button-controlled panel</h2>
      <button class="toggle" aria-controls="panel-1" aria-expanded="false" id="toggle-1" data-collapsed-label="Show details" data-expanded-label="Hide details">
        <span class="caret">▸</span>
        Show details
      </button>
      <div id="panel-1" class="details" role="region" aria-labelledby="toggle-1" tabindex="-1" hidden>
        <p>This custom widget uses a button to control visibility of a content panel.</p>
        <p>The button maintains the <code>aria-expanded</code> attribute and references the panel through <code>aria-controls</code> for assistive technologies.</p>
      </div>
    </div>

    <div class="example">
      <h2>Accordion with multiple sections</h2>
      <div>
        <button class="toggle" aria-controls="acc-a" aria-expanded="false" id="acc-btn-a" data-collapsed-label="Section A" data-expanded-label="Section A">
          <span class="caret">▸</span>
          Section A
        </button>
        <div id="acc-a" class="details" role="region" aria-labelledby="acc-btn-a" tabindex="-1" hidden>
          <p>Content for section A.</p>
        </div>
      </div>
      <div style="margin-top:8px">
        <button class="toggle" aria-controls="acc-b" aria-expanded="false" id="acc-btn-b" data-collapsed-label="Section B" data-expanded-label="Section B">
          <span class="caret">▸</span>
          Section B
        </button>
        <div id="acc-b" class="details" role="region" aria-labelledby="acc-btn-b" tabindex="-1" hidden>
          <p>Content for section B.</p>
        </div>
      </div>
      <div style="margin-top:8px">
        <button class="toggle" aria-controls="acc-c" aria-expanded="false" id="acc-btn-c" data-collapsed-label="Section C" data-expanded-label="Section C">
          <span class="caret">▸</span>
          Section C
        </button>
        <div id="acc-c" class="details" role="region" aria-labelledby="acc-btn-c" tabindex="-1" hidden>
          <p>Content for section C.</p>
        </div>
      </div>
    </div>
  </div>

<script>
(function() {
  function initToggleButton(btn) {
    var targetId = btn.getAttribute('aria-controls');
    if (!targetId) return;
    var panel = document.getElementById(targetId);
    if (!panel) return;

    var collapsedLabel = btn.getAttribute('data-collapsed-label') || 'Show';
    var expandedLabel = btn.getAttribute('data-expanded-label') || 'Hide';

    function updateButtonLabel(expanded) {
      var caretSpan = btn.querySelector('.caret');
      btn.textContent = '';
      if (caretSpan) {
        btn.appendChild(caretSpan);
      }
      btn.appendChild(document.createTextNode(expanded ? expandedLabel : collapsedLabel));
    }

    var expanded = btn.getAttribute('aria-expanded') === 'true';
    panel.hidden = !expanded;
    updateButtonLabel(expanded);

    btn.addEventListener('click', function() {
      var isExpanded = btn.getAttribute('aria-expanded') === 'true';
      btn.setAttribute('aria-expanded', String(!isExpanded));
      panel.hidden = isExpanded;
      updateButtonLabel(!isExpanded);
      if (!isExpanded) {
        panel.focus({ preventScroll: false });
      } else {
        btn.focus();
      }
    });
  }

  document.querySelectorAll('button[aria-controls]').forEach(initToggleButton);

  document.addEventListener('keydown', function(e) {
    if (e.key !== 'Escape') return;
    var active = document.activeElement;
    if (!active) return;
    var panel = active.closest('.details');
    if (!panel || panel.tagName.toLowerCase() === 'details') return;
    if (!panel.hidden) {
      var btnId = panel.getAttribute('aria-labelledby');
      var btn = btnId ? document.getElementById(btnId) : null;
      if (btn) {
        btn.setAttribute('aria-expanded', 'false');
        panel.hidden = true;
        var collapsed = btn.getAttribute('data-collapsed-label') || 'Show';
        var caretSpan = btn.querySelector('.caret');
        btn.textContent = '';
        if (caretSpan) btn.appendChild(caretSpan);
        btn.appendChild(document.createTextNode(collapsed));
        btn.focus();
      }
    }
  });
})();
</script>
</body>
</html>