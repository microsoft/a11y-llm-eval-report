<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root{
      --accent: #0b5fff;
      --bg: #f8fafc;
      --card: #ffffff;
      --muted: #6b7280;
      --radius: 10px;
      --shadow: 0 6px 18px rgba(15, 23, 42, 0.06);
      --transition: 220ms cubic-bezier(.2,.9,.3,1);
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg, #f7fbff 0%, var(--bg) 100%);
      color: #0f172a;
      margin: 32px;
      line-height: 1.4;
    }

    h1{
      margin: 0 0 18px 0;
      font-size: 20px;
    }

    .container{
      max-width: 820px;
      margin: 0 auto;
    }

    .example{
      background: var(--card);
      border-radius: var(--radius);
      padding: 14px;
      box-shadow: var(--shadow);
      margin: 14px 0;
      border: 1px solid rgba(15,23,42,0.04);
    }

    .summary-row{
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
    }

    .summary-left{
      display:flex;
      gap:12px;
      align-items:center;
    }

    .toggle-btn{
      appearance: none;
      -webkit-appearance: none;
      border: 1px solid rgba(15,23,42,0.06);
      background: linear-gradient(180deg,#ffffff,#fbfdff);
      padding: 10px 12px;
      border-radius: 10px;
      display:inline-flex;
      align-items:center;
      gap: 10px;
      cursor: pointer;
      font-size: 15px;
      color: #071233;
      box-shadow: 0 1px 0 rgba(255,255,255,0.6) inset;
      transition: box-shadow var(--transition), transform var(--transition);
    }

    .toggle-btn:focus{
      outline: none;
      box-shadow: 0 0 0 4px rgba(11,95,255,0.12);
      transform: translateY(-1px);
    }

    .toggle-btn .label{
      font-weight: 600;
    }

    .toggle-btn .meta{
      font-size: 13px;
      color: var(--muted);
      font-weight: 500;
    }

    .toggle-icon{
      display:inline-grid;
      place-items:center;
      width: 36px;
      height: 36px;
      border-radius: 8px;
      background: linear-gradient(180deg,#f1f5ff,#eef6ff);
      color: var(--accent);
      transition: transform var(--transition);
      flex-shrink: 0;
    }

    .toggle-icon svg{
      display:block;
      width: 16px;
      height: 16px;
    }

    /* rotate icon when expanded */
    .toggle-btn[aria-expanded="true"] .toggle-icon{
      transform: rotate(180deg);
    }

    .details{
      overflow: hidden;
      transition: max-height var(--transition), opacity var(--transition);
      margin-top: 12px;
      border-radius: calc(var(--radius) - 6px);
    }

    .details[hidden]{
      display: block; /* keep element in flow but visually collapsed via max-height and opacity */
      pointer-events: none;
    }

    .details .inner{
      padding: 12px;
      background: linear-gradient(180deg, rgba(13,38,76,0.02), rgba(255,255,255,0));
      border-radius: calc(var(--radius) - 8px);
      border: 1px solid rgba(11,95,255,0.04);
    }

    .details.collapsed{
      opacity: 0;
    }

    .details.open{
      opacity: 1;
    }

    /* small content styles */
    p{ margin: 0 0 10px 0; }
    ul{ margin: 0 0 10px 20px; }

    /* small helper */
    .hint{
      font-size: 13px;
      color: var(--muted);
      margin-top: 8px;
    }

    /* make transitions smoother on reduced motion preference */
    @media (prefers-reduced-motion: reduce){
      .details{ transition: none; }
      .toggle-icon{ transition: none; }
      .toggle-btn{ transition: none; transform: none; box-shadow: none; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Expand / Collapse Widget Examples</h1>

    <div class="example">
      <div class="summary-row" aria-hidden="false">
        <div class="summary-left">
          <button class="toggle-btn" aria-expanded="false" aria-controls="details-1" type="button">
            <span class="toggle-icon" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <polyline points="6 9 12 15 18 9"></polyline>
              </svg>
            </span>
            <span>
              <div class="label">More information</div>
              <div class="meta">Click to expand</div>
            </span>
          </button>
        </div>
        <div class="hint">Accessible widget: aria-expanded + aria-controls</div>
      </div>

      <div id="details-1" class="details collapsed" aria-hidden="true" hidden>
        <div class="inner">
          <p>This is an example of an expandable region. It uses a button with aria-expanded and aria-controls to indicate and manage state.</p>
          <ul>
            <li>Animated open/close with max-height</li>
            <li>Accessible labeling via aria attributes</li>
            <li>Graceful fallback for reduced-motion preferences</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="example">
      <div class="summary-row">
        <div class="summary-left">
          <button class="toggle-btn" aria-expanded="true" aria-controls="details-2" type="button">
            <span class="toggle-icon" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <polyline points="6 9 12 15 18 9"></polyline>
              </svg>
            </span>
            <span>
              <div class="label">Release notes (open)</div>
              <div class="meta">This one starts opened</div>
            </span>
          </button>
        </div>
        <div class="hint">Try collapsing this panel</div>
      </div>

      <div id="details-2" class="details open" aria-hidden="false">
        <div class="inner">
          <h3 style="margin-top:0; font-size:16px;">What's new</h3>
          <p>Version 2.1.0 includes the following updates:</p>
          <ul>
            <li>Performance improvements for initial render</li>
            <li>Bug fixes and smaller bundle size</li>
            <li>Improved accessibility for keyboard users</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="example">
      <div class="summary-row">
        <div class="summary-left">
          <button class="toggle-btn" aria-expanded="false" aria-controls="details-3" type="button">
            <span class="toggle-icon" aria-hidden="true">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <polyline points="6 9 12 15 18 9"></polyline>
              </svg>
            </span>
            <span>
              <div class="label">Tips & Tricks</div>
              <div class="meta">Keyboard: Enter / Space</div>
            </span>
          </button>
        </div>
        <div class="hint">This panel contains a longer example demonstrating dynamic height.</div>
      </div>

      <div id="details-3" class="details collapsed" aria-hidden="true" hidden>
        <div class="inner">
          <p>Longer content will animate smoothly to its natural height. The script measures the scrollHeight and applies an appropriate max-height during transitions.</p>
          <p>Example uses include:</p>
          <ul>
            <li>Progressive disclosure of advanced settings</li>
            <li>Lightweight accordion patterns</li>
            <li>Help / FAQ screens</li>
          </ul>
          <p style="margin-bottom:0;">Tip: To make content more dynamic, you can inject elements inside the .details .inner container; the open/close logic will still work after toggling.</p>
        </div>
      </div>
    </div>

  </div>

  <script>
    (function(){
      // Initialize all examples
      const examples = document.querySelectorAll('.example');

      examples.forEach((example, idx) => {
        const btn = example.querySelector('button.toggle-btn');
        const details = example.querySelector('.details');

        if (!btn || !details) return;

        // Ensure the details element has an id (aria-controls expects it)
        if (!details.id) details.id = 'details-auto-' + (idx + 1);

        // Helper functions
        function openDetails(animate = true) {
          btn.setAttribute('aria-expanded', 'true');
          details.removeAttribute('hidden');
          details.classList.remove('collapsed');
          details.classList.add('open');
          details.setAttribute('aria-hidden', 'false');

          if (!animate) {
            details.style.maxHeight = 'none';
            return;
          }

          // Measure and animate
          const start = details.scrollHeight;
          details.style.maxHeight = '0px';
          // Force reflow to pick up starting maxHeight
          details.getBoundingClientRect();
          details.style.transition = 'max-height 220ms cubic-bezier(.2,.9,.3,1), opacity 220ms cubic-bezier(.2,.9,.3,1)';
          details.style.maxHeight = start + 'px';

          // When transition ends, remove inline max-height so the container can grow naturally
          const onEnd = function(e){
            if (e.propertyName !== 'max-height') return;
            details.style.maxHeight = 'none';
            details.removeEventListener('transitionend', onEnd);
          };
          details.addEventListener('transitionend', onEnd);
        }

        function closeDetails(animate = true) {
          btn.setAttribute('aria-expanded', 'false');
          details.classList.remove('open');
          details.classList.add('collapsed');
          details.setAttribute('aria-hidden', 'true');

          if (!animate) {
            details.setAttribute('hidden', '');
            details.style.maxHeight = '';
            return;
          }

          // Prepare to animate from current height to 0
          const height = details.scrollHeight;
          details.style.maxHeight = height + 'px';
          // Force reflow
          details.getBoundingClientRect();
          details.style.transition = 'max-height 220ms cubic-bezier(.2,.9,.3,1), opacity 220ms cubic-bezier(.2,.9,.3,1)';
          details.style.maxHeight = '0px';

          const onEnd = function(e){
            if (e.propertyName !== 'max-height') return;
            details.setAttribute('hidden', '');
            details.style.maxHeight = '';
            details.removeEventListener('transitionend', onEnd);
          };
          details.addEventListener('transitionend', onEnd);
        }

        // Wire the button
        btn.addEventListener('click', (ev) => {
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          if (expanded) closeDetails();
          else openDetails();
        });

        // Allow Escape key to close when focus is inside the details region
        details.addEventListener('keydown', (ev) => {
          if (ev.key === 'Escape') {
            btn.focus();
            closeDetails();
          }
        });

        // Initialize visual state based on aria attributes / hidden attribute
        const isHidden = details.hasAttribute('hidden') || details.getAttribute('aria-hidden') === 'true';
        const isExpanded = btn.getAttribute('aria-expanded') === 'true';

        if (isExpanded && !isHidden) {
          // ensure open presentation
          details.classList.add('open');
          details.classList.remove('collapsed');
          details.style.maxHeight = 'none';
          details.removeAttribute('hidden');
          details.setAttribute('aria-hidden', 'false');
        } else {
          // start collapsed
          details.classList.add('collapsed');
          details.classList.remove('open');
          details.style.maxHeight = '0px';
          details.setAttribute('hidden', '');
          details.setAttribute('aria-hidden', 'true');
          btn.setAttribute('aria-expanded', 'false');
        }
      });

      // Optional: allow toggling panels by clicking their summary area (not just the button)
      document.querySelectorAll('.example .summary-row').forEach(row => {
        row.addEventListener('click', (e) => {
          // If the click target was the button or a control inside it, ignore because the button already handles it.
          if (e.target.closest('button.toggle-btn')) return;
          const btn = row.querySelector('button.toggle-btn');
          if (btn) btn.click();
        });
      });
    })();
  </script>
</body>
</html>