<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root {
      --accent: #0366d6;
      --bg: #f8fafc;
      --card: #ffffff;
      --border: #e6edf3;
      --radius: 8px;
      --duration: 260ms;
      --shadow: 0 6px 18px rgba(12, 28, 45, 0.06);
    }

    body {
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      margin: 32px;
      background: linear-gradient(180deg, var(--bg), #ffffff 120px);
      color: #0b1a2b;
      line-height: 1.4;
    }

    h1 {
      font-size: 1.25rem;
      margin: 0 0 18px 0;
    }

    p.lead {
      margin: 0 0 28px 0;
      color: #234;
    }

    .example {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 14px;
      margin-bottom: 18px;
      box-shadow: var(--shadow);
      max-width: 780px;
    }

    /* Expander button */
    .expander {
      display: flex;
      align-items: center;
      gap: 12px;
      width: 100%;
      padding: 10px 12px;
      background: linear-gradient(180deg, #ffffff, #fbfdff);
      border: 1px solid rgba(3, 102, 214, 0.08);
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      color: #073047;
      text-align: left;
      transition: background var(--duration), box-shadow var(--duration), transform 120ms;
      user-select: none;
    }

    .expander:focus {
      outline: 3px solid rgba(3,102,214,0.14);
      outline-offset: 2px;
    }

    .expander:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(3, 102, 214, 0.04);
    }

    .expander .label {
      flex: 1 1 auto;
    }

    .expander .meta {
      color: #5b6b73;
      font-size: 0.92rem;
    }

    .expander .chev {
      width: 18px;
      height: 18px;
      display: inline-block;
      transition: transform var(--duration) ease;
      transform-origin: 50% 50%;
    }

    /* rotate chevron when expanded */
    .expander[aria-expanded="true"] .chev {
      transform: rotate(90deg);
    }

    /* Controlled content container */
    .details {
      overflow: hidden;
      max-height: 0;
      transition: max-height var(--duration) ease;
      margin-top: 12px;
      border-radius: 8px;
      padding: 0 8px;
    }

    /* inner content styles */
    .details .inner {
      padding: 12px;
      background: #fbfeff;
      border: 1px solid #edf6fb;
      border-radius: 6px;
      color: #0f1720;
    }

    /* Example of expanded state (for non-JS environments this won't animate) */
    /* For runtime control we set max-height inline from JS for accurate height. */

    /* small helper for code blocks */
    pre {
      margin: 0;
      padding: 10px;
      background: #0b1220;
      color: #dbeafe;
      overflow: auto;
      border-radius: 6px;
      font-size: 0.87rem;
    }

    /* visual label for aria-hidden state during demo */
    .stateNote {
      margin-top: 8px;
      font-size: 0.86rem;
      color: #3b4b55;
    }
  </style>
</head>
<body>
  <h1>Expand / Collapse widgets</h1>
  <p class="lead">Two examples below show accessible expand/collapse controls. Each widget is wrapped in a container with class "example". The controlled content container uses the class "details".</p>

  <!-- Example 1 -->
  <div class="example">
    <button class="expander" id="expander-1" aria-expanded="false" aria-controls="details-1" type="button">
      <span class="chev" aria-hidden="true">
        <!-- simple chevron -->
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </span>
      <span class="label">More about the product</span>
      <span class="meta">Overview • Specs</span>
    </button>

    <div id="details-1" class="details" role="region" aria-labelledby="expander-1" aria-hidden="true">
      <div class="inner">
        <p><strong>Product summary:</strong> This product is designed to demonstrate a simple, accessible expand/collapse widget. It supports keyboard interaction, updates ARIA attributes, and animates open/close smoothly.</p>
        <ul>
          <li>Lightweight and semantic</li>
          <li>Keyboard navigable (Space / Enter)</li>
          <li>ARIA attributes reflect the state</li>
        </ul>
      </div>
    </div>

    <div class="stateNote" aria-hidden="true">State: <span id="state-1">collapsed</span></div>
  </div>

  <!-- Example 2: nested content with longer block -->
  <div class="example">
    <button class="expander" id="expander-2" aria-expanded="false" aria-controls="details-2" type="button">
      <span class="chev" aria-hidden="true">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </span>
      <span class="label">Release notes</span>
      <span class="meta">v2.3.0 • 6 items</span>
    </button>

    <div id="details-2" class="details" role="region" aria-labelledby="expander-2" aria-hidden="true">
      <div class="inner">
        <h3 style="margin-top:0;">What's new in v2.3.0</h3>
        <ol>
          <li>Improved performance for large datasets.</li>
          <li>Added experimental dark-mode support for the dashboard.</li>
          <li>Fixed a bug causing occasional layout shifts on mobile.</li>
          <li>Updated dependencies and security patches.</li>
          <li>Better keyboard focus management on modal dialogs.</li>
          <li>Minor UI polish and accessibility improvements.</li>
        </ol>
        <p style="margin-bottom:0;">For full details, view the changelog in your project repository or contact the team.</p>
      </div>
    </div>

    <div class="stateNote" aria-hidden="true">State: <span id="state-2">collapsed</span></div>
  </div>

  <script>
    (function () {
      // Find all expander buttons
      var expanders = document.querySelectorAll('.expander');

      function setState(button, details, expanded) {
        button.setAttribute('aria-expanded', expanded ? 'true' : 'false');
        details.setAttribute('aria-hidden', expanded ? 'false' : 'true');
        // Animate by setting maxHeight explicitly to content height when opening; zero when closing.
        if (expanded) {
          // ensure the content is measurable
          var prev = details.style.maxHeight;
          details.style.maxHeight = '0px';
          // Allow the browser a moment to apply the 0px before setting to scrollHeight so the transition runs
          window.requestAnimationFrame(function () {
            details.style.maxHeight = details.scrollHeight + 'px';
          });
        } else {
          // collapse
          details.style.maxHeight = details.scrollHeight + 'px';
          // next frame set to 0px to trigger transition
          window.requestAnimationFrame(function () {
            details.style.maxHeight = '0px';
          });
        }

        // Update visible state notes in demo (non-essential)
        var stateNote = document.getElementById('state-' + button.id.split('-')[1]);
        if (stateNote) stateNote.textContent = expanded ? 'expanded' : 'collapsed';
      }

      expanders.forEach(function (btn) {
        var controlsId = btn.getAttribute('aria-controls');
        if (!controlsId) return;
        var details = document.getElementById(controlsId);
        if (!details) return;

        // Initialize state based on aria-expanded (default assumed "false")
        var expanded = btn.getAttribute('aria-expanded') === 'true';
        // Ensure details has a starting max-height so CSS transition works predictably
        details.style.maxHeight = expanded ? details.scrollHeight + 'px' : '0px';
        details.setAttribute('aria-hidden', expanded ? 'false' : 'true');

        btn.addEventListener('click', function () {
          var isExpanded = btn.getAttribute('aria-expanded') === 'true';
          setState(btn, details, !isExpanded);
        });

        // Optional: when transition ends and collapsed, remove inline maxHeight to keep layout clean
        details.addEventListener('transitionend', function (e) {
          if (e.propertyName !== 'max-height') return;
          var isNowOpen = btn.getAttribute('aria-expanded') === 'true';
          if (isNowOpen) {
            // keep maxHeight to allow dynamic content resizing slightly; remove if desired:
            details.style.maxHeight = details.scrollHeight + 'px';
          } else {
            // collapsed — ensure maxHeight remains 0
            details.style.maxHeight = '0px';
          }
        });

        // If content inside changes size, update maxHeight when open
        var ro = new ResizeObserver(function () {
          if (btn.getAttribute('aria-expanded') === 'true') {
            details.style.maxHeight = details.scrollHeight + 'px';
          }
        });
        ro.observe(details);
      });
    }());
  </script>
</body>
</html>