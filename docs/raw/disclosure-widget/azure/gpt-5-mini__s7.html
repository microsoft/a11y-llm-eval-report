<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#0b76ef;
      --bg:#f7f9fc;
      --muted:#6b7280;
      --radius:8px;
    }
    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      margin: 24px;
      background: linear-gradient(180deg,#ffffff 0%, #f6fbff 100%);
      color: #0f172a;
      line-height: 1.45;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    h1{font-size:1.25rem;margin-bottom:12px}
    p.lead{margin-top:0;color:var(--muted);margin-bottom:18px}

    /* Example container */
    .example{
      background: white;
      border: 1px solid rgba(15,23,42,0.06);
      padding: 14px;
      border-radius: var(--radius);
      box-shadow: 0 6px 18px rgba(11,26,48,0.04);
      max-width:760px;
      margin-bottom:18px;
    }

    /* Toggle button */
    .toggle {
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 14px;
      cursor:pointer;
      border-radius:8px;
      border:1px solid rgba(15,23,42,0.06);
      background:linear-gradient(180deg,#ffffff,#fbfdff);
      color:var(--accent);
      font-weight:600;
      font-size:0.95rem;
      transition: box-shadow .15s, transform .06s;
    }
    .toggle:active{ transform: translateY(1px); }
    .toggle:focus{ outline:3px solid rgba(11,118,239,0.14); outline-offset:3px; }

    .toggle .chev {
      width:18px;height:18px;display:inline-block;transition:transform .22s;
      transform-origin:center;
    }
    .toggle[aria-expanded="true"] .chev{ transform:rotate(90deg); }

    /* Controlled content */
    .details {
      margin-top:12px;
      overflow: hidden;
      transition: max-height .28s cubic-bezier(.2,.9,.2,1), opacity .18s;
      max-height: 0;
      opacity: 0;
    }
    .details.open {
      opacity: 1;
    }

    .details .card {
      background: var(--bg);
      padding:12px;
      border-radius:8px;
      border:1px solid rgba(15,23,42,0.04);
      color:#0f172a;
    }

    /* small typographic helpers */
    .muted { color:var(--muted); font-size:0.95rem; }
    .small { font-size:0.85rem; color:var(--muted); margin-top:8px; }

    /* Respect prefers-reduced-motion */
    @media (prefers-reduced-motion: reduce){
      .details{ transition:none; }
      .toggle .chev{ transition:none; }
    }

  </style>
</head>
<body>
  <h1>Expand &amp; Collapse Widgets</h1>
  <p class="lead">Each widget below is wrapped in a container with the class "example". The content panels controlled by the toggles use the class "details". Buttons use aria-expanded and aria-controls for accessibility.</p>

  <!-- Example 1 -->
  <div class="example">
    <button class="toggle" id="toggle-1" aria-expanded="false" aria-controls="details-1" aria-haspopup="true">
      <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false">
        <path d="M8.5 6.5L15.5 12L8.5 17.5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path>
      </svg>
      Show details
    </button>

    <div id="details-1" class="details" role="region" aria-labelledby="toggle-1" aria-hidden="true">
      <div class="card">
        <strong>Basic details panel</strong>
        <p class="small">This content is inside a controlled region with the class "details". Click the button above to expand or collapse it. When collapsed it is visually hidden and removed from the flow (max-height = 0).</p>
      </div>
    </div>
  </div>

  <!-- Example 2 -->
  <div class="example">
    <button class="toggle" id="toggle-2" aria-expanded="false" aria-controls="details-2" aria-haspopup="true">
      <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false">
        <path d="M8.5 6.5L15.5 12L8.5 17.5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path>
      </svg>
      Release notes
    </button>

    <div id="details-2" class="details" role="region" aria-labelledby="toggle-2" aria-hidden="true">
      <div class="card">
        <strong>Version 2.4.1 — Highlights</strong>
        <ul style="margin:10px 0 0 16px;">
          <li>Improved performance for large data sets.</li>
          <li>Fixed edge-case bug when loading images.</li>
          <li>Small UI polish and accessibility improvements.</li>
        </ul>
        <p class="small">Tip: You can navigate to the toggle with the keyboard and press Space/Enter to open/close the panel.</p>
      </div>
    </div>
  </div>

  <!-- Example 3: multiple collapsible sections -->
  <div class="example">
    <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center;">
      <button class="toggle" id="toggle-3a" aria-expanded="false" aria-controls="details-3a" aria-haspopup="true">
        <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false">
          <path d="M8.5 6.5L15.5 12L8.5 17.5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
        Show FAQ 1
      </button>

      <button class="toggle" id="toggle-3b" aria-expanded="false" aria-controls="details-3b" aria-haspopup="true">
        <svg class="chev" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false">
          <path d="M8.5 6.5L15.5 12L8.5 17.5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
        Show FAQ 2
      </button>
    </div>

    <div id="details-3a" class="details" role="region" aria-labelledby="toggle-3a" aria-hidden="true" style="margin-top:12px;">
      <div class="card">
        <strong>FAQ — What is this?</strong>
        <p class="small">It's an example of multiple controlled sections. Each button manages its own panel independently.</p>
      </div>
    </div>

    <div id="details-3b" class="details" role="region" aria-labelledby="toggle-3b" aria-hidden="true" style="margin-top:12px;">
      <div class="card">
        <strong>FAQ — Keyboard support</strong>
        <p class="small">Buttons are native <code>button</code> elements, so they support activation via keyboard (Enter and Space) by default.</p>
      </div>
    </div>
  </div>

  <script>
    (function(){
      // Utility: toggle a particular details element for a button
      function togglePanel(button, instant){
        var id = button.getAttribute('aria-controls');
        if(!id) return;
        var panel = document.getElementById(id);
        if(!panel) return;

        var isOpen = button.getAttribute('aria-expanded') === 'true';

        // Respect reduced motion preference
        var reduceMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        // Closing
        if(isOpen){
          button.setAttribute('aria-expanded','false');
          panel.setAttribute('aria-hidden','true');
          panel.classList.remove('open');

          if(reduceMotion || instant){
            panel.style.maxHeight = '0px';
          } else {
            // Start from current height to animate to 0
            panel.style.maxHeight = panel.scrollHeight + 'px';
            // Force layout then animate
            requestAnimationFrame(function(){
              panel.style.maxHeight = '0px';
            });
          }
        } else {
          // Opening
          button.setAttribute('aria-expanded','true');
          panel.setAttribute('aria-hidden','false');
          panel.classList.add('open');

          if(reduceMotion || instant){
            // bypass animation
            panel.style.maxHeight = panel.scrollHeight + 'px';
            // remove inline maxHeight a moment later so it can grow naturally
            setTimeout(function(){ panel.style.maxHeight = ''; }, 50);
          } else {
            // Set maxHeight to measured height to allow transition
            panel.style.maxHeight = panel.scrollHeight + 'px';
            // After transition ends remove maxHeight so content can resize naturally
            var onEnd = function(ev){
              if(ev && ev.target !== panel) return;
              panel.style.maxHeight = '';
              panel.removeEventListener('transitionend', onEnd);
            };
            panel.addEventListener('transitionend', onEnd);
          }
        }
      }

      // Initialize toggles
      var toggles = Array.prototype.slice.call(document.querySelectorAll('.toggle[aria-controls]'));
      toggles.forEach(function(btn){
        var id = btn.getAttribute('aria-controls');
        var panel = document.getElementById(id);
        if(!panel) return;

        // Ensure initial state is closed unless aria-expanded is true
        var expanded = btn.getAttribute('aria-expanded') === 'true';
        if(expanded){
          panel.classList.add('open');
          panel.setAttribute('aria-hidden','false');
          // ensure it shows
          panel.style.maxHeight = panel.scrollHeight + 'px';
          // then clear after a moment
          setTimeout(function(){ panel.style.maxHeight = ''; }, 100);
        } else {
          panel.classList.remove('open');
          panel.setAttribute('aria-hidden','true');
          panel.style.maxHeight = '0px';
        }

        // Click toggles
        btn.addEventListener('click', function(e){
          togglePanel(btn, false);
        });

        // Optional: support close-on-escape when focused within the panel
        panel.addEventListener('keydown', function(e){
          if(e.key === 'Escape' || e.key === 'Esc'){
            // Close and move focus to the toggle
            btn.focus();
            if(btn.getAttribute('aria-expanded') === 'true'){
              togglePanel(btn, false);
            }
          }
        });
      });

      // Example: if user resizes and panels are open, clear maxHeight to allow natural flow
      window.addEventListener('resize', function(){
        toggles.forEach(function(btn){
          var id = btn.getAttribute('aria-controls');
          var panel = document.getElementById(id);
          if(!panel) return;
          if(panel.classList.contains('open')){
            panel.style.maxHeight = '';
          }
        });
      });

      // Optional: support programmatic toggles using data attributes (not required, but handy)
      document.addEventListener('click', function(e){
        var t = e.target;
        // find button ancestor with data-toggle-target
        while(t && t !== document){
          if(t.matches && t.matches('[data-toggle-target]')) break;
          t = t.parentNode;
        }
        if(t && t !== document && t.getAttribute('data-toggle-target')){
          var target = t.getAttribute('data-toggle-target');
          var btn = document.querySelector('[aria-controls="'+target+'"]');
          if(btn) togglePanel(btn, false);
        }
      });
    })();
  </script>
</body>
</html>