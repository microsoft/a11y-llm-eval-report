<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#0b5cff;
      --bg:#f7f9fc;
      --surface:#ffffff;
      --muted:#6b7280;
      --radius:8px;
      --shadow: 0 6px 18px rgba(12, 18, 46, 0.08);
      --transition: 260ms cubic-bezier(.2,.9,.3,1);
      --chevron-size: 16px;
    }

    body{
      font-family: system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
      background: linear-gradient(180deg,var(--bg),#eef4ff 60%);
      color:#0f1722;
      margin: 32px;
      line-height:1.45;
    }

    h1{
      font-size: 20px;
      margin: 0 0 18px 0;
      color: #06122a;
    }

    .examples{
      display:grid;
      gap:18px;
      max-width:860px;
    }

    .example{
      background:var(--surface);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:16px;
      border:1px solid rgba(12,18,46,0.04);
    }

    /* Toggle button */
    .toggle{
      display:flex;
      align-items:center;
      gap:12px;
      width:100%;
      background:transparent;
      border:0;
      padding:10px 12px;
      text-align:left;
      cursor:pointer;
      border-radius:8px;
      transition: background var(--transition), box-shadow var(--transition);
    }
    .toggle:focus{
      outline:2px solid rgba(11,92,255,0.14);
      box-shadow:0 0 0 4px rgba(11,92,255,0.06);
    }
    .toggle:hover{
      background: rgba(11,92,255,0.03);
    }

    .toggle .title{
      font-weight:600;
      font-size:16px;
      color:#07132a;
      flex:1;
    }
    .toggle .meta{
      font-size:13px;
      color:var(--muted);
    }

    /* Chevron */
    .toggle .chev{
      width:var(--chevron-size);
      height:var(--chevron-size);
      display:inline-block;
      transition: transform var(--transition);
      transform-origin:center;
      color:var(--muted);
      flex: none;
    }
    .toggle[aria-expanded="true"] .chev{
      transform: rotate(180deg);
      color:var(--accent);
    }

    /* Controlled content container */
    .details{
      overflow:hidden;
      max-height:0;
      opacity:0;
      transition: max-height var(--transition), opacity calc(var(--transition) / 1.4);
      margin-top:8px;
      border-radius:6px;
    }

    .details.open{
      opacity:1;
    }

    .panel{
      padding:14px 12px;
      background:linear-gradient(180deg, rgba(11,92,255,0.02), rgba(11,92,255,0.00));
      border-radius:6px;
      border:1px solid rgba(11,92,255,0.06);
      color:#0a1730;
      font-size:14px;
    }

    /* Small utility for nested content example */
    .item{
      padding:10px;
      background: #fff;
      border-radius:6px;
      border:1px solid rgba(12,18,46,0.04);
      margin-bottom:8px;
    }

    /* Respect reduced motion */
    @media (prefers-reduced-motion: reduce){
      .details{ transition: none; }
      .toggle .chev{ transition: none; }
    }

    footer{
      margin-top:18px;
      font-size:13px;
      color:var(--muted);
    }
  </style>
</head>
<body>
  <h1>Expand / Collapse Widget Examples</h1>
  <div class="examples">
    <div class="example">
      <button class="toggle" id="expl1-btn" aria-expanded="false" type="button">
        <span class="title">Simple details â€” click to expand</span>
        <span class="meta">More info</span>
        <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>

      <div class="details" id="expl1-details" role="region" aria-hidden="true" aria-labelledby="expl1-btn">
        <div class="panel">
          <p>This is a simple expand/collapse area. The button above controls the visibility of this content. The implementation uses ARIA attributes (aria-expanded, aria-controls, and aria-hidden) to improve accessibility and a smooth height animation for a pleasant visual transition.</p>
          <p>Try using your keyboard: the toggle is a native button so Space/Enter work. Press Escape while focused on the toggle to close the content.</p>
        </div>
      </div>
    </div>

    <div class="example">
      <button class="toggle" id="expl2-btn" aria-expanded="false" type="button">
        <span class="title">Nested content example</span>
        <span class="meta">3 items</span>
        <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>

      <div class="details" id="expl2-details" role="region" aria-hidden="true" aria-labelledby="expl2-btn">
        <div class="panel">
          <div class="item">
            <strong>Item One</strong>
            <div style="color:var(--muted); margin-top:6px;">Brief description about item one. Demonstrates multiple lines of content inside the details area.</div>
          </div>
          <div class="item">
            <strong>Item Two</strong>
            <div style="color:var(--muted); margin-top:6px;">Another item with its own content. The open container grows to fit these children.</div>
          </div>
          <div class="item">
            <strong>Item Three</strong>
            <div style="color:var(--muted); margin-top:6px;">Final item. Try expanding and collapsing repeatedly to see the smooth behavior.</div>
          </div>
        </div>
      </div>
    </div>

    <div class="example">
      <button class="toggle" id="expl3-btn" aria-expanded="true" type="button">
        <span class="title">Open by default</span>
        <span class="meta">Prefilled state</span>
        <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>

      <div class="details open" id="expl3-details" role="region" aria-hidden="false" aria-labelledby="expl3-btn">
        <div class="panel">
          <p>This example is opened by default. On initialization the script reads the button's aria-expanded attribute and sets the container state accordingly.</p>
        </div>
      </div>
    </div>
  </div>

  <footer>
    Tip: This pattern uses a button with aria-expanded + an associated region (class="details") that gets aria-hidden toggled. The implementation aims to be accessible and respects prefers-reduced-motion.
  </footer>

  <script>
    (function(){
      // Simple unique id generator for missing ids
      let idCounter = 0;
      function uid(prefix='id'){ idCounter += 1; return prefix + idCounter; }

      const reduceMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      function setClosed(details, button){
        details.classList.remove('open');
        details.setAttribute('aria-hidden','true');
        button.setAttribute('aria-expanded','false');

        if (reduceMotion) {
          details.style.maxHeight = '0px';
        } else {
          // start from current height to trigger transition
          details.style.maxHeight = details.scrollHeight + 'px';
          requestAnimationFrame(() => {
            details.style.maxHeight = '0px';
          });
        }
      }

      function setOpen(details, button){
        details.classList.add('open');
        details.setAttribute('aria-hidden','false');
        button.setAttribute('aria-expanded','true');

        if (reduceMotion) {
          details.style.maxHeight = '';
        } else {
          details.style.maxHeight = details.scrollHeight + 'px';
        }
      }

      // Initialize each example
      document.querySelectorAll('.example').forEach(example => {
        const button = example.querySelector('.toggle');
        const details = example.querySelector('.details');

        if (!button || !details) return;

        // Ensure ids
        if (!button.id) button.id = uid('btn-');
        if (!details.id) details.id = uid('details-');

        // Link button -> details
        button.setAttribute('aria-controls', details.id);

        // Role and labeling for details
        details.setAttribute('role', details.getAttribute('role') || 'region');
        details.setAttribute('aria-labelledby', button.id);

        // Initialize state from button aria-expanded or details.open class
        const expandedAttr = button.getAttribute('aria-expanded');
        const expanded = expandedAttr === 'true' || details.classList.contains('open');

        if (expanded) {
          // open state
          details.classList.add('open');
          details.setAttribute('aria-hidden','false');
          button.setAttribute('aria-expanded','true');
          // If no reduced motion, set a max-height so transition is consistent; remove it once transition ends
          if (!reduceMotion) {
            details.style.maxHeight = details.scrollHeight + 'px';
            // allow layout to settle then remove maxHeight to allow auto-resize
            details.addEventListener('transitionend', function cleanup(){
              details.style.maxHeight = '';
              details.removeEventListener('transitionend', cleanup);
            });
          } else {
            details.style.maxHeight = '';
          }
        } else {
          // closed state
          details.classList.remove('open');
          details.setAttribute('aria-hidden','true');
          button.setAttribute('aria-expanded','false');
          details.style.maxHeight = '0px';
        }

        // Click handler
        button.addEventListener('click', (e) => {
          const isOpen = button.getAttribute('aria-expanded') === 'true';
          if (isOpen) {
            setClosed(details, button);
          } else {
            setOpen(details, button);
          }
        });

        // Close on Escape when the button is focused
        button.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' || e.key === 'Esc') {
            const isOpen = button.getAttribute('aria-expanded') === 'true';
            if (isOpen) {
              setClosed(details, button);
              // keep focus on the button
              button.focus();
            }
          }
        });

        // Manage transitionend to cleanup maxHeight for open state
        details.addEventListener('transitionend', (e) => {
          if (e.propertyName !== 'max-height') return;
          const isOpen = details.classList.contains('open');
          if (isOpen) {
            // allow natural height after opening
            details.style.maxHeight = '';
          } else {
            // ensure hidden state stays at 0
            details.style.maxHeight = '0px';
          }
        });

        // If content inside changes size while open (images, dynamic content), adjust maxHeight briefly to allow smooth expand
        const resizeObserver = window.ResizeObserver ? new ResizeObserver(() => {
          if (details.classList.contains('open') && !reduceMotion) {
            details.style.maxHeight = details.scrollHeight + 'px';
            // remove after a tick so it can still grow/shrink naturally
            requestAnimationFrame(()=> {
              // keep until transitionend clears it
            });
          }
        }) : null;

        if (resizeObserver) {
          resizeObserver.observe(details);
        }
      });
    })();
  </script>
</body>
</html>