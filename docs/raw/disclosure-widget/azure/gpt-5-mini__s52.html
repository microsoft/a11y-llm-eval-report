<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#0366d6;
      --muted:#6b7280;
      --bg:#f8fafc;
      --card:#ffffff;
      --radius:8px;
      --transition:200ms cubic-bezier(.2,.9,.3,1);
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,var(--bg),#eef2ff 60%);
      margin: 32px;
      color:#0f172a;
      line-height:1.4;
    }

    h1{
      margin:0 0 18px 0;
      font-size:20px;
    }

    .example{
      background:var(--card);
      border:1px solid rgba(15,23,42,0.06);
      border-radius:var(--radius);
      padding:16px;
      max-width:780px;
      margin:18px 0;
      box-shadow:0 6px 18px rgba(2,6,23,0.04);
    }

    .header-row{
      display:flex;
      align-items:center;
      gap:12px;
      justify-content:space-between;
      margin-bottom:8px;
    }

    .expander{
      display:inline-flex;
      align-items:center;
      gap:10px;
      background:transparent;
      border:1px solid rgba(2,6,23,0.06);
      padding:8px 12px;
      border-radius:10px;
      font-weight:600;
      color:var(--accent);
      cursor:pointer;
      transition:transform var(--transition), box-shadow var(--transition);
      user-select:none;
    }

    .expander:focus{
      outline:3px solid rgba(3,102,214,0.12);
      outline-offset:3px;
    }

    .expander .label{
      font-size:14px;
    }

    /* chevron */
    .expander .chev{
      width:18px;
      height:18px;
      display:inline-block;
      transition:transform var(--transition);
      transform-origin:center;
    }
    .expander .chev svg{
      display:block;
      color:var(--accent);
    }

    /* rotate when expanded */
    .expander[aria-expanded="true"] .chev{
      transform:rotate(180deg);
    }

    /* Controlled details area */
    .details{
      overflow:hidden;
      transition:max-height var(--transition), opacity var(--transition);
      max-height:0; /* collapsed default */
      opacity:0;
      border-top:1px dashed rgba(2,6,23,0.06);
      margin-top:12px;
      padding-top:12px;
    }

    /* when expanded show content */
    .expander[aria-expanded="true"] + .details,
    .details[data-expanded="true"]{
      max-height:1000px;
      opacity:1;
    }

    /* example content styling */
    .details p{
      margin:0 0 10px 0;
      color:#0b1220;
    }

    .meta{
      font-size:13px;
      color:var(--muted);
    }

    /* small demo layout for controls inside details */
    .controls{
      display:flex;
      gap:8px;
      margin-top:10px;
    }

    .btn{
      padding:8px 10px;
      background:var(--accent);
      color:white;
      border-radius:8px;
      border:none;
      cursor:pointer;
      font-weight:600;
    }

    .btn.secondary{
      background:#e6eefc;
      color:var(--accent);
    }

    /* Accessible hiding fallback when JS is disabled:
       show details by default if the button is not present or JS disabled.
       We'll keep the CSS rule that collapses when aria-expanded="false". */
    noscript + .example .details{
      max-height:1000px;
      opacity:1;
    }

    footer{
      margin-top:24px;
      font-size:13px;
      color:var(--muted);
    }
  </style>
</head>
<body>
  <h1>Expand / Collapse widget examples</h1>

  <div class="example">
    <div class="header-row">
      <div>
        <div style="font-weight:700">Account details</div>
        <div class="meta">Click to reveal more information</div>
      </div>
      <button class="expander" aria-expanded="false" aria-controls="details-1" id="expander-1">
        <span class="label">Show details</span>
        <span class="chev" aria-hidden="true">
          <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </span>
      </button>
    </div>

    <div id="details-1" class="details" role="region" aria-labelledby="expander-1" aria-hidden="true" data-expanded="false">
      <p><strong>Username:</strong> jane.doe@example.com</p>
      <p><strong>Member since:</strong> February 2019</p>
      <div class="controls">
        <button class="btn" type="button">Manage</button>
        <button class="btn secondary" type="button">Sign out</button>
      </div>
    </div>
  </div>

  <div class="example">
    <div class="header-row">
      <div>
        <div style="font-weight:700">Release notes â€” v2.3.0</div>
        <div class="meta">Summary of changes included in this release</div>
      </div>
      <button class="expander" aria-expanded="false" aria-controls="details-2" id="expander-2">
        <span class="label">Read release notes</span>
        <span class="chev" aria-hidden="true">
          <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </span>
      </button>
    </div>

    <div id="details-2" class="details" role="region" aria-labelledby="expander-2" aria-hidden="true" data-expanded="false">
      <p><strong>Highlights:</strong></p>
      <ul>
        <li>Improved performance for large data sets</li>
        <li>New filtering options in the sidebar</li>
        <li>Bug fixes and accessibility improvements</li>
      </ul>
      <p class="meta">Tip: press Escape when focus is inside this panel to close it.</p>
    </div>
  </div>

  <footer>
    Note: Each widget is wrapped in a div with class "example". The content container uses the class "details".
  </footer>

  <script>
    (function(){
      // Find all expander buttons
      var expanders = document.querySelectorAll('.expander');

      function toggle(expander, setTo){
        var controlsId = expander.getAttribute('aria-controls');
        if(!controlsId) return;
        var details = document.getElementById(controlsId);
        if(!details) return;

        var expanded = setTo !== undefined ? !!setTo : expander.getAttribute('aria-expanded') === 'false';
        expander.setAttribute('aria-expanded', expanded ? 'true' : 'false');
        details.setAttribute('aria-hidden', expanded ? 'false' : 'true');
        // mirror a data attribute used by CSS for animation
        details.setAttribute('data-expanded', expanded ? 'true' : 'false');

        // update label text if present
        var label = expander.querySelector('.label');
        if(label){
          // simple example text swap
          label.textContent = expanded ? (expander.id === 'expander-1' ? 'Hide details' : 'Hide release notes') : (expander.id === 'expander-1' ? 'Show details' : 'Read release notes');
        }
      }

      expanders.forEach(function(button){
        // initialize (in case server-side or static markup was different)
        var controlsId = button.getAttribute('aria-controls');
        var details = controlsId ? document.getElementById(controlsId) : null;
        if(details){
          // If attribute aria-expanded not present, default to false
          if(!button.hasAttribute('aria-expanded')){
            button.setAttribute('aria-expanded','false');
            details.setAttribute('aria-hidden','true');
            details.setAttribute('data-expanded','false');
          } else {
            // synchronize details with button value
            var isExp = button.getAttribute('aria-expanded') === 'true';
            details.setAttribute('aria-hidden', isExp ? 'false' : 'true');
            details.setAttribute('data-expanded', isExp ? 'true' : 'false');
          }
        }

        button.addEventListener('click', function(){
          toggle(button);
        });
      });

      // Close the nearest expanded panel when Escape is pressed while focus is inside it
      document.addEventListener('keydown', function(e){
        if(e.key === 'Escape' || e.key === 'Esc'){
          // find any details that currently has focus inside
          var expandedDetails = document.querySelectorAll('.details[data-expanded="true"]');
          for(var i=0;i<expandedDetails.length;i++){
            var details = expandedDetails[i];
            if(details.contains(document.activeElement)){
              // find its controlling button via aria-labelledby or aria-controls reversed
              var labelledBy = details.getAttribute('aria-labelledby');
              var controller = labelledBy ? document.getElementById(labelledBy) : null;
              if(controller && controller.classList.contains('expander')){
                toggle(controller, false);
                controller.focus();
                e.preventDefault();
                break;
              }
            }
          }
        }
      });

      // Optional: support toggling with Enter/Space is automatic for buttons.
      // Ensure multiple expanders can operate independently.
    })();
  </script>
</body>
</html>