<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root{
      --bg:#f7f8fb;
      --card:#fff;
      --accent:#0366d6;
      --muted:#6b7280;
      --radius:8px;
      --easing:cubic-bezier(.2,.8,.2,1);
      --shadow: 0 6px 18px rgba(21,27,38,.08);
    }
    html,body{height:100%}
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans","Liberation Sans",sans-serif;
      margin:0;
      background:linear-gradient(180deg,var(--bg),#eef2f7 60%);
      color:#0f1724;
      padding:36px;
      line-height:1.4;
    }

    h1{font-size:20px;margin:0 0 18px 0}
    p.lead{margin:0 0 18px 0;color:var(--muted)}

    .container{
      max-width:880px;
      margin:0 auto;
      display:grid;
      gap:18px;
    }

    .example{
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:14px;
      border:1px solid rgba(15,23,36,0.04);
    }

    /* header/button */
    .header {
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
    }
    .meta {
      display:flex;
      gap:12px;
      align-items:center;
    }
    .title {
      margin:0;
      font-size:15px;
      font-weight:600;
      color:#0b1220;
    }
    .desc {
      font-size:13px;
      color:var(--muted);
    }

    .toggle {
      --size:36px;
      appearance:none;
      border:1px solid rgba(9,18,28,0.06);
      background:#fff;
      color:var(--accent);
      padding:8px 12px;
      border-radius:10px;
      display:inline-flex;
      gap:8px;
      align-items:center;
      cursor:pointer;
      font-weight:600;
      font-size:13px;
      transition:all 180ms var(--easing);
      box-shadow:0 1px 0 rgba(9,18,28,0.03);
    }
    .toggle:focus{
      outline:3px solid rgba(3,102,214,.12);
      outline-offset:3px;
    }
    .toggle .icon{
      width:18px;
      height:18px;
      display:inline-block;
      transition:transform 220ms var(--easing);
    }
    .toggle[aria-expanded="true"] .icon{
      transform:rotate(180deg);
    }

    /* controlled content: class details required by spec */
    .details{
      overflow:hidden;
      transition: max-height 280ms var(--easing), opacity 200ms var(--easing);
      will-change: max-height, opacity;
      margin-top:12px;
      border-radius:8px;
      padding:10px 12px;
      background:linear-gradient(180deg,rgba(3,102,214,0.03),rgba(3,102,214,0.015));
      border:1px solid rgba(3,102,214,0.06);
      color:#0b1220;
      font-size:14px;
    }
    /* when hidden via attribute 'data-closed' we can style opacity but actual hiding handled in JS */
    .details[data-closed="true"]{
      opacity:0;
      pointer-events:none;
    }
    .details p{margin:0 0 8px 0;color:#0f1724}
    .details ul{margin:6px 0 0 18px;color:var(--muted)}

    /* small note */
    .note{font-size:13px;color:var(--muted);margin-top:10px}
  </style>
</head>
<body>
  <div class="container">
    <h1>Expand / Collapse widget examples</h1>
    <p class="lead">Each widget is wrapped with a div.example, and the area it controls uses the class "details". Use the button to toggle content.</p>

    <!-- Example 1: Simple Expand/Collapse -->
    <div class="example" id="ex-1">
      <div class="header">
        <div class="meta">
          <div>
            <h2 class="title">Simple details</h2>
            <div class="desc">A concise expand/collapse region.</div>
          </div>
        </div>
        <div>
          <button class="toggle" aria-expanded="false" aria-controls="details-1" id="toggle-1">
            <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Details
          </button>
        </div>
      </div>

      <div id="details-1" class="details" data-closed="true" hidden>
        <p>This is a short block of content that is revealed when the button is toggled. Buttons use aria-expanded and aria-controls to indicate state and target.</p>
        <ul>
          <li>Accessible button control</li>
          <li>Hidden content with smooth reveal</li>
        </ul>
      </div>
    </div>

    <!-- Example 2: Nested focusable elements within details -->
    <div class="example" id="ex-2">
      <div class="header">
        <div class="meta">
          <div>
            <h2 class="title">Details with interactive content</h2>
            <div class="desc">This example contains links and a form control inside the details region.</div>
          </div>
        </div>
        <div>
          <button class="toggle" aria-expanded="false" aria-controls="details-2" id="toggle-2">
            <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Show
          </button>
        </div>
      </div>

      <div id="details-2" class="details" data-closed="true" hidden>
        <p>Interactive content stays focusable when visible:</p>
        <form onsubmit="event.preventDefault()">
          <label style="display:block;margin-bottom:8px">
            Email:
            <input type="email" placeholder="you@example.com" style="margin-left:8px;padding:6px;border-radius:6px;border:1px solid #d1d5db">
          </label>
          <button type="submit" style="padding:8px 10px;border-radius:8px;background:var(--accent);color:#fff;border:none">Subscribe</button>
        </form>
        <p style="margin-top:10px;font-size:13px;color:var(--muted)">You can focus the input when the details area is open.</p>
      </div>
    </div>

    <!-- Example 3: Longer content to show animation -->
    <div class="example" id="ex-3">
      <div class="header">
        <div class="meta">
          <div>
            <h2 class="title">Animated reveal</h2>
            <div class="desc">This demonstrates a smooth height transition for longer content.</div>
          </div>
        </div>
        <div>
          <button class="toggle" aria-expanded="false" aria-controls="details-3" id="toggle-3">
            <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Read more
          </button>
        </div>
      </div>

      <div id="details-3" class="details" data-closed="true" hidden>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Laborum, a blanditiis? Recusandae, eum quisquam, accusamus ipsum tempore maiores sequi ab dolore minima. Laboriosam, laborum voluptates? Quasi, quidem. Voluptatem, omnis neque.</p>
        <p>Ut fringilla, ipsum eu volutpat sodales, lacus ex dictum sapien, sed dignissim sapien arcu vitae magna. Integer posuere, neque at gravida efficitur, lorem justo posuere purus, sed consequat elit arcu nec sapien.</p>
        <p class="note">Tip: the button is keyboard accessible (Enter / Space) and updates the aria-expanded attribute automatically via the script.</p>
      </div>
    </div>
  </div>

  <script>
    // Attach toggle behavior to any button with aria-controls
    (function() {
      function openDetails(el, panel) {
        panel.removeAttribute('hidden');
        // prepare for animation from 0 to scrollHeight
        panel.dataset.closed = 'false';
        panel.style.maxHeight = '0px';
        // force a style flush
        panel.getBoundingClientRect();
        var full = panel.scrollHeight + 'px';
        panel.style.maxHeight = full;
        // when finished, remove max-height so it can grow naturally
        var done = function cb() {
          panel.style.maxHeight = 'none';
          panel.removeEventListener('transitionend', cb);
        };
        panel.addEventListener('transitionend', done);
        el.setAttribute('aria-expanded','true');
      }

      function closeDetails(el, panel) {
        // animate from current height to 0
        panel.dataset.closed = 'true';
        // set maxHeight to current height (in px) then immediately to 0 to animate
        panel.style.maxHeight = panel.scrollHeight + 'px';
        // force reflow
        panel.getBoundingClientRect();
        panel.style.maxHeight = '0px';
        var done = function cb() {
          panel.setAttribute('hidden','');
          panel.removeEventListener('transitionend', cb);
        };
        panel.addEventListener('transitionend', done);
        el.setAttribute('aria-expanded','false');
      }

      document.querySelectorAll('button[aria-controls]').forEach(function(btn){
        var id = btn.getAttribute('aria-controls');
        var panel = document.getElementById(id);
        if (!panel) return;

        // initialize collapsed state
        btn.setAttribute('aria-expanded', 'false');
        panel.dataset.closed = 'true';
        panel.style.maxHeight = '0px';

        btn.addEventListener('click', function(){
          var expanded = btn.getAttribute('aria-expanded') === 'true';
          if (expanded) {
            closeDetails(btn, panel);
          } else {
            openDetails(btn, panel);
          }
        });

        // allow toggle with Enter/Space is native on button; nothing extra needed.
        // Optional: close on Escape when focus inside panel
        panel.addEventListener('keydown', function(e){
          if (e.key === 'Escape') {
            closeDetails(btn, panel);
            btn.focus();
          }
        });
      });
    })();
  </script>
</body>
</html>