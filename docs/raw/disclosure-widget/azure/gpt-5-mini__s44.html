<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root{
      --accent: #0366d6;
      --bg: #ffffff;
      --muted: #6b7280;
      --surface: #f8fafc;
      --radius: 8px;
      --transition: 220ms cubic-bezier(.2,.9,.3,1);
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color-scheme: light;
    }

    body{
      margin: 24px;
      background: linear-gradient(180deg, #fbfdff 0%, #f3f7fb 100%);
      color: #0f172a;
      line-height: 1.4;
    }

    h1{
      font-size: 20px;
      margin: 0 0 18px 0;
    }

    .example{
      background: var(--bg);
      border: 1px solid rgba(2,6,23,0.06);
      box-shadow: 0 1px 2px rgba(2,6,23,0.04);
      padding: 12px;
      border-radius: 10px;
      max-width: 760px;
      margin-bottom: 16px;
    }

    .toggle{
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      width: 100%;
      background: transparent;
      border: none;
      padding: 12px;
      text-align: left;
      cursor: pointer;
      border-radius: var(--radius);
      transition: background var(--transition);
      font-size: 16px;
    }

    .toggle:hover{
      background: rgba(3,102,214,0.04);
    }

    .toggle:focus{
      outline: 3px solid rgba(3,102,214,0.18);
      outline-offset: 2px;
    }

    .toggle .label{
      display:flex;
      align-items:center;
      gap:12px;
      flex: 1 1 auto;
    }

    .toggle .title{
      font-weight: 600;
      color: #022e63;
    }

    .toggle .subtitle{
      font-size: 13px;
      color: var(--muted);
      margin-top: 2px;
      display:block;
    }

    .icon{
      width: 18px;
      height: 18px;
      flex: none;
      transition: transform var(--transition);
      transform-origin: 50% 50%;
      color: var(--accent);
      display:inline-block;
    }

    /* rotate when expanded */
    .toggle[aria-expanded="true"] .icon{
      transform: rotate(90deg);
    }

    /* details container */
    .details{
      overflow: hidden;
      max-height: 0;
      transition: max-height var(--transition), opacity var(--transition);
      opacity: 0;
      padding: 0 12px;
      margin-top: 6px;
    }

    /* visible state (we also manage aria-hidden) */
    .details.open{
      opacity: 1;
      /* max-height will be set inline for smooth animation */
      padding: 12px;
      margin-top: 10px;
      border-radius: 8px;
      background: var(--surface);
      border: 1px solid rgba(2,6,23,0.04);
    }

    .details p{
      margin: 0 0 8px 0;
      color: #0f172a;
    }

    .details .muted{
      color: var(--muted);
      font-size: 13px;
    }

    /* small helper */
    .hint{
      font-size: 13px;
      color: var(--muted);
      margin-top: 6px;
    }
  </style>
</head>
<body>
  <h1>Expand / Collapse Widget Examples</h1>

  <div class="example">
    <button class="toggle" id="toggle-1" aria-expanded="false" aria-controls="details-1">
      <span class="label">
        <span>
          <span class="title">Account settings</span>
          <span class="subtitle">Manage your profile, security and preferences</span>
        </span>
      </span>
      <span class="icon" aria-hidden="true">
        <!-- chevron icon -->
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" focusable="false" aria-hidden="true">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </span>
    </button>

    <div id="details-1" class="details" role="region" aria-labelledby="toggle-1" aria-hidden="true">
      <p><strong>Profile</strong>: Update name, photo and contact information.</p>
      <p><strong>Security</strong>: Change password, set up two-factor authentication and review sign-in devices.</p>
      <p class="muted">Tip: Press Enter or Space when the toggle is focused to open or close it. Press Escape while inside to close.</p>
    </div>
  </div>

  <div class="example">
    <button class="toggle" id="toggle-2" aria-expanded="false" aria-controls="details-2">
      <span class="label">
        <span>
          <span class="title">Billing & Plans</span>
          <span class="subtitle">View invoices, change plan or update payment method</span>
        </span>
      </span>
      <span class="icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" focusable="false" aria-hidden="true">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </span>
    </button>

    <div id="details-2" class="details" role="region" aria-labelledby="toggle-2" aria-hidden="true">
      <p><strong>Current plan:</strong> Professional — billed monthly</p>
      <p>Invoices are available for the last 12 months. You can update your card on file or switch to annual billing for a discount.</p>
      <p class="muted">This content demonstrates a slightly longer details area to show the expand/collapse animation with variable height.</p>
      <p><a href="#">View invoices</a> · <a href="#">Change plan</a></p>
    </div>
  </div>

  <div class="example">
    <button class="toggle" id="toggle-3" aria-expanded="false" aria-controls="details-3">
      <span class="label">
        <span>
          <span class="title">Accessibility notes</span>
          <span class="subtitle">How this widget supports assistive technologies</span>
        </span>
      </span>
      <span class="icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" focusable="false" aria-hidden="true">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </span>
    </button>

    <div id="details-3" class="details" role="region" aria-labelledby="toggle-3" aria-hidden="true">
      <p>This example uses:</p>
      <ul>
        <li>button element with aria-expanded to indicate state</li>
        <li>aria-controls on the toggle and aria-labelledby on the details region</li>
        <li>aria-hidden on the details region when collapsed</li>
      </ul>
      <p class="muted">Buttons are keyboard reachable and activate with Enter/Space. Escape closes the region when focus is inside.</p>
    </div>
  </div>

  <script>
    (function () {
      // Find all toggles
      const toggles = Array.from(document.querySelectorAll('.toggle'));

      function openDetails(button, details) {
        button.setAttribute('aria-expanded', 'true');
        details.classList.add('open');
        details.setAttribute('aria-hidden', 'false');

        // For smooth height transition: set max-height to scrollHeight
        const fullHeight = details.scrollHeight;
        details.style.maxHeight = fullHeight + 'px';

        // After transition, remove max-height to allow content to grow if needed
        const clearMax = () => {
          // only clear if still open
          if (details.classList.contains('open')) {
            details.style.maxHeight = 'none';
          }
          details.removeEventListener('transitionend', clearMax);
        };
        details.addEventListener('transitionend', clearMax);
      }

      function closeDetails(button, details) {
        button.setAttribute('aria-expanded', 'false');

        // To animate from current height, set explicit max-height
        const curHeight = details.scrollHeight;
        details.style.maxHeight = curHeight + 'px';

        // Force reflow to ensure the browser registers the starting height
        // eslint-disable-next-line no-unused-expressions
        details.offsetHeight;

        details.classList.remove('open');
        details.setAttribute('aria-hidden', 'true');

        // Then animate to 0
        details.style.maxHeight = '0px';
      }

      function toggle(event) {
        const button = event.currentTarget;
        const detailsId = button.getAttribute('aria-controls');
        const details = document.getElementById(detailsId);
        const expanded = button.getAttribute('aria-expanded') === 'true';
        if (expanded) {
          closeDetails(button, details);
        } else {
          openDetails(button, details);
        }
      }

      toggles.forEach(button => {
        button.addEventListener('click', toggle);

        // Optional: allow arrow keys to move focus between toggles (simple behavior)
        button.addEventListener('keydown', (e) => {
          if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {
            e.preventDefault();
            const idx = toggles.indexOf(button);
            const dir = e.key === 'ArrowDown' ? 1 : -1;
            let next = (idx + dir + toggles.length) % toggles.length;
            toggles[next].focus();
          }
        });

        // Manage Escape key while focus is inside the details region
        const detailsId = button.getAttribute('aria-controls');
        const details = document.getElementById(detailsId);

        // close on Escape when a child inside details has focus
        details.addEventListener('keydown', (e) => {
          if (e.key === 'Escape') {
            e.preventDefault();
            closeDetails(button, details);
            button.focus();
          }
        });

        // Keep the button state in sync if JS sets initial open state via attribute
        // (not used here, but included for completeness)
        const initExpanded = button.getAttribute('aria-expanded') === 'true';
        if (initExpanded) {
          details.classList.add('open');
          details.setAttribute('aria-hidden', 'false');
          details.style.maxHeight = 'none';
        } else {
          details.classList.remove('open');
          details.setAttribute('aria-hidden', 'true');
          details.style.maxHeight = '0px';
        }
      });
    })();
  </script>
</body>
</html>