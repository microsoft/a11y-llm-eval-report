<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --bg:#f8fafc;
      --card:#ffffff;
      --muted:#6b7280;
      --accent:#2563eb;
      --border:#e6e9ef;
      --radius:8px;
      --duration:300ms;
    }

    html,body{
      height:100%;
      margin:0;
      font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:linear-gradient(180deg,var(--bg),#eef2ff 120%);
      color:#0f172a;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:40px;
      box-sizing:border-box;
    }

    .container{
      max-width:900px;
      margin:0 auto;
      display:grid;
      gap:18px;
    }

    h1{
      margin:0 0 8px 0;
      font-size:20px;
      color:#0b1220;
    }
    p.lead{
      margin:0 0 20px 0;
      color:var(--muted);
      font-size:14px;
    }

    /* Example wrapper */
    .example{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:14px;
      box-shadow: 0 1px 2px rgba(12,18,30,0.04);
    }

    /* Toggle button */
    .toggle{
      display:flex;
      align-items:center;
      gap:12px;
      width:100%;
      background:transparent;
      border:0;
      padding:10px 12px;
      text-align:left;
      cursor:pointer;
      border-radius:6px;
    }
    .toggle:focus{
      outline:3px solid rgba(37,99,235,0.12);
      outline-offset:2px;
    }
    .toggle .title{
      font-weight:600;
      font-size:15px;
      color:#0f172a;
    }
    .toggle .meta{
      margin-left:auto;
      font-size:13px;
      color:var(--muted);
      display:flex;
      align-items:center;
      gap:8px;
    }

    .chev{
      width:20px;
      height:20px;
      flex:0 0 20px;
      transition:transform var(--duration) ease;
      color:var(--accent);
      display:inline-block;
    }
    .toggle[aria-expanded="true"] .chev{
      transform:rotate(180deg);
    }

    /* Controlled content container (must have class="details") */
    .details{
      overflow:hidden;
      max-height:0;
      transition:max-height var(--duration) ease;
      will-change: max-height;
    }
    .details.open{
      /* when JS sets inline max-height to 'none' we rely on that; this is fallback */
    }

    .details .content{
      padding:12px 12px 2px 12px;
      border-top:1px dashed var(--border);
      color:#0f172a;
      font-size:14px;
      line-height:1.45;
    }

    pre{
      background:#0b1220;
      color:#e6eef8;
      padding:12px;
      border-radius:6px;
      overflow:auto;
      font-size:13px;
      margin:0;
    }

    small.note{
      display:block;
      color:var(--muted);
      margin-top:8px;
      font-size:12px;
    }

    @media (prefers-reduced-motion: reduce){
      .details{ transition:none !important; }
      .chev{ transition:none !important; }
    }

  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Expand / Collapse Widget Examples</h1>
      <p class="lead">Each widget is wrapped in a div.example. The controlled content container uses the class="details".</p>
    </header>

    <!-- Example 1 -->
    <div class="example" id="example-1">
      <button class="toggle" aria-expanded="false" aria-controls="details-1" id="toggle-1">
        <svg class="chev" viewBox="0 0 20 20" fill="none" aria-hidden="true">
          <path d="M5 8l5 5 5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span class="title">More information about our process</span>
        <span class="meta">Learn more</span>
      </button>

      <div class="details" id="details-1" role="region" aria-labelledby="toggle-1" aria-hidden="true">
        <div class="content">
          <p>Our process focuses on iterative design, rapid prototypes, and user testing. We break work into small milestones and validate assumptions early.</p>
          <ul>
            <li>Discovery & research</li>
            <li>Rapid prototyping</li>
            <li>User testing & feedback</li>
            <li>Continuous delivery</li>
          </ul>
          <small class="note">Tip: Use the button above to toggle this section.</small>
        </div>
      </div>
    </div>

    <!-- Example 2 -->
    <div class="example" id="example-2">
      <button class="toggle" aria-expanded="false" aria-controls="details-2" id="toggle-2">
        <svg class="chev" viewBox="0 0 20 20" fill="none" aria-hidden="true">
          <path d="M5 8l5 5 5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span class="title">Show sample API response</span>
        <span class="meta">JSON</span>
      </button>

      <div class="details" id="details-2" role="region" aria-labelledby="toggle-2" aria-hidden="true">
        <div class="content">
          <pre>{
  "user": {
    "id": 8341,
    "name": "Ava Johnson",
    "roles": ["editor","contributor"],
    "preferences": {"theme":"auto","notifications":true}
  },
  "status": "ok"
}</pre>
          <small class="note">This block demonstrates expanding a larger, scrollable content area.</small>
        </div>
      </div>
    </div>

    <!-- Example 3 (starts open) -->
    <div class="example" id="example-3">
      <button class="toggle" aria-expanded="true" aria-controls="details-3" id="toggle-3">
        <svg class="chev" viewBox="0 0 20 20" fill="none" aria-hidden="true">
          <path d="M5 8l5 5 5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span class="title">Frequently asked question</span>
        <span class="meta">Open by default</span>
      </button>

      <div class="details open" id="details-3" role="region" aria-labelledby="toggle-3" aria-hidden="false">
        <div class="content">
          <p>Yes â€” you can set an expand/collapse widget to be open by default by marking the control's aria-expanded="true" and giving the content the open class. JavaScript will initialize this state so the visual and accessibility attributes match.</p>
        </div>
      </div>
    </div>

  </div>

  <script>
    (function(){
      // Utility to toggle a single widget
      function toggleWidget(button){
        var id = button.getAttribute('aria-controls');
        var details = document.getElementById(id);
        if (!details) return;

        var expanded = button.getAttribute('aria-expanded') === 'true';

        // If expanded -> collapse
        if (expanded) {
          // mark for screen readers
          button.setAttribute('aria-expanded', 'false');
          details.setAttribute('aria-hidden', 'true');

          // animate: from current height to 0
          // set explicit height to allow transition
          var startHeight = details.scrollHeight;
          details.style.maxHeight = startHeight + 'px';

          // ensure reflow
          details.offsetHeight;

          details.style.transition = 'max-height var(--duration, 300ms) ease';
          details.style.maxHeight = '0';
          details.classList.remove('open');

          var onCollapse = function(e){
            if (e.propertyName === 'max-height') {
              details.style.transition = '';
              // keep max-height at 0 to preserve collapsed state
              details.removeEventListener('transitionend', onCollapse);
            }
          };
          details.addEventListener('transitionend', onCollapse);
        } else {
          // expanding
          button.setAttribute('aria-expanded', 'true');
          details.setAttribute('aria-hidden', 'false');
          details.classList.add('open');

          // From 0 to scrollHeight
          // If currently has maxHeight none ('' or none), set to 0 first
          details.style.maxHeight = '0';
          // force reflow
          details.offsetHeight;

          var targetHeight = details.scrollHeight;
          details.style.transition = 'max-height var(--duration, 300ms) ease';
          details.style.maxHeight = targetHeight + 'px';

          var onExpand = function(e){
            if (e.propertyName === 'max-height') {
              // remove explicit max-height so content can grow/shrink naturally
              details.style.transition = '';
              details.style.maxHeight = 'none';
              details.removeEventListener('transitionend', onExpand);
            }
          };
          details.addEventListener('transitionend', onExpand);
        }
      }

      // Initialize all toggles on the page
      function init(){
        var toggles = document.querySelectorAll('.example .toggle[aria-controls]');
        toggles.forEach(function(btn){
          var id = btn.getAttribute('aria-controls');
          var details = document.getElementById(id);

          // If JS is available, ensure aria-hidden on details matches aria-expanded
          var expanded = btn.getAttribute('aria-expanded') === 'true';
          if (details) {
            if (expanded) {
              details.classList.add('open');
              details.setAttribute('aria-hidden','false');
              // ensure details is fully visible by removing max-height constraint
              details.style.maxHeight = 'none';
            } else {
              details.classList.remove('open');
              details.setAttribute('aria-hidden','true');
              details.style.maxHeight = '0';
            }
          }

          // Click handler
          btn.addEventListener('click', function(e){
            e.preventDefault();
            toggleWidget(btn);
          });

          // Support keyboard open/close beyond native button behavior if needed (Enter/Space work by default)
          // Allow Escape to close when focused inside details
          if (details) {
            details.addEventListener('keydown', function(ev){
              if (ev.key === 'Escape' || ev.key === 'Esc') {
                // collapse
                if (btn.getAttribute('aria-expanded') === 'true') {
                  btn.focus();
                  toggleWidget(btn);
                }
              }
            });
          }
        });
      }

      // Initialize on DOM ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
    })();
  </script>
</body>
</html>