<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Expand/Collapse Widgets</title>
  <style>
    :root {
      --bg: #ffffff;
      --surface: #f7f7fb;
      --border: #d9d9e3;
      --text: #1f2328;
      --muted: #6b7280;
      --accent: #3b82f6;
      --accent-600: #2563eb;
      --radius: 10px;
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
    }

    body {
      margin: 0;
      padding: 2rem;
      font: 16px/1.6 system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
      color: var(--text);
      background: var(--bg);
    }

    h1 {
      margin: 0 0 1rem 0;
      font-size: 1.75rem;
      font-weight: 700;
    }

    p.lead {
      margin: 0 0 1.5rem 0;
      color: var(--muted);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1rem;
    }

    .example {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 1rem;
      box-shadow: 0 1px 2px rgba(16, 24, 40, 0.06);
    }

    .example h2 {
      margin: 0 0 0.5rem 0;
      font-size: 1.1rem;
    }

    .example .hint {
      margin: 0 0 0.75rem 0;
      font-size: 0.9rem;
      color: var(--muted);
    }

    /* Shared container styling for controlled content */
    .details {
      border: 1px solid var(--border);
      border-radius: 8px;
      background: #fff;
      overflow: hidden;
    }

    /* Native <details> styling */
    details.details > summary {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 0.9rem;
      cursor: pointer;
      user-select: none;
      font-weight: 600;
      background: #fafafa;
      border-bottom: 1px solid var(--border);
    }

    details.details > summary::-webkit-details-marker {
      display: none;
    }

    details.details > summary::before {
      content: "▸";
      font-size: 0.95rem;
      color: var(--muted);
      transition: transform 180ms ease;
    }

    details.details[open] > summary::before {
      content: "▾";
    }

    details.details .content {
      padding: 0.9rem;
    }

    /* Custom JS toggle button */
    .togglebar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
      padding: 0.75rem 0.9rem;
      background: #fafafa;
      border-bottom: 1px solid var(--border);
    }

    .togglebar .title {
      font-weight: 600;
    }

    .togglebar .actions {
      display: flex;
      gap: 0.5rem;
    }

    .btn {
      appearance: none;
      border: 1px solid var(--border);
      background: #fff;
      color: var(--text);
      border-radius: 6px;
      padding: 0.45rem 0.7rem;
      font-size: 0.95rem;
      line-height: 1;
      cursor: pointer;
    }

    .btn:hover {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
    }

    .btn[aria-expanded="true"] {
      background: #eef5ff;
      border-color: var(--accent);
      color: var(--accent-600);
    }

    .details .body {
      padding: 0.9rem;
    }

    /* CSS-only checkbox toggle */
    .checkbox-toggle {
      display: block;
      cursor: pointer;
      user-select: none;
      font-weight: 600;
      padding: 0.75rem 0.9rem;
      background: #fafafa;
      border-bottom: 1px solid var(--border);
      border-radius: 8px 8px 0 0;
    }

    .checkbox-toggle .icon {
      margin-right: 0.5rem;
      color: var(--muted);
    }

    /* Default collapsed state */
    .css-only .details {
      max-height: 0;
      opacity: 0;
      overflow: hidden;
      transition: max-height 220ms ease, opacity 180ms ease;
    }

    /* Expanded when checkbox is checked */
    .css-only input[type="checkbox"]:checked ~ .details {
      max-height: 800px; /* big enough for demo content */
      opacity: 1;
    }

    .css-only input[type="checkbox"]:checked + label .icon::before {
      content: "▾";
    }

    .css-only label .icon::before {
      content: "▸";
    }

    @media (prefers-reduced-motion: reduce) {
      .css-only .details {
        transition: none;
      }
      details.details > summary::before {
        transition: none;
      }
    }

    /* Demo content helpers */
    .list {
      margin: 0;
      padding-left: 1.25rem;
    }

    .note {
      display: inline-block;
      font-size: 0.9rem;
      color: var(--muted);
      margin-top: 0.25rem;
    }

    code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.95em;
      background: #f6f8fa;
      border: 1px solid var(--border);
      padding: 0.1rem 0.3rem;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <h1>Expand/Collapse Widgets</h1>
  <p class="lead">Three approaches: native details/summary, a JavaScript-controlled button, and a CSS-only checkbox toggle.</p>

  <div class="grid">
    <!-- Example 1: Native <details> -->
    <div class="example">
      <h2>Native details/summary</h2>
      <p class="hint">Uses the HTML <code>&lt;details&gt;</code> element; keyboard and accessibility built-in.</p>

      <details class="details">
        <summary>Project Files</summary>
        <div class="content">
          <ul class="list">
            <li>README.md</li>
            <li>index.html</li>
            <li>styles.css</li>
            <li>script.js</li>
            <li>assets/
              <ul class="list">
                <li>logo.svg</li>
                <li>hero.jpg</li>
              </ul>
            </li>
          </ul>
          <span class="note">Tip: You can toggle with Enter or Space when the summary has focus.</span>
        </div>
      </details>
    </div>

    <!-- Example 2: JavaScript-controlled -->
    <div class="example">
      <h2>Button-controlled content</h2>
      <p class="hint">A button toggles a content container. Uses <code>aria-controls</code> and <code>aria-expanded</code>.</p>

      <div class="details" id="custom-details-1" hidden>
        <div class="togglebar">
          <span class="title">Release Notes</span>
          <div class="actions">
            <button class="btn" type="button" data-toggle="collapse" data-target="custom-details-1" aria-controls="custom-details-1" aria-expanded="false">Toggle</button>
          </div>
        </div>
        <div class="body" id="custom-details-1-body">
          <h3>Version 2.4.0</h3>
          <ul class="list">
            <li>Added dark mode support</li>
            <li>Improved performance on large datasets</li>
            <li>Fixed intermittent network error handling</li>
          </ul>
          <p class="note">Click Toggle again to collapse.</p>
        </div>
      </div>

      <div style="margin-top:0.5rem;">
        <button class="btn" type="button" data-toggle="collapse" data-target="custom-details-1" aria-controls="custom-details-1" aria-expanded="false">Toggle Release Notes</button>
      </div>
    </div>

    <!-- Example 3: CSS-only checkbox toggle -->
    <div class="example css-only">
      <h2>CSS-only checkbox toggle</h2>
      <p class="hint">No JavaScript. A hidden checkbox drives the state.</p>

      <input type="checkbox" id="css-toggle-1" hidden />
      <label for="css-toggle-1" class="checkbox-toggle">
        <span class="icon" aria-hidden="true"></span>
        Frequently Asked Questions
      </label>

      <div class="details" id="css-details-1">
        <div class="body">
          <h3>FAQ</h3>
          <p><strong>Q:</strong> How do I install?<br /><strong>A:</strong> Run <code>npm install</code> in your project.</p>
          <p><strong>Q:</strong> Does it support TypeScript?<br /><strong>A:</strong> Yes, types are included.</p>
          <p><strong>Q:</strong> Can I customize themes?<br /><strong>A:</strong> Use the theme API in <code>theme.config.js</code>.</p>
          <p class="note">Toggle the checkbox label to expand or collapse.</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function () {
      function setExpanded(button, target, expanded) {
        button.setAttribute('aria-expanded', expanded ? 'true' : 'false');
        target.hidden = !expanded;
      }

      function getExpanded(button, target) {
        // Prefer explicit aria-expanded; fallback to hidden state
        const attr = button.getAttribute('aria-expanded');
        if (attr === 'true') return true;
        if (attr === 'false') return false;
        return !target.hidden;
      }

      function toggle(button, target) {
        const expanded = getExpanded(button, target);
        setExpanded(button, target, !expanded);
      }

      function initButton(button) {
        const targetId = button.getAttribute('data-target') || button.getAttribute('aria-controls');
        if (!targetId) return;
        const target = document.getElementById(targetId);
        if (!target) return;

        // Initialize: sync aria-expanded with actual visibility
        const initialExpanded = !target.hidden;
        button.setAttribute('aria-expanded', initialExpanded ? 'true' : 'false');

        button.addEventListener('click', function () {
          toggle(button, target);
        });

        // Optional: toggle with Enter/Space if not a button element
        if (button.tagName !== 'BUTTON') {
          button.setAttribute('role', 'button');
          button.setAttribute('tabindex', '0');
          button.addEventListener('keydown', function (e) {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              toggle(button, target);
            }
          });
        }
      }

      document.querySelectorAll('[data-toggle="collapse"]').forEach(initButton);

      // If multiple buttons control the same target, keep them in sync
      function syncGroup(targetId, expanded) {
        document.querySelectorAll('[data-toggle="collapse"][data-target="' + targetId + '"]').forEach(function (btn) {
          btn.setAttribute('aria-expanded', expanded ? 'true' : 'false');
        });
        document.querySelectorAll('[data-toggle="collapse"][aria-controls="' + targetId + '"]').forEach(function (btn) {
          btn.setAttribute('aria-expanded', expanded ? 'true' : 'false');
        });
      }

      // Observe hidden changes to update other buttons
      const observer = new MutationObserver(function (mutations) {
        mutations.forEach(function (m) {
          if (m.attributeName === 'hidden') {
            const target = m.target;
            const expanded = !target.hidden;
            syncGroup(target.id, expanded);
          }
        });
      });

      document.querySelectorAll('.details[id]').forEach(function (el) {
        observer.observe(el, { attributes: true, attributeFilter: ['hidden'] });
      });
    })();
  </script>
</body>
</html>