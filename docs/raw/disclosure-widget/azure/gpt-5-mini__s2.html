<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#0a74da;
      --bg:#f7f9fc;
      --panel:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --radius:8px;
      --transition:200ms ease;
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      line-height:1.4;
      color:var(--text);
      background: linear-gradient(180deg,var(--bg),#eef3fb);
      margin:2rem;
      padding:0;
    }

    h1{
      font-size:1.25rem;
      margin:0 0 1rem 0;
      color:var(--accent);
      text-align:center;
    }

    .container{
      max-width:820px;
      margin:0 auto;
      display:grid;
      gap:1rem;
    }

    /* Example wrapper */
    .example{
      background:var(--panel);
      padding:1rem;
      border-radius:var(--radius);
      box-shadow:0 1px 3px rgba(16,24,40,0.06), 0 1px 2px rgba(16,24,40,0.04);
      border:1px solid rgba(15,23,42,0.04);
    }

    /* Toggle header styles */
    .toggle {
      display:flex;
      align-items:center;
      gap:0.75rem;
      width:100%;
      background:transparent;
      border:0;
      padding:0.25rem 0.4rem;
      cursor:pointer;
      text-align:left;
      font-size:1rem;
      color:var(--text);
      border-radius:6px;
    }

    .toggle:focus{
      outline:2px solid rgba(10,116,218,0.18);
      outline-offset:2px;
    }

    .toggle .title{
      flex:1 1 auto;
      font-weight:600;
    }

    .toggle .meta{
      color:var(--muted);
      font-size:0.9rem;
      margin-left:0.5rem;
      white-space:nowrap;
    }

    .chev{
      width:1.25rem;
      height:1.25rem;
      display:inline-block;
      transition: transform var(--transition);
      transform-origin:50% 45%;
      color:var(--accent);
      flex:0 0 auto;
    }

    .chev svg{ display:block; width:100%; height:100%; }

    /* Controlled panel */
    .details{
      overflow:hidden;
      transition: max-height var(--transition), opacity var(--transition);
      max-height:0;
      opacity:0;
      margin-top:.5rem;
    }

    .details.open{
      opacity:1;
    }

    .panel-content{
      padding:0.75rem 0.35rem;
      background:linear-gradient(180deg, rgba(10,116,218,0.03), rgba(10,116,218,0.01));
      border-radius:6px;
      border:1px dashed rgba(10,116,218,0.06);
      color:#0b1220;
      font-size:0.95rem;
    }

    /* rotate chevron when expanded (uses aria-expanded on button) */
    .toggle[aria-expanded="true"] .chev{
      transform:rotate(180deg);
    }

    /* small helper */
    .hint{
      font-size:0.85rem;
      color:var(--muted);
      margin-top:0.6rem;
    }

    @media (prefers-reduced-motion: reduce) {
      .details{
        transition:none;
      }
      .chev{
        transition:none;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Expand / Collapse Widget Examples</h1>

    <!-- Example 1: collapsed by default -->
    <div class="example">
      <button class="toggle"
              aria-expanded="false"
              aria-controls="details-1"
              id="toggle-1"
              type="button">
        <span class="chev" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </span>
        <span class="title">Shipping & Delivery</span>
        <span class="meta">Policy summary</span>
      </button>

      <div id="details-1" class="details" role="region" aria-labelledby="toggle-1" data-open="false" aria-hidden="true">
        <div class="panel-content">
          <p><strong>Standard shipping:</strong> Orders typically ship within 2–3 business days. Transit times vary by destination.</p>
          <p><strong>Expedited:</strong> Available at checkout for eligible addresses.</p>
          <p class="hint">Tip: Use the keyboard to focus the toggle and press Enter or Space to open/close.</p>
        </div>
      </div>
    </div>

    <!-- Example 2: expanded by default -->
    <div class="example">
      <button class="toggle"
              aria-expanded="true"
              aria-controls="details-2"
              id="toggle-2"
              type="button">
        <span class="chev" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </span>
        <span class="title">Frequently Asked Questions</span>
        <span class="meta">4 items</span>
      </button>

      <div id="details-2" class="details" role="region" aria-labelledby="toggle-2" data-open="true" aria-hidden="false">
        <div class="panel-content">
          <p><strong>Q:</strong> Can I return an item?<br><strong>A:</strong> Yes — returns are accepted within 30 days of delivery for most items.</p>
          <p><strong>Q:</strong> How do I track my order?<br><strong>A:</strong> You'll receive a tracking link via email once your order ships.</p>
          <ul>
            <li>Contact support for international returns.</li>
            <li>Refunds processed within 5–7 business days after we receive the item.</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Example 3: a compact widget -->
    <div class="example">
      <button class="toggle"
              aria-expanded="false"
              aria-controls="details-3"
              id="toggle-3"
              type="button">
        <span class="chev" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </span>
        <span class="title">Release notes</span>
        <span class="meta">v2.1.0</span>
      </button>

      <div id="details-3" class="details" role="region" aria-labelledby="toggle-3" data-open="false" aria-hidden="true">
        <div class="panel-content">
          <p>Minor bug fixes and performance improvements. See the changelog for full details.</p>
        </div>
      </div>
    </div>

  </div>

  <script>
    (function () {
      // Utility to set open/closed state with animation
      function setOpenState(button, panel, open, animate = true) {
        button.setAttribute('aria-expanded', open ? 'true' : 'false');
        panel.setAttribute('aria-hidden', open ? 'false' : 'true');

        // If user prefers reduced motion, don't animate.
        var reduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

        if (!animate || reduce) {
          if (open) {
            panel.classList.add('open');
            panel.style.maxHeight = null;
          } else {
            panel.classList.remove('open');
            panel.style.maxHeight = '0px';
          }
          return;
        }

        if (open) {
          // Measure content's full height
          panel.classList.add('open');
          // Temporarily set to auto to measure
          panel.style.maxHeight = '0px';
          var full = panel.scrollHeight;
          // Force a reflow so the transition happens
          void panel.offsetHeight;
          panel.style.maxHeight = full + 'px';
          // After transition, clear inline max-height to allow content growth
          var onTransitionEnd = function () {
            panel.style.maxHeight = null;
            panel.removeEventListener('transitionend', onTransitionEnd);
          };
          panel.addEventListener('transitionend', onTransitionEnd);
        } else {
          // Closing: set maxHeight to current pixel height then to 0
          var cur = panel.scrollHeight;
          panel.style.maxHeight = cur + 'px';
          // Force reflow
          void panel.offsetHeight;
          panel.style.maxHeight = '0px';
          panel.addEventListener('transitionend', function handler() {
            panel.classList.remove('open');
            panel.removeEventListener('transitionend', handler);
          });
        }
      }

      // Initialize widgets
      function init() {
        var toggles = document.querySelectorAll('.example .toggle');
        toggles.forEach(function (btn) {
          var id = btn.getAttribute('aria-controls');
          if (!id) return;
          var panel = document.getElementById(id);
          if (!panel) return;

          // Set initial visual state based on data-open or aria-expanded
          var dataOpen = panel.getAttribute('data-open');
          var isOpen = (dataOpen === 'true') || (btn.getAttribute('aria-expanded') === 'true');

          // Prepare panel for animation
          panel.classList.remove('open');
          panel.style.overflow = 'hidden';

          if (isOpen) {
            // Expand instantly (no animation on load)
            panel.classList.add('open');
            panel.style.maxHeight = null;
            panel.setAttribute('aria-hidden', 'false');
            btn.setAttribute('aria-expanded', 'true');
          } else {
            panel.style.maxHeight = '0px';
            panel.setAttribute('aria-hidden', 'true');
            btn.setAttribute('aria-expanded', 'false');
          }

          // Click handler
          btn.addEventListener('click', function () {
            var currentlyOpen = btn.getAttribute('aria-expanded') === 'true';
            setOpenState(btn, panel, !currentlyOpen, true);
          });

          // Support keyboard activation on Enter/Space is native for <button>,
          // but support Home/End to expand/collapse all within same example group
          btn.addEventListener('keydown', function (e) {
            if (e.key === 'Home') {
              e.preventDefault();
              setOpenState(btn, panel, true);
            } else if (e.key === 'End') {
              e.preventDefault();
              setOpenState(btn, panel, false);
            }
          });
        });
      }

      // Wait for fonts and layout to settle to measure heights correctly
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
    })();
  </script>
</body>
</html>