<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --bg:#f7f8fb;
      --card:#ffffff;
      --accent:#0b6efd;
      --muted:#6b7280;
      --border:#e6e9ef;
      --radius:10px;
    }
    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,var(--bg),#ffffff 40%);
      margin: 32px;
      color:#0f172a;
      line-height:1.4;
    }
    h1{
      margin:0 0 18px;
      font-size:20px;
      color:#0b1726;
    }
    p.lead{
      margin:0 0 22px;
      color:var(--muted);
    }

    /* example wrapper */
    .example{
      background:var(--card);
      border:1px solid var(--border);
      padding:16px;
      border-radius:var(--radius);
      margin-bottom:16px;
      box-shadow: 0 1px 0 rgba(11,13,23,0.03);
    }

    /* Toggle button */
    .toggle{
      display:flex;
      align-items:center;
      justify-content:space-between;
      width:100%;
      padding:12px 14px;
      font-size:15px;
      background:transparent;
      border:1px solid transparent;
      cursor:pointer;
      border-radius:8px;
      color: #08122a;
    }
    .toggle:focus{
      outline:3px solid rgba(11,110,253,0.12);
      border-color: rgba(11,110,253,0.12);
    }
    .toggle .title{
      display:flex;
      gap:12px;
      align-items:center;
    }
    .toggle .icon{
      width:18px;
      height:18px;
      display:inline-block;
      transition: transform .22s ease;
      color:var(--accent);
    }
    .toggle[aria-expanded="true"] .icon{
      transform: rotate(90deg);
    }
    .summary{
      color:var(--muted);
      font-size:13px;
    }

    /* controlled content */
    .details{
      margin-top:10px;
      overflow:hidden;
      max-height:0;
      transition: max-height .26s cubic-bezier(.2,.9,.2,1);
      border-radius:8px;
    }
    .details.open{
      /* max-height will be set inline to match content */
    }
    .panel{
      padding:14px;
      background:linear-gradient(180deg, rgba(10,24,42,0.02), rgba(255,255,255,0));
      border:1px solid var(--border);
      border-radius:8px;
    }
    .muted{
      color:var(--muted);
      font-size:14px;
    }

    /* form inside details */
    .sample-form{
      display:flex;
      gap:8px;
      margin-top:8px;
      flex-wrap:wrap;
    }
    .sample-form input[type="text"]{
      padding:8px 10px;
      border:1px solid var(--border);
      border-radius:6px;
      min-width:160px;
    }
    .sample-form button{
      padding:8px 12px;
      border-radius:6px;
      border:0;
      background:var(--accent);
      color:white;
      cursor:pointer;
    }

    /* Accessibility: respect reduced motion */
    @media (prefers-reduced-motion: reduce){
      .details{ transition: none; }
      .toggle .icon{ transition:none; }
    }
  </style>
</head>
<body>
  <h1>Expand / Collapse Widget Demo</h1>
  <p class="lead">Each widget is wrapped in a container with class="example". The content containers have class="details". Use the buttons to toggle visibility.</p>

  <div class="example">
    <button class="toggle" aria-expanded="false" aria-controls="details-1" id="toggle-1">
      <span class="title">
        <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false">
          <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <strong>Basic info</strong>
      </span>
      <span class="summary">Click to view short description</span>
    </button>

    <div class="details" id="details-1" aria-hidden="true">
      <div class="panel">
        <p class="muted">This is a simple expand/collapse panel. The button controls the visibility using aria-expanded and aria-controls. The content area has the class "details".</p>
      </div>
    </div>
  </div>

  <div class="example">
    <button class="toggle" aria-expanded="false" aria-controls="details-2" id="toggle-2">
      <span class="title">
        <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <strong>More options</strong>
      </span>
      <span class="summary">Contains interactive content</span>
    </button>

    <div class="details" id="details-2" aria-hidden="true">
      <div class="panel">
        <p class="muted">This panel contains some interactive controls â€” links and a small form. Keyboard users can tab into these when the panel is open.</p>
        <div class="sample-form">
          <input type="text" placeholder="Your name" />
          <button type="button">Save</button>
          <a href="#" style="align-self:center; color:var(--accent); text-decoration:none;">Learn more</a>
        </div>
      </div>
    </div>
  </div>

  <div class="example">
    <button class="toggle" aria-expanded="true" aria-controls="details-3" id="toggle-3">
      <span class="title">
        <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <strong>Initially expanded</strong>
      </span>
      <span class="summary">Open by default</span>
    </button>

    <div class="details open" id="details-3" aria-hidden="false">
      <div class="panel">
        <p class="muted">This example begins opened. The script on the page will measure and allow a smooth transition between open and closed states.</p>
      </div>
    </div>
  </div>

  <script>
    (function(){
      // Utility to toggle a details element (with smooth height transition)
      function openDetails(details){
        details.classList.add('open');
        details.setAttribute('aria-hidden', 'false');

        // set explicit max-height to enable transition to full height
        var full = details.scrollHeight + 'px';
        details.style.maxHeight = full;

        // After transition, remove inline max-height to allow content resize naturally
        function onEnd(){
          details.style.maxHeight = '';
          details.removeEventListener('transitionend', onEnd);
        }
        details.addEventListener('transitionend', onEnd);
      }

      function closeDetails(details){
        // set current height as starting point for transition
        var cur = details.scrollHeight + 'px';
        details.style.maxHeight = cur;

        // force reflow
        details.getBoundingClientRect();

        // then set to 0
        details.style.maxHeight = '0px';
        details.setAttribute('aria-hidden', 'true');

        // when transition finishes, remove open class
        function onEnd(){
          details.classList.remove('open');
          details.removeEventListener('transitionend', onEnd);
        }
        details.addEventListener('transitionend', onEnd);
      }

      // Initialize: find all toggles
      var toggles = document.querySelectorAll('.toggle');
      toggles.forEach(function(btn, index){
        var targetId = btn.getAttribute('aria-controls');
        var details = document.getElementById(targetId);
        if(!details) return;

        // Setup initial state according to aria-expanded
        var expanded = btn.getAttribute('aria-expanded') === 'true';
        if(expanded){
          // ensure open class and visible
          details.classList.add('open');
          details.setAttribute('aria-hidden','false');
          details.style.maxHeight = details.scrollHeight + 'px';
          // remove explicit max-height after a tick to allow natural height
          setTimeout(function(){
            details.style.maxHeight = '';
          }, 300);
        } else {
          details.classList.remove('open');
          details.setAttribute('aria-hidden','true');
          details.style.maxHeight = '0px';
        }

        // Click handler
        btn.addEventListener('click', function(){
          var isExpanded = btn.getAttribute('aria-expanded') === 'true';
          if(isExpanded){
            btn.setAttribute('aria-expanded','false');
            closeDetails(details);
          } else {
            btn.setAttribute('aria-expanded','true');
            openDetails(details);
          }
        });

        // Optional: allow Enter/Space handled by button automatically
      });

      // Update open panels on resize to accommodate content changes
      var resizeTimer;
      window.addEventListener('resize', function(){
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(function(){
          document.querySelectorAll('.details.open').forEach(function(details){
            // If inline maxHeight is empty, reapply to match new content height during resize
            if(!details.style.maxHeight){
              details.style.maxHeight = details.scrollHeight + 'px';
              // remove it shortly after so content can grow/shrink naturally
              setTimeout(function(){ details.style.maxHeight = ''; }, 200);
            }
          });
        }, 120);
      });

    })();
  </script>
</body>
</html>