<html class="no-js">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand/Collapse Widget Example</title>
  <style>
    :root{
      --bg:#f7f9fc;
      --card:#ffffff;
      --accent:#0366d6;
      --muted:#6b7280;
      --border:#e6eef8;
      --radius:8px;
    }

    html,body{
      height:100%;
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:linear-gradient(180deg,var(--bg),#eef6ff 120px);
      color:#0f172a;
    }

    main{
      max-width:800px;
      margin:48px auto;
      padding:20px;
    }

    h1{
      margin:0 0 18px 0;
      font-size:20px;
      color:#0b1220;
    }

    .example{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:16px;
      box-shadow: 0 6px 18px rgba(7,22,48,0.06);
      margin:18px 0;
    }

    .toggle{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 14px;
      background:transparent;
      border:1px solid var(--border);
      border-radius:8px;
      cursor:pointer;
      font-weight:600;
      color:var(--accent);
      transition:background .15s ease, box-shadow .15s ease, transform .06s ease;
    }

    .toggle:active{ transform:translateY(1px); }
    .toggle:focus{ outline:3px solid rgba(3,102,214,.12); outline-offset:2px; }

    .toggle .caret{
      width:12px;
      height:12px;
      display:inline-block;
      transition:transform .2s ease;
      transform-origin:center;
      border-right:2px solid currentColor;
      border-bottom:2px solid currentColor;
      transform:rotate(-45deg);
      margin-top:2px;
    }

    .details{
      margin-top:12px;
      overflow:hidden;
      transition:max-height .28s cubic-bezier(.2,.9,.2,1);
      will-change:max-height;
      /* When JS is enabled, details are collapsed by default; the script sets aria-hidden. */
    }

    /* When JS is enabled (we add class 'js' to html), hide details initially (aria-hidden="true") */
    html.js .details[aria-hidden="true"]{
      max-height:0;
    }

    /* Visual open state for the caret */
    .open-toggle .caret{
      transform:rotate(45deg);
    }

    .details-inner{
      padding:12px 6px;
      border-radius:6px;
      background:linear-gradient(180deg, rgba(3,102,214,0.03), rgba(3,102,214,0.01));
      border:1px solid rgba(3,102,214,0.04);
    }

    p{ margin:0 0 10px 0; color:var(--muted); line-height:1.45; }
    code{ background:#eef6ff; padding:2px 6px; border-radius:4px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace; font-size:92%; }
    .meta{ font-size:13px; color:var(--muted); margin-top:8px; }
  </style>
  <script>
    // Indicate JS is available
    document.documentElement.classList.remove('no-js');
    document.documentElement.classList.add('js');
    // Small helper to initialize after DOM is parsed
    document.addEventListener('DOMContentLoaded', function () {
      // Single expand/collapse widget
      var toggle = document.getElementById('toggle-1');
      var details = document.getElementById('details-1');

      // Ensure initial ARIA state (collapsed)
      details.setAttribute('aria-hidden','true');
      toggle.setAttribute('aria-expanded','false');

      // Keep transition consistent
      details.style.transition = 'max-height 280ms cubic-bezier(.2,.9,.2,1)';

      // When expanded fully, clear maxHeight so content can grow naturally
      details.addEventListener('transitionend', function (e) {
        if (e.propertyName !== 'max-height') return;
        if (toggle.getAttribute('aria-expanded') === 'true') {
          // Allow content to size naturally after animation completes
          details.style.maxHeight = 'none';
        }
      });

      function open() {
        // Ensure we have a numeric max-height to animate from
        var startHeight = details.scrollHeight;
        details.style.maxHeight = startHeight + 'px';
        // Force a reflow so the next changes animate
        details.getBoundingClientRect();
        // Mark open
        details.setAttribute('aria-hidden','false');
        toggle.setAttribute('aria-expanded','true');
        toggle.classList.add('open-toggle');
        toggle.querySelector('.label').textContent = 'Hide details';
      }

      function close() {
        // If maxHeight is 'none', compute the current full height first
        var fullHeight = details.scrollHeight;
        details.style.maxHeight = fullHeight + 'px';
        // Force a reflow, then collapse to 0
        requestAnimationFrame(function () {
          details.style.maxHeight = '0';
        });
        details.setAttribute('aria-hidden','true');
        toggle.setAttribute('aria-expanded','false');
        toggle.classList.remove('open-toggle');
        toggle.querySelector('.label').textContent = 'Show details';
      }

      toggle.addEventListener('click', function () {
        var expanded = toggle.getAttribute('aria-expanded') === 'true';
        if (expanded) close(); else open();
      });

      // Example: allow linking to open via hash (#details-1)
      if (location.hash === '#details-1') {
        // open immediately (set maxHeight explicitly so transition won't animate on load)
        details.style.maxHeight = details.scrollHeight + 'px';
        details.setAttribute('aria-hidden','false');
        toggle.setAttribute('aria-expanded','true');
        toggle.classList.add('open-toggle');
        toggle.querySelector('.label').textContent = 'Hide details';
        // remove the inline maxHeight after a tick so it can transition later
        requestAnimationFrame(function(){ details.style.maxHeight = 'none'; });
      }
    });
  </script>
</head>
<body>
  <main>
    <h1>Expand / Collapse Widget</h1>

    <div class="example">
      <button id="toggle-1" class="toggle" aria-controls="details-1" aria-expanded="false" type="button">
        <span class="caret" aria-hidden="true"></span>
        <span class="label">Show details</span>
      </button>

      <div id="details-1" class="details" role="region" aria-labelledby="toggle-1">
        <div class="details-inner">
          <p>This is the detailed content that the widget controls. It is wrapped in a container with the class <code>details</code>. The button above toggles visibility of this block while keeping ARIA attributes in sync (<code>aria-expanded</code> on the button and <code>aria-hidden</code> on this container).</p>
          <p>Use this pattern to hide optional information, reveal examples, or provide progressive disclosure in forms and documentation. The widget supports animated transitions and preserves accessibility for keyboard and assistive technology users.</p>
          <div class="meta">Tip: try focusing the button and pressing Space or Enter to toggle.</div>
        </div>
      </div>
    </div>

  </main>
</body>
</html>