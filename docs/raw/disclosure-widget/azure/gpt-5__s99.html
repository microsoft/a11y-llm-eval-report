<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Expand/Collapse Widgets Demo</title>
<style>
  :root { color-scheme: light dark; }
  body {
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    line-height: 1.5;
    margin: 0;
    padding: 2rem;
    background: Canvas;
    color: CanvasText;
  }
  h1 { font-size: 1.5rem; margin: 0 0 1rem; }
  .example {
    border: 1px solid #c8c8c8;
    padding: 1rem;
    border-radius: 0.5rem;
    margin-block: 1rem;
    background: #f8f8f8;
  }
  .example h2 { font-size: 1.1rem; margin: 0 0 0.5rem; }

  /* Native details styling */
  .details summary {
    cursor: pointer;
    list-style: none;
    position: relative;
    padding-inline-start: 1.5rem;
  }
  .details summary::marker { content: ""; }
  .details summary::before {
    content: "▸";
    position: absolute;
    left: 0;
    transition: transform 200ms ease;
  }
  .details[open] summary::before { transform: rotate(90deg); }
  .details .content { padding-inline-start: 1.5rem; }
  .details > * { margin-block: 0.5rem; }

  /* Custom toggle panel */
  button.toggle {
    appearance: none;
    border: 1px solid #c8c8c8;
    background: #f1f1f1;
    color: inherit;
    border-radius: 0.4rem;
    padding: 0.5rem 0.75rem;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
  }
  .toggle .chev {
    transition: transform 200ms ease;
    display: inline-block;
  }
  .toggle[aria-expanded="true"] .chev { transform: rotate(90deg); }

  .details[hidden] { display: none; }
  .details.panel {
    border-left: 3px solid #c8c8c8;
    margin-top: 0.5rem;
    padding-left: 0.75rem;
  }

  /* Accordion group demo */
  .accordion .details { border-top: 1px solid #ddd; }
  .accordion button.toggle {
    width: 100%;
    text-align: left;
    border: none;
    border-radius: 0;
    background: transparent;
    padding: 0.75rem 0;
  }
  .accordion .details.panel {
    padding-left: 0;
    margin-top: 0;
    padding-bottom: 0.75rem;
  }
</style>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const toggles = document.querySelectorAll('button.toggle[aria-controls]');
    toggles.forEach(btn => {
      const panelId = btn.getAttribute('aria-controls');
      const panel = document.getElementById(panelId);
      if (!panel) return;

      // Initialize hidden state based on aria-expanded
      const expanded = btn.getAttribute('aria-expanded') === 'true';
      panel.hidden = !expanded;

      btn.addEventListener('click', () => {
        const isExpanded = btn.getAttribute('aria-expanded') === 'true';
        btn.setAttribute('aria-expanded', String(!isExpanded));
        panel.hidden = isExpanded;
      });

      panel.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          btn.setAttribute('aria-expanded', 'false');
          panel.hidden = true;
          btn.focus();
        }
      });
    });

    // Accordion behavior: only one open at a time inside data-accordion
    document.querySelectorAll('[data-accordion]').forEach(group => {
      const groupButtons = group.querySelectorAll('button.toggle[aria-controls]');
      groupButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          const currentExpanded = btn.getAttribute('aria-expanded') === 'true';
          if (!currentExpanded) {
            groupButtons.forEach(other => {
              if (other !== btn) {
                const pid = other.getAttribute('aria-controls');
                const panel = document.getElementById(pid);
                if (panel) {
                  other.setAttribute('aria-expanded', 'false');
                  panel.hidden = true;
                }
              }
            });
          }
        });
      });
    });
  });
</script>
</head>
<body>
  <h1>Expand/Collapse Widgets</h1>
  <p>Examples of native and custom expand/collapse controls.</p>

  <div class="example">
    <h2>Native details/summary</h2>
    <details class="details">
      <summary>What is an expand/collapse widget?</summary>
      <div class="content">
        <p>An expand/collapse widget lets users reveal or hide additional information on demand, helping reduce visual clutter.</p>
        <ul>
          <li>Uses the HTML details/summary elements.</li>
          <li>Works without JavaScript.</li>
          <li>Accessible by default with keyboard and screen readers.</li>
        </ul>
      </div>
    </details>
  </div>

  <div class="example">
    <h2>Custom button controls panel</h2>
    <button id="panel-one-btn" type="button" class="toggle" aria-expanded="false" aria-controls="panel-one">
      <span class="chev" aria-hidden="true">▸</span>
      Show more about accessibility
    </button>
    <div id="panel-one" class="details panel" role="region" aria-labelledby="panel-one-btn" hidden>
      <p>When building a custom expand/collapse, ensure the button uses aria-expanded and aria-controls, and the controlled content is toggled with the hidden attribute.</p>
      <p>Provide keyboard support and manage focus for a usable experience.</p>
    </div>
  </div>

  <div class="example accordion" data-accordion>
    <h2>Accordion (only one section open)</h2>

    <button id="acc-btn-1" type="button" class="toggle" aria-expanded="true" aria-controls="acc-panel-1">
      <span class="chev" aria-hidden="true">▸</span>
      General Information
    </button>
    <div id="acc-panel-1" class="details panel" role="region" aria-labelledby="acc-btn-1">
      <p>This section starts expanded. Clicking another header will collapse it.</p>
    </div>

    <button id="acc-btn-2" type="button" class="toggle" aria-expanded="false" aria-controls="acc-panel-2">
      <span class="chev" aria-hidden="true">▸</span>
      Requirements
    </button>
    <div id="acc-panel-2" class="details panel" role="region" aria-labelledby="acc-btn-2" hidden>
      <ul>
        <li>Wrap each widget in a container with an example class.</li>
        <li>Use a details class on the content container.</li>
        <li>Ensure proper ARIA when not using native details/summary.</li>
      </ul>
    </div>

    <button id="acc-btn-3" type="button" class="toggle" aria-expanded="false" aria-controls="acc-panel-3">
      <span class="chev" aria-hidden="true">▸</span>
      Tips
    </button>
    <div id="acc-panel-3" class="details panel" role="region" aria-labelledby="acc-btn-3" hidden>
      <p>Use clear labels, respect user preferences, and avoid hiding critical information behind collapsible panels.</p>
    </div>
  </div>

  <div class="example">
    <h2>Nested content inside native details</h2>
    <details class="details">
      <summary>Frequently Asked Questions</summary>
      <div class="content">
        <details class="details">
          <summary>Can I nest collapsible sections?</summary>
          <div class="content">
            <p>Yes. Native details elements can be nested, though keep the hierarchy simple to avoid confusion.</p>
          </div>
        </details>

        <details class="details">
          <summary>Will this work without JavaScript?</summary>
          <div class="content">
            <p>Native details/summary works without JavaScript. Custom panels use minimal JavaScript to toggle visibility.</p>
          </div>
        </details>
      </div>
    </details>
  </div>

  <footer>
    <p>Demo complete.</p>
  </footer>
</body>
</html>