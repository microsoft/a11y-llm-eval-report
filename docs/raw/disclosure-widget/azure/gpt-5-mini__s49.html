<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root{
      --bg:#fafafa;
      --card:#fff;
      --muted:#666;
      --accent:#0b73ff;
      --radius:8px;
      --transition:200ms cubic-bezier(.2,.9,.3,1);
    }
    html,body{
      height:100%;
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:linear-gradient(180deg,#f3f7fb 0%,var(--bg) 100%);
      color:#111;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    .page{
      max-width:900px;
      margin:48px auto;
      padding:24px;
    }
    h1{
      margin:0 0 12px 0;
      font-size:20px;
      letter-spacing:0.2px;
    }
    p.lead{
      margin:0 0 24px 0;
      color:var(--muted);
      font-size:14px;
    }

    /* Example wrapper */
    .example{
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:0 1px 0 rgba(16,24,40,0.04), 0 8px 24px rgba(11,19,42,0.06);
      padding:16px;
      margin:16px 0;
    }

    /* Button styling */
    .disclosure{
      display:flex;
      align-items:center;
      width:100%;
      gap:12px;
      padding:12px 14px;
      border-radius:8px;
      background:linear-gradient(180deg, #ffffff 0%, #fbfdff 100%);
      border:1px solid rgba(16,24,40,0.04);
      cursor:pointer;
      transition:box-shadow var(--transition), transform var(--transition);
      font-size:15px;
      color: #0f1724;
      text-align:left;
    }
    .disclosure:focus{
      outline:none;
      box-shadow:0 6px 20px rgba(11,115,255,0.12);
      transform:translateY(-1px);
    }
    .disclosure .label{
      flex:1 1 auto;
    }
    .disclosure .meta{
      color:var(--muted);
      font-size:13px;
    }
    .icon{
      width:18px;
      height:18px;
      display:inline-block;
      transition:transform var(--transition);
      flex:0 0 18px;
      color:var(--accent);
    }
    .icon svg{ display:block; width:100%; height:100%; }

    /* Controlled content container that must have class "details" */
    .details{
      overflow:hidden;
      margin-top:12px;
      border-radius:8px;
      background:linear-gradient(180deg,#fbfdff 0%, #ffffff 100%);
      border:1px solid rgba(11,19,42,0.04);
      transition:box-shadow var(--transition);
    }
    .details .inner{
      padding:12px 14px;
      color:#17203a;
      line-height:1.5;
      font-size:14px;
    }

    /* Collapsed state */
    .details[aria-hidden="true"]{
      box-shadow:none;
    }
    .details[aria-hidden="false"]{
      box-shadow:0 10px 30px rgba(11,19,42,0.06);
    }

    /* Rotations for expanded icon */
    .disclosure[aria-expanded="true"] .icon{
      transform:rotate(180deg);
    }

    /* Small helper styles for demos */
    .note{
      font-size:13px;
      color:var(--muted);
      margin-top:10px;
    }

    /* For keyboard focus ring on inner interactive elements */
    button, [role="button"] { font: inherit; }

    /* Accessibility: hide element from visual flow but keep for screen readers (for demo) */
    .sr-only{
      position:absolute !important;
      width:1px !important;
      height:1px !important;
      padding:0!important;
      margin:-1px!important;
      overflow:hidden!important;
      clip:rect(0,0,0,0)!important;
      white-space:nowrap!important;
      border:0!important;
    }

  </style>
</head>
<body>
  <div class="page">
    <h1>Expand / Collapse Widget Examples</h1>
    <p class="lead">Two accessible examples of an expand/collapse widget. Each widget is wrapped in a container with class "example" and the controlled content container uses the class "details".</p>

    <!-- Example 1: Simple disclosure -->
    <div class="example" data-example="simple">
      <button class="disclosure"
              aria-expanded="false"
              aria-controls="details-1"
              id="btn-1">
        <span class="icon" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </span>
        <span class="label">Show additional information</span>
        <span class="meta">Click to expand</span>
      </button>

      <div id="details-1" class="details" aria-hidden="true" style="max-height:0">
        <div class="inner">
          <p>This is the controlled content for the simple disclosure example. It is placed inside a container with the class "details". The widget updates aria-expanded on the button and aria-hidden on this container.</p>
          <p class="note">Keyboard: Enter or Space to toggle; Escape to close when open.</p>
        </div>
      </div>
    </div>

    <!-- Example 2: Accordion-like item -->
    <div class="example" data-example="accordion">
      <button class="disclosure"
              aria-expanded="false"
              aria-controls="details-2"
              id="btn-2">
        <span class="icon" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </span>
        <span class="label">More about accessibility</span>
        <span class="meta">Accessible pattern</span>
      </button>

      <div id="details-2" class="details" aria-hidden="true" style="max-height:0">
        <div class="inner">
          <p>Accordions and disclosure widgets should expose the expanded state to assistive technology. This container has the "details" class as required. Animations are implemented in a way that preserves accessibility: we toggle aria-hidden rather than relying purely on CSS that might hide content from screen readers.</p>
          <ul>
            <li>Use aria-expanded on the controlling element.</li>
            <li>Use aria-hidden on the controlled container.</li>
            <li>Give the controlled container an id and reference it with aria-controls.</li>
          </ul>
        </div>
      </div>
    </div>

  </div>

  <script>
    (function(){
      // Utility to animate open/close by setting max-height from 0 to scrollHeight
      function openDetails(details){
        details.setAttribute('aria-hidden','false');
        // remove any inline transition-friendly max-height first to compute scrollHeight
        details.style.maxHeight = '0px';
        var contentHeight = details.scrollHeight;
        // allow the browser to register the change
        requestAnimationFrame(function(){
          details.style.transition = 'max-height 240ms cubic-bezier(.2,.9,.3,1)';
          details.style.maxHeight = contentHeight + 'px';
        });
        // Clean up inline max-height after transition so it can grow/shrink naturally
        details.addEventListener('transitionend', function handler(e){
          if(e.propertyName === 'max-height'){
            details.style.maxHeight = 'none';
            details.removeEventListener('transitionend', handler);
          }
        });
      }

      function closeDetails(details){
        // To animate from natural height, set max-height to current pixel height, then to 0
        var currentHeight = details.scrollHeight;
        details.style.maxHeight = currentHeight + 'px';
        // Force reflow so the starting max-height is applied
        details.getBoundingClientRect();
        requestAnimationFrame(function(){
          details.style.transition = 'max-height 180ms cubic-bezier(.2,.9,.3,1)';
          details.style.maxHeight = '0px';
        });
        details.addEventListener('transitionend', function handler(e){
          if(e.propertyName === 'max-height'){
            details.setAttribute('aria-hidden','true');
            details.removeEventListener('transitionend', handler);
            // keep max-height at 0 for collapsed state
          }
        });
      }

      // Toggle handler
      function toggle(event){
        var btn = event.currentTarget;
        var targetId = btn.getAttribute('aria-controls');
        if(!targetId) return;
        var details = document.getElementById(targetId);
        if(!details) return;

        var expanded = btn.getAttribute('aria-expanded') === 'true';

        if(expanded){
          btn.setAttribute('aria-expanded','false');
          closeDetails(details);
        } else {
          btn.setAttribute('aria-expanded','true');
          openDetails(details);
          // If multiple accordion items should close others, that logic would go here.
        }
      }

      // Attach to all disclosure buttons
      var buttons = document.querySelectorAll('.disclosure[aria-controls]');
      buttons.forEach(function(btn){
        var target = document.getElementById(btn.getAttribute('aria-controls'));
        if(target){
          // Ensure aria-hidden is explicit (already set in markup, but enforce)
          if(!target.hasAttribute('aria-hidden')){
            target.setAttribute('aria-hidden', 'true');
            target.style.maxHeight = '0';
          }
        }

        btn.addEventListener('click', toggle);

        // Keyboard support: Enter/Space toggles; Escape closes if open.
        btn.addEventListener('keydown', function(e){
          // Space or Enter activates
          if(e.key === ' ' || e.key === 'Spacebar' || e.key === 'Enter'){
            e.preventDefault();
            btn.click();
          }
          // Escape closes the panel if open
          if(e.key === 'Escape' || e.key === 'Esc'){
            var tid = btn.getAttribute('aria-controls');
            var det = document.getElementById(tid);
            if(det && btn.getAttribute('aria-expanded') === 'true'){
              btn.setAttribute('aria-expanded','false');
              closeDetails(det);
              btn.focus();
            }
          }
        });
      });

      // Close details when clicking outside (optional, keeps simple behavior)
      document.addEventListener('click', function(e){
        // If click is within a disclosure or details, do nothing
        if(e.target.closest('.example')) return;
        // close any open details
        buttons.forEach(function(btn){
          var tid = btn.getAttribute('aria-controls');
          var det = document.getElementById(tid);
          if(det && btn.getAttribute('aria-expanded') === 'true'){
            btn.setAttribute('aria-expanded','false');
            closeDetails(det);
          }
        });
      });
    })();
  </script>
</body>
</html>