<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --brand:#0366d6;
      --bg:#f7f9fc;
      --card:#ffffff;
      --muted:#6b7280;
      --radius:8px;
      --transition:200ms cubic-bezier(.2,.8,.2,1);
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      margin: 24px;
      background: linear-gradient(180deg,var(--bg),#fff);
      color: #111827;
      line-height: 1.45;
    }

    h1{font-size:1.4rem; margin:0 0 12px 0}
    p.lead{margin:0 0 18px 0; color:var(--muted)}

    .container{
      max-width: 820px;
      margin: 0 auto;
    }

    .example{
      background:var(--card);
      border: 1px solid rgba(15,23,42,0.06);
      padding: 16px;
      border-radius: var(--radius);
      box-shadow: 0 1px 2px rgba(15,23,42,0.03);
      margin-bottom: 16px;
    }

    .example h2{font-size:1rem; margin:0 0 8px 0}
    .controls{
      display:flex;
      gap:12px;
      align-items:center;
      margin-bottom:8px;
    }

    .toggle-btn{
      appearance:none;
      -webkit-appearance:none;
      border:1px solid rgba(15,23,42,0.08);
      background:#fff;
      color:var(--brand);
      padding:8px 12px;
      border-radius:6px;
      font-weight:600;
      cursor:pointer;
      display:inline-flex;
      gap:8px;
      align-items:center;
      transition: box-shadow var(--transition), transform var(--transition);
    }
    .toggle-btn:focus{
      outline: none;
      box-shadow: 0 0 0 4px rgba(3,102,214,0.12);
    }
    .toggle-btn[aria-expanded="true"]{
      background: linear-gradient(180deg,#f0f8ff,#fff);
      transform: translateY(-1px);
    }

    /* Controlled content area */
    .details{
      overflow: hidden;
      max-height: 0px; /* collapsed by default */
      transition: max-height var(--transition), opacity var(--transition);
      opacity: 0;
      border-radius: 6px;
      border: 1px solid rgba(15,23,42,0.04);
      padding: 0 12px;
      box-sizing: border-box;
    }

    .details.open{
      opacity: 1;
      /* max-height will be set dynamically via JS for smooth animation */
      padding-top: 12px;
      padding-bottom: 12px;
    }

    .details-content{
      font-size: 0.95rem;
      color:#111827;
    }

    .muted{
      color: var(--muted);
      font-size: 0.9rem;
    }

    /* small helper styles for demo content */
    .item-list{
      margin:0;
      padding:0 0 0 18px;
    }

    .code{
      display:inline-block;
      background:#0f1724;
      color:#dbeafe;
      padding:4px 8px;
      border-radius:6px;
      font-family: monospace;
      font-size:0.85rem;
    }

    .hint{font-size:0.85rem; color:var(--muted); margin-top:8px;}
  </style>
</head>
<body>
  <div class="container">
    <h1>Expand / Collapse Widget Examples</h1>
    <p class="lead">Each widget below demonstrates an accessible expand/collapse pattern. Controlled content containers use the <span class="code">details</span> class.</p>

    <!-- Example 1: Simple toggle -->
    <div class="example">
      <h2>Simple Toggle</h2>
      <div class="controls">
        <button class="toggle-btn" aria-expanded="false" aria-controls="details-1" id="toggle-1">
          ▶ Show details
        </button>
        <span class="muted">Click the button to expand/collapse</span>
      </div>
      <div class="details" id="details-1" role="region" aria-labelledby="toggle-1" aria-hidden="true">
        <div class="details-content">
          <p>This is a simple example of an expandable region. It uses a button with <code>aria-expanded</code> and a controlled content container with the <code>details</code> class.</p>
          <ul class="item-list">
            <li>Accessible: button updates <code>aria-expanded</code>.</li>
            <li>Animated: smooth height transition when opening/closing.</li>
            <li>Keyboard support: native button keys (Enter/Space) toggle state.</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Example 2: Initially open -->
    <div class="example">
      <h2>Initially open</h2>
      <div class="controls">
        <button class="toggle-btn" aria-expanded="true" aria-controls="details-2" id="toggle-2">
          ▼ Hide content
        </button>
        <span class="muted">This one starts open</span>
      </div>
      <div class="details open" id="details-2" role="region" aria-labelledby="toggle-2" aria-hidden="false">
        <div class="details-content">
          <p>Content is visible by default. The JavaScript will set an inline max-height to allow a smooth transition if the user collapses it.</p>
          <p class="hint">Tip: You can include any markup inside a <span class="code">details</span> container — text, images, forms, etc.</p>
        </div>
      </div>
    </div>

    <!-- Example 3: Nested / long content -->
    <div class="example">
      <h2>Long content (demo of animation)</h2>
      <div class="controls">
        <button class="toggle-btn" aria-expanded="false" aria-controls="details-3" id="toggle-3">
          ▶ Read more
        </button>
        <span class="muted">The container expands to fit content height</span>
      </div>
      <div class="details" id="details-3" role="region" aria-labelledby="toggle-3" aria-hidden="true">
        <div class="details-content">
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus. Suspendisse lectus tortor, dignissim sit amet, adipiscing nec, ultricies sed, dolor.</p>
          <p>Curabitur sem urna, consequat vel, suscipit in, mattis placerat, nulla. Sed ac leo. Pellentesque imperdiet. Proin quam nisl, tincidunt et, mattis eget, convallis nec, purus.</p>
          <ol class="item-list">
            <li>Step one: identify the goal.</li>
            <li>Step two: plan the content structure.</li>
            <li>Step three: implement and test accessibility attributes.</li>
          </ol>
          <p class="hint">Note: the JavaScript uses the element's scrollHeight to animate height precisely.</p>
        </div>
      </div>
    </div>

  </div>

  <script>
    (function(){
      // Utility: toggle a details region by id
      function openDetails(el){
        el.classList.add('open');
        el.setAttribute('aria-hidden','false');
        // set explicit maxHeight to enable transition to actual height
        var full = el.scrollHeight;
        el.style.maxHeight = full + 'px';
      }
      function closeDetails(el){
        // set maxHeight to current height then force reflow, then set to 0 to animate
        el.style.maxHeight = el.scrollHeight + 'px';
        // force reflow
        el.offsetHeight;
        el.style.maxHeight = '0px';
        el.classList.remove('open');
        el.setAttribute('aria-hidden','true');
      }

      // Initialize: for each toggle button, wire up events
      var buttons = document.querySelectorAll('.toggle-btn[aria-controls]');
      buttons.forEach(function(btn){
        var targetId = btn.getAttribute('aria-controls');
        var target = document.getElementById(targetId);
        if(!target) return;

        // If details starts open, ensure maxHeight is set to content height to avoid abrupt collapse
        if(target.classList.contains('open') || btn.getAttribute('aria-expanded') === 'true'){
          // set initial expanded state
          btn.setAttribute('aria-expanded','true');
          target.setAttribute('aria-hidden','false');
          // set maxHeight to scrollHeight to allow transitions when collapsing
          // defer to next frame to ensure styles computed
          requestAnimationFrame(function(){
            target.style.maxHeight = target.scrollHeight + 'px';
          });
        } else {
          // ensure collapsed initial state
          btn.setAttribute('aria-expanded','false');
          target.setAttribute('aria-hidden','true');
          target.style.maxHeight = '0px';
        }

        btn.addEventListener('click', function(){
          var expanded = btn.getAttribute('aria-expanded') === 'true';
          if(expanded){
            btn.setAttribute('aria-expanded','false');
            closeDetails(target);
            btn.innerText = btn.innerText.replace('▼','▶').replace('Hide','Show').replace('Read more','Read more');
            // provide a clear icon/string (simple glyph)
            if(btn.id === 'toggle-1') btn.innerText = '▶ Show details';
            if(btn.id === 'toggle-2') btn.innerText = '▶ Show content';
            if(btn.id === 'toggle-3') btn.innerText = '▶ Read more';
          } else {
            btn.setAttribute('aria-expanded','true');
            openDetails(target);
            if(btn.id === 'toggle-1') btn.innerText = '▼ Hide details';
            if(btn.id === 'toggle-2') btn.innerText = '▼ Hide content';
            if(btn.id === 'toggle-3') btn.innerText = '▼ Read less';
          }
        });

        // Clean up inline maxHeight after transition to allow auto height if content changes
        target.addEventListener('transitionend', function(e){
          if(e.propertyName !== 'max-height') return;
          if(target.classList.contains('open')){
            // remove maxHeight so content can grow/shrink naturally
            target.style.maxHeight = 'none';
          }
        });

      });

      // Optional: support deep-link via hash (#details-2 etc.) -> open referenced details
      if(location.hash){
        var target = document.getElementById(location.hash.slice(1));
        if(target && target.classList.contains('details')){
          // find controlling button
          var btn = document.querySelector('[aria-controls="'+ target.id +'"]');
          if(btn){
            btn.click();
            // move focus for a11y
            btn.focus();
          }
        }
      }
    })();
  </script>
</body>
</html>