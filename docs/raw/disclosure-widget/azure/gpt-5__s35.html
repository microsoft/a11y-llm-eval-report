<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Expand/Collapse Widgets Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --bg: #f7f7fa;
      --text: #1f1f29;
      --border: #d9d9e3;
      --accent: #3b82f6;
      --muted: #6b7280;
    }
    * { box-sizing: border-box; }
    html, body {
      margin: 0;
      padding: 0;
      background: var(--bg);
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      line-height: 1.5;
    }
    main {
      max-width: 820px;
      margin: 0 auto;
      padding: 24px;
    }
    h1 {
      font-size: 1.75rem;
      margin: 0 0 16px 0;
    }
    p.intro {
      color: var(--muted);
      margin: 0 0 24px 0;
    }
    .example {
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      margin: 16px 0;
      box-shadow: 0 1px 2px rgba(0,0,0,0.04);
    }
    .example h2 {
      font-size: 1.125rem;
      margin: 0 0 10px 0;
    }
    .example .hint {
      color: var(--muted);
      font-size: 0.95rem;
      margin-bottom: 8px;
    }
    .details {
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 10px 12px;
      background: #fafafa;
    }
    details.details {
      padding: 0; /* summary has its own padding */
      background: transparent;
      border: none;
    }
    details.details > summary {
      list-style: none;
      cursor: pointer;
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 10px 12px;
      background: #fafafa;
      position: relative;
      font-weight: 600;
    }
    details.details > summary::marker {
      content: "";
    }
    details.details > summary::before {
      content: "▸";
      display: inline-block;
      width: 1em;
      margin-right: 6px;
      transition: transform 180ms ease;
      color: var(--muted);
    }
    details.details[open] > summary::before {
      transform: rotate(90deg);
      color: var(--accent);
    }
    details.details > .content {
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 12px;
      margin-top: 8px;
      background: #fff;
    }
    button.toggle {
      font: inherit;
      font-weight: 600;
      background: #f0f7ff;
      color: #0b63d1;
      border: 1px solid #c9e2ff;
      border-radius: 10px;
      padding: 10px 12px;
      cursor: pointer;
    }
    button.toggle:hover {
      background: #e8f2ff;
    }
    button.toggle:focus-visible,
    details.details > summary:focus-visible {
      outline: 3px solid rgba(59, 130, 246, 0.35);
      outline-offset: 2px;
    }
    .accordion .item {
      margin: 8px 0;
    }
    .accordion .item button {
      width: 100%;
      text-align: left;
      font: inherit;
      font-weight: 600;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: #fafafa;
      cursor: pointer;
      position: relative;
    }
    .accordion .item button::after {
      content: "▸";
      position: absolute;
      right: 12px;
      color: var(--muted);
      transition: transform 180ms ease, color 180ms ease;
    }
    .accordion .item button[aria-expanded="true"]::after {
      transform: rotate(90deg);
      color: var(--accent);
    }
    .accordion .item .details {
      margin-top: 8px;
      background: #fff;
    }
    .details[hidden] {
      display: none !important;
    }
    .content p {
      margin: 0 0 10px 0;
    }
    .content ul {
      margin: 6px 0 0 20px;
    }
    footer {
      margin-top: 24px;
      color: var(--muted);
      font-size: 0.95rem;
      text-align: center;
    }
  </style>
</head>
<body>
  <main>
    <h1>Expand/Collapse Widgets</h1>
    <p class="intro">Below are different expand/collapse widgets. Each widget is wrapped in a container with an "example" class. The controlled content container uses the "details" class.</p>

    <div class="example">
      <h2>Native HTML details/summary</h2>
      <p class="hint">Uses the built-in details element with a summary.</p>
      <details class="details">
        <summary>What is contained in this section?</summary>
        <div class="content">
          <p>This content is revealed using the native HTML details/summary element.</p>
          <ul>
            <li>It is keyboard-accessible by default.</li>
            <li>It can be nested within other content easily.</li>
            <li>Screen readers announce its expanded/collapsed state.</li>
          </ul>
        </div>
      </details>
    </div>

    <div class="example" id="example-button-toggle">
      <h2>Button-controlled region</h2>
      <p class="hint">A button toggles visibility of a controlled content container.</p>
      <button type="button" class="toggle" id="btn-toggle-1" aria-expanded="false" aria-controls="panel-1">Show more details</button>
      <div class="details" id="panel-1" role="region" aria-labelledby="btn-toggle-1" hidden>
        <div class="content">
          <p>This region is controlled by the button above using ARIA attributes.</p>
          <p>It receives focus on first focusable element when opened.</p>
          <p>
            <a href="#example-button-toggle">Example link inside</a>
          </p>
        </div>
      </div>
    </div>

    <div class="example accordion" id="example-accordion" data-accordion>
      <h2>Accordion (single-open)</h2>
      <p class="hint">Only one section opens at a time in this group.</p>

      <div class="item">
        <button type="button" id="acc-btn-1" aria-expanded="false" aria-controls="acc-panel-1">Section 1: Overview</button>
        <div class="details" id="acc-panel-1" role="region" aria-labelledby="acc-btn-1" hidden>
          <div class="content">
            <p>An overview with a quick summary of the accordion interface.</p>
            <ul>
              <li>Click or press Enter/Space to toggle.</li>
              <li>Arrow keys navigate between headers.</li>
              <li>Home/End jump to first/last header.</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="item">
        <button type="button" id="acc-btn-2" aria-expanded="false" aria-controls="acc-panel-2">Section 2: Details</button>
        <div class="details" id="acc-panel-2" role="region" aria-labelledby="acc-btn-2" hidden>
          <div class="content">
            <p>More in-depth information is provided in this section.</p>
            <ul>
              <li>Supports rich content and interactive elements.</li>
              <li>Closes other open sections automatically.</li>
              <li>Uses ARIA to convey state to assistive technologies.</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="item">
        <button type="button" id="acc-btn-3" aria-expanded="false" aria-controls="acc-panel-3">Section 3: Resources</button>
        <div class="details" id="acc-panel-3" role="region" aria-labelledby="acc-btn-3" hidden>
          <div class="content">
            <p>Useful references and links:</p>
            <ul>
              <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/details" target="_blank" rel="noopener">MDN: details element</a></li>
              <li><a href="https://www.w3.org/WAI/ARIA/apg/patterns/accordion/" target="_blank" rel="noopener">WAI-ARIA: Accordion pattern</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <footer>
      Demo ends here. Try interacting with each widget.
    </footer>
  </main>

  <script>
    (function() {
      const focusableSelector = [
        'a[href]',
        'button:not([disabled])',
        'input:not([disabled])',
        'select:not([disabled])',
        'textarea:not([disabled])',
        '[tabindex]:not([tabindex="-1"])'
      ].join(',');

      function firstFocusable(el) {
        return el.querySelector(focusableSelector);
      }

      function togglePanel(button, panel, expand) {
        const willExpand = typeof expand === 'boolean' ? expand : (button.getAttribute('aria-expanded') !== 'true');
        button.setAttribute('aria-expanded', willExpand ? 'true' : 'false');
        panel.hidden = !willExpand;
        if (willExpand) {
          const ff = firstFocusable(panel);
          if (ff) ff.focus({ preventScroll: true });
        }
      }

      // Generic button-controlled panels
      document.querySelectorAll('button[aria-controls]').forEach(btn => {
        const panelId = btn.getAttribute('aria-controls');
        const panel = document.getElementById(panelId);
        if (!panel) return;

        btn.addEventListener('click', () => {
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          const container = btn.closest('[data-accordion]');
          if (container && !expanded) {
            // Accordion: close other panels
            container.querySelectorAll('button[aria-controls]').forEach(otherBtn => {
              if (otherBtn === btn) return;
              const otherPanel = document.getElementById(otherBtn.getAttribute('aria-controls'));
              if (!otherPanel) return;
              otherBtn.setAttribute('aria-expanded', 'false');
              otherPanel.hidden = true;
            });
          }
          togglePanel(btn, panel, !expanded);
        });

        // Keyboard support for accordion headers
        btn.addEventListener('keydown', (e) => {
          const isAccordion = !!btn.closest('[data-accordion]');
          if (!isAccordion) {
            if ((e.key === 'Enter' || e.key === ' ') && !e.defaultPrevented) {
              e.preventDefault();
              btn.click();
            }
            return;
          }

          const headers = Array.from(btn.closest('[data-accordion]').querySelectorAll('button[aria-controls]'));
          const idx = headers.indexOf(btn);
          if (e.key === 'ArrowDown') {
            e.preventDefault();
            const next = headers[(idx + 1) % headers.length];
            next.focus();
          } else if (e.key === 'ArrowUp') {
            e.preventDefault();
            const prev = headers[(idx - 1 + headers.length) % headers.length];
            prev.focus();
          } else if (e.key === 'Home') {
            e.preventDefault();
            headers[0].focus();
          } else if (e.key === 'End') {
            e.preventDefault();
            headers[headers.length - 1].focus();
          } else if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            btn.click();
          }
        });
      });
    })();
  </script>
</body>
</html>