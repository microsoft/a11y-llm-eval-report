<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent: #0366d6;
      --muted: #6c757d;
      --bg: #f8fafc;
      --surface: #ffffff;
      --radius: 8px;
      --transition: 300ms cubic-bezier(.2,.8,.2,1);
    }

    html,body{
      height:100%;
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg, var(--bg) 0%, #eef6ff 100%);
      color:#111827;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .page {
      max-width: 820px;
      margin: 48px auto;
      padding: 24px;
    }

    h1 { margin: 0 0 18px 0; font-size: 22px; }
    p.lead { margin: 0 0 20px 0; color: var(--muted); }

    /* Example wrapper */
    .example {
      background: var(--surface);
      border-radius: var(--radius);
      padding: 12px;
      box-shadow: 0 1px 2px rgba(16,24,40,0.03), 0 6px 18px rgba(13,38,76,0.06);
      margin: 18px 0;
      border: 1px solid rgba(15,23,42,0.04);
    }

    /* Toggle button */
    .toggle {
      display: flex;
      align-items: center;
      justify-content: space-between;
      width:100%;
      gap: 12px;
      background: transparent;
      border: none;
      padding: 12px;
      cursor: pointer;
      font-size: 16px;
      border-radius: 6px;
      text-align: left;
      color: inherit;
    }

    .toggle:hover {
      background: rgba(2,6,23,0.03);
    }

    .toggle:focus {
      outline: 3px solid rgba(3,102,214,0.18);
      outline-offset: 2px;
    }

    .title {
      display:flex;
      flex-direction:column;
      align-items:flex-start;
      gap:4px;
    }

    .title .main {
      font-weight: 600;
    }

    .title .sub {
      font-size: 13px;
      color: var(--muted);
    }

    .chev {
      width: 20px;
      height: 20px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      color: var(--accent);
      transition: transform var(--transition);
      flex: 0 0 20px;
    }

    /* Rotate when expanded */
    .toggle[aria-expanded="true"] .chev {
      transform: rotate(180deg);
    }

    /* Details container - controlled content */
    .details {
      overflow: hidden;
      transition: max-height var(--transition), opacity var(--transition);
      max-height: 0;
      opacity: 0;
      padding: 0 12px;
    }

    .details.open {
      opacity: 1;
    }

    .details-inner {
      padding: 12px 0;
      border-top: 1px dashed rgba(15,23,42,0.06);
      color: #111827;
      line-height: 1.5;
      background: linear-gradient(180deg, rgba(255,255,255,0.0), rgba(250,250,252,0.02));
      border-radius: 6px;
    }

    /* Small note for keyboard controls */
    .hint {
      margin-top: 8px;
      font-size: 13px;
      color: var(--muted);
    }

    /* Make images and lists look nicer inside details */
    .details-inner img { max-width:100%; border-radius:6px; display:block; margin:8px 0; }
    .details-inner ul { padding-left:20px; margin:8px 0; }
  </style>
</head>
<body>
  <div class="page" id="top">
    <h1>Expand / Collapse Widget</h1>
    <p class="lead">Examples of an accessible expand/collapse widget. Each widget is wrapped in a div.example and the controlled content uses class="details". Use the buttons to toggle each section.</p>

    <div class="example">
      <button class="toggle" id="toggle-1" aria-expanded="false" aria-controls="details-1">
        <span class="title">
          <span class="main">More about Topic A</span>
          <span class="sub">Short summary (click to expand)</span>
        </span>
        <span class="chev" aria-hidden="true">▾</span>
      </button>

      <div class="details" id="details-1" role="region" aria-labelledby="toggle-1" aria-hidden="true">
        <div class="details-inner">
          <p>Topic A covers foundational concepts and background information. When expanded, you can see more details, examples, and links to resources for further study.</p>
          <ul>
            <li>Key idea 1: Something important to know.</li>
            <li>Key idea 2: Another relevant point with context.</li>
            <li>Key idea 3: Practical example and usage notes.</li>
          </ul>
          <p><strong>Tip:</strong> Use the button above (or press Enter/Space when focused) to open and close this panel.</p>
        </div>
      </div>

      <div class="hint">Keyboard: Tab → Enter/Space to toggle</div>
    </div>

    <div class="example">
      <button class="toggle" id="toggle-2" aria-expanded="false" aria-controls="details-2">
        <span class="title">
          <span class="main">Examples & Code Snippets</span>
          <span class="sub">A set of quick examples you can try</span>
        </span>
        <span class="chev" aria-hidden="true">▾</span>
      </button>

      <div class="details" id="details-2" role="region" aria-labelledby="toggle-2" aria-hidden="true">
        <div class="details-inner">
          <p>Here are a few concise code snippets and examples that demonstrate usage patterns:</p>
          <pre style="background:#f4f6f8;padding:10px;border-radius:6px;overflow:auto;font-size:13px;margin:8px 0;">
// Example pseudo-code
function greet(name) {
  return `Hello, ${name}!`;
}
          </pre>
          <p>Try copying one of these snippets into your editor to experiment.</p>
        </div>
      </div>

      <div class="hint">These panels animate their height to provide a smooth transition.</div>
    </div>

  </div>

  <script>
    (function () {
      // Utilities for expanding/collapsing with smooth height animation.
      function expand(detailsEl) {
        detailsEl.classList.add('open');
        detailsEl.setAttribute('aria-hidden', 'false');

        // Remove any inline max-height before measuring
        detailsEl.style.maxHeight = '0px';
        var full = detailsEl.scrollHeight;
        // set to scrollHeight to animate open
        detailsEl.style.maxHeight = full + 'px';

        // After transition, clear max-height so content can grow naturally
        var onTransitionEnd = function (e) {
          if (e.target !== detailsEl) return;
          detailsEl.style.maxHeight = 'none';
          detailsEl.removeEventListener('transitionend', onTransitionEnd);
        };
        detailsEl.addEventListener('transitionend', onTransitionEnd);
      }

      function collapse(detailsEl) {
        // To animate from current height, set max-height to current pixel height.
        var current = detailsEl.scrollHeight;
        detailsEl.style.maxHeight = current + 'px';

        // Force a repaint so the browser registers the current height before setting to 0
        detailsEl.offsetHeight; // eslint-disable-line no-unused-expressions

        detailsEl.style.maxHeight = '0px';
        detailsEl.setAttribute('aria-hidden', 'true');

        var onTransitionEnd = function (e) {
          if (e.target !== detailsEl) return;
          detailsEl.classList.remove('open');
          detailsEl.removeEventListener('transitionend', onTransitionEnd);
        };
        detailsEl.addEventListener('transitionend', onTransitionEnd);
      }

      function toggleBtn(button) {
        var controlsId = button.getAttribute('aria-controls');
        if (!controlsId) return;
        var detailsEl = document.getElementById(controlsId);
        if (!detailsEl) return;

        var expanded = button.getAttribute('aria-expanded') === 'true';
        if (expanded) {
          // collapse
          button.setAttribute('aria-expanded', 'false');
          collapse(detailsEl);
        } else {
          // expand
          button.setAttribute('aria-expanded', 'true');
          expand(detailsEl);
        }
      }

      // Initialize all toggle buttons inside .example containers
      document.addEventListener('DOMContentLoaded', function () {
        var buttons = document.querySelectorAll('.example .toggle');
        buttons.forEach(function (btn) {
          var controlsId = btn.getAttribute('aria-controls');
          var detailsEl = controlsId ? document.getElementById(controlsId) : null;
          if (detailsEl) {
            // Ensure details start collapsed according to aria-expanded
            var initExpanded = btn.getAttribute('aria-expanded') === 'true';
            if (initExpanded) {
              detailsEl.classList.add('open');
              detailsEl.setAttribute('aria-hidden', 'false');
              detailsEl.style.maxHeight = 'none';
            } else {
              detailsEl.classList.remove('open');
              detailsEl.setAttribute('aria-hidden', 'true');
              detailsEl.style.maxHeight = '0px';
            }
          }

          // Click toggles
          btn.addEventListener('click', function (e) {
            e.preventDefault();
            toggleBtn(btn);
          });

          // Support Space and Enter explicitly (buttons already handle it, but keep for completeness)
          btn.addEventListener('keydown', function (e) {
            var code = e.key;
            if (code === ' ' || code === 'Spacebar') {
              e.preventDefault();
              toggleBtn(btn);
            } else if (code === 'Enter') {
              e.preventDefault();
              toggleBtn(btn);
            } else if (code === 'Escape' || code === 'Esc') {
              // Close when escape is pressed while focused on toggle
              if (btn.getAttribute('aria-expanded') === 'true') {
                btn.setAttribute('aria-expanded', 'false');
                var controlsId2 = btn.getAttribute('aria-controls');
                var detailsEl2 = document.getElementById(controlsId2);
                if (detailsEl2) collapse(detailsEl2);
              }
            }
          });
        });
      });
    }());
  </script>
</body>
</html>