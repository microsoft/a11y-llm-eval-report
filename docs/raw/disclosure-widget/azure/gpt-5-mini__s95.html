<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#0b76ef;
      --bg:#f8fafc;
      --card:#ffffff;
      --muted:#6b7280;
      --radius:8px;
      --transition:250ms cubic-bezier(.2,.9,.3,1);
    }

    body{
      font-family: system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue","Noto Sans",Arial;
      background: linear-gradient(180deg,#f3f6fb, #ffffff);
      color:#111827;
      margin:24px;
      line-height:1.45;
    }

    h1{
      font-size:1.25rem;
      margin:0 0 18px;
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(auto-fit,minmax(260px,1fr));
      gap:16px;
      align-items:start;
    }

    .example{
      background:var(--card);
      border:1px solid rgba(15,23,42,0.06);
      border-radius:var(--radius);
      padding:14px;
      box-shadow: 0 1px 2px rgba(15,23,42,0.03);
    }

    .widget{
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .expander{
      display:flex;
      align-items:center;
      gap:12px;
      width:100%;
    }

    .expander button.toggle{
      -webkit-appearance:none;
      appearance:none;
      background:linear-gradient(180deg,rgba(11,118,239,0.06),rgba(11,118,239,0.02));
      border:1px solid rgba(11,118,239,0.12);
      color:var(--accent);
      padding:8px 12px;
      font-weight:600;
      border-radius:8px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      cursor:pointer;
      transition:all var(--transition);
      box-shadow: 0 1px 0 rgba(11,118,239,0.06);
    }

    .expander button.toggle[aria-expanded="true"]{
      background:var(--accent);
      color:white;
      border-color: transparent;
      box-shadow: 0 6px 20px rgba(11,118,239,0.12);
    }

    .toggle .chev{
      display:inline-block;
      width:14px;
      height:14px;
      transition: transform var(--transition);
      transform-origin:50% 45%;
    }

    .toggle[aria-expanded="true"] .chev{
      transform: rotate(180deg);
    }

    .meta{
      color:var(--muted);
      font-size:0.875rem;
      margin-left:auto;
    }

    .details{
      overflow:hidden;
      max-height:0;
      transition:max-height var(--transition), opacity var(--transition);
      opacity:0;
      border-radius:8px;
      padding:0 10px;
      border:1px solid rgba(15,23,42,0.03);
      background: linear-gradient(180deg, rgba(15,23,42,0.02), rgba(15,23,42,0.01));
    }

    .details.open{
      opacity:1;
      padding:12px;
      /* large enough to hold content; using max-height for transition */
      max-height:600px;
    }

    .details p{
      margin:0 0 8px;
      color:#111827;
      font-size:0.95rem;
    }

    .details ul{
      margin:0 0 8px 18px;
    }

    .sr-only{
      position:absolute;
      width:1px;
      height:1px;
      padding:0;
      margin:-1px;
      overflow:hidden;
      clip:rect(0,0,0,0);
      white-space:nowrap;
      border:0;
    }

    /* small helper for initial example label */
    .label{
      font-size:0.9rem;
      color:var(--muted);
    }

    footer{
      margin-top:18px;
      font-size:0.85rem;
      color:var(--muted);
    }

    /* focus styles */
    .toggle:focus{
      outline: 3px solid rgba(11,118,239,0.16);
      outline-offset:2px;
    }

  </style>
</head>
<body>
  <main>
    <h1>Expand / Collapse Widget</h1>

    <div class="grid">
      <!-- Example 1: collapsed by default -->
      <div class="example">
        <div class="widget" id="widget-1">
          <div class="expander">
            <button class="toggle" id="toggle-1" aria-expanded="false" aria-controls="details-1" type="button">
              <span class="chev" aria-hidden="true">▾</span>
              <span class="label">Show details</span>
            </button>
            <span class="meta">Collapsed</span>
          </div>

          <div class="details" id="details-1" role="region" aria-labelledby="toggle-1" aria-hidden="true">
            <p><strong>What you'll find here</strong></p>
            <p>This section contains extra information that is hidden by default. Use the button above to reveal it.</p>
            <ul>
              <li>Accessible toggle using button with aria-expanded and aria-controls.</li>
              <li>Animated reveal with smooth transitions.</li>
              <li>Content container has the required class "details".</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Example 2: expanded by default -->
      <div class="example">
        <div class="widget" id="widget-2">
          <div class="expander">
            <button class="toggle" id="toggle-2" aria-expanded="true" aria-controls="details-2" type="button">
              <span class="chev" aria-hidden="true">▾</span>
              <span class="label">Hide details</span>
            </button>
            <span class="meta">Expanded</span>
          </div>

          <div class="details open" id="details-2" role="region" aria-labelledby="toggle-2" aria-hidden="false">
            <p><strong>Active details</strong></p>
            <p>This example starts expanded to show how the open state looks. The button text and aria-expanded reflect the state.</p>
            <p>Try toggling either button. The controlled container always uses the "details" class as requested.</p>
          </div>
        </div>
      </div>
    </div>

    <footer>
      Tip: The button is keyboard-focusable. Space/Enter toggles the content; Esc collapses an open region.
    </footer>
  </main>

  <script>
    (function(){
      // Find all toggle buttons that control a details region
      const toggles = document.querySelectorAll('button.toggle[aria-controls]');

      function setOpen(toggle, open) {
        const detailsId = toggle.getAttribute('aria-controls');
        const details = document.getElementById(detailsId);
        if(!details) return;
        toggle.setAttribute('aria-expanded', open ? 'true' : 'false');
        if(open){
          details.classList.add('open');
          details.setAttribute('aria-hidden','false');
          // update button label if present
          const label = toggle.querySelector('.label');
          if(label) label.textContent = 'Hide details';
        } else {
          details.classList.remove('open');
          details.setAttribute('aria-hidden','true');
          const label = toggle.querySelector('.label');
          if(label) label.textContent = 'Show details';
        }
      }

      toggles.forEach(toggle => {
        const detailsId = toggle.getAttribute('aria-controls');
        const details = document.getElementById(detailsId);
        // Ensure initial sync between aria-expanded and details
        const expanded = toggle.getAttribute('aria-expanded') === 'true';
        if(details){
          if(expanded){
            details.classList.add('open');
            details.setAttribute('aria-hidden','false');
          } else {
            details.classList.remove('open');
            details.setAttribute('aria-hidden','true');
          }
        }

        toggle.addEventListener('click', () => {
          const isOpen = toggle.getAttribute('aria-expanded') === 'true';
          setOpen(toggle, !isOpen);
        });

        // Support Escape key to collapse when focus is within the details region
        const detailsRegion = details;
        if(detailsRegion){
          detailsRegion.addEventListener('keydown', (ev) => {
            if(ev.key === 'Escape' || ev.key === 'Esc'){
              setOpen(toggle, false);
              toggle.focus();
            }
          });
        }

        // Also allow Esc from the button to collapse if it's open
        toggle.addEventListener('keydown', (ev) => {
          if((ev.key === 'Escape' || ev.key === 'Esc') && toggle.getAttribute('aria-expanded') === 'true'){
            setOpen(toggle, false);
          }
        });
      });

      // Optionally allow click outside to close any open widget (uncomment if desired)
      // document.addEventListener('click', (e) => {
      //   toggles.forEach(t => {
      //     const details = document.getElementById(t.getAttribute('aria-controls'));
      //     if(details && details.classList.contains('open') && !t.contains(e.target) && !details.contains(e.target)){
      //       setOpen(t, false);
      //     }
      //   });
      // });

    })();
  </script>
</body>
</html>