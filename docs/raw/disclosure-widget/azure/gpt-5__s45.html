<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Expand/Collapse Widget Examples</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --border: #d0d7de;
      --bg: #f6f8fa;
      --text: #24292f;
      --accent: #0969da;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      padding: 2rem;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background: white;
      line-height: 1.6;
    }
    h1 { margin-top: 0; }
    .examples { display: grid; gap: 1.25rem; }
    .example {
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1rem;
      background: var(--bg);
    }
    .example h2 {
      margin: 0 0 .5rem 0;
      font-size: 1.1rem;
    }

    /* Native <details> styling */
    details.details {
      background: white;
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: .5rem .75rem;
    }
    details.details > summary {
      cursor: pointer;
      font-weight: 600;
      list-style: none;
      outline: none;
    }
    details.details > summary::-webkit-details-marker { display: none; }
    details.details > summary::before {
      content: "▸";
      display: inline-block;
      margin-right: .5rem;
      transform: translateY(-1px);
      transition: transform .2s;
    }
    details.details[open] > summary::before {
      transform: rotate(90deg);
    }
    details.details .content {
      margin-top: .5rem;
      color: #4d4d4d;
    }

    /* Custom button-controlled panel */
    .controls {
      display: flex;
      align-items: center;
      gap: .5rem;
      margin-bottom: .5rem;
    }
    .toggle-btn {
      appearance: none;
      border: 1px solid var(--border);
      background: white;
      color: var(--text);
      border-radius: 6px;
      padding: .4rem .75rem;
      font-weight: 600;
      cursor: pointer;
    }
    .toggle-btn:hover { border-color: #b3bac2; }
    .toggle-btn:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }
    .details {
      background: white;
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: .75rem;
    }
    .details[hidden] { display: none; }

    /* Accordion demo */
    .accordion {
      display: grid;
      gap: .5rem;
    }
    .accordion-item {
      border: 1px solid var(--border);
      border-radius: 6px;
      background: white;
    }
    .accordion-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: .5rem;
      width: 100%;
      border: 0;
      background: transparent;
      cursor: pointer;
      padding: .6rem .75rem;
      font-weight: 600;
    }
    .accordion-header:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }
    .accordion-header .chevron {
      transition: transform .2s;
    }
    .accordion-header[aria-expanded="true"] .chevron {
      transform: rotate(90deg);
    }
    .accordion-panel.details {
      padding: .75rem;
      border-top: 1px solid var(--border);
      border-radius: 0 0 6px 6px;
    }

    footer {
      margin-top: 2rem;
      font-size: .9rem;
      color: #57606a;
    }
  </style>
</head>
<body>
  <h1>Expand/Collapse Widget Demonstration</h1>
  <p>This page shows different patterns for expand/collapse widgets. Each widget is wrapped with a container having the "example" class, and the container for controlled content uses the "details" class.</p>

  <section class="examples">
    <div class="example">
      <h2>Native HTML details/summary</h2>
      <details class="details">
        <summary>What is an expand/collapse widget?</summary>
        <div class="content">
          <p>An expand/collapse widget hides non-critical content until the user chooses to reveal it. The native HTML details/summary pattern provides built-in accessibility and toggling behavior without JavaScript.</p>
          <ul>
            <li>Click the summary row to expand or collapse.</li>
            <li>Keyboard users can focus the summary and press Space/Enter.</li>
            <li>Screen readers announce the expanded/collapsed state.</li>
          </ul>
        </div>
      </details>
    </div>

    <div class="example">
      <h2>Custom button controls a content panel</h2>
      <div class="controls">
        <button class="toggle-btn" aria-expanded="false" aria-controls="custom-panel-1" id="custom-trigger-1">
          Show more
        </button>
        <span id="custom-state-1" aria-live="polite" style="font-size:.9rem;color:#57606a;">Collapsed</span>
      </div>
      <div id="custom-panel-1" class="details" hidden role="region" aria-labelledby="custom-trigger-1">
        <p>This panel is controlled by a button. Click the button to toggle visibility. The button updates its aria-expanded state for assistive technologies, and the panel is hidden/shown accordingly.</p>
        <p>You can place any content here, such as images, lists, or forms.</p>
      </div>
    </div>

    <div class="example">
      <h2>Accordion with single-open behavior</h2>
      <div class="accordion" role="presentation">
        <div class="accordion-item">
          <button class="accordion-header" aria-expanded="false" aria-controls="acc-panel-1" id="acc-trigger-1">
            Section One
            <span class="chevron">▸</span>
          </button>
          <div id="acc-panel-1" class="accordion-panel details" hidden role="region" aria-labelledby="acc-trigger-1">
            <p>Content for section one. Only one section remains open at a time in this accordion.</p>
          </div>
        </div>

        <div class="accordion-item">
          <button class="accordion-header" aria-expanded="false" aria-controls="acc-panel-2" id="acc-trigger-2">
            Section Two
            <span class="chevron">▸</span>
          </button>
          <div id="acc-panel-2" class="accordion-panel details" hidden role="region" aria-labelledby="acc-trigger-2">
            <p>Content for section two. Opening this will close any other open section.</p>
          </div>
        </div>

        <div class="accordion-item">
          <button class="accordion-header" aria-expanded="false" aria-controls="acc-panel-3" id="acc-trigger-3">
            Section Three
            <span class="chevron">▸</span>
          </button>
          <div id="acc-panel-3" class="accordion-panel details" hidden role="region" aria-labelledby="acc-trigger-3">
            <p>Content for section three. Use Tab to navigate and Enter/Space to toggle sections.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <footer>
    Each widget is wrapped in a div with class "example". The controlled content containers have class "details".
  </footer>

  <script>
    // Custom button toggler
    function setExpanded(button, expanded) {
      button.setAttribute('aria-expanded', String(expanded));
      const panelId = button.getAttribute('aria-controls');
      const panel = panelId ? document.getElementById(panelId) : null;
      if (panel) {
        panel.hidden = !expanded;
      }
      const live = document.getElementById(button.id.replace('trigger', 'state'));
      if (live) {
        live.textContent = expanded ? 'Expanded' : 'Collapsed';
      }
      // Update button label
      const showLabel = button.dataset.showLabel || 'Show more';
      const hideLabel = button.dataset.hideLabel || 'Show less';
      button.textContent = expanded ? hideLabel : showLabel;
    }

    document.addEventListener('click', (e) => {
      const btn = e.target.closest('.toggle-btn');
      if (btn) {
        const isExpanded = btn.getAttribute('aria-expanded') === 'true';
        setExpanded(btn, !isExpanded);
      }
    });

    document.addEventListener('keydown', (e) => {
      const btn = e.target.closest('.toggle-btn');
      if (!btn) return;
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        const isExpanded = btn.getAttribute('aria-expanded') === 'true';
        setExpanded(btn, !isExpanded);
      } else if (e.key === 'Escape') {
        const isExpanded = btn.getAttribute('aria-expanded') === 'true';
        if (isExpanded) setExpanded(btn, false);
      }
    });

    // Accordion single-open behavior
    function toggleAccordion(button) {
      const expanded = button.getAttribute('aria-expanded') === 'true';
      const container = button.closest('.accordion');
      if (!container) return;

      // Close all
      container.querySelectorAll('.accordion-header[aria-expanded="true"]').forEach((b) => {
        b.setAttribute('aria-expanded', 'false');
        const id = b.getAttribute('aria-controls');
        const panel = id ? document.getElementById(id) : null;
        if (panel) panel.hidden = true;
      });

      // Open requested if it was not already open
      if (!expanded) {
        button.setAttribute('aria-expanded', 'true');
        const id = button.getAttribute('aria-controls');
        const panel = id ? document.getElementById(id) : null;
        if (panel) panel.hidden = false;
      }
    }

    document.addEventListener('click', (e) => {
      const header = e.target.closest('.accordion-header');
      if (header) {
        toggleAccordion(header);
      }
    });

    document.addEventListener('keydown', (e) => {
      const header = e.target.closest('.accordion-header');
      if (!header) return;
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        toggleAccordion(header);
      } else if (e.key === 'Escape') {
        // Collapse if open
        if (header.getAttribute('aria-expanded') === 'true') {
          header.setAttribute('aria-expanded', 'false');
          const id = header.getAttribute('aria-controls');
          const panel = id ? document.getElementById(id) : null;
          if (panel) panel.hidden = true;
        }
      }
    });
  </script>
</body>
</html>