<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Expand/Collapse Widgets Demo</title>
    <style>
      :root {
        --border: #d6d6d6;
        --text: #1f2937;
        --muted: #6b7280;
        --bg: #ffffff;
        --accent: #2563eb;
        --focus: #93c5fd;
      }

      * {
        box-sizing: border-box;
      }

      html, body {
        margin: 0;
        padding: 0;
        background: var(--bg);
        color: var(--text);
        font: 16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      }

      main {
        max-width: 800px;
        margin: 2rem auto;
        padding: 0 1rem 3rem;
      }

      h1 {
        font-size: 1.75rem;
        margin: 0 0 1rem;
      }

      p.lead {
        color: var(--muted);
        margin: 0 0 1.5rem;
      }

      .example {
        border: 1px solid var(--border);
        border-radius: 10px;
        padding: 1rem;
        margin: 1rem 0;
        background: #fafafa;
      }

      .example + .example {
        margin-top: 1.25rem;
      }

      /* Native <details> styling */
      details.details {
        border: 1px solid var(--border);
        border-radius: 8px;
        background: white;
        padding: 0.5rem;
      }

      details.details[open] {
        box-shadow: 0 1px 2px rgba(0,0,0,0.05);
      }

      details.details > summary {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        cursor: pointer;
        list-style: none;
        outline: none;
        padding: 0.5rem;
        border-radius: 6px;
      }

      /* Remove default marker */
      details.details > summary::-webkit-details-marker {
        display: none;
      }

      /* Custom marker */
      .marker {
        display: inline-block;
        width: 1rem;
        height: 1rem;
        border-radius: 2px;
        border: 1px solid var(--border);
        background: #f1f5f9;
        position: relative;
      }

      .marker::before,
      .marker::after {
        content: "";
        position: absolute;
        background: var(--accent);
        transition: transform 150ms ease;
      }

      .marker::before {
        width: 10px;
        height: 2px;
        top: calc(50% - 1px);
        left: calc(50% - 5px);
      }

      .marker::after {
        width: 2px;
        height: 10px;
        top: calc(50% - 5px);
        left: calc(50% - 1px);
      }

      details.details[open] .marker::after {
        transform: scaleY(0); /* turn + into - when open */
      }

      details.details .summary-title {
        font-weight: 600;
      }
      details.details .summary-hint {
        margin-left: auto;
        color: var(--muted);
        font-size: 0.9rem;
      }

      details.details .panel-content {
        margin: 0.5rem 0.5rem 0.25rem;
        padding-top: 0.5rem;
        border-top: 1px dashed var(--border);
      }

      /* Custom button-controlled panel */
      .controls {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      button.toggle {
        appearance: none;
        border: 1px solid var(--border);
        background: white;
        color: var(--text);
        padding: 0.5rem 0.75rem;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
      }

      button.toggle:hover {
        border-color: #b7b7b7;
        background: #f8fafc;
      }

      button.toggle:focus-visible {
        outline: 3px solid var(--focus);
        outline-offset: 2px;
      }

      .toggle .chev {
        display: inline-block;
        transition: transform 200ms ease;
        margin-right: 0.25rem;
      }

      .toggle[aria-expanded="true"] .chev {
        transform: rotate(180deg);
      }

      .details {
        border: 1px solid var(--border);
        border-radius: 8px;
        margin-top: 0.75rem;
        padding: 0.75rem;
        background: white;
      }

      .details[hidden] {
        display: none !important;
      }

      .muted {
        color: var(--muted);
      }

      code {
        font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
        background: #f3f4f6;
        border-radius: 6px;
        padding: 0.1rem 0.25rem;
      }

      /* Accordion example */
      .accordion-item + .accordion-item {
        margin-top: 0.5rem;
      }

      .accordion-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 0.5rem;
      }

      .accordion-toggle {
        width: 100%;
        text-align: left;
      }
    </style>
  </head>
  <body>
    <main>
      <h1>Expand/Collapse Widgets</h1>
      <p class="lead">Examples of expandable panels using the native details element and a custom ARIA-controlled toggle.</p>

      <div class="example" id="ex-native">
        <h2>Native widget using the details element</h2>
        <details class="details">
          <summary>
            <span class="marker" aria-hidden="true"></span>
            <span class="summary-title">How does this work?</span>
            <span class="summary-hint" aria-hidden="true">Click to expand</span>
          </summary>
          <div class="panel-content">
            <p>The native <code>&lt;details&gt;</code> element provides built-in expand/collapse behavior with keyboard and mouse support. The content below the summary is revealed when open.</p>
            <ul>
              <li>It toggles without JavaScript.</li>
              <li>It is accessible by default in most modern browsers.</li>
              <li>You can enhance styles while keeping semantics.</li>
            </ul>
          </div>
        </details>
      </div>

      <div class="example" id="ex-custom">
        <h2>Custom button-controlled panel</h2>
        <div class="controls">
          <button type="button" class="toggle" id="toggle-1" aria-expanded="false" aria-controls="panel-1">
            <span class="chev" aria-hidden="true">▾</span>
            <span class="toggle-label">Show details</span>
          </button>
          <span class="muted" id="toggle-1-hint">Press to reveal content</span>
        </div>
        <div id="panel-1" class="details" role="region" aria-labelledby="toggle-1" hidden>
          <p>This panel is controlled via a button with <code>aria-expanded</code> and <code>aria-controls</code>. The region has <code>role="region"</code> and is labeled by the controlling button.</p>
          <p>Use this pattern when you need custom behavior, animations, or cross-browser consistency.</p>
          <ul>
            <li>Accessible labeling via <code>aria-labelledby</code>.</li>
            <li>Programmatic control with JavaScript.</li>
            <li>Can update button text when expanded/collapsed.</li>
          </ul>
        </div>
      </div>

      <div class="example" id="ex-accordion">
        <h2>Accordion (group of expand/collapse items)</h2>
        <p class="muted">Only one section open at a time (optional behavior).</p>

        <div class="accordion-item">
          <div class="accordion-header">
            <button class="toggle accordion-toggle" type="button" id="acc-btn-1" aria-expanded="false" aria-controls="acc-panel-1">
              <span class="chev" aria-hidden="true">▾</span>
              <span class="toggle-label">Section one</span>
            </button>
          </div>
          <div id="acc-panel-1" class="details" role="region" aria-labelledby="acc-btn-1" hidden>
            <p>Content for section one. This uses the same pattern as the custom panel above.</p>
          </div>
        </div>

        <div class="accordion-item">
          <div class="accordion-header">
            <button class="toggle accordion-toggle" type="button" id="acc-btn-2" aria-expanded="false" aria-controls="acc-panel-2">
              <span class="chev" aria-hidden="true">▾</span>
              <span class="toggle-label">Section two</span>
            </button>
          </div>
          <div id="acc-panel-2" class="details" role="region" aria-labelledby="acc-btn-2" hidden>
            <p>Content for section two. Toggle to expand and collapse.</p>
          </div>
        </div>

        <div class="accordion-item">
          <div class="accordion-header">
            <button class="toggle accordion-toggle" type="button" id="acc-btn-3" aria-expanded="false" aria-controls="acc-panel-3">
              <span class="chev" aria-hidden="true">▾</span>
              <span class="toggle-label">Section three</span>
            </button>
          </div>
          <div id="acc-panel-3" class="details" role="region" aria-labelledby="acc-btn-3" hidden>
            <p>Content for section three.</p>
          </div>
        </div>
      </div>
    </main>

    <script>
      // Utility to toggle a panel controlled by a button
      function togglePanel(btn, panel, options = {}) {
        const isExpanded = btn.getAttribute('aria-expanded') === 'true';
        const next = !isExpanded;

        btn.setAttribute('aria-expanded', String(next));
        panel.hidden = !next;

        // Update button label if requested
        const labelEl = btn.querySelector('.toggle-label');
        if (labelEl) {
          const collapsedText = options.collapsedText || 'Show details';
          const expandedText = options.expandedText || 'Hide details';
          labelEl.textContent = next ? expandedText : collapsedText;
        }
      }

      // Initialize custom panel example
      (function initCustomPanel() {
        const btn = document.getElementById('toggle-1');
        const panel = document.getElementById('panel-1');
        if (!btn || !panel) return;

        btn.addEventListener('click', () => togglePanel(btn, panel, {
          collapsedText: 'Show details',
          expandedText: 'Hide details'
        }));
      })();

      // Initialize accordion with optional single-open behavior
      (function initAccordion() {
        const toggles = Array.from(document.querySelectorAll('.accordion-toggle'));
        const panels = toggles.map(btn => document.getElementById(btn.getAttribute('aria-controls'))).filter(Boolean);

        function closeOthers(exceptBtn) {
          toggles.forEach(btn => {
            if (btn === exceptBtn) return;
            const panelId = btn.getAttribute('aria-controls');
            const panel = document.getElementById(panelId);
            if (!panel) return;
            btn.setAttribute('aria-expanded', 'false');
            panel.hidden = true;
            const label = btn.querySelector('.toggle-label');
            if (label) label.textContent = 'Section ' + btn.id.split('-').pop();
          });
        }

        toggles.forEach(btn => {
          const panelId = btn.getAttribute('aria-controls');
          const panel = document.getElementById(panelId);
          if (!panel) return;

          btn.addEventListener('click', () => {
            const expanded = btn.getAttribute('aria-expanded') === 'true';
            // Close others before toggling this one
            closeOthers(btn);
            // Toggle current
            togglePanel(btn, panel, {
              collapsedText: btn.querySelector('.toggle-label')?.textContent || 'Show',
              expandedText: 'Hide'
            });
          });
        });

        // Optional: allow only one open initially (all closed)
        panels.forEach(p => p.hidden = true);
        toggles.forEach(b => b.setAttribute('aria-expanded', 'false'));
      })();
    </script>
  </body>
</html>