<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#0b79d0;
      --muted:#666;
      --bg:#f7f9fb;
      --radius:8px;
    }
    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      margin: 24px;
      background: linear-gradient(180deg,#fff 0%, var(--bg) 100%);
      color: #111;
      line-height: 1.4;
    }

    h1{font-size:1.25rem;margin:0 0 18px}
    p.lead{margin:0 0 18px;color:var(--muted)}

    .example{
      background:#fff;
      border:1px solid rgba(0,0,0,0.06);
      padding:16px;
      border-radius:var(--radius);
      box-shadow: 0 4px 12px rgba(16,24,40,0.04);
      margin: 16px 0;
    }

    .disclosure-button {
      display:flex;
      align-items:center;
      gap:12px;
      width:100%;
      padding:10px 12px;
      font-size:1rem;
      background:transparent;
      border:1px solid rgba(0,0,0,0.06);
      border-radius:8px;
      cursor:pointer;
      text-align:left;
    }
    .disclosure-button:focus{
      outline:3px solid rgba(11,121,208,0.18);
      outline-offset:2px;
    }
    .disclosure-button .chev{
      transition: transform 0.2s ease;
      width:18px;height:18px;
      display:inline-block;
      transform-origin:center;
    }
    .disclosure-button[aria-expanded="true"] .chev{
      transform: rotate(90deg);
    }

    .details{
      overflow:hidden;
      transition:max-height 240ms ease, opacity 200ms ease;
      opacity:1;
      margin-top:12px;
      border-left:3px solid rgba(11,121,208,0.06);
      padding:12px;
      border-radius:6px;
      background:#fbfdff;
    }
    .details[hidden]{
      display:none;
      max-height:0;
      opacity:0;
      padding:0;
      margin-top:8px;
    }

    /* Accordion styles */
    .accordion {
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .accordion .header-row{
      display:flex;
      gap:8px;
    }
    .note{font-size:0.875rem;color:var(--muted);margin-top:8px;}
  </style>
</head>
<body>
  <main>
    <h1>Expand / Collapse Widget Examples</h1>
    <p class="lead">Two accessible patterns: a simple disclosure and an accordion. Buttons use aria-expanded and aria-controls; content containers use the class "details".</p>

    <!-- Example 1: Simple disclosure -->
    <div class="example" id="ex-simple">
      <h2 style="font-size:1rem;margin:0 0 8px">Simple disclosure</h2>
      <button
        class="disclosure-button"
        id="btn-simple"
        aria-controls="details-simple"
        aria-expanded="false"
        data-toggle="disclosure"
      >
        <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <polyline points="8 6 16 12 8 18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span>Show more details about this item</span>
      </button>

      <div class="details" id="details-simple" hidden aria-hidden="true">
        <p style="margin:0 0 8px">
          This is the controlled content for the simple disclosure. It starts hidden and becomes visible when the button above is activated. The content container has class="details".
        </p>
        <p style="margin:0" class="note">Tip: The button updates aria-expanded and aria-controls keeps it programmatically associated with this details region.</p>
      </div>
    </div>

    <!-- Example 2: Accordion (multiple sections) -->
    <div class="example" id="ex-accordion" aria-labelledby="accordion-label">
      <h2 id="accordion-label" style="font-size:1rem;margin:0 0 8px">Accordion (single-section toggle)</h2>

      <div class="accordion" role="tablist" aria-multiselectable="false">
        <div>
          <div class="header-row">
            <button
              class="disclosure-button"
              id="acc-btn-1"
              aria-controls="acc-details-1"
              aria-expanded="false"
              data-toggle="accordion"
            >
              <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                <polyline points="8 6 16 12 8 18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <span>Section 1 — Overview</span>
            </button>
          </div>
          <div class="details" id="acc-details-1" hidden aria-hidden="true">
            <p style="margin:0">Section 1 content: summary information and a quick overview.</p>
          </div>
        </div>

        <div>
          <div class="header-row">
            <button
              class="disclosure-button"
              id="acc-btn-2"
              aria-controls="acc-details-2"
              aria-expanded="false"
              data-toggle="accordion"
            >
              <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                <polyline points="8 6 16 12 8 18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <span>Section 2 — Details</span>
            </button>
          </div>
          <div class="details" id="acc-details-2" hidden aria-hidden="true">
            <p style="margin:0">Section 2 content: more detailed explanation and examples.</p>
          </div>
        </div>

        <div>
          <div class="header-row">
            <button
              class="disclosure-button"
              id="acc-btn-3"
              aria-controls="acc-details-3"
              aria-expanded="false"
              data-toggle="accordion"
            >
              <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                <polyline points="8 6 16 12 8 18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <span>Section 3 — Extra</span>
            </button>
          </div>
          <div class="details" id="acc-details-3" hidden aria-hidden="true">
            <p style="margin:0">Section 3 content: extra resources and links.</p>
          </div>
        </div>
      </div>

      <p class="note">Keyboard: Up/Down/Home/End navigate between headers. Enter/Space toggle the focused section.</p>
    </div>

  </main>

  <script>
    (function(){
      // Utility to animate open/close using maxHeight
      function openDetails(el){
        el.hidden = false;
        el.style.display = 'block';
        // give layout time to apply display before measuring
        requestAnimationFrame(function(){
          var height = el.scrollHeight + 'px';
          el.style.maxHeight = '0px';
          el.style.opacity = '0';
          // next frame set to desired height
          requestAnimationFrame(function(){
            el.style.maxHeight = height;
            el.style.opacity = '1';
          });
        });
      }
      function closeDetails(el){
        // animate to zero then hide
        el.style.maxHeight = el.scrollHeight + 'px';
        el.style.opacity = '1';
        requestAnimationFrame(function(){
          el.style.maxHeight = '0px';
          el.style.opacity = '0';
        });
        // after transition, set hidden
        var t = parseFloat(getComputedStyle(el).transitionDuration || 0) * 1000;
        setTimeout(function(){
          el.hidden = true;
          el.style.display = '';
          el.style.maxHeight = '';
          el.style.opacity = '';
        }, t + 20);
      }

      // Generic toggle handler for any disclosure-like widget
      document.querySelectorAll('button[data-toggle]').forEach(function(btn){
        var type = btn.getAttribute('data-toggle');
        var detailsId = btn.getAttribute('aria-controls');
        var details = detailsId ? document.getElementById(detailsId) : null;
        if(!details) return;

        btn.addEventListener('click', function(){
          var expanded = btn.getAttribute('aria-expanded') === 'true';
          if(type === 'accordion'){
            // Close other accordion sections within the same tablist (if any)
            var container = btn.closest('[role="tablist"]') || document;
            container.querySelectorAll('button[data-toggle="accordion"]').forEach(function(other){
              if(other === btn) return;
              var oid = other.getAttribute('aria-controls');
              var odetails = oid ? document.getElementById(oid) : null;
              if(odetails && other.getAttribute('aria-expanded') === 'true'){
                other.setAttribute('aria-expanded','false');
                odetails.setAttribute('aria-hidden','true');
                closeDetails(odetails);
              }
            });
          }

          if(expanded){
            btn.setAttribute('aria-expanded','false');
            details.setAttribute('aria-hidden','true');
            closeDetails(details);
          } else {
            btn.setAttribute('aria-expanded','true');
            details.setAttribute('aria-hidden','false');
            openDetails(details);
          }
        });

        // Keyboard navigation for accordions (arrow/home/end)
        if(type === 'accordion'){
          btn.addEventListener('keydown', function(e){
            var KEY = {UP:38,DOWN:40,HOME:36,END:35};
            var list = (btn.closest('[role="tablist"]') || document).querySelectorAll('button[data-toggle="accordion"]');
            var idx = Array.prototype.indexOf.call(list, btn);
            switch(e.keyCode){
              case KEY.UP:
                e.preventDefault();
                var prev = list[(idx - 1 + list.length) % list.length];
                prev.focus();
                break;
              case KEY.DOWN:
                e.preventDefault();
                var next = list[(idx + 1) % list.length];
                next.focus();
                break;
              case KEY.HOME:
                e.preventDefault();
                list[0].focus();
                break;
              case KEY.END:
                e.preventDefault();
                list[list.length - 1].focus();
                break;
            }
          });
        }
      });

      // If user navigates with focus and activation via keyboard, normal <button> handles Space/Enter click.
      // Ensure content respects initial aria-expanded states (none open by default).
      // For demonstration, leave all closed.
    })();
  </script>
</body>
</html>