<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#0b6cf2;
      --bg:#f7f9fc;
      --card:#ffffff;
      --muted:#6b7280;
      --radius:8px;
      --transition:250ms cubic-bezier(.2,.9,.3,1);
    }
    body{
      font-family: system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
      background: linear-gradient(180deg,var(--bg),#eef4ff);
      padding: 32px;
      color:#0f1724;
      line-height:1.4;
    }

    h1{font-size:1.25rem;margin:0 0 18px 0}
    p.lead{margin:0 0 24px 0;color:var(--muted)}

    .container{
      max-width:760px;
      margin:0 auto;
    }

    /* Example wrapper */
    .example{
      background:var(--card);
      border-radius:var(--radius);
      padding:16px;
      box-shadow:0 2px 8px rgba(12,20,40,0.06);
      margin-bottom:16px;
    }

    /* Toggle button */
    .toggle{
      display:flex;
      align-items:center;
      justify-content:space-between;
      width:100%;
      background:transparent;
      border:1px solid transparent;
      padding:10px 12px;
      border-radius:8px;
      cursor:pointer;
      font-weight:600;
      color:#071127;
      font-size:1rem;
      transition:background var(--transition),box-shadow var(--transition),border-color var(--transition);
    }
    .toggle:hover{
      background:rgba(11,108,242,0.06);
    }
    .toggle:focus{
      outline:none;
      box-shadow:0 0 0 4px rgba(11,108,242,0.12);
      border-color: rgba(11,108,242,0.16);
    }

    .toggle .meta{
      display:flex;
      gap:12px;
      align-items:center;
      color:var(--muted);
      font-weight:500;
      font-size:0.95rem;
    }

    /* Chevron (pseudo) */
    .toggle .chev{
      width:18px;
      height:18px;
      display:inline-block;
      transition:transform var(--transition);
      color:var(--accent);
      margin-left:12px;
      flex-shrink:0;
    }
    .toggle[aria-expanded="true"] .chev{
      transform:rotate(180deg);
    }

    /* Details (controlled content) */
    .details{
      overflow:hidden;
      max-height:0;
      transition:max-height var(--transition),opacity var(--transition);
      opacity:0;
      margin-top:12px;
      border-top:1px dashed rgba(12,20,40,0.06);
      padding-top:12px;
    }
    .details.open{
      opacity:1;
    }

    .details p{margin:0 0 8px 0;color:#123}
    .details ul{margin:0;padding-left:18px;color:var(--muted)}
    .small{
      font-size:0.875rem;
      color:var(--muted);
    }

    /* Example variations */
    .example.small{padding:12px}
    .example.alt{background:linear-gradient(180deg,#ffffff,#fbfdff)}

    /* Visually hidden for assistive text if needed */
    .visually-hidden{
      position:absolute!important;
      height:1px;width:1px;overflow:hidden;
      clip:rect(1px,1px,1px,1px);
      white-space:nowrap;border:0;padding:0;margin:-1px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Expand / Collapse Widgets</h1>
    <p class="lead">Each widget is wrapped in a div.example. The controlled content has the class details. Buttons use aria-expanded and aria-controls for accessibility.</p>

    <!-- Example 1 -->
    <div class="example" data-example="1">
      <button type="button"
              id="toggle-1"
              class="toggle"
              aria-expanded="false"
              aria-controls="details-1"
              >
        <span>
          Show More About Feature A
        </span>
        <span style="display:flex;align-items:center">
          <span class="meta small">Estimated read: 30s</span>
          <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path fill="currentColor" d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"/>
          </svg>
        </span>
      </button>

      <div id="details-1"
           class="details"
           role="region"
           aria-labelledby="toggle-1"
           aria-hidden="true">
        <p>
          Feature A improves performance by asynchronously batching updates and reducing reflows. This short description demonstrates the controlled content area.
        </p>
        <ul>
          <li>Batching updates</li>
          <li>Reduced reflows</li>
          <li>Better perceived speed</li>
        </ul>
      </div>
    </div>

    <!-- Example 2 (initially open) -->
    <div class="example alt" data-example="2">
      <button type="button"
              id="toggle-2"
              class="toggle"
              aria-expanded="true"
              aria-controls="details-2"
              >
        <span>
          Release Notes â€” Version 2.1
        </span>
        <span style="display:flex;align-items:center">
          <span class="meta small">Updated today</span>
          <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path fill="currentColor" d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"/>
          </svg>
        </span>
      </button>

      <div id="details-2"
           class="details"
           role="region"
           aria-labelledby="toggle-2"
           aria-hidden="false">
        <p><strong>What's new:</strong></p>
        <ul>
          <li>Added keyboard shortcuts for quick navigation.</li>
          <li>Improved reliability of the sync engine.</li>
          <li>Minor UI polish and bug fixes.</li>
        </ul>
        <p class="small">Tip: Press Space or Enter while the toggle has focus to collapse/expand.</p>
      </div>
    </div>

  </div>

  <script>
    (function(){
      // Initialize all examples
      const examples = document.querySelectorAll('.example');
      examples.forEach(example => {
        const btn = example.querySelector('.toggle');
        const details = example.querySelector('.details');
        if(!btn || !details) return;

        // Ensure IDs exist for aria-controls/labelledby
        if(!btn.id) btn.id = 'toggle-'+Math.random().toString(36).slice(2,9);
        if(!details.id) details.id = 'details-'+Math.random().toString(36).slice(2,9);

        btn.setAttribute('aria-controls', details.id);
        details.setAttribute('aria-labelledby', btn.id);

        // Helper to set collapsed/expanded state with animation
        const expand = () => {
          details.classList.add('open');
          details.style.maxHeight = details.scrollHeight + 'px';
          details.setAttribute('aria-hidden','false');
          btn.setAttribute('aria-expanded','true');
        };
        const collapse = () => {
          // For smooth collapse, set maxHeight to current scrollHeight then to 0
          details.style.maxHeight = details.scrollHeight + 'px';
          // Force repaint to ensure transition
          // eslint-disable-next-line no-unused-expressions
          details.offsetHeight;
          details.style.maxHeight = '0px';
          details.setAttribute('aria-hidden','true');
          btn.setAttribute('aria-expanded','false');
          // remove open class after transition to hide border/padding areas if needed
        };

        // Setup initial state from aria-expanded attribute
        const initiallyExpanded = btn.getAttribute('aria-expanded') === 'true';
        if(initiallyExpanded){
          // open without transition (set maxHeight to scrollHeight so transition can work later)
          details.classList.add('open');
          details.style.maxHeight = details.scrollHeight + 'px';
          details.setAttribute('aria-hidden','false');
          btn.setAttribute('aria-expanded','true');
        } else {
          details.classList.remove('open');
          details.style.maxHeight = '0px';
          details.setAttribute('aria-hidden','true');
          btn.setAttribute('aria-expanded','false');
        }

        btn.addEventListener('click', () => {
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          if(expanded){
            collapse();
          } else {
            expand();
          }
        });

        // After transition ends, tidy up inline styles for open state so content can grow naturally if needed
        details.addEventListener('transitionend', (e) => {
          if(e.propertyName !== 'max-height') return;
          const isOpen = btn.getAttribute('aria-expanded') === 'true';
          if(isOpen){
            // clear max-height so content can expand if children change; keep open class for styles
            details.style.maxHeight = 'none';
          } else {
            details.classList.remove('open');
          }
        });

        // If window resizes and details is open, adjust the maxHeight to fit new content size
        window.addEventListener('resize', () => {
          const isOpen = btn.getAttribute('aria-expanded') === 'true';
          if(isOpen){
            // temporarily set maxHeight to scrollHeight
            details.style.maxHeight = details.scrollHeight + 'px';
            // then let transitionend clear it to 'none' (or keep it if no transition)
            // This avoids jumpiness when resizing while expanded.
            // If we had previously set maxHeight to 'none', reapply it after a tick.
            requestAnimationFrame(() => {
              details.style.maxHeight = 'none';
            });
          }
        });

        // Support keyboard toggling on Space/Enter is automatic for button elements.
        // Extra: allow ESC to collapse when inside details
        details.addEventListener('keydown', (ev) => {
          if(ev.key === 'Escape' || ev.key === 'Esc'){
            collapse();
            btn.focus();
          }
        });
      });
    })();
  </script>
</body>
</html>