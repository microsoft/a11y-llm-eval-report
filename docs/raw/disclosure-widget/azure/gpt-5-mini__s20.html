<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#1e88e5;
      --radius:8px;
      --transition:240ms cubic-bezier(.2,.8,.2,1);
      --bg:#f8fafc;
      --panel-bg:#fff;
      --muted:#6b7280;
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      line-height:1.4;
      margin: 24px;
      background: linear-gradient(180deg, #fbfdff 0%, #f4f7fb 100%);
      color: #0f172a;
    }

    h1{
      margin-top: 0;
      font-size: 1.25rem;
      font-weight: 600;
    }

    p.lead{
      margin-top:0.25rem;
      margin-bottom: 1rem;
      color: var(--muted);
      font-size:0.95rem;
    }

    .example{
      border: 1px solid rgba(15,23,42,0.06);
      background: var(--panel-bg);
      padding: 12px;
      border-radius: var(--radius);
      box-shadow: 0 1px 2px rgba(2,6,23,0.04);
      max-width: 720px;
      margin-bottom: 16px;
    }

    /* Toggle button */
    .toggle {
      display:flex;
      align-items: center;
      gap: 12px;
      width:100%;
      background:transparent;
      border: none;
      padding: 8px 12px;
      text-align: left;
      cursor: pointer;
      border-radius: 8px;
      transition: background var(--transition);
      font-size: 1rem;
    }

    .toggle:focus {
      outline: 3px solid rgba(30,136,229,0.18);
      outline-offset: 2px;
    }

    .toggle:hover{
      background: rgba(15,23,42,0.02);
    }

    .toggle .label{
      flex: 1 1 auto;
      display:flex;
      flex-direction:column;
      align-items:flex-start;
    }

    .toggle .title{
      font-weight:600;
      font-size: 1rem;
      color: #0f172a;
    }

    .toggle .desc{
      font-size: 0.86rem;
      color: var(--muted);
      margin-top: 2px;
    }

    .chev{
      width:24px;
      height:24px;
      display:inline-grid;
      place-items:center;
      transition: transform var(--transition);
      color: var(--accent);
      flex: 0 0 24px;
    }

    /* Rotate when expanded using aria-expanded attribute on button */
    .toggle[aria-expanded="true"] .chev{
      transform: rotate(90deg);
    }

    /* Controlled content panel */
    .details{
      overflow: hidden;
      max-height: 0;
      transition: max-height var(--transition), opacity var(--transition);
      opacity: 0;
      margin-top: 8px;
      border-top: 1px dashed rgba(15,23,42,0.06);
      padding-top: 12px;
    }

    /* When the panel is open we add an 'open' class via JS */
    .details.open{
      opacity: 1;
    }

    /* Content inside details */
    .details .inner{
      padding: 6px 2px;
    }

    /* A simple list inside */
    ul.feature-list{
      margin: 0;
      padding-left: 1.25rem;
      color: var(--muted);
    }

    /* Reduced motion: disable height animation */
    @media (prefers-reduced-motion: reduce){
      .details{
        transition: none;
      }
      .chev{
        transition: none;
      }
    }

    /* Small utility */
    .muted{
      color: var(--muted);
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <h1>Expand / Collapse Widget</h1>
  <p class="lead">Examples of an accessible expand/collapse pattern. Each widget is wrapped with a div.example and the controlled content container uses class="details".</p>

  <!-- Example 1: Simple info panel -->
  <div class="example">
    <button class="toggle" aria-expanded="false" aria-controls="details-1" id="toggle-1">
      <span class="label">
        <span class="title">More information</span>
        <span class="desc">Tap to reveal additional details.</span>
      </span>
      <span class="chev" aria-hidden="true">▶</span>
    </button>

    <div class="details" id="details-1" role="region" aria-labelledby="toggle-1" hidden>
      <div class="inner">
        <p class="muted">This is additional contextual information that is hidden by default. Use the button above to toggle visibility. The panel is accessible via aria-controls and aria-expanded on the button, and the region has role="region".</p>
      </div>
    </div>
  </div>

  <!-- Example 2: Feature list -->
  <div class="example">
    <button class="toggle" aria-expanded="false" aria-controls="details-2" id="toggle-2">
      <span class="label">
        <span class="title">View features</span>
        <span class="desc">See a short list of features for this product.</span>
      </span>
      <span class="chev" aria-hidden="true">▶</span>
    </button>

    <div class="details" id="details-2" role="region" aria-labelledby="toggle-2" hidden>
      <div class="inner">
        <ul class="feature-list">
          <li>Fast and responsive UI</li>
          <li>Accessible markup and keyboard support</li>
          <li>Lightweight and easy to style</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Example 3: Expanded content with actions -->
  <div class="example">
    <button class="toggle" aria-expanded="false" aria-controls="details-3" id="toggle-3">
      <span class="label">
        <span class="title">Advanced options</span>
        <span class="desc">Toggle advanced settings and actions.</span>
      </span>
      <span class="chev" aria-hidden="true">▶</span>
    </button>

    <div class="details" id="details-3" role="region" aria-labelledby="toggle-3" hidden>
      <div class="inner">
        <p class="muted">Adjust the following settings for more control.</p>
        <div style="margin-top:8px; display:flex; gap:8px; flex-wrap:wrap;">
          <button type="button">Reset</button>
          <button type="button">Apply</button>
          <button type="button">Preview</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function(){
      // Utility to animate open/close using max-height and class toggles
      function setOpen(detailsEl, open){
        if(open){
          // remove hidden attribute for assistive tech
          detailsEl.hidden = false;
          detailsEl.classList.add('open');
          // Set max-height to scrollHeight to animate
          const start = detailsEl.scrollHeight;
          detailsEl.style.maxHeight = start + "px";

          // when transition ends, clear max-height so content can resize naturally
          const cleanup = () => {
            // Only clear if still open
            if(detailsEl.classList.contains('open')){
              detailsEl.style.maxHeight = "";
            }
            detailsEl.removeEventListener('transitionend', cleanup);
          };
          detailsEl.addEventListener('transitionend', cleanup);
        } else {
          // animate to 0
          const curHeight = detailsEl.scrollHeight;
          // set explicit height to enable transition
          detailsEl.style.maxHeight = curHeight + "px";
          // force reflow
          void detailsEl.offsetHeight;
          detailsEl.classList.remove('open');
          detailsEl.style.maxHeight = "0px";

          const onHidden = () => {
            detailsEl.hidden = true;
            detailsEl.removeEventListener('transitionend', onHidden);
          };
          detailsEl.addEventListener('transitionend', onHidden);
        }
      }

      // Initialize toggles
      const toggles = document.querySelectorAll('.toggle[aria-controls]');
      toggles.forEach(btn => {
        const id = btn.getAttribute('aria-controls');
        const panel = document.getElementById(id);
        if(!panel) return;

        // ensure initial state matches DOM (hidden attribute)
        const expanded = btn.getAttribute('aria-expanded') === 'true';
        if(expanded){
          panel.hidden = false;
          panel.classList.add('open');
          panel.style.maxHeight = "";
        } else {
          panel.hidden = true;
          panel.classList.remove('open');
          panel.style.maxHeight = "0px";
        }

        // click handler
        btn.addEventListener('click', () => {
          const isExpanded = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!isExpanded));
          setOpen(panel, !isExpanded);
        });

        // Support keyboard toggle through Space/Enter is native on button.
        // Allow Escape to close when focus inside panel
        panel.addEventListener('keydown', (e) => {
          if(e.key === 'Escape' || e.key === 'Esc'){
            btn.focus();
            btn.setAttribute('aria-expanded', 'false');
            setOpen(panel, false);
          }
        });
      });

      // Optional: close all open panels when pressing Shift+Escape anywhere
      document.addEventListener('keydown', (e) => {
        if(e.key === 'Escape' && e.shiftKey){
          toggles.forEach(btn => {
            const id = btn.getAttribute('aria-controls');
            const panel = document.getElementById(id);
            btn.setAttribute('aria-expanded','false');
            setOpen(panel, false);
          });
        }
      });
    })();
  </script>
</body>
</html>