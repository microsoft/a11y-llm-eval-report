<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Expand/Collapse Widget Examples</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    *, *::before, *::after { box-sizing: border-box; }
    :root {
      --border: #d0d7de;
      --bg: #f6f8fa;
      --text: #0f172a;
      --accent: #2563eb;
    }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background: #fff;
      line-height: 1.6;
    }
    main {
      max-width: 900px;
      margin: 0 auto;
      padding: 32px 16px 64px;
    }
    header {
      margin-bottom: 24px;
    }
    header h1 {
      margin: 0 0 8px 0;
      font-size: 1.8rem;
    }
    header p {
      margin: 0;
      color: #475569;
    }
    .example {
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 16px;
      background: var(--bg);
      margin: 16px 0;
    }
    .example h2 {
      margin: 0 0 10px 0;
      font-size: 1.2rem;
      color: #1f2937;
    }
    .toggle {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 10px 12px;
      background: #fff;
      color: #0f172a;
      font-weight: 600;
      cursor: pointer;
      transition: background 150ms ease, border-color 150ms ease, box-shadow 150ms ease;
      user-select: none;
    }
    .toggle:hover {
      background: #ffffff;
      border-color: #c3cad1;
      box-shadow: 0 1px 2px rgba(0,0,0,0.06);
    }
    .toggle:focus-visible {
      outline: 3px solid rgba(37,99,235,0.35);
      outline-offset: 2px;
    }
    .toggle::after {
      content: "▸";
      display: inline-block;
      transform-origin: center;
      transition: transform 200ms ease;
      color: #334155;
    }
    /* Rotate arrow for JS button when expanded */
    .toggle[aria-expanded="true"]::after {
      transform: rotate(90deg);
    }

    /* Visually hidden element (accessible to screen readers) */
    .visually-hidden {
      position: absolute !important;
      width: 1px !important;
      height: 1px !important;
      padding: 0 !important;
      margin: -1px !important;
      overflow: hidden !important;
      clip: rect(0, 0, 0, 0) !important;
      white-space: nowrap !important;
      border: 0 !important;
    }

    /* Container for controlled content (non-native details) */
    .details:not(details) {
      max-height: 0;
      overflow: hidden;
      opacity: 0;
      transition: max-height 260ms ease, opacity 200ms ease;
      will-change: max-height, opacity;
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 0 12px;
      margin-top: 10px;
    }
    .details:not(details).is-open {
      opacity: 1;
      /* max-height is set dynamically by JS or via checkbox state */
    }
    .details:not(details) > .inner {
      padding: 12px 0;
    }

    /* CSS-only toggler arrow based on checkbox state */
    #css-toggle-1 + label.toggle::after {
      transform: rotate(0deg);
    }
    #css-toggle-1:checked + label.toggle::after {
      transform: rotate(90deg);
    }
    /* CSS-only open state */
    #css-toggle-1:checked ~ .details {
      max-height: 700px; /* large enough for demo content */
      opacity: 1;
    }

    /* Styling for native <details> */
    details.details {
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 0 12px;
    }
    details.details > summary {
      list-style: none;
      cursor: pointer;
      font-weight: 600;
      padding: 10px 0;
      position: relative;
      user-select: none;
    }
    details.details > summary::marker {
      content: "";
    }
    details.details > summary::after {
      content: "▸";
      position: absolute;
      right: 0;
      top: 50%;
      transform: translateY(-50%);
      transition: transform 200ms ease;
      color: #334155;
    }
    details.details[open] > summary::after {
      transform: translateY(-50%) rotate(90deg);
    }
    details.details > .content {
      border-top: 1px dashed #e5e7eb;
      padding: 12px 0;
      color: #334155;
    }

    /* Content utility styles */
    .content p { margin: 0 0 10px 0; }
    .content ul { margin: 0 0 10px 20px; }
    code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      background: #f1f5f9;
      border: 1px solid #e2e8f0;
      padding: 2px 4px;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <main>
    <header>
      <h1>Expand/Collapse Widgets</h1>
      <p>Three approaches: native HTML details, CSS-only, and JavaScript-controlled. Each widget is wrapped with an <code>example</code> container, and the controlled content uses a <code>details</code> class.</p>
    </header>

    <div class="example">
      <h2>Native HTML details</h2>
      <details class="details">
        <summary>Shipping and returns</summary>
        <div class="content">
          <p>Most orders ship within 2 business days. You will receive a tracking number by email when your order ships.</p>
          <p>Returns are accepted within 30 days of delivery. Items must be in original condition. To start a return, visit your account and select the order.</p>
          <ul>
            <li>Processing time: 1–2 business days</li>
            <li>Standard shipping: 3–5 business days</li>
            <li>Express shipping: 1–2 business days</li>
          </ul>
        </div>
      </details>
    </div>

    <div class="example">
      <h2>CSS-only toggle</h2>
      <input type="checkbox" id="css-toggle-1" class="visually-hidden" aria-controls="css-content-1" aria-expanded="false">
      <label for="css-toggle-1" class="toggle" id="css-toggle-label-1">Frequently asked questions</label>
      <div class="details" id="css-content-1" role="region" aria-labelledby="css-toggle-label-1" aria-hidden="true">
        <div class="inner">
          <div class="content">
            <p><strong>Q:</strong> Do you ship internationally?</p>
            <p><strong>A:</strong> Yes, we ship to most countries. Shipping rates and times vary by location.</p>
            <p><strong>Q:</strong> Can I change my order after placing it?</p>
            <p><strong>A:</strong> Changes are possible within 2 hours of placing your order. Contact support for assistance.</p>
          </div>
        </div>
      </div>
    </div>

    <div class="example">
      <h2>JavaScript-controlled panel</h2>
      <button class="toggle" id="js-toggle-1" data-toggle-js aria-controls="js-content-1" aria-expanded="false">Product specifications</button>
      <div class="details" id="js-content-1" role="region" aria-labelledby="js-toggle-1" aria-hidden="true">
        <div class="inner">
          <div class="content">
            <p>Model: X200 Ultra</p>
            <ul>
              <li>Display: 6.5" OLED, 120 Hz</li>
              <li>Processor: Octa-core 3.2 GHz</li>
              <li>Storage: 256 GB</li>
              <li>Battery: 5,000 mAh fast charge</li>
            </ul>
            <p>Warranty: 2 years limited warranty. See our <a href="#">terms</a> for details.</p>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Keep CSS-only example's ARIA state in sync with checkbox state
    (function () {
      const cb = document.getElementById('css-toggle-1');
      const content = document.getElementById('css-content-1');
      const label = document.getElementById('css-toggle-label-1');
      if (!cb || !content) return;

      const setAria = () => {
        const expanded = cb.checked;
        cb.setAttribute('aria-expanded', String(expanded));
        content.setAttribute('aria-hidden', String(!expanded));
      };
      cb.addEventListener('change', setAria);
      // Initialize
      setAria();
      // Allow label click to trigger (already via for=), but ensure keyboard is fine
      label.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          cb.checked = !cb.checked;
          cb.dispatchEvent(new Event('change', { bubbles: true }));
        }
      });
    })();

    // JavaScript-controlled toggler with animated height
    (function () {
      const buttons = document.querySelectorAll('[data-toggle-js]');
      buttons.forEach((btn) => {
        const targetId = btn.getAttribute('aria-controls');
        const panel = document.getElementById(targetId);
        if (!panel) return;

        const open = () => {
          btn.setAttribute('aria-expanded', 'true');
          panel.setAttribute('aria-hidden', 'false');
          panel.classList.add('is-open');
          // Set max-height for smooth animation
          panel.style.maxHeight = panel.scrollHeight + 'px';
          panel.style.opacity = '1';
        };
        const close = () => {
          btn.setAttribute('aria-expanded', 'false');
          panel.setAttribute('aria-hidden', 'true');
          // Animate to 0 height
          panel.style.maxHeight = '0px';
          panel.style.opacity = '0';
          // Remove class after the transition finishes for consistency
          const onTransitionEnd = (e) => {
            if (e.propertyName === 'max-height') {
              panel.classList.remove('is-open');
              panel.removeEventListener('transitionend', onTransitionEnd);
            }
          };
          panel.addEventListener('transitionend', onTransitionEnd);
        };

        const toggle = () => {
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          if (expanded) {
            close();
          } else {
            open();
          }
        };

        btn.addEventListener('click', toggle);

        // Recalculate height when content or viewport size changes
        const recalc = () => {
          if (btn.getAttribute('aria-expanded') === 'true') {
            panel.style.maxHeight = panel.scrollHeight + 'px';
          }
        };
        window.addEventListener('resize', recalc);
        // Initialize closed
        close();
      });
    })();
  </script>
</body>
</html>