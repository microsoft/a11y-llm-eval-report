<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#2563eb;
      --muted:#6b7280;
      --bg:#f8fafc;
      --surface:#ffffff;
      --radius:8px;
      --shadow: 0 2px 10px rgba(16,24,40,0.06);
    }

    body{
      margin: 24px;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,var(--bg),#ffffff 60%);
      color: #0f172a;
      line-height: 1.45;
    }

    h1{ margin: 0 0 12px 0; font-size: 20px; }
    p.lead { margin: 0 0 20px 0; color: var(--muted); }

    .example{
      background: var(--surface);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px;
      margin: 16px 0;
      max-width: 720px;
      border: 1px solid rgba(15,23,42,0.04);
    }

    .toggle{
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      background: transparent;
      border: 1px solid rgba(15,23,42,0.06);
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      color: #0f172a;
      user-select: none;
    }

    .toggle:focus{
      outline: 3px solid rgba(37,99,235,0.14);
      outline-offset: 2px;
    }

    .toggle .chev{
      width: 14px;
      height: 14px;
      transition: transform 220ms ease;
      transform-origin: center;
      display: inline-block;
    }

    .toggle[aria-expanded="true"] .chev{
      transform: rotate(90deg);
    }

    .details{
      overflow: hidden;
      transition: max-height 300ms cubic-bezier(.2,.9,.3,1), opacity 220ms ease;
      opacity: 1;
      margin-top: 12px;
      /* start closed by default unless removed in markup */
    }

    .details[hidden]{
      /* We'll rely on max-height animation for visual collapse.
         Keep pointer-events: none and opacity small to avoid accidental focus. */
      pointer-events: none;
      opacity: 0;
    }

    .details .inner{
      padding: 8px 0;
    }

    /* Simple content styling */
    .note{
      background: linear-gradient(180deg, #f8fafc, #ffffff);
      padding: 12px;
      border-radius: 6px;
      border: 1px solid rgba(15,23,42,0.04);
      color: var(--muted);
      font-size: 14px;
    }

    .form-row{
      display:flex;
      gap:8px;
      margin-top:10px;
    }
    .form-row input[type="text"]{
      flex:1;
      padding:8px;
      border-radius:6px;
      border:1px solid rgba(15,23,42,0.08);
    }

    /* small helper */
    .meta { color: var(--muted); font-size: 13px; margin-top: 8px; }
  </style>
</head>
<body>
  <h1>Expand / Collapse widget</h1>
  <p class="lead">Each widget below is wrapped in a div.example. The controlled content container uses the class="details".</p>

  <!-- Example 1: Simple text -->
  <div class="example">
    <button id="btn1" class="toggle" aria-expanded="false" aria-controls="panel1">
      <span class="chev" aria-hidden="true">▶</span>
      Simple details
    </button>

    <div id="panel1" class="details" role="region" aria-hidden="true" aria-labelledby="btn1" hidden>
      <div class="inner">
        <p class="note">This is a short block of content that can be expanded or collapsed. It uses the class="details" on the container and is controlled by the button above.</p>
      </div>
    </div>
    <div class="meta">Example 1: default closed</div>
  </div>

  <!-- Example 2: Form / interactive content (opened by default) -->
  <div class="example">
    <button id="btn2" class="toggle" aria-expanded="true" aria-controls="panel2">
      <span class="chev" aria-hidden="true">▶</span>
      User settings
    </button>

    <div id="panel2" class="details" role="region" aria-hidden="false" aria-labelledby="btn2">
      <div class="inner">
        <p class="note">Update your display name and preferences. This panel starts open to demonstrate an expanded state.</p>
        <div class="form-row">
          <label for="name">Name</label>
          <input id="name" type="text" value="Sam Example" />
        </div>
        <div class="form-row">
          <label for="color">Favorite color</label>
          <input id="color" type="text" placeholder="e.g. Blue" />
        </div>
      </div>
    </div>
    <div class="meta">Example 2: default open</div>
  </div>

  <!-- Example 3: Long content to show animation -->
  <div class="example">
    <button id="btn3" class="toggle" aria-expanded="false" aria-controls="panel3">
      <span class="chev" aria-hidden="true">▶</span>
      Read more (long content)
    </button>

    <div id="panel3" class="details" role="region" aria-hidden="true" aria-labelledby="btn3" hidden>
      <div class="inner">
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer ut ipsum at lacus sollicitudin efficitur. Sed vitae elit vitae arcu feugiat consequat. Nunc pharetra magna vitae velit lacinia, vitae hendrerit augue tristique. Phasellus et sem sit amet erat varius egestas. Aenean hendrerit libero in lectus aliquet, nec placerat urna pharetra.</p>
        <p>Praesent non nisl ut neque tincidunt consequat. Donec at felis vel mauris faucibus pulvinar. Aliquam ut nibh nibh. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Vestibulum vestibulum, neque ut vehicula placerat, nibh elit dictum augue, at viverra quam nisl vitae libero.</p>
        <p>Curabitur vitae neque sit amet urna interdum volutpat. Integer sit amet lacus id tortor gravida lacinia. Suspendisse potenti. Integer bibendum semper urna, sed dapibus lorem dapibus id.</p>
      </div>
    </div>
    <div class="meta">Example 3: long content, closed</div>
  </div>

  <script>
    // Toggle behavior for buttons with class "toggle"
    (function(){
      function expand(details, button){
        // make visible for measurement
        details.removeAttribute('hidden');
        details.setAttribute('aria-hidden', 'false');
        button.setAttribute('aria-expanded', 'true');

        // get the height to animate to
        var startHeight = details.scrollHeight;

        // Set explicit max-height for transition
        details.style.maxHeight = '0px';
        // Force a repaint so the starting max-height is applied
        // then set to the target height.
        requestAnimationFrame(function(){
          details.style.transition = 'max-height 300ms cubic-bezier(.2,.9,.3,1), opacity 220ms ease';
          details.style.maxHeight = startHeight + 'px';
          details.style.opacity = '1';
        });

        // After transition, clear inline max-height so content can size naturally
        var after = function(){
          details.style.maxHeight = '';
          details.style.transition = '';
          details.removeEventListener('transitionend', after);
        };
        details.addEventListener('transitionend', after);
      }

      function collapse(details, button){
        // measure current height
        var startHeight = details.scrollHeight;
        // set explicit height so we can animate from it
        details.style.maxHeight = startHeight + 'px';
        details.style.transition = 'max-height 300ms cubic-bezier(.2,.9,.3,1), opacity 220ms ease';

        // trigger a repaint then animate to 0
        requestAnimationFrame(function(){
          details.style.maxHeight = '0px';
          details.style.opacity = '0';
        });

        // When finished, hide it from accessibility tree and remove inline styles
        var after = function(){
          details.setAttribute('hidden', '');
          details.setAttribute('aria-hidden', 'true');
          details.style.maxHeight = '';
          details.style.transition = '';
          details.style.opacity = '';
          details.removeEventListener('transitionend', after);
        };
        details.addEventListener('transitionend', after);

        button.setAttribute('aria-expanded', 'false');
      }

      function toggle(event){
        var btn = event.currentTarget;
        var targetId = btn.getAttribute('aria-controls');
        if(!targetId) return;
        var details = document.getElementById(targetId);
        if(!details) return;

        var isExpanded = btn.getAttribute('aria-expanded') === 'true';
        if(isExpanded){
          collapse(details, btn);
        } else {
          expand(details, btn);
        }
      }

      // Initialize: ensure details elements that are not hidden have no hidden attribute
      document.querySelectorAll('.details').forEach(function(d){
        if (d.getAttribute('aria-hidden') === 'false'){
          // ensure visible state starts expanded with no hidden attr and no max-height to avoid animation on load
          d.removeAttribute('hidden');
          d.style.maxHeight = '';
          d.style.opacity = '';
        } else {
          // ensure hidden attribute exists for collapsed panels
          d.setAttribute('hidden','');
        }
      });

      // Attach listeners
      document.querySelectorAll('.toggle').forEach(function(b){
        b.addEventListener('click', toggle);
      });

      // Optional: support toggling by pressing Enter or Space when focused on the button
      // (button elements already do this by default, but the handler covers custom behavior)
      document.addEventListener('keydown', function(e){
        var t = e.target;
        if(t && t.classList && t.classList.contains('toggle')){
          if(e.code === 'Enter' || e.code === 'Space' || e.key === ' '){
            e.preventDefault();
            t.click();
          }
        }
      });
    })();
  </script>
</body>
</html>