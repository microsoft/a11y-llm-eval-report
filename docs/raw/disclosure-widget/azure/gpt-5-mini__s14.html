<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#0466c8;
      --muted:#555;
      --bg:#f8f9fb;
      --card:#fff;
      --radius:8px;
      --transition:200ms ease;
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      line-height:1.4;
      margin:20px;
      background: linear-gradient(180deg,#fbfdff,#f3f7fb);
      color:#102a43;
    }

    h1{
      font-size:1.25rem;
      margin:0 0 18px 0;
    }

    .example{
      background:var(--card);
      border:1px solid #e6eef8;
      border-radius:var(--radius);
      padding:16px;
      margin:12px 0;
      box-shadow: 0 1px 2px rgba(16,42,67,0.04);
      max-width:720px;
    }

    .example + .example{
      margin-top:18px;
    }

    .widget-header{
      display:flex;
      align-items:center;
      gap:12px;
      justify-content:space-between;
    }

    .title{
      display:flex;
      gap:12px;
      align-items:center;
    }

    .title h2{
      font-size:1rem;
      margin:0;
      font-weight:600;
    }

    .hint{
      color:var(--muted);
      font-size:.875rem;
    }

    .toggle{
      background:transparent;
      border:1px solid transparent;
      color:var(--accent);
      padding:8px 12px;
      border-radius:6px;
      cursor:pointer;
      font-weight:600;
      display:inline-flex;
      align-items:center;
      gap:8px;
      transition:background var(--transition), box-shadow var(--transition), transform var(--transition);
    }

    .toggle:focus{
      outline:4px solid rgba(4,102,200,0.12);
      outline-offset:2px;
    }

    /* add a simple chevron using generated content */
    .toggle::after{
      content: "â–¾";
      font-size:0.85rem;
      display:inline-block;
      transform-origin:center;
      transition:transform var(--transition);
      color:var(--accent);
    }
    .toggle[aria-expanded="true"]::after{
      transform:rotate(180deg);
    }

    /* Controlled content container */
    .details{
      overflow:hidden;
      max-height:0;
      transition:max-height var(--transition);
      margin-top:12px;
      border-top:1px dashed #e6eef8;
      padding-top:12px;
    }

    .details.open{
      /* max-height is set dynamically via JS for smooth animation */
    }

    /* content inside details */
    .details p{
      margin:0 0 8px 0;
      color:#16324f;
    }

    .details ul{
      margin:8px 0 0 18px;
      color:#16324f;
    }

    /* small demo of nested content */
    .nested{
      background:var(--bg);
      border-radius:6px;
      padding:10px;
      margin-top:8px;
    }

    /* tiny footer note */
    .meta{
      margin-top:8px;
      font-size:.85rem;
      color:var(--muted);
    }
  </style>
</head>
<body>
  <h1>Expand / Collapse Widgets</h1>

  <div class="example">
    <div class="widget-header">
      <div class="title">
        <h2>Basic details</h2>
        <span class="hint">A simple accessible toggle</span>
      </div>
      <button class="toggle" aria-expanded="false" aria-controls="details-1" id="toggle-1">
        Show details
      </button>
    </div>

    <div id="details-1" class="details" role="region" aria-labelledby="toggle-1" aria-hidden="true">
      <p>
        This section demonstrates a standard expand/collapse widget. The button above controls the visibility of this content.
        The button uses aria-expanded and aria-controls and the content uses aria-hidden to communicate state to assistive technology.
      </p>
      <ul>
        <li>Accessible: uses semantic button and ARIA attributes.</li>
        <li>Animated: smooth transition using max-height.</li>
        <li>Keyboard operable: Space / Enter activate the button by default.</li>
      </ul>
      <div class="meta">Tip: Resize the content to see the animation adapt.</div>
    </div>
  </div>

  <div class="example">
    <div class="widget-header">
      <div class="title">
        <h2>Nested content example</h2>
        <span class="hint">Shows more complex content inside the details</span>
      </div>
      <button class="toggle" aria-expanded="false" aria-controls="details-2" id="toggle-2">
        Read more
      </button>
    </div>

    <div id="details-2" class="details" role="region" aria-labelledby="toggle-2" aria-hidden="true">
      <p>
        The content below includes nested elements and another simple inline toggle to demonstrate composition.
      </p>

      <div class="nested">
        <p style="margin:0 0 8px 0;">Inside the nested area you can place any markup: forms, lists, images, etc.</p>
        <button class="toggle nested-toggle" aria-expanded="false" aria-controls="nested-details-1" id="nested-toggle-1" style="font-size:.9rem;padding:6px 10px;">
          Reveal nested note
        </button>

        <div id="nested-details-1" class="details" role="region" aria-labelledby="nested-toggle-1" aria-hidden="true" style="margin-top:8px;">
          <p style="margin:0;">This is a nested piece of information. Notice the same patterns apply: aria attributes and animated expand/collapse.</p>
        </div>
      </div>

      <div class="meta">Nested widgets are independent; expand or collapse them separately.</div>
    </div>
  </div>

  <script>
    (function(){
      // Utility to toggle a details element
      function openDetails(details){
        details.classList.add('open');
        // Set explicit max-height to animate from current height to full height
        details.style.maxHeight = details.scrollHeight + 'px';
        details.setAttribute('aria-hidden','false');
      }

      function closeDetails(details){
        // For smooth transition, set maxHeight to current scrollHeight, then to 0
        details.style.maxHeight = details.scrollHeight + 'px';
        // Force style calculation so the transition occurs
        details.getBoundingClientRect();
        requestAnimationFrame(function(){
          details.style.maxHeight = '0px';
        });
        details.setAttribute('aria-hidden','true');
        // Cleanup after transition ends
        details.addEventListener('transitionend', function handler(e){
          if (e.propertyName === 'max-height'){
            details.classList.remove('open');
            details.style.maxHeight = '';
            details.removeEventListener('transitionend', handler);
          }
        });
      }

      function toggle(event){
        var btn = event.currentTarget;
        var controls = btn.getAttribute('aria-controls');
        if (!controls) return;
        var details = document.getElementById(controls);
        if (!details) return;

        var expanded = btn.getAttribute('aria-expanded') === 'true';
        if (expanded){
          btn.setAttribute('aria-expanded','false');
          btn.textContent = btn.textContent.replace(/^(Hide|Close|Collapse)/i, function(){ return 'Show'; }); // gentle try to keep label; not relied upon
          closeDetails(details);
        } else {
          btn.setAttribute('aria-expanded','true');
          btn.textContent = btn.textContent.replace(/^(Show|Read|Reveal)/i, function(orig){ 
            // sensible label swap if matches common verbs
            if (/Read/i.test(orig)) return 'Hide';
            if (/Reveal/i.test(orig)) return 'Hide';
            return 'Hide';
          });
          openDetails(details);
        }
      }

      // Initialize all toggles inside examples
      var toggles = document.querySelectorAll('.example .toggle');
      toggles.forEach(function(btn){
        var controls = btn.getAttribute('aria-controls');
        var details = controls ? document.getElementById(controls) : null;
        if (!details) return;

        // Ensure starting state based on aria-expanded
        var expanded = btn.getAttribute('aria-expanded') === 'true';
        details.setAttribute('aria-hidden', expanded ? 'false' : 'true');
        if (expanded){
          details.classList.add('open');
          // ensure max-height is set so content is visible without animation on load
          details.style.maxHeight = details.scrollHeight + 'px';
        } else {
          details.classList.remove('open');
          details.style.maxHeight = '0px';
        }

        btn.addEventListener('click', toggle);
      });

      // Allow resetting button labels to more descriptive if you prefer
      // (This small helper preserves original text where possible)
    })();
  </script>
</body>
</html>