<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#2563eb;
      --bg:#ffffff;
      --muted:#6b7280;
      --radius:8px;
      --shadow: 0 6px 18px rgba(16,24,40,0.06);
    }
    body{
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,#f8fafc, #ffffff 40%);
      color:#0f172a;
      line-height:1.45;
      padding:40px;
      margin:0;
    }

    h1{
      margin:0 0 20px 0;
      font-size:20px;
      color:var(--accent);
    }
    p.lead { margin:0 0 28px 0; color:var(--muted); }

    .example {
      background: var(--bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:14px;
      margin:18px 0;
      max-width:760px;
    }

    .toggle {
      display:flex;
      align-items:center;
      justify-content:space-between;
      width:100%;
      background:transparent;
      border:1px solid rgba(15,23,42,0.06);
      padding:12px 14px;
      border-radius:8px;
      font-weight:600;
      color:#0f172a;
      cursor:pointer;
      gap:12px;
      transition:box-shadow .15s, border-color .15s;
    }
    .toggle:focus {
      outline: 3px solid rgba(37,99,235,0.18);
      outline-offset:2px;
    }
    .toggle:hover{
      box-shadow:0 4px 10px rgba(2,6,23,0.06);
    }

    .toggle .title {
      display:flex;
      align-items:center;
      gap:12px;
      flex:1 1 auto;
    }
    .toggle .title .dot {
      width:10px;
      height:10px;
      background:var(--accent);
      border-radius:50%;
      opacity:.12;
    }
    .toggle .meta {
      color:var(--muted);
      font-size:13px;
      flex:0 0 auto;
      margin-left:12px;
    }

    /* chevron */
    .toggle .chev {
      width:18px;
      height:18px;
      display:inline-block;
      transform-origin:center;
      transition:transform .22s cubic-bezier(.2,.9,.2,1);
      color:var(--muted);
    }
    /* rotate when open */
    [aria-expanded="true"] .chev{ transform:rotate(180deg); }

    /* details: controlled content container */
    .details{
      overflow:hidden;
      margin-top:12px;
      border-radius:8px;
      transition:max-height .28s cubic-bezier(.2,.9,.2,1), opacity .18s linear;
      background:linear-gradient(180deg, rgba(37,99,235,0.03), rgba(37,99,235,0.01));
      padding:0 12px;
      box-sizing:border-box;
      max-height:0;
      opacity:0;
    }
    .details[data-open="true"]{ opacity:1; }

    .details .inner{
      padding:12px 6px 18px 6px;
    }

    .details p { margin:0 0 10px 0; color:#0f172a; }
    .details ul{ margin:8px 0 0 18px; color:var(--muted); }
    .small { font-size:13px; color:var(--muted); }

    /* small visual separator in nested example */
    .sub-toggle {
      display:flex;
      align-items:center;
      justify-content:space-between;
      width:100%;
      background:transparent;
      border:none;
      padding:8px 6px;
      font-weight:600;
      cursor:pointer;
      color:#0f172a;
    }
    .sub-toggle:focus{ outline:2px solid rgba(37,99,235,0.12); border-radius:6px; }
    .sub-details{ overflow:hidden; transition:max-height .22s ease, opacity .18s linear; max-height:0; opacity:0; }
    .sub-details[data-open="true"]{ opacity:1; }
    code { background:#f1f5f9; padding:2px 6px; border-radius:6px; font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace; font-size:13px; }
  </style>
</head>
<body>
  <h1>Expand / Collapse Widget Examples</h1>
  <p class="lead">Each widget below is wrapped in a div.example. The container that is shown/hidden has the class "details". Buttons control those containers via aria attributes.</p>

  <!-- Example 1: Simple toggle -->
  <div class="example">
    <button id="toggle-1" class="toggle" aria-expanded="false" aria-controls="details-1" data-target="details-1">
      <span class="title"><span class="dot" aria-hidden="true"></span> Simple overview</span>
      <span class="meta small">Click to expand</span>
      <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <polyline points="6 9 12 15 18 9" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>

    <div id="details-1" class="details" data-open="false" role="region" aria-labelledby="toggle-1" aria-hidden="true">
      <div class="inner">
        <p>This is a compact expand/collapse widget. Use the button above to toggle visibility of this content. The button updates <code>aria-expanded</code> and the container carries the <code>details</code> class as requested.</p>
        <p class="small">Tips: keyboard users can press Space or Enter on the button. Screen readers will be informed via the aria attributes.</p>
      </div>
    </div>
  </div>

  <!-- Example 2: Nested details (accordion-like) -->
  <div class="example">
    <button id="toggle-2" class="toggle" aria-expanded="false" aria-controls="details-2" data-target="details-2">
      <span class="title"><span class="dot" aria-hidden="true"></span> Nested sections</span>
      <span class="meta small">Contains inner items</span>
      <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <polyline points="6 9 12 15 18 9" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>

    <div id="details-2" class="details" data-open="false" role="region" aria-labelledby="toggle-2" aria-hidden="true">
      <div class="inner">
        <p>Below are a couple of nested toggles. They themselves control containers that also use the <code>details</code> class (named <code>sub-details</code> here).</p>

        <div style="margin-top:8px;">
          <button class="sub-toggle" aria-expanded="false" aria-controls="sub-1" data-target="sub-1" id="sub-toggle-1">
            <span>First nested item</span>
            <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false" style="width:16px;height:16px;">
              <polyline points="6 9 12 15 18 9" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <div id="sub-1" class="sub-details" data-open="false" role="region" aria-labelledby="sub-toggle-1" aria-hidden="true">
            <div style="padding:8px 6px 12px 6px;">
              <p class="small">Nested content A. Useful for breaking down information into smaller pieces.</p>
            </div>
          </div>
        </div>

        <div style="margin-top:12px;">
          <button class="sub-toggle" aria-expanded="false" aria-controls="sub-2" data-target="sub-2" id="sub-toggle-2">
            <span>Second nested item</span>
            <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false" style="width:16px;height:16px;">
              <polyline points="6 9 12 15 18 9" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <div id="sub-2" class="sub-details" data-open="false" role="region" aria-labelledby="sub-toggle-2" aria-hidden="true">
            <div style="padding:8px 6px 12px 6px;">
              <p class="small">Nested content B. This shows how multiple levels can be composed while keeping ARIA relationships intact.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Example 3: Long content example -->
  <div class="example">
    <button id="toggle-3" class="toggle" aria-expanded="false" aria-controls="details-3" data-target="details-3">
      <span class="title"><span class="dot" aria-hidden="true"></span> Long content example</span>
      <span class="meta small">Expandable article excerpt</span>
      <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <polyline points="6 9 12 15 18 9" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>

    <div id="details-3" class="details" data-open="false" role="region" aria-labelledby="toggle-3" aria-hidden="true">
      <div class="inner">
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer pulvinar, sem sit amet vulputate volutpat, quam neque congue mi, vitae faucibus mi ipsum sit amet arcu. Sed vitae augue nec velit cursus gravida. Donec pretium, augue eu cursus faucibus, erat nisi luctus nunc, vel pharetra felis eros sed orci.</p>
        <p>Morbi non fermentum lectus. Praesent vehicula dapibus tortor, et pretium turpis aliquet non. Nullam volutpat, neque a iaculis condimentum, ipsum lorem mattis arcu, non luctus magna lectus vel lorem. Integer in scelerisque nisl. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Cras a dolor vitae ipsum facilisis lacinia.</p>
        <ul>
          <li>Point one explaining a detail.</li>
          <li>Point two with additional information.</li>
          <li>Point three to wrap up the excerpt.</li>
        </ul>
        <p class="small">End of excerpt.</p>
      </div>
    </div>
  </div>

  <script>
    (function(){
      // Generic toggling logic for any button with data-target controlling a details-like container.
      function animateOpen(details){
        // prepare for animation
        details.style.display = 'block';
        // allow the browser to layout and get scrollHeight
        var height = details.scrollHeight;
        details.style.maxHeight = '0px';
        // ensure dataset flag
        details.dataset.open = "true";
        details.setAttribute('aria-hidden', 'false');
        // force reflow then animate to full height
        requestAnimationFrame(function(){
          details.style.maxHeight = height + 'px';
        });
        // after transition, clean up max-height inline style so content can grow naturally
        function onEnd(e){
          if (e && e.target !== details) return;
          details.style.maxHeight = 'none';
          details.removeEventListener('transitionend', onEnd);
        }
        details.addEventListener('transitionend', onEnd);
      }

      function animateClose(details){
        // from whatever state, set maxHeight to current height then to 0
        var height = details.scrollHeight;
        details.style.maxHeight = height + 'px';
        // force reflow so the starting height is applied
        requestAnimationFrame(function(){
          details.style.maxHeight = '0px';
        });
        function onEnd(e){
          if (e && e.target !== details) return;
          details.dataset.open = "false";
          details.setAttribute('aria-hidden', 'true');
          details.style.display = ''; // clear display (let CSS govern)
          details.removeEventListener('transitionend', onEnd);
        }
        details.addEventListener('transitionend', onEnd);
      }

      function toggleFromButton(btn){
        var targetId = btn.dataset.target || btn.getAttribute('aria-controls');
        if (!targetId) return;
        var details = document.getElementById(targetId);
        if (!details) return;

        var expanded = btn.getAttribute('aria-expanded') === 'true';
        if (expanded){
          // close
          btn.setAttribute('aria-expanded', 'false');
          // set data-open to false will be done after animation end
          animateClose(details);
        } else {
          // open
          btn.setAttribute('aria-expanded', 'true');
          animateOpen(details);
        }
      }

      // attach listeners to top-level toggles
      var toggles = document.querySelectorAll('[data-target]');
      toggles.forEach(function(btn){
        btn.addEventListener('click', function(e){
          toggleFromButton(btn);
        });

        // ensure keyboard interaction works (buttons handle Enter/Space by default).
        // Add extra convenience: Home/End to open/close if needed.
        btn.addEventListener('keydown', function(e){
          // optional: Support "Home" to open and "End" to close
          if (e.key === 'Home'){ // open
            var targetId = btn.dataset.target || btn.getAttribute('aria-controls');
            var details = document.getElementById(targetId);
            if (details && btn.getAttribute('aria-expanded') !== 'true'){
              btn.setAttribute('aria-expanded', 'true');
              animateOpen(details);
            }
          } else if (e.key === 'End'){ // close
            var targetId = btn.dataset.target || btn.getAttribute('aria-controls');
            var details = document.getElementById(targetId);
            if (details && btn.getAttribute('aria-expanded') !== 'false'){
              btn.setAttribute('aria-expanded', 'false');
              animateClose(details);
            }
          }
        });
      });

      // Keep sizes correct if window resized while open: recompute open max-heights
      var resizeTimeout;
      window.addEventListener('resize', function(){
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(function(){
          var openDetails = document.querySelectorAll('.details[data-open="true"], .sub-details[data-open="true"]');
          openDetails.forEach(function(details){
            // If maxHeight is 'none' (we cleared it), set to scrollHeight to ensure stability, then clear
            details.style.maxHeight = details.scrollHeight + 'px';
            // then after a frame, remove inline maxHeight so it can grow if needed
            requestAnimationFrame(function(){
              details.style.maxHeight = 'none';
            });
          });
        }, 120);
      });

      // Initial state: ensure all details elements reflect data-open attribute
      document.querySelectorAll('.details, .sub-details').forEach(function(details){
        var isOpen = details.dataset.open === 'true';
        details.setAttribute('aria-hidden', isOpen ? 'false' : 'true');
        if (isOpen){
          details.style.display = 'block';
          details.style.maxHeight = 'none';
          // ensure the controlling button indicates expanded
          var id = details.id;
          if (id){
            var btn = document.querySelector('[aria-controls="' + id + '"]');
            if (btn) btn.setAttribute('aria-expanded', 'true');
          }
        } else {
          details.style.maxHeight = '0px';
          details.style.display = '';
          var id = details.id;
          if (id){
            var btn = document.querySelector('[aria-controls="' + id + '"]');
            if (btn) btn.setAttribute('aria-expanded', 'false');
          }
        }
      });
    })();
  </script>
</body>
</html>