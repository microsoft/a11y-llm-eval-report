<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#2563eb;
      --bg:#f8fafc;
      --surface:#ffffff;
      --muted:#6b7280;
      --radius:8px;
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,var(--bg),#eef2ff 60%);
      margin: 24px;
      color: #0f172a;
      line-height: 1.4;
    }

    h1{
      font-size: 1.25rem;
      margin: 0 0 14px 0;
    }

    .examples {
      max-width: 900px;
      margin: 0 auto;
      display: grid;
      gap: 18px;
    }

    .example {
      background: var(--surface);
      border-radius: var(--radius);
      box-shadow: 0 6px 20px rgba(2,6,23,0.06);
      padding: 14px;
      border: 1px solid rgba(15,23,42,0.04);
    }

    .toggle {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 8px 12px;
      background: linear-gradient(180deg, rgba(37,99,235,0.09), rgba(37,99,235,0.04));
      border: 1px solid rgba(37,99,235,0.16);
      color: var(--accent);
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
    }

    .toggle:focus {
      outline: 3px solid rgba(37,99,235,0.15);
      outline-offset: 3px;
    }

    .toggle .chev{
      display: inline-block;
      width: 14px;
      height: 14px;
      transform-origin: 50% 45%;
      transition: transform 220ms ease;
    }

    .toggle[aria-expanded="true"] .chev {
      transform: rotate(90deg);
    }

    /* Container for controlled content */
    .details {
      overflow: hidden;
      max-height: 0;
      transition: max-height 260ms cubic-bezier(.2,.9,.2,1);
      margin-top: 12px;
      border-radius: 6px;
      background: linear-gradient(180deg,#ffffff,#fbfdff);
      border: 1px solid rgba(15,23,42,0.03);
    }

    /* inner padding separate from animated box size */
    .details > .details-content {
      padding: 12px;
    }

    .details p { margin: 0 0 10px 0; color: #0f172a; }
    .details small { color: var(--muted); }

    /* a little helper state class when content is open (not required for animation) */
    .details.open {
      box-shadow: 0 8px 24px rgba(2,6,23,0.04);
    }

    /* Optional: responsive */
    @media (max-width:600px){
      .toggle { width: 100%; justify-content: space-between; }
    }
  </style>
</head>
<body>
  <main class="examples" role="main">
    <h1>Expand / Collapse Widget Examples</h1>

    <div class="example">
      <button class="toggle" id="toggle-1" aria-expanded="false" aria-controls="details-1">
        <span>Basic details</span>
        <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path fill="currentColor" d="M9.29 6.71a1 1 0 0 0 0 1.41L13.17 12l-3.88 3.88a1 1 0 1 0 1.41 1.41l4.59-4.59a1 1 0 0 0 0-1.41L10.7 6.7a1 1 0 0 0-1.41 0z"/>
        </svg>
      </button>

      <div class="details" id="details-1" role="region" aria-labelledby="toggle-1" aria-hidden="true">
        <div class="details-content">
          <p>This is a simple expandable area. Click the button above to reveal or hide this content. The widget updates aria-expanded on the button and aria-hidden on this container for accessibility.</p>
          <small>Tip: Buttons naturally support keyboard activation (Enter / Space).</small>
        </div>
      </div>
    </div>

    <div class="example">
      <button class="toggle" id="toggle-2" aria-expanded="false" aria-controls="details-2">
        <span>Longer content (with images)</span>
        <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path fill="currentColor" d="M9.29 6.71a1 1 0 0 0 0 1.41L13.17 12l-3.88 3.88a1 1 0 1 0 1.41 1.41l4.59-4.59a1 1 0 0 0 0-1.41L10.7 6.7a1 1 0 0 0-1.41 0z"/>
        </svg>
      </button>

      <div class="details" id="details-2" role="region" aria-labelledby="toggle-2" aria-hidden="true">
        <div class="details-content">
          <p>Content blocks can include images, lists, or any markup. The container will animate open and closed while keeping padding intact.</p>
          <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='480' height='120'><rect width='100%' height='100%' fill='%23eef2ff'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' fill='%234256eb' font-family='Arial' font-size='18'>Placeholder Image</text></svg>" alt="placeholder" style="max-width:100%;border-radius:6px;display:block;margin-top:8px;">
          <ul style="margin:8px 0 0 18px;">
            <li>Point one</li>
            <li>Point two</li>
            <li>Point three</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="example">
      <button class="toggle" id="toggle-3" aria-expanded="false" aria-controls="details-3">
        <span>Nested example (interactive content)</span>
        <svg class="chev" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path fill="currentColor" d="M9.29 6.71a1 1 0 0 0 0 1.41L13.17 12l-3.88 3.88a1 1 0 1 0 1.41 1.41l4.59-4.59a1 1 0 0 0 0-1.41L10.7 6.7a1 1 0 0 0-1.41 0z"/>
        </svg>
      </button>

      <div class="details" id="details-3" role="region" aria-labelledby="toggle-3" aria-hidden="true">
        <div class="details-content">
          <p>This panel contains a small form to demonstrate interactive content inside a collapsible area.</p>
          <form onsubmit="event.preventDefault()" style="display:grid;gap:8px;max-width:420px;">
            <label style="display:flex;flex-direction:column;font-size:14px;">
              Name
              <input type="text" placeholder="Your name" style="padding:8px;border:1px solid rgba(2,6,23,0.08);border-radius:6px;">
            </label>
            <label style="display:flex;flex-direction:column;font-size:14px;">
              Message
              <textarea rows="3" placeholder="Write something..." style="padding:8px;border:1px solid rgba(2,6,23,0.08);border-radius:6px;"></textarea>
            </label>
            <div style="display:flex;gap:10px;">
              <button type="submit" class="toggle" style="background:var(--accent);color:#fff;border:none;">Send</button>
              <button type="button" class="toggle" id="reset-3" style="background:transparent;border:1px solid rgba(15,23,42,0.06);color:var(--accent);">Reset</button>
            </div>
          </form>
        </div>
      </div>
    </div>

  </main>

  <script>
    (function(){
      // Initialize all example widgets by wiring button -> details behavior.
      const examples = document.querySelectorAll('.example');

      examples.forEach(example => {
        const button = example.querySelector('.toggle');
        if (!button) return;
        const controlsId = button.getAttribute('aria-controls');
        const details = controlsId ? document.getElementById(controlsId) : null;
        if (!details) return;

        // Ensure initial ARIA states are set (in case markup changed)
        button.setAttribute('aria-expanded', button.getAttribute('aria-expanded') === 'true' ? 'true' : 'false');
        details.setAttribute('aria-hidden', button.getAttribute('aria-expanded') === 'true' ? 'false' : 'true');

        // Helper to open
        const open = () => {
          button.setAttribute('aria-expanded','true');
          details.setAttribute('aria-hidden','false');
          details.classList.add('open');

          // set max-height to content height to animate
          const contentHeight = details.scrollHeight;
          details.style.maxHeight = contentHeight + 'px';

          // when transition finishes, remove explicit maxHeight so content can grow/shrink naturally
          const cleanup = () => {
            if (button.getAttribute('aria-expanded') === 'true') {
              details.style.maxHeight = null;
            }
            details.removeEventListener('transitionend', cleanup);
          };
          details.addEventListener('transitionend', cleanup);
        };

        // Helper to close
        const close = () => {
          button.setAttribute('aria-expanded','false');
          details.setAttribute('aria-hidden','true');

          // set current height then animate to 0
          const contentHeight = details.scrollHeight;
          details.style.maxHeight = contentHeight + 'px';

          // force reflow so the starting max-height is applied before changing to 0
          // eslint-disable-next-line no-unused-expressions
          details.offsetHeight;

          requestAnimationFrame(() => {
            details.style.maxHeight = '0px';
          });

          const cleanup = () => {
            details.classList.remove('open');
            details.removeEventListener('transitionend', cleanup);
          };
          details.addEventListener('transitionend', cleanup);
        };

        // Click toggles
        button.addEventListener('click', () => {
          const expanded = button.getAttribute('aria-expanded') === 'true';
          if (expanded) close(); else open();
        });

        // Keep max-height accurate when the window resizes (for open details)
        window.addEventListener('resize', () => {
          if (button.getAttribute('aria-expanded') === 'true') {
            // temporarily set explicit height to new scrollHeight
            details.style.maxHeight = details.scrollHeight + 'px';
            // remove it shortly after to allow natural sizing
            clearTimeout(details._resizeTimeout);
            details._resizeTimeout = setTimeout(() => {
              details.style.maxHeight = null;
            }, 250);
          }
        });
      });

      // Small example: reset form inside the third example
      const resetBtn = document.getElementById('reset-3');
      if (resetBtn) {
        resetBtn.addEventListener('click', () => {
          const form = resetBtn.closest('.details').querySelector('form');
          if (form) form.reset();
        });
      }
    })();
  </script>
</body>
</html>