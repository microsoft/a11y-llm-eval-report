<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#0066cc;
      --bg:#f7f9fb;
      --muted:#6b7280;
      --radius:8px;
      --transition:300ms;
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      margin: 2rem;
      color:#111827;
      background: linear-gradient(180deg,#ffffff 0%, #f4f6f8 100%);
      line-height:1.45;
    }

    h1{
      margin:0 0 1rem 0;
      font-size:1.25rem;
    }

    .example{
      background: white;
      border: 1px solid #e6edf3;
      border-radius: var(--radius);
      padding: 1rem;
      margin-bottom: 1rem;
      box-shadow: 0 1px 2px rgba(16,24,40,0.03);
    }

    .summary-button{
      appearance: none;
      -webkit-appearance: none;
      border: 1px solid #e1e8ef;
      background: linear-gradient(180deg, #ffffff, #fbfdff);
      padding: .5rem .75rem;
      border-radius: 6px;
      width: 100%;
      text-align: left;
      font-size: 1rem;
      display:flex;
      align-items:center;
      gap: .75rem;
      cursor: pointer;
    }

    .summary-button:focus{
      outline: 3px solid rgba(0,102,204,0.15);
      outline-offset: 2px;
    }

    .summary-title{
      flex: 1;
      font-weight: 600;
    }
    .summary-meta{
      color: var(--muted);
      font-size: .9rem;
    }

    .chev{
      width:1rem;
      height:1rem;
      transition: transform var(--transition) ease;
      flex-shrink:0;
      display:inline-block;
    }
    .summary-button[aria-expanded="true"] .chev{
      transform: rotate(90deg);
    }

    /* Controlled content */
    .details{
      overflow: hidden;
      transition: max-height var(--transition) ease;
      border-radius: 6px;
      margin-top: .75rem;
      padding: .75rem;
      background: var(--bg);
      border: 1px dashed rgba(14, 20, 30, 0.03);
    }

    .details > *:first-child{
      margin-top: 0;
    }
    .details > *:last-child{
      margin-bottom: 0;
    }

    /* small helper styles */
    p{ margin: .25rem 0 .75rem 0; color:#20262b }
    ul{ margin: .25rem 0 .75rem 1.1rem; color:#20262b }
    code{
      background: #0f1724;
      color: #e6eef8;
      padding: .15rem .35rem;
      border-radius: 4px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace;
      font-size: .875rem;
    }
  </style>
</head>
<body>
  <h1>Expand / Collapse widget examples</h1>

  <div class="example">
    <button class="summary-button" aria-expanded="false" aria-controls="details-1" id="summary-1">
      <svg class="chev" viewBox="0 0 20 20" fill="none" aria-hidden="true">
        <path d="M6 4l8 6-8 6" stroke="#111827" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span class="summary-title">More information</span>
      <span class="summary-meta">Click to expand</span>
    </button>

    <div id="details-1" class="details" aria-hidden="true" role="region" aria-labelledby="summary-1" style="max-height: 0;">
      <p>
        This is a simple reveal region. It uses an accessible button that controls the hidden content with
        aria-expanded and aria-controls. The content here can include text, lists, images or any other markup.
      </p>
      <ul>
        <li>Accessible markup with aria attributes</li>
        <li>Smooth height animation using max-height</li>
        <li>Keyboard and pointer interactions supported by the button element</li>
      </ul>
    </div>
  </div>

  <div class="example">
    <button class="summary-button" aria-expanded="true" aria-controls="details-2" id="summary-2">
      <svg class="chev" viewBox="0 0 20 20" fill="none" aria-hidden="true">
        <path d="M6 4l8 6-8 6" stroke="#111827" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span class="summary-title">Features (open by default)</span>
      <span class="summary-meta">Tap to collapse</span>
    </button>

    <div id="details-2" class="details" aria-hidden="false" role="region" aria-labelledby="summary-2" style="max-height: none;">
      <p><strong>Highlights:</strong></p>
      <ul>
        <li>Works with screen readers — aria-expanded and aria-hidden are kept in sync.</li>
        <li>Animated transitions for a smoother user experience.</li>
        <li>Progressive enhancement — if JavaScript is unavailable, the content remains visible when set open.</li>
      </ul>
      <p>Example usage in code: <code>&lt;button aria-expanded&gt; ... &lt;/button&gt;</code></p>
    </div>
  </div>

  <script>
    (function(){
      // Utility to set numeric max-height then optionally clear to 'none' after transition
      function expand(panel){
        // remove explicit max-height none to measure
        panel.style.maxHeight = panel.scrollHeight + "px";
        panel.setAttribute("aria-hidden","false");
        // after transition ends, if still expanded, set to none so it can grow naturally if content changes
        var onEnd = function(e){
          if(e.target !== panel) return;
          // make sure it's expanded before setting none
          if(panel.getAttribute("aria-hidden") === "false"){
            panel.style.maxHeight = "none";
          }
          panel.removeEventListener("transitionend", onEnd);
        };
        panel.addEventListener("transitionend", onEnd);
      }

      function collapse(panel){
        // if currently maxHeight is none, set to actual height first so transition can run
        if(getComputedStyle(panel).maxHeight === "none"){
          panel.style.maxHeight = panel.scrollHeight + "px";
          // force a reflow so the browser notices the previous assignment
          // eslint-disable-next-line no-unused-expressions
          panel.offsetHeight;
        }
        panel.style.maxHeight = "0px";
        panel.setAttribute("aria-hidden","true");
      }

      function toggle(button,panel){
        var expanded = button.getAttribute("aria-expanded") === "true";
        if(expanded){
          button.setAttribute("aria-expanded","false");
          collapse(panel);
        } else {
          button.setAttribute("aria-expanded","true");
          expand(panel);
        }
      }

      // initialize all widgets on the page
      document.querySelectorAll(".summary-button[aria-controls]").forEach(function(btn){
        var id = btn.getAttribute("aria-controls");
        var panel = document.getElementById(id);
        if(!panel) return;

        // Ensure initial visual state matches attributes
        var expanded = btn.getAttribute("aria-expanded") === "true";
        if(expanded){
          panel.setAttribute("aria-hidden","false");
          panel.style.maxHeight = "none";
        } else {
          panel.setAttribute("aria-hidden","true");
          panel.style.maxHeight = "0px";
        }

        // Pointer/click behavior
        btn.addEventListener("click", function(){
          toggle(btn,panel);
        });

        // Allow Enter and Space via keydown on the button element is handled by the browser
        // But add support for Home/End to open/close quickly
        btn.addEventListener("keydown", function(e){
          if(e.key === "Home"){
            e.preventDefault();
            if(btn.getAttribute("aria-expanded") !== "true"){
              btn.setAttribute("aria-expanded","true");
              expand(panel);
            }
          } else if(e.key === "End"){
            e.preventDefault();
            if(btn.getAttribute("aria-expanded") !== "false"){
              btn.setAttribute("aria-expanded","false");
              collapse(panel);
            }
          }
        });
      });
    })();
  </script>
</body>
</html>