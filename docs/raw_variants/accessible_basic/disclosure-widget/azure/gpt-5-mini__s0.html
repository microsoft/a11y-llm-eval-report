<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Accessible Expand/Collapse Widget Examples</title>
  <meta name="description" content="Two accessible expand/collapse widget examples: a native details/summary widget and a custom ARIA widget. Each widget is wrapped in a div.example and the controlled content container uses the class details." />
  <style>
    :root{
      --bg:#ffffff;
      --text:#0b0b0b;
      --muted:#4a4a4a;
      --accent:#005A9C;
      --accent-contrast:#ffffff;
      --focus:#ffb000;
      --border:#dcdcdc;
      --max-width:900px;
      --radius:6px;
    }

    html,body{
      height:100%;
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
      background:var(--bg);
      color:var(--text);
      line-height:1.4;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    a:focus, button:focus {
      outline:3px solid var(--focus);
      outline-offset:2px;
    }

    header{
      border-bottom:1px solid var(--border);
      padding:1rem;
      background:linear-gradient(180deg,#f8f9fb,transparent);
    }

    .container{
      max-width:var(--max-width);
      margin:1.25rem auto;
      padding:1rem;
    }

    h1{
      font-size:1.25rem;
      margin:0 0 .25rem 0;
      color:var(--text);
    }

    p.lead{
      margin:0;
      color:var(--muted);
      font-size:0.95rem;
    }

    .examples{
      display:grid;
      gap:1rem;
      margin-top:1rem;
    }

    .example{
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:1rem;
      background:#fff;
    }

    .example h2{
      font-size:1rem;
      margin:0 0 .5rem 0;
    }

    /* Native details styling */
    details.details{
      background:#fbfdff;
      border:1px solid #e6f0fb;
      border-radius:6px;
      padding:0.25rem;
    }

    details.details summary{
      list-style:none;
      cursor:pointer;
      display:flex;
      align-items:center;
      gap:.75rem;
      padding:.6rem .75rem;
      margin:0;
      user-select:none;
      color:var(--text);
      font-weight:600;
      border-radius:6px;
    }

    details.details summary::-webkit-details-marker{
      display:none;
    }

    /* Icon/chevron */
    .chev{
      width:1rem;
      height:1rem;
      display:inline-block;
      transform-origin:center;
      transition:transform .22s ease;
      color:var(--accent);
      flex:0 0 1rem;
    }

    details[open] .chev{
      transform:rotate(90deg);
    }

    .summary-desc{
      font-weight:400;
      color:var(--muted);
      font-size:0.95rem;
      display:block;
    }

    details.details > .details-body{
      padding:.5rem .75rem 1rem;
      border-top:1px solid #eef6ff;
      color:var(--muted);
      font-size:0.95rem;
    }

    /* Custom ARIA widget */
    .aria-toggle{
      display:flex;
      align-items:center;
      gap:.75rem;
      justify-content:space-between;
      width:100%;
      background:linear-gradient(180deg,#fff,#fcfcfd);
      padding:.6rem .75rem;
      border-radius:6px;
      border:1px solid #e6e6e6;
    }

    .aria-toggle button{
      appearance:none;
      -webkit-appearance:none;
      border:0;
      background:var(--accent);
      color:var(--accent-contrast);
      padding:.45rem .6rem;
      border-radius:6px;
      font-weight:600;
      cursor:pointer;
      font-size:0.95rem;
    }

    .aria-toggle .label{
      text-align:left;
      display:flex;
      flex-direction:column;
      gap:0.125rem;
      margin-right:1rem;
      color:var(--text);
    }

    .aria-toggle .label .sub{
      color:var(--muted);
      font-size:0.95rem;
      font-weight:400;
    }

    .details{
      margin-top:.75rem;
      padding:.75rem;
      background:#fbfbff;
      border:1px solid #eef3ff;
      border-radius:6px;
      color:var(--muted);
      font-size:0.95rem;
    }

    /* Hidden state for custom container */
    .details[hidden]{
      display:none;
    }

    /* Make focus visible for summary when keyboard-focused (some browsers hide) */
    summary:focus{
      outline:3px solid var(--focus);
      outline-offset:2px;
      border-radius:6px;
    }

    /* Accessibility: larger hit targets on small screens */
    @media (max-width:420px){
      .aria-toggle button{ padding:.6rem .75rem; font-size:1rem;}
      details.details summary{padding:.9rem;}
    }

    /* Respect reduced motion */
    @media (prefers-reduced-motion:reduce){
      .chev{ transition:none; }
    }

    footer{
      margin-top:1.25rem;
      padding-top:1rem;
      border-top:1px solid var(--border);
      color:var(--muted);
      font-size:0.9rem;
    }

    /* Utility */
    .sr-only{
      border:0 !important;
      clip:rect(1px,1px,1px,1px) !important;
      -webkit-clip-path:inset(50%) !important;
      clip-path:inset(50%) !important;
      height:1px !important;
      margin:-1px !important;
      overflow:hidden !important;
      padding:0 !important;
      position:absolute !important;
      width:1px !important;
      white-space:nowrap !important;
    }
  </style>
</head>
<body>
  <a class="sr-only" href="#main">Skip to main content</a>

  <header>
    <div class="container">
      <h1>Accessible Expand / Collapse Widget Examples</h1>
      <p class="lead">Two patterns: a semantic native details/summary widget and a custom ARIA-controlled widget. Each widget is wrapped with a div.example and the content container uses the class "details". Use keyboard (Tab and Enter/Space) to interact.</p>
    </div>
  </header>

  <main id="main" class="container" tabindex="-1">
    <section aria-labelledby="examples-heading">
      <h2 id="examples-heading" class="sr-only">Examples</h2>
      <div class="examples">

        <!-- Example 1: Native details element (semantic-first) -->
        <div class="example" aria-labelledby="ex1-heading">
          <h2 id="ex1-heading">Example 1 — Native details/summary (semantic)</h2>

          <!-- The details element itself is used as the container for controlled content and has the required class "details". -->
          <details class="details" aria-label="More information about our accessibility principles">
            <summary>
              <svg class="chev" aria-hidden="true" focusable="false" viewBox="0 0 24 24" width="16" height="16">
                <path fill="currentColor" d="M9 6l6 6-6 6"/>
              </svg>
              Accessibility principles
              <span class="summary-desc">Why we prioritize accessible interactions</span>
            </summary>

            <div class="details-body">
              <p>Using the native details and summary elements provides built-in keyboard support, semantics and disclosure behavior. Screen readers announce the expanded/collapsed state automatically. This pattern is recommended when the browser behavior matches your needs.</p>
              <p>Tips:
                <ul>
                  <li>Ensure the summary text clearly describes the content it reveals.</li>
                  <li>Keep the controls reachable via keyboard and visible focus indicators.</li>
                </ul>
              </p>
            </div>
          </details>
        </div>

        <!-- Example 2: Custom ARIA-controlled widget -->
        <div class="example" aria-labelledby="ex2-heading">
          <h2 id="ex2-heading">Example 2 — Custom ARIA-controlled widget</h2>

          <div class="aria-toggle" role="group" aria-labelledby="toggle-2-label">
            <div class="label" id="toggle-2-label">
              <strong>More details about the feature</strong>
              <span class="sub">Custom ARIA widget with a button that controls the content below.</span>
            </div>

            <!-- The button is the toggle control. It uses aria-expanded and aria-controls. -->
            <button
              id="toggle-2"
              aria-expanded="false"
              aria-controls="details-2"
              type="button">
              Show details
            </button>
          </div>

          <!-- The content container uses the required class "details". It is hidden by default. It uses role="region" and aria-labelledby to provide accessible name linking back to the control. -->
          <div id="details-2" class="details" role="region" aria-labelledby="toggle-2" hidden aria-hidden="true">
            <p>This custom widget demonstrates how to implement an accessible expand/collapse where you need full control over markup and behavior. The button updates aria-expanded and the content container is shown/hidden by toggling the hidden attribute. The region is labeled by the toggle control for screen reader clarity.</p>
            <p>Keyboard support:
              <ul>
                <li>Tab to focus the toggle button and press Enter or Space to open/close.</li>
                <li>Press Escape while focus is inside the details region to close and return focus to the toggle.</li>
              </ul>
            </p>
            <p><a href="#" id="details-2-link">An example focusable element inside the details</a></p>
          </div>
        </div>

      </div>

      <footer>
        <p>These examples prioritize semantic HTML where possible and add ARIA only when required. They include visible focus states, keyboard operability and sufficient color contrast to meet WCAG 2.2 AA guidance.</p>
      </footer>
    </section>
  </main>

  <script>
    (function () {
      // Enhance the native details element to ensure keyboard focus styling consistency where needed.
      // No ARIA changes are necessary for native details, but supporting script can improve behaviour cross-browser.
      // Custom ARIA widget script:
      const toggleBtn = document.getElementById('toggle-2');
      const details = document.getElementById('details-2');

      function openDetails() {
        toggleBtn.setAttribute('aria-expanded', 'true');
        details.removeAttribute('hidden');
        details.setAttribute('aria-hidden', 'false');
        toggleBtn.textContent = 'Hide details';
      }

      function closeDetails() {
        toggleBtn.setAttribute('aria-expanded', 'false');
        details.setAttribute('hidden', '');
        details.setAttribute('aria-hidden', 'true');
        toggleBtn.textContent = 'Show details';
      }

      function toggleDetails() {
        const expanded = toggleBtn.getAttribute('aria-expanded') === 'true';
        if (expanded) {
          closeDetails();
        } else {
          openDetails();
        }
      }

      toggleBtn.addEventListener('click', function (e) {
        toggleDetails();
      });

      // Ensure Enter/Space are handled (button does this natively, but keep for parity and any customization)
      toggleBtn.addEventListener('keydown', function (e) {
        // Let browser handle Enter/Space for button activation; do not prevent default unless customizing key handling.
        // Keep this listener minimal so that behavior remains native and accessible.
      });

      // Close when Escape is pressed while focus is inside the details region.
      details.addEventListener('keydown', function (e) {
        if (e.key === 'Escape' || e.key === 'Esc') {
          e.preventDefault();
          closeDetails();
          // Return focus to the toggle button for clear keyboard context
          toggleBtn.focus();
        }
      });

      // Also close if user focuses the close control via a link that says "Close" (if present in more complex UIs)
      // For demonstration, link inside details will just move focus.
      const innerLink = document.getElementById('details-2-link');
      if (innerLink) {
        innerLink.addEventListener('click', function (e) {
          // Example: keep it as a normal link but ensure it does not close the details automatically.
          // e.preventDefault();
          // closeDetails();
          // toggleBtn.focus();
        });
      }

      // Accessibility: keyboard users may open details and then press Tab to move into content.
      // No additional trapping is applied; this keeps behavior predictable.

      // Improve support for reduced motion user preference (no scripting required; transitions handled via CSS).
      // Ensure that the initial state matches attributes defined in HTML.
      (function syncInitialState() {
        const expanded = toggleBtn.getAttribute('aria-expanded') === 'true';
        if (!expanded) {
          details.setAttribute('hidden', '');
          details.setAttribute('aria-hidden', 'true');
        } else {
          details.removeAttribute('hidden');
          details.setAttribute('aria-hidden', 'false');
        }
      })();
    })();
  </script>
</body>
</html>