<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Accessible Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#0b63ff;
      --bg:#ffffff;
      --text:#0b0b0b;
      --muted:#4b5563;
      --focus: 3px solid #ffbf47;
    }

    html,body{
      height:100%;
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:var(--bg);
      color:var(--text);
      line-height:1.4;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    header{
      padding:1.25rem;
      border-bottom:1px solid #e6e9ee;
      background:linear-gradient(180deg, #fbfcfe, #ffffff);
    }

    main{
      padding:1.25rem;
      max-width:900px;
      margin:0 auto;
    }

    h1{
      margin:0 0 0.25rem 0;
      font-size:1.25rem;
    }

    p.lead{
      margin:0;
      color:var(--muted);
      font-size:0.95rem;
    }

    /* Example container */
    .example{
      margin:1.25rem 0;
      border:1px solid #e6e9ee;
      padding:1rem;
      border-radius:8px;
      background:#fff;
    }

    /* Toggle button */
    .toggle {
      display:inline-flex;
      align-items:center;
      gap:0.5rem;
      background:transparent;
      border:1px solid #d0d7df;
      padding:0.5rem 0.75rem;
      border-radius:6px;
      cursor:pointer;
      font-size:1rem;
      color:var(--text);
      transition:background .15s, border-color .15s;
    }

    .toggle:hover{
      background:#f6f8fb;
      border-color:#c8d5f7;
    }

    .toggle:focus{
      outline: none;
      box-shadow: var(--focus);
      border-color: var(--accent);
    }

    .toggle .icon{
      width:1rem;
      height:1rem;
      display:inline-block;
      transition:transform .18s ease;
      transform-origin:center;
    }

    /* rotate icon when expanded via attribute */
    .toggle[aria-expanded="true"] .icon {
      transform: rotate(90deg);
    }

    /* Controlled content */
    .details{
      margin-top:0.75rem;
      padding:0.75rem;
      border-radius:6px;
      border:1px dashed #e6edf3;
      background:#fbfdff;
    }

    /* When hidden using the hidden attribute, browsers don't display.
       Provide a transition in case users alter styles; keep simple for accessibility. */
    .details[hidden]{
      display:none;
    }

    .details h4{
      margin:0 0 0.5rem 0;
      font-size:1rem;
    }

    .details p{
      margin:0 0 0.5rem 0;
      color:var(--muted);
      font-size:0.95rem;
    }

    /* Visually hidden utility for screen-reader-only text */
    .sr-only {
      position: absolute !important;
      height: 1px; width: 1px;
      overflow: hidden;
      clip: rect(1px, 1px, 1px, 1px);
      white-space: nowrap;
      border: 0; padding: 0; margin: -1px;
    }

    /* Focus styles for interactive elements inside details */
    .details a, .details button, .details input{
      font-size:0.95rem;
    }

    footer{
      margin-top:2rem;
      color:var(--muted);
      font-size:0.9rem;
    }

    /* Make sure focus outlines are visible even when users have custom preferences */
    :focus {
      outline-offset: 2px;
    }

  </style>
</head>
<body>
  <header>
    <h1 id="page-title">Accessible Expand / Collapse Widget Examples</h1>
    <p class="lead">Each example is wrapped in a container with the class "example". The controlled content container uses the class "details". Use the keyboard (Tab, Enter, Space, Escape) to interact.</p>
  </header>

  <main>
    <!-- Example 1 -->
    <div class="example" aria-labelledby="ex1-heading">
      <h2 id="ex1-heading" style="font-size:1rem; margin:0 0 0.5rem 0;">Simple details panel</h2>

      <button
        id="ex1-toggle"
        class="toggle"
        aria-expanded="false"
        aria-controls="ex1-details"
        type="button"
      >
        <span class="icon" aria-hidden="true">▶</span>
        <span>Show more</span>
        <span class="sr-only" id="ex1-toggle-extra"> about seasonal hours</span>
      </button>

      <div
        id="ex1-details"
        class="details"
        role="region"
        aria-labelledby="ex1-toggle"
        hidden
      >
        <h4>Seasonal hours</h4>
        <p>From June through August, we extend our hours on weekends. Check the schedule below or contact customer support for holiday hours.</p>
        <p><strong>Saturday:</strong> 09:00 – 18:00<br><strong>Sunday:</strong> 10:00 – 16:00</p>
        <a href="#contact" style="color:var(--accent);">Contact support</a>
      </div>
    </div>

    <!-- Example 2 -->
    <div class="example" aria-labelledby="ex2-heading">
      <h2 id="ex2-heading" style="font-size:1rem; margin:0 0 0.5rem 0;">Form inside a details region</h2>

      <button
        id="ex2-toggle"
        class="toggle"
        aria-expanded="false"
        aria-controls="ex2-details"
        type="button"
      >
        <span class="icon" aria-hidden="true">▶</span>
        <span>Provide feedback</span>
      </button>

      <div
        id="ex2-details"
        class="details"
        role="region"
        aria-labelledby="ex2-toggle"
        hidden
      >
        <h4>Feedback</h4>
        <p>We appreciate your input. Fill out the short form and press submit.</p>
        <form>
          <label for="name-2">Name</label><br>
          <input id="name-2" name="name" type="text" autocomplete="name" style="margin-top:0.25rem; padding:0.4rem; width:100%; box-sizing:border-box;"><br><br>

          <label for="message-2">Message</label><br>
          <textarea id="message-2" name="message" rows="4" style="margin-top:0.25rem; padding:0.4rem; width:100%; box-sizing:border-box;"></textarea><br><br>

          <button type="submit" style="background:var(--accent); color:#fff; border:none; padding:0.5rem 0.75rem; border-radius:6px; cursor:pointer;">Submit</button>
        </form>
      </div>
    </div>

    <!-- Example 3 -->
    <div class="example" aria-labelledby="ex3-heading">
      <h2 id="ex3-heading" style="font-size:1rem; margin:0 0 0.5rem 0;">Multiple collapsed sections</h2>

      <p style="margin:0 0 0.5rem 0; color:var(--muted);">These are independent expand/collapse sections; opening one does not affect the others.</p>

      <div style="display:flex; gap:0.5rem; flex-wrap:wrap; margin-top:0.5rem;">
        <div style="flex:1 1 220px; min-width:220px;">
          <button id="ex3a-toggle" class="toggle" aria-expanded="false" aria-controls="ex3a-details" type="button">
            <span class="icon" aria-hidden="true">▶</span>
            <span>Overview</span>
          </button>

          <div id="ex3a-details" class="details" role="region" aria-labelledby="ex3a-toggle" hidden>
            <h4>Overview</h4>
            <p>Short project summary and status updates.</p>
          </div>
        </div>

        <div style="flex:1 1 220px; min-width:220px;">
          <button id="ex3b-toggle" class="toggle" aria-expanded="false" aria-controls="ex3b-details" type="button">
            <span class="icon" aria-hidden="true">▶</span>
            <span>Resources</span>
          </button>

          <div id="ex3b-details" class="details" role="region" aria-labelledby="ex3b-toggle" hidden>
            <h4>Resources</h4>
            <p>Links and documents available for the team.</p>
            <ul>
              <li><a href="#" style="color:var(--accent);">Project brief</a></li>
              <li><a href="#" style="color:var(--accent);">Design assets</a></li>
            </ul>
          </div>
        </div>

        <div style="flex:1 1 220px; min-width:220px;">
          <button id="ex3c-toggle" class="toggle" aria-expanded="false" aria-controls="ex3c-details" type="button">
            <span class="icon" aria-hidden="true">▶</span>
            <span>Timeline</span>
          </button>

          <div id="ex3c-details" class="details" role="region" aria-labelledby="ex3c-toggle" hidden>
            <h4>Timeline</h4>
            <p>Milestones and upcoming deadlines.</p>
          </div>
        </div>
      </div>
    </div>

    <footer>
      <p>Keyboard notes: Buttons are focusable (Tab). Toggle with Enter or Space. Press Escape to close an open panel and return focus to its toggle.</p>
    </footer>
  </main>

  <script>
    (function () {
      // Initialize all examples with their toggle buttons and controlled details regions.
      // Behavior:
      // - The button controls the visibility using aria-expanded and the details element's hidden attribute.
      // - The details element has role="region" and aria-labelledby pointing back to the button.
      // - Pressing Escape when a panel is open will close it and focus the toggle.
      // - Buttons support Enter/Space by default (browser behavior).
      // This script is minimal and unobtrusive.

      /**
       * Toggle a details region open/closed.
       * @param {HTMLElement} button
       * @param {HTMLElement} details
       */
      function toggle(button, details) {
        var expanded = button.getAttribute('aria-expanded') === 'true';
        if (expanded) {
          // close
          button.setAttribute('aria-expanded', 'false');
          details.hidden = true;
          details.setAttribute('aria-hidden', 'true');
          // Return focus to the toggle in case it was moved
          button.focus({ preventScroll: true });
        } else {
          // open
          button.setAttribute('aria-expanded', 'true');
          details.hidden = false;
          details.removeAttribute('aria-hidden');
          // After opening, try to move focus to first focusable element in details if user used keyboard? Do not auto-focus by default.
        }
      }

      /**
       * Set up a single toggle pair.
       */
      function setupToggle(button) {
        var id = button.getAttribute('aria-controls');
        if (!id) return;
        var details = document.getElementById(id);
        if (!details) return;

        // Ensure role=region and aria-labelledby exist (in case markup omitted)
        if (!details.getAttribute('role')) {
          details.setAttribute('role', 'region');
        }
        if (!details.getAttribute('aria-labelledby')) {
          details.setAttribute('aria-labelledby', button.id || '');
        }

        // Initialize collapsed state
        button.setAttribute('aria-expanded', 'false');
        details.hidden = true;
        details.setAttribute('aria-hidden', 'true');

        // Click toggles
        button.addEventListener('click', function () {
          toggle(button, details);
        });

        // Allow Escape to close when panel is open.
        // We'll add a keydown listener on the document while the panel is open to catch Escape.
        var escHandler = function (ev) {
          if (ev.key === 'Escape' || ev.key === 'Esc') {
            // If details is open, close it and focus button.
            if (button.getAttribute('aria-expanded') === 'true') {
              toggle(button, details);
              // Prevent further handling
              ev.stopPropagation();
              ev.preventDefault();
            }
          }
        };

        // Add listeners to add/remove escHandler when panel opens/closes
        // Observe attribute changes to aria-expanded so we can attach/detach listener.
        var observer = new MutationObserver(function (mutations) {
          mutations.forEach(function (mut) {
            if (mut.type === 'attributes' && mut.attributeName === 'aria-expanded') {
              var isOpen = button.getAttribute('aria-expanded') === 'true';
              if (isOpen) {
                document.addEventListener('keydown', escHandler);
              } else {
                document.removeEventListener('keydown', escHandler);
              }
            }
          });
        });
        observer.observe(button, { attributes: true });

        // Cleanup on page unload
        window.addEventListener('unload', function () {
          document.removeEventListener('keydown', escHandler);
          observer.disconnect();
        });

        // Ensure focusable elements inside details are not reachable when hidden.
        // When hidden attribute is set, browsers exclude the element from the focus order.
        // For extra safety, add aria-hidden when collapsed (done above).
        // No additional changes required here.
      }

      // Find all toggle buttons inside examples
      var toggles = document.querySelectorAll('.example .toggle[aria-controls]');
      toggles.forEach(function (btn) {
        setupToggle(btn);
      });

      // Provide a small enhancement: keyboard users who press Enter/Space while focusing a toggle will toggle
      // (handled by browser automatically for buttons). No extra handling needed.
    })();
  </script>
</body>
</html>