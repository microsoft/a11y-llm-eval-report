<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Accessible Expand / Collapse Widget Examples</title>
  <style>
    :root{
      --bg: #ffffff;
      --text: #0b0b0b;
      --accent: #0a66c2; /* dark blue */
      --muted: #6b7280;
      --focus: #ffbf47; /* high-visibility focus ring */
      --radius: 8px;
    }

    /* Basic layout */
    html,body{
      height:100%;
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: var(--bg);
      color: var(--text);
      line-height:1.4;
      font-size:18px;
    }

    header{
      padding:1.25rem;
      border-bottom: 1px solid #e6e7ea;
    }

    main{
      max-width:900px;
      margin:1.25rem auto;
      padding:0 1rem 4rem 1rem;
    }

    h1{
      font-size:1.25rem;
      margin:0;
    }

    p.lead{
      color:var(--muted);
      margin:0.5rem 0 1rem 0;
    }

    /* Example wrapper required by the prompt */
    .example{
      margin-bottom:1.25rem;
      border:1px solid #e6e7ea;
      padding:1rem;
      border-radius: var(--radius);
      background:#fbfdff;
    }

    /* The toggle button */
    .toggle{
      display:flex;
      align-items:center;
      gap:0.5rem;
      width:100%;
      background:linear-gradient(180deg,#ffffff,#f6fbff);
      border:1px solid #dbe9fb;
      color:var(--text);
      padding:0.75rem 1rem;
      border-radius:calc(var(--radius) - 2px);
      font-size:1rem;
      text-align:left;
      cursor:pointer;
    }

    .toggle .label{
      flex:1;
      font-weight:600;
    }

    .toggle .meta{
      color:var(--muted);
      font-size:0.95rem;
    }

    /* Expand/collapse icon (pure CSS) */
    .chevron{
      width:1rem;
      height:1rem;
      display:inline-block;
      transform-origin:50% 40%;
      transition: transform 180ms ease;
      color:var(--accent);
    }

    /* Focus styles must be clearly visible */
    .toggle:focus{
      outline:3px solid var(--focus);
      outline-offset:3px;
    }

    /* Controlled content container (required class 'details') */
    .details{
      margin-top:0.75rem;
      overflow:hidden;
      border-radius:calc(var(--radius) - 3px);
      border:1px solid #eef3fb;
      background:#ffffff;
      padding:0.75rem 1rem;
      /* Collapsed by default via max-height and aria-hidden class toggled by JS */
      max-height: 0;
      transition: max-height 260ms cubic-bezier(.2,.9,.2,1), opacity 180ms ease;
      opacity:0;
    }

    .details.open{
      /* large enough to contain expected content */
      max-height: 100vh;
      opacity:1;
    }

    /* Rotate chevron when expanded; will be toggled via [aria-expanded="true"] */
    button[aria-expanded="true"] .chevron{
      transform: rotate(180deg);
    }

    /* Content styles */
    .details p{
      margin:0 0 0.75rem 0;
      color:var(--text);
    }
    .details a{
      color:var(--accent);
      text-decoration:underline;
    }

    /* Reduced motion preference */
    @media (prefers-reduced-motion: reduce){
      .details, .chevron, button[aria-expanded] .chevron{
        transition:none;
      }
    }

    /* Visually-hidden class for screen reader-only text */
    .sr-only{
      position:absolute!important;
      height:1px;width:1px;
      overflow:hidden;
      clip:rect(1px,1px,1px,1px);
      white-space:nowrap;
      border:0;padding:0;margin:-1px;
    }

    /* Ensure interactive contrast and hit target sizes */
    .toggle{
      min-height:44px;
    }

    /* Utility for inline instructions */
    .instructions{
      font-size:0.95rem;
      color:var(--muted);
      margin-bottom:0.75rem;
    }

    footer{
      margin-top:2rem;
      color:var(--muted);
      font-size:0.9rem;
    }

    /* Make sure the region role is clearly indicated for assistive tech */
    .details[aria-hidden="true"]{
      visibility:hidden;
    }
    .details[aria-hidden="false"]{
      visibility:visible;
    }
  </style>
</head>
<body>
  <a class="sr-only" href="#main">Skip to main content</a>
  <header>
    <h1>Accessible Expand/Collapse Widgets</h1>
    <p class="lead">Keyboard and screen reader friendly expand/collapse patterns. Each widget is wrapped in a div.example and the controlled container uses the class "details".</p>
  </header>

  <main id="main" tabindex="-1">
    <section aria-labelledby="examples-heading">
      <h2 id="examples-heading" class="sr-only">Examples</h2>

      <!-- Example 1 -->
      <div class="example">
        <p class="instructions">Press Enter or Space to toggle. Press Escape to close when focus is inside the expanded content.</p>

        <button
          id="toggle-1"
          class="toggle"
          aria-expanded="false"
          aria-controls="content-1"
        >
          <span class="label">Account security tips</span>
          <span class="meta">3 items</span>
          <svg class="chevron" aria-hidden="true" viewBox="0 0 20 20" fill="none" focusable="false" role="img" style="margin-left:0.5rem;">
            <path d="M5 8l5 5 5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>

        <div id="content-1" class="details" role="region" aria-labelledby="toggle-1" aria-hidden="true" tabindex="0">
          <p><strong>Keep software updated:</strong> Install updates for your operating system and applications promptly to protect against known vulnerabilities.</p>
          <p><strong>Use unique passwords:</strong> Avoid reusing passwords across sites. Consider a reputable password manager to generate and store strong passwords.</p>
          <p><strong>Enable two-factor authentication:</strong> Where available, use a second factor (like an authenticator app) to make access harder for attackers.</p>
          <p><a href="https://www.us-cert.gov/ncas/tips" target="_blank" rel="noopener noreferrer">Learn more about security tips</a></p>
        </div>
      </div>

      <!-- Example 2 -->
      <div class="example">
        <p class="instructions">This example demonstrates a short FAQ item. The content region has class "details".</p>

        <button
          id="toggle-2"
          class="toggle"
          aria-expanded="false"
          aria-controls="content-2"
        >
          <span class="label">What is your refund policy?</span>
          <span class="meta">FAQ</span>
          <svg class="chevron" aria-hidden="true" viewBox="0 0 20 20" fill="none" focusable="false" role="img">
            <path d="M5 8l5 5 5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>

        <div id="content-2" class="details" role="region" aria-labelledby="toggle-2" aria-hidden="true" tabindex="0">
          <p>We offer a 30-day money-back guarantee on most products. To request a refund, contact support with your order number and reason for the request.</p>
          <p><a href="#contact">Contact support</a> or review our <a href="#terms">terms and conditions</a> for details.</p>
        </div>
      </div>
    </section>

    <footer>
      <p>All examples follow accessible practices: semantic markup, visible focus, keyboard support, and assistive attributes (aria-expanded, aria-controls, role="region").</p>
    </footer>
  </main>

  <script>
    (function () {
      // Initialize all toggle buttons and wire up behavior
      const examples = document.querySelectorAll('.example');

      examples.forEach(example => {
        const button = example.querySelector('.toggle');
        const details = example.querySelector('.details');

        if (!button || !details) return;

        // Ensure IDs exist and link properly (aria-controls, aria-labelledby)
        if (!button.id) button.id = `toggle-${Math.random().toString(36).slice(2,9)}`;
        if (!details.id) details.id = `content-${Math.random().toString(36).slice(2,9)}`;
        button.setAttribute('aria-controls', details.id);
        details.setAttribute('aria-labelledby', button.id);

        // Helper to set open/closed state
        function setOpen(open, moveFocusIntoContent = false) {
          button.setAttribute('aria-expanded', open ? 'true' : 'false');
          if (open) {
            details.classList.add('open');
            details.setAttribute('aria-hidden', 'false');
            // For screen reader clarity, visibility should be visible when aria-hidden false
            // Leave focus on the button; if moveFocusIntoContent true, set focus to content container
            if (moveFocusIntoContent) {
              details.focus({preventScroll:true});
            }
          } else {
            details.classList.remove('open');
            details.setAttribute('aria-hidden', 'true');
          }
        }

        // Initial collapsed state
        setOpen(false);

        // Toggle on click
        button.addEventListener('click', (e) => {
          const expanded = button.getAttribute('aria-expanded') === 'true';
          setOpen(!expanded);
        });

        // Prevent page scroll when space toggles button (some browsers handle this)
        button.addEventListener('keydown', (e) => {
          if (e.code === 'Space' || e.key === ' ') {
            // Space key should toggle; let the click handler handle state, but prevent default scrolling
            e.preventDefault();
          }
        });

        // Allow Escape to close when focus is inside details region
        details.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' || e.key === 'Esc') {
            setOpen(false);
            // Return focus to the triggering button
            button.focus({preventScroll:false});
          }
        });

        // Close when clicking outside the expanded details (optional but helpful)
        document.addEventListener('click', (e) => {
          if (button.getAttribute('aria-expanded') === 'true') {
            if (!example.contains(e.target)) {
              setOpen(false);
            }
          }
        });

        // Manage focus styles for keyboard users: show outline when keyboard navigation is used
        // (This is an enhancement; browsers often manage :focus styles but we ensure visibility)
        // Track last input modality
        let hadKeyboardEvent = false;
        window.addEventListener('keydown', (e) => {
          hadKeyboardEvent = true;
        }, true);
        window.addEventListener('mousedown', (e) => {
          hadKeyboardEvent = false;
        }, true);

        button.addEventListener('focus', (e) => {
          if (hadKeyboardEvent) {
            button.classList.add('focus-visible');
          }
        });
        button.addEventListener('blur', () => {
          button.classList.remove('focus-visible');
        });

      });
    })();
  </script>
</body>
</html>