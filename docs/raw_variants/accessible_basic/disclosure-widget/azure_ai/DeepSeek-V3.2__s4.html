<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expand/Collapse Widget Demo</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 2rem auto;
            padding: 0 1rem;
            color: #333;
            background-color: #f9f9f9;
        }
        h1, h2 {
            color: #2c3e50;
        }
        .example {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            border-radius: 4px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: background-color 0.2s;
        }
        button:hover, button:focus-visible {
            background-color: #2980b9;
            outline: 2px solid #2980b9;
            outline-offset: 2px;
        }
        button:active {
            background-color: #1c6ea4;
        }
        button .icon {
            display: inline-block;
            transition: transform 0.3s ease;
            font-weight: bold;
        }
        button[aria-expanded="true"] .icon {
            transform: rotate(45deg);
        }
        .details {
            margin-top: 1rem;
            padding: 1rem;
            border: 1px solid #eee;
            border-radius: 4px;
            background-color: #f8fafc;
            overflow: hidden;
            transition: max-height 0.3s ease, opacity 0.3s ease;
        }
        .details[hidden] {
            display: block;
            max-height: 0;
            opacity: 0;
            padding-top: 0;
            padding-bottom: 0;
            border-width: 0;
        }
        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        footer {
            margin-top: 3rem;
            text-align: center;
            font-size: 0.9rem;
            color: #7f8c8d;
            border-top: 1px solid #eee;
            padding-top: 1rem;
        }
    </style>
</head>
<body>
    <header>
        <h1>Accessible Expand/Collapse Widget Demo</h1>
        <p>This page demonstrates accessible expand/collapse (disclosure) widgets. Each example uses semantic HTML and ARIA attributes where necessary. All controls are keyboard operable.</p>
    </header>

    <main>
        <section class="example">
            <h2>Product Features</h2>
            <button type="button" aria-expanded="false" aria-controls="details1">
                <span class="icon">+</span>
                <span>View advanced features</span>
                <span class="visually-hidden">. This button controls the visibility of additional content.</span>
            </button>
            <div id="details1" class="details" hidden>
                <p>Our product includes a suite of advanced features designed to enhance your workflow:</p>
                <ul>
                    <li><strong>Real-time collaboration:</strong> Work simultaneously with team members.</li>
                    <li><strong>Advanced analytics:</strong> Gain insights with detailed reports and dashboards.</li>
                    <li><strong>Custom automation:</strong> Create automated workflows without coding.</li>
                    <li><strong>Enterprise-grade security:</strong> Data encryption and compliance certifications.</li>
                </ul>
                <p>These features are available on all paid plans.</p>
            </div>
        </section>

        <section class="example">
            <h2>Frequently Asked Question</h2>
            <button type="button" aria-expanded="false" aria-controls="details2">
                <span class="icon">+</span>
                <span>What is your cancellation policy?</span>
                <span class="visually-hidden">. This button controls the visibility of the answer.</span>
            </button>
            <div id="details2" class="details" hidden>
                <p>You can cancel your subscription at any time. After cancellation, you will retain access to your plan's features until the end of your current billing period. We do not provide refunds for partial months. You can cancel directly from your account settings page.</p>
                <p>If you need assistance, please contact our support team.</p>
            </div>
        </section>

        <section class="example">
            <h2>Technical Specifications</h2>
            <button type="button" aria-expanded="false" aria-controls="details3">
                <span class="icon">+</span>
                <span>Show detailed specifications</span>
                <span class="visually-hidden">. This button controls the visibility of a technical data table.</span>
            </button>
            <div id="details3" class="details" hidden>
                <table>
                    <caption>Device Specifications</caption>
                    <thead>
                        <tr>
                            <th scope="col">Component</th>
                            <th scope="col">Minimum</th>
                            <th scope="col">Recommended</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th scope="row">Processor</th>
                            <td>2.0 GHz Dual-Core</td>
                            <td>3.0 GHz Quad-Core or better</td>
                        </tr>
                        <tr>
                            <th scope="row">Memory</th>
                            <td>4 GB RAM</td>
                            <td>8 GB RAM or more</td>
                        </tr>
                        <tr>
                            <th scope="row">Storage</th>
                            <td>10 GB available space</td>
                            <td>50 GB SSD</td>
                        </tr>
                        <tr>
                            <th scope="row">Operating System</th>
                            <td>Windows 10, macOS 10.14</td>
                            <td>Windows 11, macOS 12</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <footer>
        <p>Demo conforms to WCAG 2.2 Level AA. All widgets are fully keyboard accessible.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const buttons = document.querySelectorAll('button[aria-controls]');

            buttons.forEach(button => {
                const targetId = button.getAttribute('aria-controls');
                const target = document.getElementById(targetId);

                if (!target) return;

                // Toggle visibility
                button.addEventListener('click', function() {
                    const isExpanded = button.getAttribute('aria-expanded') === 'true';
                    button.setAttribute('aria-expanded', !isExpanded);
                    target.hidden = isExpanded;

                    // Manage focus for better accessibility
                    if (!isExpanded) {
                        setTimeout(() => {
                            const firstFocusable = target.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
                            if (firstFocusable) {
                                firstFocusable.focus();
                            }
                        }, 10);
                    }
                });

                // Keyboard support (Space and Enter)
                button.addEventListener('keydown', function(e) {
                    if (e.key === ' ' || e.key === 'Enter') {
                        e.preventDefault();
                        button.click();
                    }
                });

                // Ensure initial state is reflected
                target.hidden = button.getAttribute('aria-expanded') === 'false';
            });
        });
    </script>
</body>
</html>