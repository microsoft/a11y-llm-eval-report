<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expand/Collapse Widget Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .example {
            margin-bottom: 30px;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }
        .example h2 {
            margin: 0;
            padding: 15px;
            background-color: #f5f5f5;
            font-size: 1.2em;
            cursor: pointer;
            user-select: none;
            border-bottom: 1px solid #ddd;
        }
        .example h2:hover {
            background-color: #e9e9e9;
        }
        .example h2:focus {
            outline: 2px solid #007acc;
            outline-offset: -2px;
        }
        .details {
            padding: 0;
            margin: 0;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out;
        }
        .details.expanded {
            max-height: 500px; /* Adjust based on content */
            padding: 15px;
        }
        .content {
            margin: 0;
        }
        button {
            background: none;
            border: none;
            cursor: pointer;
            font: inherit;
            padding: 0;
            color: inherit;
        }
        .toggle-icon {
            float: right;
            transition: transform 0.3s ease;
        }
        .toggle-icon::before {
            content: '+';
            font-weight: bold;
        }
        .details.expanded .toggle-icon::before {
            content: '−';
        }
        /* High contrast mode support */
        @media (prefers-contrast: high) {
            .example {
                border-width: 2px;
            }
            .example h2 {
                border-width: 2px;
            }
        }
        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            .details,
            .toggle-icon {
                transition: none;
            }
        }
    </style>
</head>
<body>
    <main>
        <h1>Expand/Collapse Widget Demo</h1>
        
        <p>This page demonstrates accessible expand/collapse widgets. Each example can be toggled using keyboard navigation (Enter or Space) or mouse clicks. The content is hidden by default and expands smoothly when activated.</p>
        
        <div class="example" role="region" aria-labelledby="example1-title">
            <h2 id="example1-title" tabindex="0" role="button" aria-expanded="false" aria-controls="example1-content">
                Example 1: Basic Information
                <span class="toggle-icon" aria-hidden="true"></span>
            </h2>
            <div id="example1-content" class="details" role="region" aria-labelledby="example1-title">
                <div class="content">
                    <p>This is the first example of an expandable section. It contains basic information about accessibility guidelines. The widget uses semantic HTML where possible and ARIA attributes to ensure full keyboard accessibility and screen reader support.</p>
                    <ul>
                        <li>Use clear and descriptive headings</li>
                        <li>Ensure proper contrast ratios</li>
                        <li>Provide keyboard navigation</li>
                        <li>Include smooth transitions for better UX</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="example" role="region" aria-labelledby="example2-title">
            <h2 id="example2-title" tabindex="0" role="button" aria-expanded="false" aria-controls="example2-content">
                Example 2: Advanced Features
                <span class="toggle-icon" aria-hidden="true"></span>
            </h2>
            <div id="example2-content" class="details" role="region" aria-labelledby="example2-title">
                <div class="content">
                    <p>This second example demonstrates more advanced features of the expand/collapse pattern. Notice how the visual indicator changes from a plus (+) to a minus (−) when expanded, providing clear visual feedback.</p>
                    <p>Key accessibility considerations include:</p>
                    <table>
                        <caption>Accessibility Checklist</caption>
                        <thead>
                            <tr>
                                <th scope="col">Feature</th>
                                <th scope="col">WCAG Success Criterion</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Keyboard focusable</td>
                                <td>2.1.1 Keyboard</td>
                            </tr>
                            <tr>
                                <td>ARIA live regions</td>
                                <td>4.1.2 Name, Role, Value</td>
                            </tr>
                            <tr>
                                <td>Visible focus indicator</td>
                                <td>2.4.7 Focus Visible</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <div class="example" role="region" aria-labelledby="example3-title">
            <h2 id="example3-title" tabindex="0" role="button" aria-expanded="false" aria-controls="example3-content">
                Example 3: Usage Instructions
                <span class="toggle-icon" aria-hidden="true"></span>
            </h2>
            <div id="example3-content" class="details" role="region" aria-labelledby="example3-title">
                <div class="content">
                    <h3>How to use these widgets:</h3>
                    <ol>
                        <li><strong>Keyboard users:</strong> Tab to the heading and press Enter or Space to toggle</li>
                        <li><strong>Screen reader users:</strong> The expanded state is announced automatically</li>
                        <li><strong>Mouse users:</strong> Click anywhere on the heading to expand/collapse</li>
                        <li><strong>Touch devices:</strong> Tap the heading to toggle the content</li>
                    </ol>
                    <p>These widgets respect user preferences for reduced motion and high contrast modes, ensuring they work well across different accessibility needs.</p>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Get all example headings
        const headings = document.querySelectorAll('.example h2[role="button"]');
        
        headings.forEach(heading => {
            const content = document.getElementById(heading.getAttribute('aria-controls'));
            const toggleIcon = heading.querySelector('.toggle-icon');
            let isExpanded = false;
            
            // Add click event listener
            heading.addEventListener('click', toggleContent);
            
            // Add keyboard event listeners for Enter and Space
            heading.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    toggleContent();
                }
                // Allow Escape to close (optional enhancement)
                if (e.key === 'Escape' && isExpanded) {
                    e.preventDefault();
                    toggleContent();
                }
            });
            
            function toggleContent() {
                isExpanded = !isExpanded;
                
                // Update ARIA attributes
                heading.setAttribute('aria-expanded', isExpanded);
                
                // Toggle CSS classes
                content.classList.toggle('expanded', isExpanded);
                heading.setAttribute('aria-expanded', isExpanded.toString());
                
                // Focus management
                if (isExpanded) {
                    // Focus first focusable element in content or keep focus on heading
                    const firstFocusable = content.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
                    if (firstFocusable) {
                        firstFocusable.focus();
                    }
                }
                
                // Update toggle icon (handled by CSS)
                toggleIcon.setAttribute('aria-hidden', 'true');
            }
        });
        
        // Ensure focus management works correctly
        document.addEventListener('DOMContentLoaded', () => {
            headings.forEach(heading => {
                heading.focus();
            });
        });
    </script>
</body>
</html>