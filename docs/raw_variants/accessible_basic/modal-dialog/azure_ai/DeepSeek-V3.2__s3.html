<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modal Dialog Example</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            padding: 2rem;
            background-color: #f5f5f5;
            color: #333;
        }

        main {
            max-width: 800px;
            margin: 0 auto;
        }

        h1 {
            margin-bottom: 1rem;
        }

        p {
            margin-bottom: 1.5rem;
        }

        .trigger {
            background-color: #0056b3;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .trigger:hover,
        .trigger:focus-visible {
            background-color: #004494;
            outline: 2px solid #0056b3;
            outline-offset: 2px;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 1rem;
        }

        .modal-overlay[aria-hidden="false"] {
            display: flex;
        }

        .modal-dialog {
            background-color: white;
            border-radius: 0.5rem;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            padding: 1.5rem 1.5rem 1rem;
            border-bottom: 1px solid #e5e5e5;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .modal-title {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            line-height: 1;
            color: #666;
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 0.25rem;
        }

        .modal-close:hover,
        .modal-close:focus-visible {
            color: #000;
            background-color: #f0f0f0;
            outline: 2px solid #0056b3;
        }

        .modal-content {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1rem 1.5rem 1.5rem;
            border-top: 1px solid #e5e5e5;
            display: flex;
            justify-content: flex-end;
            gap: 0.75rem;
        }

        .modal-footer button {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-size: 0.9rem;
            cursor: pointer;
            border: 1px solid #ccc;
            background-color: #f8f8f8;
            transition: background-color 0.2s;
        }

        .modal-footer button:hover,
        .modal-footer button:focus-visible {
            background-color: #e8e8e8;
            outline: 2px solid #0056b3;
            outline-offset: 1px;
        }

        .modal-footer .primary {
            background-color: #0056b3;
            color: white;
            border-color: #0056b3;
        }

        .modal-footer .primary:hover,
        .modal-footer .primary:focus-visible {
            background-color: #004494;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
    </style>
</head>
<body>
    <main>
        <h1>Modal Dialog Example</h1>
        <p>This page demonstrates an accessible modal dialog. The button below will open the modal.</p>
        <button class="trigger" aria-haspopup="dialog" aria-expanded="false" aria-controls="example-modal">
            Open Modal Dialog
        </button>
        <p>Additional content here to show the modal overlay effect when the dialog is open.</p>
    </main>

    <div class="modal-overlay" id="modal-overlay" aria-hidden="true" aria-modal="true" role="dialog" aria-labelledby="modal-title" aria-describedby="modal-description">
        <div class="modal-dialog" id="example-modal" tabindex="-1">
            <div class="modal-header">
                <h2 class="modal-title" id="modal-title">Example Modal Dialog</h2>
                <button class="modal-close" aria-label="Close dialog">
                    &times;
                </button>
            </div>
            <div class="modal-content">
                <p id="modal-description">This is an example of an accessible modal dialog. It traps focus when open and can be closed via the close button, the Escape key, or by clicking outside the dialog.</p>
                <p>Modal dialogs are used to display important information or request user input without navigating away from the current page.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="primary">Confirm</button>
                <button type="button">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const triggerButton = document.querySelector('.trigger');
            const modalOverlay = document.getElementById('modal-overlay');
            const modalDialog = document.getElementById('example-modal');
            const closeButton = document.querySelector('.modal-close');
            const cancelButton = document.querySelector('.modal-footer button:not(.primary)');
            const focusableElements = modalDialog.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
            const firstFocusableElement = focusableElements[0];
            const lastFocusableElement = focusableElements[focusableElements.length - 1];
            let previousActiveElement;

            function openModal() {
                previousActiveElement = document.activeElement;
                modalOverlay.setAttribute('aria-hidden', 'false');
                triggerButton.setAttribute('aria-expanded', 'true');
                document.body.style.overflow = 'hidden';
                modalDialog.focus();

                // Add event listeners for closing
                document.addEventListener('keydown', handleKeyDown);
                modalOverlay.addEventListener('click', handleOverlayClick);
            }

            function closeModal() {
                modalOverlay.setAttribute('aria-hidden', 'true');
                triggerButton.setAttribute('aria-expanded', 'false');
                document.body.style.overflow = '';
                if (previousActiveElement) {
                    previousActiveElement.focus();
                }

                // Remove event listeners
                document.removeEventListener('keydown', handleKeyDown);
                modalOverlay.removeEventListener('click', handleOverlayClick);
            }

            function handleKeyDown(event) {
                if (event.key === 'Escape') {
                    closeModal();
                }
                if (event.key === 'Tab') {
                    if (event.shiftKey) {
                        if (document.activeElement === firstFocusableElement) {
                            event.preventDefault();
                            lastFocusableElement.focus();
                        }
                    } else {
                        if (document.activeElement === lastFocusableElement) {
                            event.preventDefault();
                            firstFocusableElement.focus();
                        }
                    }
                }
            }

            function handleOverlayClick(event) {
                if (event.target === modalOverlay) {
                    closeModal();
                }
            }

            triggerButton.addEventListener('click', openModal);
            closeButton.addEventListener('click', closeModal);
            cancelButton.addEventListener('click', closeModal);

            // Close on primary button click for demo purposes
            document.querySelector('.modal-footer .primary').addEventListener('click', closeModal);
        });
    </script>
</body>
</html>