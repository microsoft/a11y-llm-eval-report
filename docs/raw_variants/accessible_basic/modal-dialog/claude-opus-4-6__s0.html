<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modal Dialog Example</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, sans-serif;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f0f2f5;
            color: #1a1a1a;
        }

        .trigger {
            padding: 12px 24px;
            font-size: 1rem;
            font-weight: 600;
            color: #fff;
            background-color: #0055d4;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .trigger:hover {
            background-color: #003fa3;
        }

        .trigger:focus-visible {
            outline: 3px solid #0055d4;
            outline-offset: 2px;
        }

        .modal-backdrop {
            display: none;
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-backdrop.open {
            display: flex;
        }

        .modal-dialog {
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            padding: 0;
            position: relative;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px 12px;
            border-bottom: 1px solid #e0e0e0;
        }

        .modal-header h2 {
            font-size: 1.25rem;
            font-weight: 700;
            color: #1a1a1a;
        }

        .modal-close {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: none;
            border: 2px solid transparent;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.25rem;
            color: #555;
            transition: background-color 0.2s ease, color 0.2s ease;
            flex-shrink: 0;
        }

        .modal-close:hover {
            background-color: #f0f0f0;
            color: #1a1a1a;
        }

        .modal-close:focus-visible {
            outline: 3px solid #0055d4;
            outline-offset: 2px;
        }

        .modal-body {
            padding: 20px 24px;
        }

        .modal-body p {
            font-size: 1rem;
            line-height: 1.6;
            color: #444;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            padding: 12px 24px 20px;
            border-top: 1px solid #e0e0e0;
        }

        .btn-secondary {
            padding: 10px 20px;
            font-size: 0.9375rem;
            font-weight: 600;
            color: #333;
            background-color: #e8e8e8;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .btn-secondary:hover {
            background-color: #d0d0d0;
        }

        .btn-secondary:focus-visible {
            outline: 3px solid #0055d4;
            outline-offset: 2px;
        }

        .btn-primary {
            padding: 10px 20px;
            font-size: 0.9375rem;
            font-weight: 600;
            color: #fff;
            background-color: #0055d4;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .btn-primary:hover {
            background-color: #003fa3;
        }

        .btn-primary:focus-visible {
            outline: 3px solid #0055d4;
            outline-offset: 2px;
        }
    </style>
</head>
<body>
    <button class="trigger" id="openModal">Open Modal</button>

    <div class="modal-backdrop" id="modalBackdrop">
        <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="modalTitle" id="modalDialog">
            <div class="modal-header">
                <h2 id="modalTitle">Modal Title</h2>
                <button class="modal-close" aria-label="Close modal" id="closeModalX">
                    <span aria-hidden="true">&#10005;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>This is an example modal dialog. It traps focus within the dialog while open and can be closed by pressing the Escape key, clicking the close button, or clicking outside the dialog.</p>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="cancelBtn">Cancel</button>
                <button class="btn-primary" id="confirmBtn">Confirm</button>
            </div>
        </div>
    </div>

    <script>
        const openBtn = document.getElementById('openModal');
        const backdrop = document.getElementById('modalBackdrop');
        const dialog = document.getElementById('modalDialog');
        const closeX = document.getElementById('closeModalX');
        const cancelBtn = document.getElementById('cancelBtn');
        const confirmBtn = document.getElementById('confirmBtn');

        let previouslyFocused = null;

        function getFocusableElements() {
            const elements = dialog.querySelectorAll(
                'a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])'
            );
            return Array.from(elements);
        }

        function openModal() {
            previouslyFocused = document.activeElement;
            backdrop.classList.add('open');
            document.body.style.overflow = 'hidden';

            const focusable = getFocusableElements();
            if (focusable.length > 0) {
                focusable[0].focus();
            }
        }

        function closeModal() {
            backdrop.classList.remove('open');
            document.body.style.overflow = '';

            if (previouslyFocused) {
                previouslyFocused.focus();
            }
        }

        function trapFocus(e) {
            if (!backdrop.classList.contains('open')) return;
            if (e.key !== 'Tab') return;

            const focusable = getFocusableElements();
            if (focusable.length === 0) return;

            const firstFocusable = focusable[0];
            const lastFocusable = focusable[focusable.length - 1];

            if (e.shiftKey) {
                if (document.activeElement === firstFocusable) {
                    e.preventDefault();
                    lastFocusable.focus();
                }
            } else {
                if (document.activeElement === lastFocusable) {
                    e.preventDefault();
                    firstFocusable.focus();
                }
            }
        }

        openBtn.addEventListener('click', openModal);
        closeX.addEventListener('click', closeModal);
        cancelBtn.addEventListener('click', closeModal);
        confirmBtn.addEventListener('click', closeModal);

        backdrop.addEventListener('click', function (e) {
            if (e.target === backdrop) {
                closeModal();
            }
        });

        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape' && backdrop.classList.contains('open')) {
                closeModal();
            }
            trapFocus(e);
        });
    </script>
</body>
</html>