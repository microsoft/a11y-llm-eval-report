<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Accessible Modal Dialog Example</title>
  <style>
    :root {
      --bg: #0b0f17;
      --panel: #111827;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --border: #334155;
      --accent: #60a5fa;
      --focus: #fbbf24;
      --shadow: 0 20px 50px rgba(0, 0, 0, 0.55);
      --radius: 14px;
      --gap: 1rem;
      --pad: 1rem;
      --maxw: 34rem;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      color: var(--text);
      background: linear-gradient(180deg, #0b0f17, #070a10);
      min-height: 100vh;
      display: grid;
      place-items: center;
      padding: 2rem 1rem;
    }

    main {
      width: min(48rem, 100%);
      background: rgba(17, 24, 39, 0.65);
      border: 1px solid rgba(51, 65, 85, 0.55);
      border-radius: var(--radius);
      padding: 1.25rem;
      box-shadow: var(--shadow);
    }

    h1 {
      font-size: 1.25rem;
      margin: 0 0 0.75rem;
      letter-spacing: 0.01em;
    }

    p {
      margin: 0 0 1rem;
      color: var(--muted);
      line-height: 1.5;
    }

    .trigger {
      appearance: none;
      border: 1px solid rgba(96, 165, 250, 0.7);
      background: rgba(96, 165, 250, 0.12);
      color: var(--text);
      padding: 0.65rem 0.9rem;
      border-radius: 0.75rem;
      font-weight: 600;
      cursor: pointer;
    }

    .trigger:hover {
      background: rgba(96, 165, 250, 0.18);
    }

    .trigger:focus-visible,
    button:focus-visible {
      outline: 3px solid var(--focus);
      outline-offset: 2px;
    }

    /* Modal */
    .modal-overlay[hidden] { display: none; }

    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      display: grid;
      place-items: center;
      padding: 1.25rem;
    }

    .modal {
      width: min(var(--maxw), 100%);
      border-radius: var(--radius);
      background: rgba(17, 24, 39, 0.98);
      border: 1px solid rgba(51, 65, 85, 0.75);
      box-shadow: var(--shadow);
      padding: 1.1rem;
    }

    .modal header {
      display: flex;
      align-items: start;
      justify-content: space-between;
      gap: var(--gap);
      margin-bottom: 0.75rem;
    }

    .modal-title {
      margin: 0;
      font-size: 1.05rem;
    }

    .modal-body {
      color: var(--text);
      line-height: 1.55;
    }

    .modal-body p {
      color: var(--text);
      margin: 0.25rem 0 0.75rem;
    }

    .modal-actions {
      display: flex;
      gap: 0.75rem;
      justify-content: end;
      margin-top: 1rem;
      flex-wrap: wrap;
    }

    .btn {
      appearance: none;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(148, 163, 184, 0.08);
      color: var(--text);
      padding: 0.6rem 0.85rem;
      border-radius: 0.75rem;
      font-weight: 600;
      cursor: pointer;
    }

    .btn:hover { background: rgba(148, 163, 184, 0.12); }

    .btn-primary {
      border-color: rgba(96, 165, 250, 0.85);
      background: rgba(96, 165, 250, 0.18);
    }
    .btn-primary:hover { background: rgba(96, 165, 250, 0.24); }

    .icon-btn {
      appearance: none;
      border: 1px solid rgba(148, 163, 184, 0.55);
      background: transparent;
      color: var(--text);
      border-radius: 0.75rem;
      padding: 0.35rem 0.5rem;
      cursor: pointer;
      line-height: 1;
      min-width: 2.25rem;
      min-height: 2.25rem;
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }
  </style>
</head>
<body>
  <main>
    <h1>Modal dialog example</h1>
    <p>This example uses an accessible modal with focus management. It is closed by default.</p>
    <button type="button" class="trigger" id="openModalBtn">
      Open modal dialog
    </button>
  </main>

  <!-- Modal overlay is hidden by default -->
  <div class="modal-overlay" id="modalOverlay" hidden>
    <div
      class="modal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="modalTitle"
      aria-describedby="modalDesc"
    >
      <header>
        <h2 class="modal-title" id="modalTitle">Example modal</h2>
        <button type="button" class="icon-btn" data-modal-close aria-label="Close dialog">
          <span aria-hidden="true">×</span>
        </button>
      </header>

      <div class="modal-body" id="modalDesc">
        <p>
          This is a modal dialog. Press <kbd>Escape</kbd> to close, or use the buttons below.
          Focus is trapped inside the dialog while it’s open.
        </p>
      </div>

      <div class="modal-actions">
        <button type="button" class="btn" data-modal-close>Cancel</button>
        <button type="button" class="btn btn-primary" id="confirmBtn">Confirm</button>
      </div>
    </div>
  </div>

  <script>
    (function () {
      const openBtn = document.getElementById('openModalBtn');
      const overlay = document.getElementById('modalOverlay');
      const dialog = overlay.querySelector('[role="dialog"]');
      const closeBtns = overlay.querySelectorAll('[data-modal-close]');
      const confirmBtn = document.getElementById('confirmBtn');

      let lastActive = null;

      function getFocusable(container) {
        const selectors = [
          'a[href]',
          'area[href]',
          'button:not([disabled])',
          'input:not([disabled]):not([type="hidden"])',
          'select:not([disabled])',
          'textarea:not([disabled])',
          '[tabindex]:not([tabindex="-1"])'
        ];
        return Array.from(container.querySelectorAll(selectors.join(',')))
          .filter(el => !el.hasAttribute('disabled') && el.getAttribute('aria-hidden') !== 'true');
      }

      function openModal() {
        if (!overlay.hasAttribute('hidden')) return;

        lastActive = document.activeElement;
        overlay.removeAttribute('hidden');

        // Prevent background scrolling while modal is open
        document.documentElement.style.overflow = 'hidden';
        document.body.style.overflow = 'hidden';

        // Focus first focusable element in dialog (close button first)
        const focusables = getFocusable(dialog);
        (focusables[0] || dialog).focus();
      }

      function closeModal() {
        if (overlay.hasAttribute('hidden')) return;

        overlay.setAttribute('hidden', '');
        document.documentElement.style.overflow = '';
        document.body.style.overflow = '';

        if (lastActive && typeof lastActive.focus === 'function') {
          lastActive.focus();
        } else {
          openBtn.focus();
        }
      }

      // Open via trigger button (required class is "trigger")
      openBtn.addEventListener('click', openModal);

      // Close via close buttons
      closeBtns.forEach(btn => btn.addEventListener('click', closeModal));

      // Click outside the dialog closes it
      overlay.addEventListener('click', (e) => {
        if (e.target === overlay) closeModal();
      });

      // Keyboard handling: Escape closes, Tab traps focus
      overlay.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          e.preventDefault();
          closeModal();
          return;
        }

        if (e.key !== 'Tab') return;

        const focusables = getFocusable(dialog);
        if (focusables.length === 0) {
          e.preventDefault();
          dialog.focus();
          return;
        }

        const first = focusables[0];
        const last = focusables[focusables.length - 1];

        if (e.shiftKey && document.activeElement === first) {
          e.preventDefault();
          last.focus();
        } else if (!e.shiftKey && document.activeElement === last) {
          e.preventDefault();
          first.focus();
        }
      });

      // Example action
      confirmBtn.addEventListener('click', () => {
        closeModal();
      });
    })();
  </script>
</body>
</html>