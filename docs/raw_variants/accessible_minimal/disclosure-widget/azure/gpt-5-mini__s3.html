<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Accessible Expand/Collapse Widget Examples</title>
  <style>
    :root{
      --accent: #0366d6;
      --bg: #ffffff;
      --border: #e1e4e8;
      --radius: 8px;
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      line-height: 1.45;
      background: #f6f8fa;
      color: #0b1117;
      margin: 24px;
      padding: 0;
    }

    header{
      margin-bottom: 18px;
    }

    h1{
      font-size: 1.25rem;
      margin: 0 0 8px 0;
    }

    p.lead{
      margin: 0 0 18px 0;
      color: #39424a;
      font-size: 0.95rem;
    }

    .example{
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 14px;
      margin-bottom: 18px;
      box-shadow: 0 1px 0 rgba(9,30,66,0.02);
    }

    .toggle-button{
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      font-size: 1rem;
      background: linear-gradient(180deg,#fff,#fbfdff);
      border: 1px solid var(--border);
      border-radius: 6px;
      color: #072a4b;
      cursor: pointer;
      width: 100%;
      text-align: left;
    }

    .toggle-button:hover{
      box-shadow: 0 1px 0 rgba(9,30,66,0.03);
    }

    .toggle-button:focus{
      outline: 3px solid rgba(3,102,214,0.18);
      outline-offset: 2px;
    }

    .toggle-button .label{
      flex: 1 1 auto;
    }

    .toggle-button .meta{
      font-size: 0.9rem;
      color: #586e75;
      white-space: nowrap;
    }

    .toggle-button .icon{
      width: 18px;
      height: 18px;
      flex: 0 0 18px;
      display: inline-block;
      transition: transform 240ms ease;
    }

    .toggle-button[aria-expanded="true"] .icon{
      transform: rotate(90deg);
    }

    .details{
      overflow: hidden;
      transition: max-height 260ms ease, opacity 220ms ease;
      max-height: 0;
      opacity: 0;
      margin-top: 10px;
      padding-left: 4px;
    }

    .details.open{
      opacity: 1;
      /* max-height will be set inline to scrollHeight for smooth animation */
    }

    .details p{
      margin: 6px 0;
    }

    .sr-only{
      position: absolute !important;
      height: 1px; width: 1px;
      overflow: hidden;
      clip: rect(1px, 1px, 1px, 1px);
      white-space: nowrap;
    }

    footer{
      margin-top: 28px;
      font-size: 0.9rem;
      color: #4b5960;
    }
  </style>
</head>
<body>
  <header>
    <h1>Expand / Collapse Widget (Accessible)</h1>
    <p class="lead">Two examples of an accessible expand/collapse widget. Each widget is wrapped in a container with the class "example" and its controlled content uses the class "details". Use Enter or Space to toggle when focused.</p>
  </header>

  <!-- Example 1 -->
  <div class="example">
    <button
      id="exp-btn-1"
      class="toggle-button"
      aria-expanded="false"
      aria-controls="exp-details-1"
      type="button"
    >
      <span class="icon" aria-hidden="true">▶</span>
      <span class="label">Show product description</span>
      <span class="meta">More</span>
    </button>

    <div
      id="exp-details-1"
      class="details"
      role="region"
      aria-labelledby="exp-btn-1"
      aria-hidden="true"
    >
      <p><strong>Compact water bottle — 500ml:</strong> Lightweight, BPA-free, and insulated to keep drinks cool for up to 12 hours. Ideal for commuting, gym, and outdoor activities.</p>
      <p>Care: Hand wash recommended. Not suitable for hot beverages.</p>
    </div>
  </div>

  <!-- Example 2 -->
  <div class="example">
    <button
      id="exp-btn-2"
      class="toggle-button"
      aria-expanded="false"
      aria-controls="exp-details-2"
      type="button"
    >
      <span class="icon" aria-hidden="true">▶</span>
      <span class="label">Accessibility notes</span>
      <span class="meta">Read</span>
    </button>

    <div
      id="exp-details-2"
      class="details"
      role="region"
      aria-labelledby="exp-btn-2"
      aria-hidden="true"
    >
      <p>These widgets synchronize the button's aria-expanded attribute with the content's aria-hidden state so assistive technologies can understand the relationship.</p>
      <p>Keyboard interaction: When the button has focus, press Enter or Space to toggle the content. Focus remains on the button for predictable navigation.</p>
    </div>
  </div>

  <footer>
    <p>Example widgets use aria-controls to link button and content, role="region", and aria-labelledby for clear labels.</p>
  </footer>

  <script>
    (function(){
      // Utility: find all toggle buttons in the document
      var buttons = document.querySelectorAll('.toggle-button[aria-controls]');

      function openDetails(button, details){
        button.setAttribute('aria-expanded','true');
        details.classList.add('open');
        details.setAttribute('aria-hidden','false');

        // set max-height to scrollHeight for smooth open animation
        var height = details.scrollHeight;
        details.style.maxHeight = height + 'px';
      }

      function closeDetails(button, details){
        button.setAttribute('aria-expanded','false');
        details.setAttribute('aria-hidden','true');

        // collapse animation: set max-height to current height then to 0
        var height = details.scrollHeight;
        details.style.maxHeight = height + 'px'; // ensure computed
        // force repaint to make transition
        details.getBoundingClientRect();
        details.style.maxHeight = '0px';

        // remove open class after transition finishes to reset opacity
        details.addEventListener('transitionend', function handler(e){
          if (e.propertyName === 'max-height'){
            details.classList.remove('open');
            // clean up inline style
            details.style.maxHeight = '';
            details.removeEventListener('transitionend', handler);
          }
        });
      }

      function toggle(event){
        var button = event.currentTarget;
        var id = button.getAttribute('aria-controls');
        var details = document.getElementById(id);
        if (!details) return;

        var expanded = button.getAttribute('aria-expanded') === 'true';
        if (expanded){
          closeDetails(button, details);
        } else {
          openDetails(button, details);
        }
      }

      // Add listeners to each button
      Array.prototype.forEach.call(buttons, function(button){
        var id = button.getAttribute('aria-controls');
        var details = document.getElementById(id);

        // Ensure initial state is hidden
        if (details){
          details.setAttribute('aria-hidden','true');
          details.style.maxHeight = '0px';
        }

        // Click toggles
        button.addEventListener('click', toggle);

        // Space and Enter activate the button naturally; keep for redundancy and consistent behavior
        button.addEventListener('keydown', function(e){
          if (e.key === ' ' || e.key === 'Spacebar'){ // older browsers
            e.preventDefault();
            button.click();
          } else if (e.key === 'Enter'){
            // Enter should activate the button by default, but ensure consistent toggle
            e.preventDefault();
            button.click();
          }
        });
      });

      // Respect reduced motion preference by disabling height animation
      var media = window.matchMedia('(prefers-reduced-motion: reduce)');
      function handleReducedMotion(){
        if (media && media.matches){
          var detailsEls = document.querySelectorAll('.details');
          detailsEls.forEach(function(d){
            d.style.transition = 'none';
          });
        }
      }
      handleReducedMotion();
      if (media && media.addEventListener){
        media.addEventListener('change', handleReducedMotion);
      }
    })();
  </script>
</body>
</html>