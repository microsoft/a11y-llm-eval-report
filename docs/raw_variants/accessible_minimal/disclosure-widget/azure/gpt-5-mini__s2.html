<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Accessible Expand/Collapse Widget Examples</title>
  <style>
    :root{
      --accent:#0366d6;
      --bg:#f8fafc;
      --panel-bg:#ffffff;
      --border:#e2e8f0;
      --radius:8px;
      --duration:220ms;
      --text:#0f172a;
    }

    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      line-height:1.5;
      margin:1.25rem;
      color:var(--text);
      background:linear-gradient(180deg,var(--bg),#ffffff 60%);
    }

    h1{
      font-size:1.25rem;
      margin:0 0 1rem 0;
    }

    .example{
      background:var(--panel-bg);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:1rem;
      margin:0 0 1rem 0;
      box-shadow:0 1px 2px rgba(16,24,40,0.03);
      max-width:760px;
    }

    .widget-header{
      display:flex;
      align-items:center;
      gap:0.75rem;
    }

    .toggle{
      appearance:none;
      -webkit-appearance:none;
      border:1px solid var(--border);
      background:white;
      color:var(--text);
      padding:0.5rem 0.75rem;
      border-radius:6px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:0.5rem;
      cursor:pointer;
      font:inherit;
      box-shadow:none;
      transition:box-shadow var(--duration), transform var(--duration), border-color var(--duration);
    }

    .toggle:focus{
      outline:3px solid rgba(3,102,214,0.15);
      outline-offset:2px;
    }

    .toggle:hover{
      border-color:rgba(3,102,214,0.12);
    }

    .toggle .icon{
      display:inline-block;
      width:1rem;
      height:1rem;
      transform-origin:center;
      transition:transform var(--duration) ease;
    }

    .toggle[aria-expanded="true"] .icon{
      transform:rotate(90deg);
    }

    .title{
      font-weight:600;
      font-size:1rem;
      color:var(--text);
    }

    /* details panel (controlled content) */
    .details{
      margin-top:0.75rem;
      overflow:hidden;
      transition:max-height var(--duration) ease, opacity var(--duration) ease;
      max-height:0;
      opacity:0;
      border-top:1px solid var(--border);
      padding-top:0.75rem;
    }

    .details.open{
      opacity:1;
      max-height:100vh; /* large value to allow expand; respects natural height */
    }

    .details p{
      margin:0 0 0.75rem 0;
    }

    .visually-hidden{
      position:absolute !important;
      height:1px;
      width:1px;
      overflow:hidden;
      clip:rect(1px,1px,1px,1px);
      white-space:nowrap;
      border:0;
      padding:0;
      margin:-1px;
    }

    /* Respect reduced motion preference */
    @media (prefers-reduced-motion: reduce){
      .details{
        transition:none;
      }
      .toggle .icon{
        transition:none;
      }
    }
  </style>
</head>
<body>
  <h1>Accessible Expand/Collapse Widget Examples</h1>

  <div class="example" data-example="1">
    <div class="widget-header">
      <button class="toggle"
              id="toggle-1"
              aria-expanded="false"
              aria-controls="details-1"
              type="button">
        <span class="icon" aria-hidden="true">▶</span>
        <span class="title">About Mountain Lions</span>
      </button>
      <div class="visually-hidden" aria-hidden="true">Press Enter or Space to expand or collapse the panel.</div>
    </div>

    <div id="details-1" class="details"
         role="region"
         aria-labelledby="toggle-1"
         aria-hidden="true">
      <p>Mountain lions (also called cougars or pumas) are large felines native to the Americas. They are solitary and territorial animals that prefer regions with cover for stalking prey.</p>
      <p>These cats are adaptable and can be found in a range of habitats, including deserts, forests, and mountains. They are crepuscular, most active at dawn and dusk.</p>
    </div>
  </div>

  <div class="example" data-example="2">
    <div class="widget-header">
      <button class="toggle"
              id="toggle-2"
              aria-expanded="true"
              aria-controls="details-2"
              type="button">
        <span class="icon" aria-hidden="true">▶</span>
        <span class="title">How to Prepare Tea</span>
      </button>
    </div>

    <div id="details-2" class="details open"
         role="region"
         aria-labelledby="toggle-2"
         aria-hidden="false">
      <p>Start with fresh, cold water. Heat to the temperature recommended for your tea type — near-boiling for black tea, lower for green or white. Use about one teaspoon of loose tea per cup.</p>
      <p>Steep for the recommended time, strain the leaves, and enjoy. Adjust steep time and tea quantity to taste.</p>
    </div>
  </div>

  <div class="example" data-example="3">
    <div class="widget-header">
      <button class="toggle"
              id="toggle-3"
              aria-expanded="false"
              aria-controls="details-3"
              type="button">
        <span class="icon" aria-hidden="true">▶</span>
        <span class="title">Accessibility Notes</span>
      </button>
    </div>

    <div id="details-3" class="details"
         role="region"
         aria-labelledby="toggle-3"
         aria-hidden="true">
      <p>This widget uses native button elements with aria-expanded and aria-controls to communicate state and relationships. The content region uses role="region" and aria-labelledby to link back to the control.</p>
      <p>Keyboard users can activate the toggle with Enter or Space. Motion preference is respected via prefers-reduced-motion.</p>
    </div>
  </div>

  <script>
    (function(){
      // Graceful setup: find all examples that contain a button.toggle and a .details panel
      var examples = document.querySelectorAll('.example');
      var uidCounter = 0;

      examples.forEach(function(example){
        var btn = example.querySelector('.toggle');
        var panel = example.querySelector('.details');
        if(!btn || !panel) return;

        // Ensure unique IDs if missing
        if(!btn.id){
          uidCounter += 1;
          btn.id = 'toggle-auto-' + uidCounter;
        }
        if(!panel.id){
          uidCounter += 1;
          panel.id = 'details-auto-' + uidCounter;
        }

        // Initialize state from attributes already in markup
        var expanded = btn.getAttribute('aria-expanded') === 'true';
        setState(btn, panel, expanded);

        // Click toggles
        btn.addEventListener('click', function(){
          var isExpanded = btn.getAttribute('aria-expanded') === 'true';
          setState(btn, panel, !isExpanded);
        });

        // Allow Home/End keys to open/close all examples in a simple way (optional accessibility enhancement)
        btn.addEventListener('keydown', function(e){
          if(e.key === 'Home'){
            e.preventDefault();
            setState(btn, panel, true);
          } else if(e.key === 'End'){
            e.preventDefault();
            setState(btn, panel, false);
          }
        });
      });

      function setState(button, panel, toOpen){
        if(toOpen){
          button.setAttribute('aria-expanded','true');
          panel.classList.add('open');
          panel.setAttribute('aria-hidden','false');
        } else {
          button.setAttribute('aria-expanded','false');
          panel.classList.remove('open');
          panel.setAttribute('aria-hidden','true');
        }
      }

      // If JavaScript is disabled, ensure panels that were intended to be open remain visible.
      // We already used classes/open and aria-hidden in markup for the initial states,
      // so no further action is required here for progressive enhancement.
    })();
  </script>
</body>
</html>