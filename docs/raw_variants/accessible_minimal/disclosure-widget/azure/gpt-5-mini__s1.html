<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Accessible Expand/Collapse Widget Demo</title>
  <style>
    :root{
      --bg:#f8fafc;
      --card:#ffffff;
      --accent:#0b79d0;
      --text:#0b1720;
      --muted:#5b6b76;
      --focus: 3px solid #ffd54f;
    }
    html,body{
      height:100%;
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
      background:var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.4;
    }

    main{
      max-width:900px;
      margin:48px auto;
      padding:20px;
    }

    h1{
      margin:0 0 8px 0;
      font-size:1.45rem;
    }
    p.lead{
      margin:0 0 20px 0;
      color:var(--muted);
    }

    /* Example wrapper required by spec */
    .example{
      background:var(--card);
      border:1px solid #e6eef6;
      border-radius:8px;
      padding:16px;
      margin:18px 0;
      box-shadow:0 1px 2px rgba(11,23,32,0.03);
    }

    /* Toggle button */
    .toggle{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 14px;
      font-size:1rem;
      color:var(--accent);
      background:transparent;
      border:1px solid #dbeefc;
      border-radius:6px;
      cursor:pointer;
      transition:background .15s, border-color .15s, color .15s;
    }
    .toggle:hover{
      background:#f0fbff;
      border-color:#bfe9ff;
    }
    .toggle:focus{
      outline:none;
      box-shadow:var(--focus);
      border-color:var(--accent);
    }

    /* Icon (pure CSS) */
    .toggle .icon{
      width:14px;
      height:14px;
      display:inline-block;
      position:relative;
      flex:0 0 14px;
    }
    .toggle .icon::before,
    .toggle .icon::after{
      content:"";
      position:absolute;
      left:0;
      right:0;
      height:2px;
      background:currentColor;
      top:50%;
      transform:translateY(-50%);
      transition:transform .18s ease;
      border-radius:2px;
    }
    .toggle .icon::after{
      width:100%;
      transform-origin:center;
    }
    .toggle[aria-expanded="false"] .icon::before{
      transform: translateY(-50%) rotate(90deg);
    }
    .toggle[aria-expanded="true"] .icon::before{
      transform: translateY(-50%) rotate(0deg);
    }

    /* Details container (must have class details) */
    .details{
      margin-top:12px;
      padding:12px;
      border-radius:6px;
      background:#fbfeff;
      border:1px dashed #e8f6ff;
    }

    /* When hidden via attribute [hidden] browsers hide it; provide subtle transition when open */
    .details[hidden]{
      display:none;
    }

    /* Additional styling inside details */
    .details p{
      margin:0 0 10px 0;
      color:var(--muted);
    }
    .details ul{
      margin:0 0 10px 20px;
    }

    /* Small visually hidden helper for screen readers */
    .visually-hidden{
      position:absolute!important;
      height:1px; width:1px;
      overflow:hidden;
      clip:rect(1px, 1px, 1px, 1px);
      white-space:nowrap;
    }

    /* Helpful footer note */
    footer{
      margin-top:26px;
      color:var(--muted);
      font-size:.9rem;
    }

    /* Responsive */
    @media (max-width:520px){
      .toggle{
        width:100%;
        justify-content:space-between;
      }
    }
  </style>
</head>
<body>
  <main>
    <h1>Expand / Collapse Widget — Accessible Demo</h1>
    <p class="lead">Each widget below is wrapped with a container that has the class "example". The controlled content uses the class "details". Buttons manage aria-expanded and aria-controls for assistive technologies.</p>

    <!-- Example 1 -->
    <div class="example" id="example-1">
      <div style="display:flex; justify-content:space-between; align-items:center; gap:12px;">
        <div>
          <strong>Widget 1:</strong>
          <div style="color:var(--muted); font-size:.95rem;">Basic information you can reveal or hide</div>
        </div>
        <div>
          <button class="toggle"
                  id="toggle-1"
                  aria-expanded="false"
                  aria-controls="details-1">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Show details</span>
          </button>
        </div>
      </div>

      <div id="details-1" class="details" role="region" aria-labelledby="toggle-1" hidden aria-hidden="true">
        <p><strong>Additional details:</strong> This section contains more information about the item above. It is hidden by default and can be revealed by activating the "Show details" button.</p>
        <p>Keyboard interaction: Use Tab to focus the toggle button; press Space or Enter to toggle the content. Press Escape to close when open.</p>
        <ul>
          <li>Accessible labels: the button has aria-expanded and aria-controls.</li>
          <li>The content region has role="region" and aria-labelledby pointing to the button.</li>
        </ul>
      </div>
    </div>

    <!-- Example 2 -->
    <div class="example" id="example-2">
      <div style="display:flex; justify-content:space-between; align-items:center; gap:12px;">
        <div>
          <strong>Widget 2:</strong>
          <div style="color:var(--muted); font-size:.95rem;">Example with links and a longer paragraph</div>
        </div>
        <div>
          <button class="toggle"
                  id="toggle-2"
                  aria-expanded="false"
                  aria-controls="details-2">
            <span class="icon" aria-hidden="true"></span>
            <span class="label">Reveal content</span>
          </button>
        </div>
      </div>

      <div id="details-2" class="details" role="region" aria-labelledby="toggle-2" hidden aria-hidden="true">
        <p>This content area can include interactive elements such as links, buttons, and form controls. When expanded, keyboard focus can move into this region and interact with its contents.</p>
        <p><a href="#" style="color:var(--accent)">Example link</a> — this demonstrates that links remain keyboard accessible while inside the expanded region.</p>
        <p>If you need to programmatically focus the first control when expanding, that can be done from script in a manner that remains respectful to the user's expectations.</p>
      </div>
    </div>

    <footer>
      Note: If JavaScript is disabled, content remains collapsed (hidden). This demo includes a small script to toggle aria attributes and the hidden state for accessibility.
    </footer>
  </main>

  <script>
    (function(){
      // Find all examples and set up toggle behavior
      const examples = document.querySelectorAll('.example');

      examples.forEach(example => {
        const toggle = example.querySelector('.toggle');
        if (!toggle) return;

        const detailsId = toggle.getAttribute('aria-controls');
        const details = example.querySelector('#' + CSS.escape(detailsId));

        if (!details) return;

        // Helper to update UI state
        function setOpen(open, moveFocus){
          toggle.setAttribute('aria-expanded', String(open));
          if (open){
            // Show region
            details.hidden = false;
            details.setAttribute('aria-hidden','false');
            example.classList.add('open');
            // Update label text
            const label = toggle.querySelector('.label');
            if (label) label.textContent = 'Hide details';
            if (moveFocus){
              // Optional: move focus into the details region to the first focusable element,
              // otherwise leave focus on the toggle button. Here we keep focus on the button
              // but if you want to focus first control inside, implement that logic.
            }
          } else {
            details.hidden = true;
            details.setAttribute('aria-hidden','true');
            example.classList.remove('open');
            const label = toggle.querySelector('.label');
            if (label) label.textContent = toggle.id === 'toggle-2' ? 'Reveal content' : 'Show details';
          }
        }

        // Initialize (respect markup initial state)
        setOpen(toggle.getAttribute('aria-expanded') === 'true');

        // Click toggles
        toggle.addEventListener('click', () => {
          const isOpen = toggle.getAttribute('aria-expanded') === 'true';
          setOpen(!isOpen);
        });

        // Close on Escape when open
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' || e.key === 'Esc'){
            if (toggle.getAttribute('aria-expanded') === 'true'){
              setOpen(false);
              toggle.focus();
            }
          }
        });

        // If details contain links or other interactive elements, we do not trap focus.
        // Optional: keep developer control for more complex focus management.
      });
    })();
  </script>
</body>
</html>