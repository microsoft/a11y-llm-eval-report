<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Modal Dialog Example - Accessible Component</title>
  <style>
    :root {
      --color-bg: #ffffff;
      --color-text: #1a1a1a;
      --color-muted-text: #4a4a4a;
      --color-link: #0056b3;
      --color-border: #cccccc;
      --color-focus: #0056b3;
      --color-danger: #c41e3a;
      --color-success: #2d7a2d;
      --color-button-bg: #0056b3;
      --color-button-text: #ffffff;
      --color-button-hover: #003d82;
      --color-overlay: rgba(0, 0, 0, 0.6);
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      line-height: 1.6;
      color: var(--color-text);
      background-color: var(--color-bg);
      margin: 0;
      padding: 2rem;
      min-height: 100vh;
    }

    .sr-only:not(:focus):not(:active) {
      clip: rect(0 0 0 0);
      clip-path: inset(50%);
      height: 1px;
      overflow: hidden;
      position: absolute;
      white-space: nowrap;
      width: 1px;
    }

    header {
      margin-bottom: 2rem;
    }

    main {
      max-width: 800px;
    }

    h1 {
      font-size: 2rem;
      margin: 0 0 1rem 0;
      color: var(--color-text);
    }

    p {
      margin: 0 0 1rem 0;
      max-width: 65ch;
    }

    .trigger {
      background-color: var(--color-button-bg);
      color: var(--color-button-text);
      border: 2px solid var(--color-button-bg);
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      border-radius: 4px;
      transition: background-color 0.2s, border-color 0.2s;
    }

    .trigger:hover {
      background-color: var(--color-button-hover);
      border-color: var(--color-button-hover);
    }

    .trigger:focus {
      outline: 2px solid var(--color-focus);
      outline-offset: 2px;
      box-shadow: 0 0 0 4px rgba(0, 86, 179, 0.2);
    }

    @media (forced-colors: active) {
      .trigger:focus {
        outline: 2px solid ButtonBorder;
      }
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--color-overlay);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      z-index: 1000;
    }

    .modal-overlay[hidden] {
      display: none;
    }

    .modal-dialog {
      background-color: var(--color-bg);
      border: 1px solid var(--color-border);
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      max-width: 600px;
      width: 100%;
      max-height: calc(100vh - 2rem);
      overflow-y: auto;
      position: relative;
    }

    @media (forced-colors: active) {
      .modal-dialog {
        border: 2px solid ButtonBorder;
      }
    }

    .modal-header {
      padding: 1.5rem;
      border-bottom: 1px solid var(--color-border);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
    }

    .modal-title {
      margin: 0;
      font-size: 1.5rem;
      color: var(--color-text);
      flex: 1;
      min-width: 0;
    }

    .modal-close {
      background-color: transparent;
      border: 2px solid var(--color-border);
      color: var(--color-text);
      width: 2.5rem;
      height: 2.5rem;
      border-radius: 4px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: background-color 0.2s, border-color 0.2s;
    }

    .modal-close:hover {
      background-color: #f0f0f0;
      border-color: var(--color-text);
    }

    .modal-close:focus {
      outline: 2px solid var(--color-focus);
      outline-offset: 2px;
      box-shadow: 0 0 0 4px rgba(0, 86, 179, 0.2);
    }

    @media (forced-colors: active) {
      .modal-close:focus {
        outline: 2px solid ButtonBorder;
      }
    }

    .modal-close svg {
      width: 1.25rem;
      height: 1.25rem;
      fill: currentColor;
    }

    .modal-body {
      padding: 1.5rem;
    }

    .modal-body p {
      margin-bottom: 1rem;
    }

    .modal-body p:last-child {
      margin-bottom: 0;
    }

    .modal-footer {
      padding: 1.5rem;
      border-top: 1px solid var(--color-border);
      display: flex;
      gap: 1rem;
      justify-content: flex-end;
      flex-wrap: wrap;
    }

    .button {
      padding: 0.625rem 1.25rem;
      font-size: 1rem;
      font-weight: 600;
      border-radius: 4px;
      cursor: pointer;
      border: 2px solid transparent;
      transition: background-color 0.2s, border-color 0.2s;
    }

    .button-primary {
      background-color: var(--color-button-bg);
      color: var(--color-button-text);
      border-color: var(--color-button-bg);
    }

    .button-primary:hover {
      background-color: var(--color-button-hover);
      border-color: var(--color-button-hover);
    }

    .button-secondary {
      background-color: transparent;
      color: var(--color-text);
      border-color: var(--color-border);
    }

    .button-secondary:hover {
      background-color: #f0f0f0;
      border-color: var(--color-text);
    }

    .button:focus {
      outline: 2px solid var(--color-focus);
      outline-offset: 2px;
      box-shadow: 0 0 0 4px rgba(0, 86, 179, 0.2);
    }

    @media (forced-colors: active) {
      .button:focus {
        outline: 2px solid ButtonBorder;
      }
    }

    @media (max-width: 640px) {
      body {
        padding: 1rem;
      }

      .modal-dialog {
        max-width: 100%;
      }

      .modal-header,
      .modal-body,
      .modal-footer {
        padding: 1rem;
      }

      .modal-footer {
        flex-direction: column;
      }

      .button {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <a href="#maincontent" class="sr-only">Skip to main content</a>

  <header>
    <h1>Modal Dialog Component Example</h1>
  </header>

  <main id="maincontent" tabindex="-1">
    <p>This page demonstrates an accessible modal dialog component. Click the button below to open the modal.</p>
    
    <button type="button" class="trigger" id="openModal">
      Open Modal Dialog
    </button>

    <p style="margin-top: 2rem;">When the modal opens, focus moves to the close button. The Escape key closes the modal. Focus is trapped within the modal while it is open, and returns to the trigger button when closed.</p>
  </main>

  <div class="modal-overlay" id="modalOverlay" hidden>
    <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal-header">
        <h2 class="modal-title" id="modalTitle">Example Modal Dialog</h2>
        <button type="button" class="modal-close" id="closeModal" aria-label="Close dialog">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <p>This is an accessible modal dialog component. It demonstrates proper focus management, keyboard interaction, and ARIA attributes.</p>
        <p>Key accessibility features include:</p>
        <ul>
          <li>Focus moves to the close button when opened</li>
          <li>Focus is trapped within the modal</li>
          <li>Escape key closes the modal</li>
          <li>Focus returns to the trigger button when closed</li>
          <li>Background content is inert while modal is open</li>
          <li>Proper ARIA attributes (role, aria-modal, aria-labelledby)</li>
        </ul>
      </div>
      <div class="modal-footer">
        <button type="button" class="button button-secondary" id="cancelButton">Cancel</button>
        <button type="button" class="button button-primary" id="confirmButton">Confirm</button>
      </div>
    </div>
  </div>

  <script>
    (function() {
      const openModalButton = document.getElementById('openModal');
      const modalOverlay = document.getElementById('modalOverlay');
      const closeModalButton = document.getElementById('closeModal');
      const cancelButton = document.getElementById('cancelButton');
      const confirmButton = document.getElementById('confirmButton');
      const modalDialog = modalOverlay.querySelector('.modal-dialog');
      
      let previouslyFocusedElement = null;
      const focusableSelectors = 'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';

      function getFocusableElements() {
        return Array.from(modalDialog.querySelectorAll(focusableSelectors))
          .filter(el => !el.hasAttribute('disabled') && el.offsetParent !== null);
      }

      function trapFocus(event) {
        if (!modalOverlay.hasAttribute('hidden')) {
          const focusableElements = getFocusableElements();
          const firstFocusable = focusableElements[0];
          const lastFocusable = focusableElements[focusableElements.length - 1];

          if (event.key === 'Tab') {
            if (event.shiftKey) {
              if (document.activeElement === firstFocusable) {
                event.preventDefault();
                lastFocusable.focus();
              }
            } else {
              if (document.activeElement === lastFocusable) {
                event.preventDefault();
                firstFocusable.focus();
              }
            }
          }
        }
      }

      function openModal() {
        previouslyFocusedElement = document.activeElement;
        modalOverlay.removeAttribute('hidden');
        document.body.style.overflow = 'hidden';
        closeModalButton.focus();
        document.addEventListener('keydown', handleKeyDown);
      }

      function closeModal() {
        modalOverlay.setAttribute('hidden', '');
        document.body.style.overflow = '';
        document.removeEventListener('keydown', handleKeyDown);
        if (previouslyFocusedElement) {
          previouslyFocusedElement.focus();
          previouslyFocusedElement = null;
        }
      }

      function handleKeyDown(event) {
        if (event.key === 'Escape') {
          closeModal();
        }
        trapFocus(event);
      }

      function handleOverlayClick(event) {
        if (event.target === modalOverlay) {
          closeModal();
        }
      }

      openModalButton.addEventListener('click', openModal);
      closeModalButton.addEventListener('click', closeModal);
      cancelButton.addEventListener('click', closeModal);
      confirmButton.addEventListener('click', function() {
        closeModal();
      });
      modalOverlay.addEventListener('click', handleOverlayClick);
    })();
  </script>
</body>
</html>