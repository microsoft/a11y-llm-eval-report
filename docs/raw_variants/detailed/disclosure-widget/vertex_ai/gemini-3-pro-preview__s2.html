<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expand/Collapse Widget Example - Accessible Components</title>
    <style>
        /* 
         * CSS Custom Properties (Design Tokens)
         * Enforcing specific color palette for consistency and contrast.
         */
        :root {
            --color-bg: #ffffff;
            --color-text: #212529;
            --color-primary: #005a9c; /* Meets 4.5:1 against white */
            --color-primary-hover: #004475;
            --color-border: #ced4da;
            --color-bg-light: #f8f9fa;
            --color-focus: #005a9c;
            --color-focus-ring: #80bdff;
            --focus-outline-width: 3px;
        }

        /* 
         * Base Styles 
         */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: var(--color-text);
            background-color: var(--color-bg);
            margin: 0;
            padding: 0;
        }

        /* 
         * Skip Link 
         * Hidden visually until focused.
         */
        .skip-link {
            position: absolute;
            top: 0;
            left: 0;
            background: var(--color-primary);
            color: #fff;
            padding: 0.5rem 1rem;
            z-index: 100;
            text-decoration: none;
            transform: translateY(-100%);
            transition: transform 0.2s;
        }

        .skip-link:focus {
            transform: translateY(0);
            outline: var(--focus-outline-width) solid var(--color-focus-ring);
            outline-offset: 2px;
        }

        /* 
         * Layout Landmarks 
         */
        header, main, footer {
            padding: 1rem;
            max-width: 800px;
            margin: 0 auto;
        }

        header {
            border-bottom: 1px solid var(--color-border);
            margin-bottom: 2rem;
        }

        h1 {
            margin: 0;
            font-size: 2rem;
        }

        h2 {
            font-size: 1.5rem;
            margin-top: 2rem;
            color: var(--color-primary);
        }

        /* 
         * Widget Styling 
         */
        .example {
            border: 1px solid var(--color-border);
            border-radius: 4px;
            margin-bottom: 1.5rem;
            overflow: hidden; /* Ensures rounded corners */
        }

        /* 
         * Trigger Button
         * Using native <button> for keyboard accessibility.
         */
        .disclosure-btn {
            appearance: none;
            background-color: var(--color-bg-light);
            border: none;
            border-bottom: 1px solid transparent; /* Reserve space for border when open */
            color: var(--color-text);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 1.125rem;
            font-weight: 600;
            padding: 1rem;
            text-align: left;
            width: 100%;
        }

        .disclosure-btn:hover {
            background-color: #e2e6ea;
            color: var(--color-primary);
        }

        /* Focus styles: High contrast double border approach for visibility */
        .disclosure-btn:focus-visible {
            outline: var(--focus-outline-width) solid var(--color-focus);
            outline-offset: -2px; /* Pulls outline inside */
            z-index: 1; /* Ensure outline sits above content */
        }

        /* SVG Icon rotation based on state */
        .disclosure-btn svg {
            width: 1.5rem;
            height: 1.5rem;
            fill: currentColor; /* Adapts to text color automatically */
            transition: transform 0.2s ease-in-out;
        }

        .disclosure-btn[aria-expanded="true"] svg {
            transform: rotate(180deg);
        }

        .disclosure-btn[aria-expanded="true"] {
            border-bottom-color: var(--color-border);
            background-color: #e9ecef;
        }

        /* 
         * Content Panel 
         * Using [hidden] attribute for state management.
         */
        .details {
            padding: 1rem;
            background-color: var(--color-bg);
        }

        /* Ensure hidden content is truly hidden from layout and AT */
        .details[hidden] {
            display: none;
        }

        /* 
         * High Contrast / Forced Colors Mode Support 
         */
        @media (forced-colors: active) {
            .disclosure-btn:focus-visible {
                outline: 2px solid CanvasText;
                outline-offset: 2px;
            }
            
            .example {
                border: 2px solid CanvasText;
            }

            .disclosure-btn {
                border-bottom: 1px solid ButtonText;
            }
        }
    </style>
</head>
<body>

    <a href="#maincontent" class="skip-link">Skip to main content</a>

    <header>
        <h1>Accessible Expand/Collapse Widgets</h1>
    </header>

    <main id="maincontent" tabindex="-1">
        
        <p>
            The following examples demonstrate accessible disclosure widgets (often called accordions or expand/collapse sections). 
            They use semantic HTML buttons, ARIA attributes for state, and high-contrast focus indicators.
        </p>

        <!-- Example 1: Single Disclosure -->
        <section aria-labelledby="heading-1">
            <h2 id="heading-1">Frequently Asked Questions</h2>
            
            <div class="example">
                <h3>
                    <button type="button" 
                            class="disclosure-btn" 
                            aria-expanded="false" 
                            aria-controls="faq-answer-1" 
                            id="faq-btn-1">
                        <span>What is the return policy?</span>
                        <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                            <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"></path>
                        </svg>
                    </button>
                </h3>
                <div id="faq-answer-1" class="details" hidden>
                    <p>Our return policy allows you to return items within 30 days of purchase for a full refund. Items must be in their original condition and packaging.</p>
                </div>
            </div>

            <div class="example">
                <h3>
                    <button type="button" 
                            class="disclosure-btn" 
                            aria-expanded="false" 
                            aria-controls="faq-answer-2" 
                            id="faq-btn-2">
                        <span>How do I track my order?</span>
                        <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                            <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"></path>
                        </svg>
                    </button>
                </h3>
                <div id="faq-answer-2" class="details" hidden>
                    <p>Once your order has shipped, you will receive an email with a tracking number. You can use this number on our website to check the status of your delivery.</p>
                </div>
            </div>
        </section>

        <!-- Example 2: Complex Content -->
        <section aria-labelledby="heading-2">
            <h2 id="heading-2">Account Settings</h2>

            <div class="example">
                <h3>
                    <button type="button" 
                            class="disclosure-btn" 
                            aria-expanded="false" 
                            aria-controls="privacy-settings" 
                            id="privacy-btn">
                        <span>Privacy Preferences</span>
                        <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                            <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"></path>
                        </svg>
                    </button>
                </h3>
                <div id="privacy-settings" class="details" hidden>
                    <p>Manage how your data is used.</p>
                    <form action="#" method="get">
                        <div style="margin-bottom: 1rem;">
                            <input type="checkbox" id="marketing-emails" name="marketing">
                            <label for="marketing-emails">Receive marketing emails</label>
                        </div>
                        <button type="button" style="padding: 0.5rem 1rem; background: var(--color-primary); color: white; border: none; border-radius: 4px; cursor: pointer;">Save Changes</button>
                    </form>
                </div>
            </div>
        </section>

    </main>

    <footer>
        <p>&copy; 2023 Accessible Widgets Demo.</p>
    </footer>

    <script>
        /**
         * Accessible Disclosure Pattern
         * Handles toggle logic and ARIA state updates.
         */
        document.addEventListener('DOMContentLoaded', () => {
            const triggers = document.querySelectorAll('.disclosure-btn');

            triggers.forEach(trigger => {
                trigger.addEventListener('click', () => {
                    // Get the value of aria-expanded (string "true" or "false")
                    const isExpanded = trigger.getAttribute('aria-expanded') === 'true';
                    const targetId = trigger.getAttribute('aria-controls');
                    const content = document.getElementById(targetId);

                    if (!content) return;

                    // Toggle State
                    // 1. Toggle aria-expanded on the button
                    trigger.setAttribute('aria-expanded', !isExpanded);

                    // 2. Toggle the hidden attribute on the content container
                    if (isExpanded) {
                        content.hidden = true;
                    } else {
                        content.hidden = false;
                    }
                });
            });
        });
    </script>
</body>
</html>