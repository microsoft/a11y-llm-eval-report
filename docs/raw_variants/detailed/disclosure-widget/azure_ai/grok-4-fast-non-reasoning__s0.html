<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root {
      --color-bg: #ffffff;
      --color-text: #1a1a1a;
      --color-muted-text: #6b7280;
      --color-border: #d1d5db;
      --color-focus: #3b82f6;
      --color-heading: #111827;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: var(--color-text);
      background-color: var(--color-bg);
      margin: 0;
      padding: 2rem;
      max-width: 800px;
      margin: 0 auto;
    }

    .sr-only:not(:focus):not(:active) {
      clip: rect(0 0 0 0);
      clip-path: inset(50%);
      height: 1px;
      overflow: hidden;
      position: absolute;
      white-space: nowrap;
      width: 1px;
    }

    header {
      text-align: center;
      margin-bottom: 3rem;
      border-bottom: 1px solid var(--color-border);
      padding-bottom: 1rem;
    }

    main {
      margin-bottom: 3rem;
    }

    h1 {
      color: var(--color-heading);
      margin: 0 0 0.5rem 0;
      font-size: 2rem;
    }

    .subtitle {
      color: var(--color-muted-text);
      margin: 0;
      font-size: 1rem;
    }

    .example {
      margin-bottom: 3rem;
      border: 1px solid var(--color-border);
      border-radius: 0.5rem;
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .example-header {
      background-color: #f9fafb;
      padding: 1.5rem;
      border-bottom: 1px solid var(--color-border);
    }

    .example-title {
      margin: 0 0 0.5rem 0;
      color: var(--color-heading);
      font-size: 1.25rem;
      font-weight: 600;
    }

    .example-description {
      margin: 0;
      color: var(--color-muted-text);
      font-size: 0.875rem;
    }

    .expandable {
      margin: 0;
    }

    .expandable + .expandable {
      margin-top: 1rem;
    }

    .expandable-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem 1.5rem;
      background-color: #f9fafb;
      border: 1px solid var(--color-border);
      border-radius: 0.375rem;
      cursor: pointer;
      transition: background-color 0.2s ease;
      width: 100%;
      text-align: left;
      font-size: 1rem;
      line-height: 1.5;
      color: var(--color-text);
    }

    .expandable-header:hover {
      background-color: #f3f4f6;
    }

    .expandable-header:focus {
      outline: 2px solid var(--color-focus);
      outline-offset: -2px;
      background-color: #f3f4f6;
    }

    .expandable-header[aria-expanded="true"] {
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
    }

    .expandable-icon {
      width: 1rem;
      height: 1rem;
      transition: transform 0.2s ease;
      flex-shrink: 0;
      display: inline-block;
      vertical-align: middle;
    }

    .expandable-header[aria-expanded="true"] .expandable-icon {
      transform: rotate(180deg);
    }

    .details {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease, padding 0.3s ease;
      background-color: var(--color-bg);
      border: 1px solid var(--color-border);
      border-top: none;
      border-radius: 0 0 0.375rem 0.375rem;
    }

    .expandable-header[aria-expanded="true"] + .details {
      max-height: 500px; /* Adjust based on content */
      padding: 1rem 1.5rem;
    }

    .details p {
      margin: 0 0 1rem 0;
    }

    .details ul {
      margin: 0 0 1rem 1.5rem;
      padding: 0;
    }

    .details li {
      margin-bottom: 0.25rem;
    }

    @media (forced-colors: active) {
      .expandable-header {
        border-color: ButtonBorder;
        background-color: ButtonFace;
        color: ButtonText;
      }

      .expandable-header:hover,
      .expandable-header:focus {
        background-color: Highlight;
        color: HighlightText;
      }

      .details {
        border-color: ButtonBorder;
        background-color: Canvas;
        color: CanvasText;
      }

      .expandable-icon {
        fill: currentColor;
        stroke: currentColor;
      }
    }

    @media (max-width: 320px) {
      body {
        padding: 1rem;
      }

      .example-header {
        padding: 1rem;
      }

      .expandable-header {
        padding: 0.75rem 1rem;
        font-size: 0.875rem;
      }

      .details {
        padding: 0.75rem 1rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <a href="#maincontent" class="sr-only">Skip to main content</a>
    <h1>Expand/Collapse Widget Examples</h1>
    <p class="subtitle">Accessible accordion-style expand/collapse components</p>
  </header>

  <main id="maincontent" tabindex="-1">
    <div class="example">
      <div class="example-header">
        <h2 class="example-title">Basic Expand/Collapse</h2>
        <p class="example-description">A simple expandable section with smooth transitions and keyboard support.</p>
      </div>
      <section class="expandable" aria-labelledby="basic-heading">
        <button 
          id="basic-heading"
          class="expandable-header" 
          aria-expanded="false"
          aria-controls="basic-content"
          type="button"
        >
          <span>What is an expandable widget?</span>
          <svg class="expandable-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6,9 12,15 18,9"></polyline>
          </svg>
        </button>
        <div id="basic-content" class="details">
          <p>An expandable widget, also known as an accordion or disclosure widget, allows users to show and hide sections of content. This helps organize information hierarchically and reduces cognitive load by showing only relevant details at a time.</p>
          <p>Key accessibility features include:</p>
          <ul>
            <li>Proper heading association with <code>aria-labelledby</code></li>
            <li>State indication with <code>aria-expanded</code></li>
            <li>Control relationship with <code>aria-controls</code></li>
            <li>Keyboard navigation support (Enter/Space to toggle, Escape to close)</li>
            <li>Visible focus indicators</li>
          </ul>
        </div>
      </section>
    </div>

    <div class="example">
      <div class="example-header">
        <h2 class="example-title">Multiple Expandable Sections</h2>
        <p class="example-description">Several expandable sections where only one can be open at a time (accordion behavior).</p>
      </div>
      <section class="expandable" aria-labelledby="features-heading">
        <button 
          id="features-heading"
          class="expandable-header" 
          aria-expanded="false"
          aria-controls="features-content"
          type="button"
        >
          <span>Features</span>
          <svg class="expandable-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6,9 12,15 18,9"></polyline>
          </svg>
        </button>
        <div id="features-content" class="details">
          <p>Our accessibility-focused expandable widgets include:</p>
          <ul>
            <li>Keyboard navigation with Enter, Space, and Escape keys</li>
            <li>Screen reader announcements for state changes</li>
            <li>Smooth transitions that don't interfere with assistive technology</li>
            <li>Proper focus management</li>
            <li>Support for high contrast mode</li>
            <li>Responsive design that works at all viewport sizes</li>
          </ul>
        </div>
      </section>

      <section class="expandable" aria-labelledby="accessibility-heading">
        <button 
          id="accessibility-heading"
          class="expandable-header" 
          aria-expanded="true"
          aria-controls="accessibility-content"
          type="button"
        >
          <span>Accessibility Benefits</span>
          <svg class="expandable-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6,9 12,15 18,9"></polyline>
          </svg>
        </button>
        <div id="accessibility-content" class="details">
          <p>These widgets improve the experience for:</p>
          <ul>
            <li><strong>Screen reader users:</strong> Clear announcements of expanded/collapsed state</li>
            <li><strong>Keyboard users:</strong> Full navigation support without mouse dependency</li>
            <li><strong>Low vision users:</strong> High contrast focus indicators and sufficient text contrast</li>
            <li><strong>Cognitive load:</strong> Progressive disclosure reduces information overload</li>
            <li><strong>Mobile users:</strong> Touch-friendly controls with adequate touch targets</li>
          </ul>
        </div>
      </section>

      <section class="expandable" aria-labelledby="usage-heading">
        <button 
          id="usage-heading"
          class="expandable-header" 
          aria-expanded="false"
          aria-controls="usage-content"
          type="button"
        >
          <span>Best Practices</span>
          <svg class="expandable-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6,9 12,15 18,9"></polyline>
          </svg>
        </button>
        <div id="usage-content" class="details">
          <p>When implementing expandable widgets:</p>
          <ul>
            <li>Always provide a visible label for the control</li>
            <li>Use semantic HTML where possible</li>
            <li>Ensure content is accessible when expanded</li>
            <li>Provide clear visual feedback for state changes</li>
            <li>Test with real assistive technology</li>
            <li>Consider the default state based on user needs</li>
          </ul>
        </div>
      </section>
    </div>

    <div class="example">
      <div class="example-header">
        <h2 class="example-title">FAQ Style</h2>
        <p class="example-description">Question-answer format commonly used for frequently asked questions.</p>
      </div>
      
      <section class="expandable" aria-labelledby="faq1-heading">
        <button 
          id="faq1-heading"
          class="expandable-header" 
          aria-expanded="false"
          aria-controls="faq1-content"
          type="button"
        >
          <span>Why is accessibility important for expandable widgets?</span>
          <svg class="expandable-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6,9 12,15 18,9"></polyline>
          </svg>
        </button>
        <div id="faq1-content" class="details">
          <p>Accessibility ensures that all users, regardless of their abilities or the technology they use, can interact with and understand the content. Expandable widgets are particularly important for accessibility because they control how information is revealed to users, and poor implementation can hide critical content from assistive technologies or keyboard navigation.</p>
        </div>
      </section>

      <section class="expandable" aria-labelledby="faq2-heading">
        <button 
          id="faq2-heading"
          class="expandable-header" 
          aria-expanded="false"
          aria-controls="faq2-content"
          type="button"
        >
          <span>How do I test my expandable widgets?</span>
          <svg class="expandable-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6,9 12,15 18,9"></polyline>
          </svg>
        </button>
        <div id="faq2-content" class="details">
          <p>Test with:</p>
          <ul>
            <li>Screen readers (NVDA, JAWS, VoiceOver, TalkBack)</li>
            <li>Keyboard-only navigation</li>
            <li>High contrast mode</li>
            <li>Reduced motion preferences</li>
            <li>Different screen sizes and zoom levels</li>
            <li>Automated accessibility testing tools</li>
          </ul>
          <p>Manual testing with actual assistive technology is essential for comprehensive coverage.</p>
        </div>
      </section>

      <section class="expandable" aria-labelledby="faq3-heading">
        <button 
          id="faq3-heading"
          class="expandable-header" 
          aria-expanded="false"
          aria-controls="faq3-content"
          type="button"
        >
          <span>What are the WCAG requirements?</span>
          <svg class="expandable-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6,9 12,15 18,9"></polyline>
          </svg>
        </button>
        <div id="faq3-content" class="details">
          <p>Relevant WCAG 2.2 success criteria include:</p>
          <ul>
            <li><strong>1.4.10 Reflow:</strong> Content must work at 320px without loss of content or functionality</li>
            <li><strong>1.4.13 Content on Hover/Focus:</strong> Expanded content must remain accessible</li>
            <li><strong>2.1.1 Keyboard:</strong> All functionality must be keyboard accessible</li>
            <li><strong>2.4.7 Focus Visible:</strong> Keyboard focus must be clearly visible</li>
            <li><strong>4.1.2 Name, Role, Value:</strong> Proper ARIA attributes for state and relationships</li>
          </ul>
        </div>
      </section>
    </div>
  </main>

  <script>
    // Get all expandable buttons
    const expandableButtons = document.querySelectorAll('.expandable-header');

    expandableButtons.forEach(button => {
      button.addEventListener('click', toggleExpandable);
      button.addEventListener('keydown', handleKeydown);
    });

    function toggleExpandable(event) {
      const button = event.currentTarget;
      const isExpanded = button.getAttribute('aria-expanded') === 'true';
      const contentId = button.getAttribute('aria-controls');
      const content = document.getElementById(contentId);

      if (!content) return;

      // Toggle state
      button.setAttribute('aria-expanded', !isExpanded);
      content.classList.toggle('expanded', !isExpanded);

      // For accordion behavior in the multiple sections example
      if (button.closest('.example').querySelectorAll('.expandable').length > 1) {
        const siblingButtons = button.closest('.example').querySelectorAll('.expandable-header');
        siblingButtons.forEach(sibling => {
          if (sibling !== button && sibling.getAttribute('aria-expanded') === 'true') {
            const siblingContentId = sibling.getAttribute('aria-controls');
            const siblingContent = document.getElementById(siblingContentId);
            sibling.setAttribute('aria-expanded', 'false');
            if (siblingContent) {
              siblingContent.classList.remove('expanded');
            }
          }
        });
      }

      // Focus management
      if (!isExpanded) {
        // When expanding, focus stays on button
        button.focus();
      }
    }

    function handleKeydown(event) {
      const button = event.currentTarget;
      
      switch (event.key) {
        case 'Enter':
        case ' ':
          event.preventDefault();
          toggleExpandable(event);
          break;
        case 'Escape':
          if (button.getAttribute('aria-expanded') === 'true') {
            event.preventDefault();
            button.setAttribute('aria-expanded', 'false');
            const contentId = button.getAttribute('aria-controls');
            const content = document.getElementById(contentId);
            if (content) {
              content.classList.remove('expanded');
            }
            button.focus();
          }
          break;
        default:
          break;
      }
    }

    // Set initial state for any pre-expanded sections
    document.addEventListener('DOMContentLoaded', () => {
      expandableButtons.forEach(button => {
        const isExpanded = button.getAttribute('aria-expanded') === 'true';
        const contentId = button.getAttribute('aria-controls');
        const content = document.getElementById(contentId);
        
        if (content) {
          if (isExpanded) {
            content.classList.add('expanded');
          }
        }
      });
    });

    // Handle reduced motion preference
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      document.documentElement.style.setProperty('--transition-duration', '0s');
    }
  </script>
</body>
</html>