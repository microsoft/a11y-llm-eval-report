<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root {
      --color-bg: #ffffff;
      --color-text: #1a1a1a;
      --color-muted-text: #6b7280;
      --color-border: #d1d5db;
      --color-focus: #3b82f6;
      --color-heading: #111827;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: var(--color-text);
      background-color: var(--color-bg);
      margin: 0;
      padding: 2rem;
      max-width: 800px;
      margin: 0 auto;
    }

    h1 {
      color: var(--color-heading);
      margin-bottom: 2rem;
    }

    .example {
      margin-bottom: 3rem;
      border: 1px solid var(--color-border);
      border-radius: 8px;
      overflow: hidden;
    }

    .example h2 {
      background-color: #f9fafb;
      color: var(--color-heading);
      margin: 0;
      padding: 1rem 1.5rem;
      font-size: 1.25rem;
      border-bottom: 1px solid var(--color-border);
    }

    .expandable {
      position: relative;
    }

    .expandable-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem 1.5rem;
      background-color: #f9fafb;
      border-bottom: 1px solid var(--color-border);
      cursor: pointer;
      font-weight: 600;
      color: var(--color-text);
      outline: none;
      transition: background-color 0.2s ease;
    }

    .expandable-header:hover {
      background-color: #f3f4f6;
    }

    .expandable-header:focus {
      background-color: #f3f4f6;
      outline: 2px solid var(--color-focus);
      outline-offset: -2px;
    }

    .expandable-header[aria-expanded="true"] .icon {
      transform: rotate(180deg);
    }

    .icon {
      width: 20px;
      height: 20px;
      fill: currentColor;
      transition: transform 0.2s ease;
      color: var(--color-muted-text);
    }

    .details {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease, padding 0.3s ease;
      background-color: var(--color-bg);
    }

    .details[aria-hidden="false"] {
      max-height: 500px; /* Adjust based on content */
      padding: 1rem 1.5rem;
    }

    .details[aria-hidden="false"] + .expandable-header {
      border-bottom: none;
    }

    .content {
      margin: 0;
      color: var(--color-text);
    }

    .content p {
      margin: 0 0 1rem 0;
    }

    .content ul {
      margin: 0 0 1rem 1.5rem;
      padding: 0;
    }

    .content li {
      margin-bottom: 0.5rem;
    }

    /* Skip link styles */
    .sr-only:not(:focus):not(:active) {
      clip: rect(0 0 0 0);
      clip-path: inset(50%);
      height: 1px;
      overflow: hidden;
      position: absolute;
      white-space: nowrap;
      width: 1px;
    }

    /* High contrast support */
    @media (forced-colors: active) {
      .expandable-header {
        border: 1px solid ButtonBorder;
        background-color: ButtonFace;
        color: ButtonText;
      }
      
      .expandable-header:focus {
        border-color: ButtonText;
        background-color: Highlight;
        color: HighlightText;
      }
      
      .icon {
        fill: ButtonText;
      }
      
      .details[aria-hidden="false"] {
        background-color: Canvas;
        color: CanvasText;
        border: 1px solid CanvasText;
      }
    }

    /* Focus visible for high contrast */
    @media (prefers-reduced-motion: no-preference) {
      .expandable-header:focus {
        outline: 2px solid transparent;
        box-shadow: 0 0 0 3px var(--color-focus);
      }
    }
  </style>
</head>
<body>
  <a href="#maincontent" class="sr-only">Skip to main content</a>
  
  <header>
    <h1>Expand/Collapse Widget Examples</h1>
  </header>

  <main id="maincontent" tabindex="-1">
    <div class="example">
      <h2>Basic FAQ Entry</h2>
      <div class="expandable" role="region" aria-labelledby="faq1-heading">
        <button 
          id="faq1-heading"
          class="expandable-header"
          aria-expanded="false"
          aria-controls="faq1-content"
          type="button"
        >
          <span>What is responsive design?</span>
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M7 10l5 5 5-5z"/>
          </svg>
        </button>
        <div 
          id="faq1-content"
          class="details"
          role="region"
          aria-labelledby="faq1-heading"
          tabindex="-1"
          aria-hidden="true"
        >
          <div class="content">
            <p>Responsive design is an approach to web design that makes your web content adapt to different screen sizes and devices. It ensures that users have a good experience whether they're viewing your site on a desktop, tablet, or mobile phone.</p>
            <p>Key principles include using flexible grids, flexible images, and media queries to create layouts that work across various devices.</p>
          </div>
        </div>
      </div>
    </div>

    <div class="example">
      <h2>Settings Panel</h2>
      <div class="expandable" role="region" aria-labelledby="settings-heading">
        <button 
          id="settings-heading"
          class="expandable-header"
          aria-expanded="false"
          aria-controls="settings-content"
          type="button"
        >
          <span>Notification Preferences</span>
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M7 10l5 5 5-5z"/>
          </svg>
        </button>
        <div 
          id="settings-content"
          class="details"
          role="region"
          aria-labelledby="settings-heading"
          tabindex="-1"
          aria-hidden="true"
        >
          <div class="content">
            <p>Manage your notification settings below:</p>
            <ul>
              <li><label><input type="checkbox" checked> Email notifications</label></li>
              <li><label><input type="checkbox"> Push notifications</label></li>
              <li><label><input type="checkbox"> SMS alerts</label></li>
            </ul>
            <p>These settings will apply to all your subscribed services.</p>
          </div>
        </div>
      </div>
    </div>

    <div class="example">
      <h2>Product Features</h2>
      <div class="expandable" role="region" aria-labelledby="features-heading">
        <button 
          id="features-heading"
          class="expandable-header"
          aria-expanded="true"
          aria-controls="features-content"
          type="button"
        >
          <span>Key Features</span>
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M7 10l5 5 5-5z"/>
          </svg>
        </button>
        <div 
          id="features-content"
          class="details"
          role="region"
          aria-labelledby="features-heading"
          tabindex="-1"
          aria-hidden="false"
        >
          <div class="content">
            <p>Our product includes the following features:</p>
            <ul>
              <li>Real-time collaboration with team members</li>
              <li>Advanced analytics and reporting</li>
              <li>Customizable workflows and automation</li>
              <li>Secure cloud storage with encryption</li>
              <li>Mobile and desktop applications</li>
            </ul>
            <p>Each feature is designed to improve your productivity and streamline your workflow.</p>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Get all expandable buttons
    const expandableButtons = document.querySelectorAll('.expandable-header');

    expandableButtons.forEach(button => {
      button.addEventListener('click', function(event) {
        event.preventDefault();
        
        const isExpanded = this.getAttribute('aria-expanded') === 'true';
        const contentId = this.getAttribute('aria-controls');
        const content = document.getElementById(contentId);
        
        // Toggle expanded state
        this.setAttribute('aria-expanded', !isExpanded);
        content.setAttribute('aria-hidden', isExpanded);
        
        // Focus management: move focus to content when expanded
        if (!isExpanded) {
          // Small delay to allow the content to render
          setTimeout(() => {
            content.focus();
          }, 100);
        }
        
        // Handle escape key to close
        function handleEscape(event) {
          if (event.key === 'Escape' && !isExpanded) {
            this.setAttribute('aria-expanded', 'false');
            content.setAttribute('aria-hidden', 'true');
            this.focus();
          }
        }
        
        // Add escape key listener when expanded
        if (!isExpanded) {
          document.addEventListener('keydown', handleEscape.bind(this));
          
          // Remove listener when closed
          const removeEscapeListener = () => {
            document.removeEventListener('keydown', handleEscape.bind(this));
            document.removeEventListener('click', removeEscapeListener);
          };
          
          // Also close when clicking outside
          document.addEventListener('click', removeEscapeListener);
        }
      });
      
      // Prevent default on space key to avoid scrolling
      button.addEventListener('keydown', function(event) {
        if (event.key === ' ') {
          event.preventDefault();
        }
      });
    });

    // Close all expandables when escape is pressed globally (if any are open)
    document.addEventListener('keydown', function(event) {
      if (event.key === 'Escape') {
        expandableButtons.forEach(button => {
          if (button.getAttribute('aria-expanded') === 'true') {
            const contentId = button.getAttribute('aria-controls');
            const content = document.getElementById(contentId);
            
            button.setAttribute('aria-expanded', 'false');
            content.setAttribute('aria-hidden', 'true');
            button.focus();
          }
        });
      }
    });
  </script>
</body>
</html>