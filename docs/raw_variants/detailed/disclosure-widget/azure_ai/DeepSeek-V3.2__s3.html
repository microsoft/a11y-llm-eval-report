<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expand/Collapse Widget - Examples - Accessibility Demo</title>
    <style>
        :root {
            /* Define a small token palette for accessibility */
            --color-bg: #ffffff;
            --color-text: #1a1a1a;
            --color-muted-text: #4a4a4a;
            --color-link: #0056b3;
            --color-border: #cccccc;
            --color-focus: #0056b3;
            --color-danger: #dc3545;
            --color-success: #28a745;
            --color-accent: #6c63ff;
            --color-accent-hover: #5752d4;
            --spacing-unit: 0.5rem;
        }
        * {
            box-sizing: border-box;
        }
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.5;
            margin: 0;
            padding: 0;
            background-color: var(--color-bg);
            color: var(--color-text);
            min-width: 320px;
            overflow-x: hidden;
        }
        /* Skip link */
        .skip-link {
            position: absolute;
            top: -3rem;
            left: 0.5rem;
            padding: 0.75rem;
            background-color: var(--color-accent);
            color: white;
            text-decoration: none;
            font-weight: bold;
            border-radius: 0.25rem;
            z-index: 1000;
        }
        .skip-link:focus {
            top: 0.5rem;
            outline: 3px solid var(--color-focus);
            outline-offset: 2px;
        }
        /* High Contrast support for focus outline */
        @media (forced-colors: active) {
            .skip-link:focus {
                outline: 2px solid ButtonBorder;
                outline-offset: 1px;
            }
        }
        header, nav, main, footer {
            padding: 1rem;
            max-width: 80rem;
            margin: 0 auto;
        }
        header {
            border-bottom: 1px solid var(--color-border);
        }
        nav ul {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            list-style: none;
            padding: 0;
            margin: 0;
        }
        nav a {
            color: var(--color-link);
            text-decoration: none;
            padding: 0.25rem;
        }
        nav a:hover,
        nav a:focus {
            text-decoration: underline;
            outline: none;
        }
        main {
            min-height: 60vh;
        }
        footer {
            border-top: 1px solid var(--color-border);
            color: var(--color-muted-text);
            font-size: 0.9rem;
        }
        h1, h2, h3, h4 {
            line-height: 1.2;
            margin-top: 1.5em;
            margin-bottom: 0.5em;
        }
        h1 {
            font-size: 2.5rem;
            margin-top: 1rem;
        }
        @media (max-width: 600px) {
            h1 {
                font-size: 2rem;
            }
        }
        h2 {
            font-size: 1.75rem;
        }
        h3 {
            font-size: 1.25rem;
        }
        p, li {
            color: var(--color-text);
            max-width: 80ch;
        }
        a {
            color: var(--color-link);
        }
        .example {
            border: 1px solid var(--color-border);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 2rem 0;
            background-color: #f9f9f9;
        }
        .details {
            margin-top: 1rem;
            padding: 1rem;
            border: 1px solid var(--color-border);
            border-radius: 0.25rem;
            background-color: var(--color-bg);
            max-width: 100%;
            overflow-wrap: anywhere;
        }
        .details[hidden] {
            display: none;
        }
        /* Button styles */
        button {
            font: inherit;
            background-color: var(--color-accent);
            color: white;
            border: 2px solid transparent;
            border-radius: 0.375rem;
            padding: 0.625rem 1.25rem;
            cursor: pointer;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: background-color 0.2s ease;
            min-height: 44px;
            min-width: 44px;
        }
        button:hover {
            background-color: var(--color-accent-hover);
        }
        button:focus {
            outline: 3px solid var(--color-focus);
            outline-offset: 2px;
        }
        button:active {
            transform: translateY(1px);
        }
        /* High Contrast support for button */
        @media (forced-colors: active) {
            button {
                border: 2px solid ButtonBorder;
            }
            button:focus {
                outline: 2px solid ButtonBorder;
                outline-offset: 1px;
            }
        }
        button[aria-expanded="true"] .icon {
            transform: rotate(180deg);
        }
        .icon {
            width: 1.25em;
            height: 1.25em;
            fill: currentColor;
            stroke: currentColor;
            transition: transform 0.3s ease;
            flex-shrink: 0;
        }
        .warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-left: 4px solid #f39c12;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0.25rem;
            color: #856404;
        }
        /* Ensure reflow works at 320px */
        @media (max-width: 320px) {
            .example, .details, button {
                width: 100%;
            }
            nav ul {
                flex-direction: column;
                gap: 0.5rem;
            }
            button {
                justify-content: space-between;
            }
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <header>
        <h1>Accessibility Demo: Expand/Collapse Widgets</h1>
    </header>
    <nav aria-label="Primary">
        <ul>
            <li><a href="#example1">Example 1</a></li>
            <li><a href="#example2">Example 2</a></li>
            <li><a href="#example3">Example 3</a></li>
        </ul>
    </nav>
    <main id="main-content" tabindex="-1">
        <p>This page demonstrates accessible expand/collapse widgets. Each uses a button to toggle the visibility of associated content.</p>

        <div class="example" id="example1">
            <h2>Example 1: Product Details</h2>
            <button type="button" aria-expanded="false" aria-controls="product-details-1">
                <span>Show product care instructions</span>
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
                </svg>
            </button>
            <div id="product-details-1" class="details" hidden>
                <h3>Care Instructions for Organic Cotton T-Shirt</h3>
                <p>To ensure the longevity of your garment, please follow these guidelines:</p>
                <ul>
                    <li>Machine wash cold with similar colors.</li>
                    <li>Use a mild, eco-friendly detergent.</li>
                    <li>Tumble dry low or lay flat to dry.</li>
                    <li>Do not bleach. Do not iron directly on print.</li>
                </ul>
                <p>Following these steps will help maintain the fabric's quality and color.</p>
            </div>
        </div>

        <div class="example" id="example2">
            <h2>Example 2: FAQ Item</h2>
            <button type="button" aria-expanded="false" aria-controls="faq-answer-2">
                <span>What is your return policy?</span>
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
                </svg>
            </button>
            <div id="faq-answer-2" class="details" hidden>
                <p>We offer a 30-day return policy for all unused items in their original packaging. Returns are free if initiated within 14 days of delivery. Please contact our customer service team to start a return. Refunds are processed within 5-10 business days after we receive the item.</p>
                <p>For more details, visit our <a href="/returns">Returns & Exchanges page</a>.</p>
            </div>
        </div>

        <div class="example" id="example3">
            <h2>Example 3: Configuration Options</h2>
            <button type="button" aria-expanded="true" aria-controls="advanced-settings-3">
                <span>Hide advanced settings</span>
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
                </svg>
            </button>
            <div id="advanced-settings-3" class="details">
                <h3>Advanced Privacy Settings</h3>
                <form>
                    <fieldset>
                        <legend>Data Collection Preferences</legend>
                        <div>
                            <input type="checkbox" id="analytics" name="analytics">
                            <label for="analytics">Allow anonymous usage analytics</label>
                        </div>
                        <div>
                            <input type="checkbox" id="personalization" name="personalization" checked>
                            <label for="personalization">Enable personalized recommendations</label>
                        </div>
                    </fieldset>
                    <div>
                        <label for="data-retention">Data retention period:</label>
                        <select id="data-retention" name="data-retention">
                            <option value="30">30 days</option>
                            <option value="90" selected>90 days</option>
                            <option value="365">1 year</option>
                        </select>
                    </div>
                    <button type="button">Save Preferences</button>
                </form>
            </div>
        </div>

        <div class="warning">
            <h3>Accessibility Note</h3>
            <p>These widgets are implemented with native HTML buttons and proper ARIA attributes (<code>aria-expanded</code>, <code>aria-controls</code>). The content is toggled using the <code>hidden</code> attribute. Keyboard users can operate them with <kbd>Enter</kbd> or <kbd>Space</kbd>. Focus is clearly visible, and the interface adapts to high contrast and narrow viewports.</p>
        </div>
    </main>
    <footer>
        <p>Â© 2023 Accessibility Demo. This page is for demonstration purposes.</p>
        <p>Contrast ratios and keyboard operability have been verified for WCAG 2.2 AA conformance.</p>
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const toggleButtons = document.querySelectorAll('button[aria-controls][aria-expanded]');

            toggleButtons.forEach(button => {
                const targetId = button.getAttribute('aria-controls');
                const target = document.getElementById(targetId);

                if (!target) return;

                // Initialize state based on 'hidden' attribute
                button.setAttribute('aria-expanded', !target.hidden);

                button.addEventListener('click', () => {
                    const isExpanded = button.getAttribute('aria-expanded') === 'true';
                    const newState = !isExpanded;

                    // Update ARIA attribute
                    button.setAttribute('aria-expanded', newState);
                    // Toggle hidden attribute on content
                    target.hidden = !newState;

                    // Update button text (optional, for demo clarity)
                    const span = button.querySelector('span');
                    if (span) {
                        // Simple text swap based on example content
                        if (button.closest('#example3')) {
                            span.textContent = newState ? 'Hide advanced settings' : 'Show advanced settings';
                        } else if (button.closest('#example1')) {
                            span.textContent = newState ? 'Hide product care instructions' : 'Show product care instructions';
                        } else if (button.closest('#example2')) {
                            span.textContent = newState ? 'Hide return policy answer' : 'What is your return policy?';
                        }
                    }
                });

                // Optional: Close on Escape key (good for complex widgets)
                target.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && !target.hidden) {
                        button.setAttribute('aria-expanded', 'false');
                        target.hidden = true;
                        button.focus();
                        const span = button.querySelector('span');
                        if (span && button.closest('#example3')) {
                            span.textContent = 'Show advanced settings';
                        }
                    }
                });
            });
        });
    </script>
</body>
</html>