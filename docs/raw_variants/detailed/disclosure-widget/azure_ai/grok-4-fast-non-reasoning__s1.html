<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Expand/Collapse Widget Examples</title>
  <style>
    :root {
      --color-bg: #ffffff;
      --color-text: #1a1a1a;
      --color-muted-text: #6b7280;
      --color-border: #d1d5db;
      --color-focus: #3b82f6;
      --color-heading: #111827;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: var(--color-text);
      background-color: var(--color-bg);
      margin: 0;
      padding: 2rem;
      max-width: 800px;
      margin: 0 auto;
    }

    .sr-only:not(:focus):not(:active) {
      clip: rect(0 0 0 0);
      clip-path: inset(50%);
      height: 1px;
      overflow: hidden;
      position: absolute;
      white-space: nowrap;
      width: 1px;
    }

    header {
      margin-bottom: 2rem;
    }

    h1 {
      color: var(--color-heading);
      margin: 0 0 1rem 0;
      font-size: 2rem;
    }

    main {
      margin-top: 2rem;
    }

    .example {
      margin-bottom: 3rem;
      border: 1px solid var(--color-border);
      border-radius: 8px;
      overflow: hidden;
    }

    .example h2 {
      background-color: #f9fafb;
      color: var(--color-heading);
      margin: 0;
      padding: 1rem 1.5rem;
      border-bottom: 1px solid var(--color-border);
      font-size: 1.25rem;
    }

    .expandable {
      border: none;
      background: none;
      width: 100%;
      padding: 1rem 1.5rem;
      text-align: left;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 500;
      color: var(--color-text);
      display: flex;
      align-items: center;
      justify-content: space-between;
      transition: background-color 0.2s ease;
    }

    .expandable:hover {
      background-color: #f3f4f6;
    }

    .expandable:focus {
      outline: 2px solid var(--color-focus);
      outline-offset: -2px;
      background-color: #f3f4f6;
    }

    .expandable[aria-expanded="true"] .icon {
      transform: rotate(180deg);
    }

    .icon {
      transition: transform 0.2s ease;
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      color: var(--color-text);
    }

    .details {
      padding: 0;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease, padding 0.3s ease;
      background-color: #ffffff;
    }

    .details[aria-hidden="false"] {
      max-height: 500px; /* Adjust based on content */
      padding: 1.5rem;
    }

    .details p {
      margin: 0 0 1rem 0;
      color: var(--color-text);
    }

    .details ul {
      margin: 0 0 1rem 1.5rem;
      padding: 0;
      color: var(--color-text);
    }

    .details li {
      margin-bottom: 0.5rem;
    }

    .example-content {
      color: var(--color-muted-text);
      font-style: italic;
    }

    @media (forced-colors: active) {
      .expandable {
        border: 1px solid ButtonBorder;
        background-color: ButtonFace;
        color: ButtonText;
      }

      .expandable:hover,
      .expandable:focus {
        background-color: Highlight;
        color: HighlightText;
      }

      .details {
        background-color: Canvas;
        color: CanvasText;
      }

      .icon {
        fill: CanvasText;
      }
    }

    /* Ensure reflow at 320px */
    @media (max-width: 320px) {
      body {
        padding: 1rem;
      }

      .example h2 {
        padding: 0.75rem 1rem;
        font-size: 1.1rem;
      }

      .expandable {
        padding: 0.75rem 1rem;
      }

      .details[aria-hidden="false"] {
        padding: 1rem;
      }
    }
  </style>
</head>
<body>
  <a href="#maincontent" class="sr-only">Skip to main content</a>
  
  <header>
    <h1>Expand/Collapse Widget Examples</h1>
    <p>These examples demonstrate accessible expand/collapse patterns using native HTML elements and ARIA attributes.</p>
  </header>

  <main id="maincontent" tabindex="-1">
    <div class="example">
      <h2>FAQ: What is responsive design?</h2>
      <button 
        class="expandable" 
        id="faq1" 
        aria-expanded="false" 
        aria-controls="faq1-content"
        type="button"
        aria-labelledby="faq1"
      >
        <span>What is responsive design?</span>
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M6 9l6 6 6-6"/>
        </svg>
      </button>
      <div 
        id="faq1-content" 
        class="details" 
        role="region" 
        aria-labelledby="faq1"
        aria-hidden="true"
        tabindex="-1"
      >
        <p>Responsive design is an approach to web design that makes your web content adapt to different screen sizes and devices. It uses flexible layouts, images, and CSS media queries to ensure that the website looks good and functions well across all devices.</p>
        <p>The goal is to provide an optimal viewing experience—easy reading and navigation with a minimum of resizing, panning, and scrolling—across a wide range of devices from desktop computers to mobile phones.</p>
      </div>
    </div>

    <div class="example">
      <h2>Product Features</h2>
      <button 
        class="expandable" 
        id="features" 
        aria-expanded="false" 
        aria-controls="features-content"
        type="button"
        aria-labelledby="features"
      >
        <span>View all features</span>
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M6 9l6 6 6-6"/>
        </svg>
      </button>
      <div 
        id="features-content" 
        class="details" 
        role="region" 
        aria-labelledby="features"
        aria-hidden="true"
        tabindex="-1"
      >
        <ul>
          <li><strong>Cross-platform compatibility:</strong> Works seamlessly on desktop, tablet, and mobile devices.</li>
          <li><strong>Real-time collaboration:</strong> Multiple users can work together simultaneously.</li>
          <li><strong>Advanced security:</strong> End-to-end encryption and secure data storage.</li>
          <li><strong>Custom integrations:</strong> Connect with your favorite tools and services.</li>
          <li><strong>Analytics dashboard:</strong> Track performance and gain insights with detailed reports.</li>
        </ul>
        <p class="example-content">This pattern is ideal for feature lists, product specifications, or any content that users might want to expand for more details.</p>
      </div>
    </div>

    <div class="example">
      <h2>Accessibility Guidelines</h2>
      <button 
        class="expandable" 
        id="guidelines" 
        aria-expanded="false" 
        aria-controls="guidelines-content"
        type="button"
        aria-labelledby="guidelines"
      >
        <span>Key accessibility principles</span>
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M6 9l6 6 6-6"/>
        </svg>
      </button>
      <div 
        id="guidelines-content" 
        class="details" 
        role="region" 
        aria-labelledby="guidelines"
        aria-hidden="true"
        tabindex="-1"
      >
        <p>Follow these core principles to create accessible web experiences:</p>
        <ul>
          <li><strong>Perceivable:</strong> Information and UI components must be presentable to users in ways they can perceive.</li>
          <li><strong>Operable:</strong> UI components and navigation must be operable through various input methods.</li>
          <li><strong>Understandable:</strong> Information and the operation of the user interface must be understandable.</li>
          <li><strong>Robust:</strong> Content must be robust enough to be interpreted by a variety of assistive technologies.</li>
        </ul>
        <p class="example-content">This expandable section demonstrates how to present guidelines or instructional content that might be too lengthy for initial display.</p>
      </div>
    </div>
  </main>

  <script>
    // Initialize all expandable widgets
    document.querySelectorAll('.expandable').forEach(button => {
      button.addEventListener('click', function(event) {
        event.preventDefault();
        
        const isExpanded = this.getAttribute('aria-expanded') === 'true';
        const contentId = this.getAttribute('aria-controls');
        const content = document.getElementById(contentId);
        
        // Toggle expanded state
        this.setAttribute('aria-expanded', !isExpanded);
        content.setAttribute('aria-hidden', isExpanded);
        
        // Focus management: when expanding, focus the content
        if (!isExpanded) {
          // Small delay to allow the content to render before focusing
          setTimeout(() => {
            content.focus();
          }, 100);
        }
        
        // Handle Escape key to close
        function handleEscape(event) {
          if (event.key === 'Escape' && !isExpanded) {
            this.setAttribute('aria-expanded', 'false');
            content.setAttribute('aria-hidden', 'true');
            this.focus();
          }
        }
        
        // Add escape listener when expanded
        if (!isExpanded) {
          document.addEventListener('keydown', handleEscape.bind(this));
          
          // Clean up listener when closed
          const cleanup = () => {
            document.removeEventListener('keydown', handleEscape);
            document.removeEventListener('click', cleanup);
          };
          
          // Also close when clicking outside
          document.addEventListener('click', cleanup);
        }
      });
      
      // Handle keyboard navigation
      button.addEventListener('keydown', function(event) {
        const isExpanded = this.getAttribute('aria-expanded') === 'true';
        const contentId = this.getAttribute('aria-controls');
        const content = document.getElementById(contentId);
        
        if (event.key === 'Enter' || event.key === ' ') {
          event.preventDefault();
          this.click();
        }
        
        if (event.key === 'ArrowDown' && isExpanded) {
          event.preventDefault();
          content.querySelector('p, ul')?.focus();
        }
        
        if (event.key === 'ArrowUp' && isExpanded) {
          event.preventDefault();
          content.focus();
        }
      });
    });
  </script>
</body>
</html>