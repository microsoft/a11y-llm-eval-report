<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Contact form - Contact - Example Site</title>
  <style>
    /* Design tokens (use these tokens for all colors) */
    :root{
      --color-bg: #ffffff;
      --color-text: #0b0b0b;
      --color-muted-text: #3c3c3c; /* ensure contrast */
      --color-border: #cfcfcf;
      --color-focus: #004ea3; /* strong blue for focus ring */
      --color-danger: #b00020; /* error color */
      --color-success: #007a3d;
      --color-link: #0b66ff;
      --radius: 6px;
      --max-width: 640px;
      --field-padding: 12px;
      --font-family: system-ui, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }

    /* Basic reset and layout */
    html,body{
      height:100%;
      margin:0;
      background:var(--color-bg);
      color:var(--color-text);
      font-family:var(--font-family);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.4;
      font-size:16px;
    }

    /* Provide a skip link; visible when focused */
    .sr-only:not(:focus):not(:active){
      clip: rect(0 0 0 0);
      clip-path: inset(50%);
      height:1px;
      overflow:hidden;
      position:absolute;
      white-space:nowrap;
      width:1px;
    }

    header{
      border-bottom:1px solid var(--color-border);
      padding:12px 16px;
    }

    nav{
      padding:8px 16px;
      background:transparent;
    }

    main{
      padding:24px 16px;
      display:flex;
      justify-content:center;
    }

    .container{
      width:100%;
      max-width:var(--max-width);
      box-sizing:border-box;
    }

    h1{
      margin:0 0 16px 0;
      font-size:1.5rem;
    }

    form{
      background:transparent;
      padding:0;
      margin:0;
    }

    .form-field{
      margin-bottom:16px;
      display:block;
    }

    label{
      display:inline-block;
      margin-bottom:6px;
      font-weight:600;
      color:var(--color-text);
    }

    /* Required star */
    .required-indicator{
      color:var(--color-danger);
      margin-left:6px;
      font-weight:700;
    }

    input[type="text"],
    input[type="email"],
    input[type="tel"]{
      display:block;
      width:100%;
      box-sizing:border-box;
      padding:var(--field-padding);
      font-size:1rem;
      border:1px solid var(--color-border);
      border-radius:var(--radius);
      background-color:transparent;
      color:var(--color-text);
    }

    /* Ensure long values wrap and do not overflow */
    input{
      min-width:0;
    }

    /* Helper text */
    .helper-text{
      display:block;
      margin-top:6px;
      color:var(--color-muted-text);
      font-size:0.9375rem;
    }

    /* Error message */
    .error-message{
      margin-top:6px;
      color:var(--color-danger);
      font-size:0.95rem;
    }

    /* Submit button */
    .form-actions{
      margin-top:20px;
    }

    button[type="submit"]{
      background:var(--color-link);
      color:white;
      padding:10px 16px;
      border-radius:6px;
      border:0;
      cursor:pointer;
      font-size:1rem;
    }

    button[type="submit"]:hover{
      filter:brightness(.95);
    }

    button[type="submit"]:disabled{
      opacity:0.6;
      cursor:not-allowed;
    }

    /* Focus styles - strong visible focus for keyboard users */
    :focus{
      outline: none;
    }

    input:focus,
    button:focus,
    a:focus{
      box-shadow: 0 0 0 4px rgba(0,78,163,0.12);
      outline: 3px solid var(--color-focus); /* ensures contrast with adjacent colors */
      outline-offset: 2px;
    }

    /* Small responsive tweaks to ensure reflow at 320px */
    @media (max-width: 420px){
      .container{
        padding-left:8px;
        padding-right:8px;
      }
      h1{ font-size:1.25rem; }
    }

    /* High contrast / forced colors support */
    @media (forced-colors: active) {
      :root {
        /* let system colors handle most contrasts */
      }
      input, button{
        border:1px solid ButtonBorder;
        background: Canvas;
        color: CanvasText;
      }
      button[type="submit"]{
        background: ButtonFace;
        color: ButtonText;
      }
      /* Ensure focus is visible */
      :focus {
        outline: 2px solid Highlight;
        outline-offset: 1px;
      }
      .error-message{
        color: LinkText; /* use system color for readability */
      }
    }

    /* Keep layout clean */
    footer{
      border-top:1px solid var(--color-border);
      padding:12px 16px;
      font-size:0.9rem;
      color:var(--color-muted-text);
    }

    /* Success message */
    .success-message{
      margin-top:12px;
      color:var(--color-success);
      font-weight:600;
    }
  </style>
</head>
<body>
  <header>
    <a href="#maincontent" class="sr-only">Skip to main content</a>
    <div style="display:flex;align-items:center;gap:12px;">
      <strong>Example Site</strong>
    </div>
  </header>

  <nav aria-label="Primary">
    <ul style="list-style:none;margin:8px 16px;padding:0;display:flex;gap:12px;">
      <li><a href="#" style="color:var(--color-link);text-decoration:none;">Home</a></li>
      <li><a href="#" style="color:var(--color-link);text-decoration:none;">Contact</a></li>
    </ul>
  </nav>

  <main id="maincontent" tabindex="-1">
    <div class="container">
      <h1>Contact us</h1>

      <form id="contactForm" novalidate aria-describedby="form-instructions">
        <p id="form-instructions" style="margin-top:0;color:var(--color-muted-text);font-size:0.95rem;">
          We’ll only use this information to respond to your request. Fields marked with an asterisk are required.
        </p>

        <div class="form-field">
          <label for="fullName">Full Name
            <span class="required-indicator" aria-hidden="true">*</span>
          </label>
          <input id="fullName" name="fullName" type="text" required aria-required="true" aria-describedby="fullName-help" autocomplete="name" />
          <div id="fullName-help" class="helper-text">Enter your first and last name as you would like us to address you.</div>
          <!-- Error container (inserted dynamically if needed) -->
        </div>

        <div class="form-field">
          <label for="email">Email Address
            <span class="required-indicator" aria-hidden="true">*</span>
          </label>
          <input id="email" name="email" type="email" required aria-required="true" aria-describedby="email-help" autocomplete="email" />
          <div id="email-help" class="helper-text">Expected format: name@example.com — we will send a confirmation to this address.</div>
        </div>

        <div class="form-field">
          <label for="phone">Phone Number
            <span style="font-weight:600;color:var(--color-muted-text);font-size:0.95rem;margin-left:6px;">(optional)</span>
          </label>
          <input id="phone" name="phone" type="tel" aria-describedby="phone-help" pattern="^\+?[0-9\s\-\(\)]{7,}$" title="Preferably include country code, e.g. +1 555-555-5555" autocomplete="tel" />
          <div id="phone-help" class="helper-text">Preferred format: include country code if possible, for example: +1 555-555-5555.</div>
        </div>

        <div class="form-actions">
          <button type="submit" id="submitBtn">Submit</button>
        </div>

        <div id="formMessage" role="status" aria-live="polite" style="min-height:1.2em;"></div>
      </form>
    </div>
  </main>

  <footer>
    <div>© Example Site</div>
  </footer>

  <script>
    (function(){
      // Strict mode for predictable behavior
      'use strict';

      const form = document.getElementById('contactForm');
      const submitBtn = document.getElementById('submitBtn');
      const formMessage = document.getElementById('formMessage');

      /**
       * Utility: create or return existing error element for a field
       * Error element will have id `${field.id}-error` and role="alert" (assertive) for immediate announcement.
       */
      function showFieldError(input, message) {
        let errorId = input.id + '-error';
        let errorEl = document.getElementById(errorId);
        if (!errorEl) {
          errorEl = document.createElement('div');
          errorEl.className = 'error-message';
          errorEl.id = errorId;
          errorEl.setAttribute('role', 'alert'); // announces to assistive tech
          // Insert after the helper text if present, otherwise after input
          const parent = input.parentElement;
          const helper = parent.querySelector('.helper-text');
          if (helper && helper.nextSibling) {
            helper.parentNode.insertBefore(errorEl, helper.nextSibling);
          } else {
            input.insertAdjacentElement('afterend', errorEl);
          }
        }
        errorEl.textContent = message;
        // Mark input invalid for accessibility
        input.setAttribute('aria-invalid', 'true');

        // Ensure aria-describedby includes both helper (if any) and error
        const describedBy = Array.from(new Set([...(input.getAttribute('aria-describedby') || '').split(/\s+/).filter(Boolean), errorId])).join(' ');
        input.setAttribute('aria-describedby', describedBy);
      }

      function clearFieldError(input) {
        const errorId = input.id + '-error';
        const errorEl = document.getElementById(errorId);
        if (errorEl) {
          errorEl.parentNode.removeChild(errorEl);
        }
        input.removeAttribute('aria-invalid');

        // Remove error id from aria-describedby but preserve helper text ids
        const current = (input.getAttribute('aria-describedby') || '').split(/\s+/).filter(Boolean).filter(id => id !== errorId);
        if (current.length > 0) {
          input.setAttribute('aria-describedby', current.join(' '));
        } else {
          input.removeAttribute('aria-describedby');
        }
      }

      // Validate a single input using browser validity but give custom messages
      function validateInput(input) {
        // Skip validation for inputs that are hidden/disabled
        if (input.disabled || input.hidden) return null;

        // Clear previous error first
        clearFieldError(input);

        // For required fields, let browser handle missing value
        if (input.hasAttribute('required') && !input.value.trim()) {
          const labelText = getLabelText(input) || 'This field';
          const msg = labelText + ' is required.';
          showFieldError(input, msg);
          return msg;
        }

        // If there's a value but pattern/type invalid, use validation message or custom message
        if (input.value.trim()) {
          if (input.type === 'email') {
            // Use browser validity for email
            if (!input.checkValidity()) {
              const msg = 'Enter a valid email address in the format name@example.com.';
              showFieldError(input, msg);
              return msg;
            }
          } else if (input.getAttribute('pattern')) {
            // Pattern applies only when value present
            if (!input.checkValidity()) {
              const custom = input.getAttribute('title') || 'The value does not match the expected format.';
              showFieldError(input, custom);
              return custom;
            }
          }
        }

        // Valid
        clearFieldError(input);
        return null;
      }

      function getLabelText(input){
        const id = input.id;
        if (!id) return null;
        const label = document.querySelector('label[for="' + CSS.escape(id) + '"]');
        if (label) {
          // Return visible label text without the required indicator
          const clone = label.cloneNode(true);
          // Remove required indicator if present
          const req = clone.querySelector('.required-indicator');
          if (req) req.remove();
          return clone.textContent.trim();
        }
        return null;
      }

      // Validate on input/change and clear errors as user types
      const inputs = Array.from(form.querySelectorAll('input'));
      inputs.forEach(inp => {
        inp.addEventListener('input', function(){
          // Don't run expensive validations on every keystroke for complex fields, but this is small
          validateInput(inp);
        });

        inp.addEventListener('blur', function(){
          validateInput(inp);
        });
      });

      form.addEventListener('submit', function(evt){
        evt.preventDefault();
        formMessage.textContent = '';
        formMessage.className = '';
        let firstInvalid = null;
        let anyErrors = false;

        // Validate all inputs
        inputs.forEach(inp => {
          const err = validateInput(inp);
          if (err && !firstInvalid) {
            firstInvalid = inp;
            anyErrors = true;
          }
        });

        if (anyErrors) {
          // Focus the first invalid control
          if (firstInvalid) {
            firstInvalid.focus();
          }
          formMessage.textContent = 'Please correct the highlighted fields and try again.';
          formMessage.style.color = 'var(--color-danger)';
          formMessage.setAttribute('aria-live','assertive');
          return;
        }

        // Simulate successful submission (replace with real submit logic)
        submitBtn.disabled = true;
        submitBtn.setAttribute('aria-busy', 'true');

        setTimeout(() => {
          submitBtn.disabled = false;
          submitBtn.removeAttribute('aria-busy');
          form.reset();

          // Remove any lingering errors
          inputs.forEach(clearFieldError);

          formMessage.textContent = 'Thanks — your message has been sent.';
          formMessage.style.color = 'var(--color-success)';
          formMessage.className = 'success-message';

          // Move focus to the form message for assistive tech
          formMessage.focus && formMessage.focus();
        }, 700);
      });

      // Ensure formMessage is focusable for screen readers to move focus to it programmatically when needed
      formMessage.tabIndex = -1;

      // Ensure skip link works: when clicked, focus main content
      const skipLink = document.querySelector('a[href="#maincontent"]');
      if (skipLink) {
        skipLink.addEventListener('click', function(e){
          const main = document.getElementById('maincontent');
          if (main) {
            main.focus();
          }
        });
      }
    })();
  </script>
</body>
</html>