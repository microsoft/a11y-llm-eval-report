<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Contact form - Contact - Example</title>
  <style>
    /* Design tokens (use these only) */
    :root{
      --color-bg: #ffffff;
      --color-text: #0b0b0b;
      --color-muted-text: #2f4f4f; /* high contrast muted */
      --color-link: #0b61d3;
      --color-border: #cfd8dd;
      --color-focus: #ffbf47;
      --color-danger: #b40e0e;
      --color-success: #007a3d;
      --max-width: 720px;
      --container-padding: 16px;
      --radius: 8px;
      --input-padding: 12px;
      --font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    /* Basic reset and layout */
    html,body{
      height:100%;
      margin:0;
      background:var(--color-bg);
      color:var(--color-text);
      font-family:var(--font-family);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.4;
    }

    header, nav, main, footer {
      display:block;
    }

    .page {
      display:flex;
      min-height:100vh;
      flex-direction:column;
    }

    header {
      border-bottom:1px solid var(--color-border);
      background: transparent;
    }

    .header-inner {
      max-width:var(--max-width);
      margin:0 auto;
      padding:12px var(--container-padding);
      display:flex;
      align-items:center;
      gap:12px;
    }

    .brand {
      font-weight:600;
      color:var(--color-text);
      text-decoration:none;
    }

    /* Skip link - first focusable element (visible on focus) */
    .sr-only:not(:focus):not(:active) {
      clip: rect(0 0 0 0);
      clip-path: inset(50%);
      height: 1px;
      overflow: hidden;
      position: absolute;
      white-space: nowrap;
      width: 1px;
    }

    .skip-link {
      margin:0;
      padding:8px 12px;
      background:var(--color-link);
      color:white;
      border-radius:4px;
      display:inline-block;
      text-decoration:none;
      font-weight:600;
    }

    /* Main container */
    main {
      flex:1 0 auto;
      display:flex;
      justify-content:center;
      align-items:flex-start;
      padding:24px var(--container-padding);
    }

    .card {
      width:100%;
      max-width:var(--max-width);
      background: #fff;
      border:1px solid var(--color-border);
      border-radius:var(--radius);
      padding:20px;
      box-sizing:border-box;
      box-shadow: 0 1px 3px rgba(0,0,0,0.04);
    }

    h1 {
      margin:0 0 12px 0;
      font-size:1.5rem;
    }

    form {
      display:flex;
      flex-direction:column;
      gap:16px;
    }

    .form-field {
      display:flex;
      flex-direction:column;
      gap:6px;
      min-width:0; /* important for flex children and long content */
    }

    label {
      font-weight:600;
      color:var(--color-text);
    }

    .required-marker {
      color:var(--color-danger);
      margin-left:6px;
      font-weight:700;
    }

    .sr-only {
      position:absolute!important;
      height:1px; width:1px;
      overflow:hidden;
      clip:rect(1px, 1px, 1px, 1px);
      white-space:nowrap;
    }

    input[type="text"],
    input[type="email"],
    input[type="tel"] {
      font-size:1rem;
      padding:var(--input-padding);
      border:1px solid var(--color-border);
      border-radius:6px;
      background:transparent;
      color:var(--color-text);
      outline: none;
      box-sizing:border-box;
      transition:box-shadow .08s, border-color .08s;
      min-height:44px;
    }

    input::placeholder {
      color:var(--color-muted-text);
      opacity:0.9;
    }

    /* Focus styles meet contrast and visible */
    input:focus, button:focus {
      box-shadow: 0 0 0 4px rgba(255,191,71,0.15);
      border-color:var(--color-focus);
      outline: 3px solid transparent; /* ensure forced colors can show outline */
      border-radius:6px;
    }

    /* Buttons */
    .actions {
      display:flex;
      gap:12px;
      justify-content:flex-start;
      align-items:center;
      flex-wrap:wrap;
    }

    button {
      background:var(--color-link);
      color:white;
      border:1px solid var(--color-link);
      padding:10px 16px;
      font-size:1rem;
      border-radius:6px;
      cursor:pointer;
      min-height:44px;
    }

    button:hover {
      filter:brightness(.95);
    }

    button:active {
      transform:translateY(1px);
    }

    .helper {
      margin:0;
      color:var(--color-muted-text);
      font-size:0.95rem;
    }

    .helper small {
      display:block;
      color:var(--color-muted-text);
    }

    .error {
      color:var(--color-danger);
      font-size:0.95rem;
      margin-top:4px;
    }

    .status-success {
      color:var(--color-success);
      font-weight:600;
    }

    /* Ensure that link and focus boundaries meet 3:1 */
    a:focus {
      outline: 3px dashed var(--color-focus);
      outline-offset:3px;
    }

    footer {
      border-top:1px solid var(--color-border);
      padding:12px var(--container-padding);
      background: transparent;
      text-align:center;
      font-size:0.9rem;
      color:var(--color-muted-text);
    }

    /* Responsive behavior for reflow at 320px */
    @media (max-width:420px) {
      .header-inner, .card {
        padding-left:12px;
        padding-right:12px;
      }
      h1 { font-size:1.25rem; }
    }

    /* Respect Forced Colors / High Contrast mode */
    @media (forced-colors: active) {
      input:focus, button:focus {
        box-shadow:none;
        border:2px solid ButtonText;
        outline: 3px solid ButtonText;
      }
      button {
        border:2px solid ButtonBorder;
        background: ButtonFace;
        color: ButtonText;
      }
      .skip-link {
        border:2px solid ButtonBorder;
        background: ButtonFace;
        color: ButtonText;
      }
    }

    /* Prevent long strings from overflowing */
    .form-field { overflow-wrap:anywhere; word-break:break-word; }

  </style>
</head>
<body>
  <div class="page">
    <header>
      <div class="header-inner">
        <a href="#maincontent" class="skip-link sr-only">Skip to main content</a>
        <a class="brand" href="#" aria-label="Example site home">Example</a>
      </div>
    </header>

    <main id="maincontent" tabindex="-1" role="main" aria-labelledby="contact-title">
      <div class="card" role="region" aria-labelledby="contact-title">
        <h1 id="contact-title">Contact us</h1>

        <form id="contact-form" novalidate aria-describedby="form-instructions">
          <p id="form-instructions" class="helper">We respond to all messages within 3 business days. Fields marked with * are required.</p>

          <!-- Full Name (required) -->
          <div class="form-field">
            <label for="full-name">
              Full Name
              <span class="required-marker" aria-hidden="true">*</span>
              <span class="sr-only"> required</span>
            </label>
            <input id="full-name" name="full-name" type="text" autocomplete="name"
                   placeholder="First and last name"
                   aria-required="true" aria-describedby="" />
            <!-- Error placeholder will be inserted dynamically -->
          </div>

          <!-- Email Address (required, with helper) -->
          <div class="form-field">
            <label for="email">
              Email Address
              <span class="required-marker" aria-hidden="true">*</span>
              <span class="sr-only"> required</span>
            </label>
            <input id="email" name="email" type="email" inputmode="email" autocomplete="email"
                   placeholder="you@example.com"
                   aria-required="true"
                   aria-describedby="email-help" />
            <p id="email-help" class="helper">Please use a valid email address (for example: user@example.com).</p>
          </div>

          <!-- Phone Number (optional, with helper) -->
          <div class="form-field">
            <label for="phone">
              Phone Number
              <span class="sr-only"> optional</span>
            </label>
            <input id="phone" name="phone" type="tel" inputmode="tel" autocomplete="tel"
                   placeholder="+1 555-555-5555"
                   aria-required="false"
                   aria-describedby="phone-help" />
            <p id="phone-help" class="helper">Preferred format: country code and number, e.g. +1 555-555-5555. Providing a phone helps us contact you faster but is optional.</p>
          </div>

          <div class="actions">
            <button type="submit" id="submit-button">Send message</button>
            <div id="form-status" aria-live="polite" role="status" class="helper" style="align-self:center;"></div>
          </div>
        </form>
      </div>
    </main>

    <footer>
      <p>&copy; <span id="year"></span> Example — All rights reserved.</p>
    </footer>
  </div>

  <script>
    (function(){
      // Final verification checklist (programmatic steps satisfied in code):
      // - Landmarks: header, main, footer present
      // - One h1 inside main: yes (id=contact-title)
      // - Skip link present as first focusable element (in header)
      // - Controls have visible labels and programmatic association via for + id
      // - Required fields: aria-required used and visible marker provided
      // - Helper text associated via aria-describedby
      // - Errors are inserted and associated via aria-describedby and aria-invalid
      // - Focus first invalid field on submit
      // - Keyboard operable; focus styles visible
      // - Reflow-friendly styles and fluid widths
      // - Forced colors: handled with media query

      var form = document.getElementById('contact-form');
      var fullName = document.getElementById('full-name');
      var email = document.getElementById('email');
      var phone = document.getElementById('phone');
      var status = document.getElementById('form-status');
      var year = document.getElementById('year');
      year.textContent = new Date().getFullYear();

      // Helper - create error node
      function createErrorNode(id, message){
        var d = document.createElement('div');
        d.className = 'error';
        d.id = id;
        d.setAttribute('role','alert');
        d.textContent = message;
        return d;
      }

      // Utility to add an error to a field
      function showFieldError(field, message){
        clearFieldError(field);
        var errorId = field.id + '-error';
        var errorNode = createErrorNode(errorId, message);

        // Append after the field (which is inside .form-field)
        var container = field.closest('.form-field');
        if (container) {
          container.appendChild(errorNode);
        } else {
          field.parentNode.appendChild(errorNode);
        }

        // Manage aria-describedby: include existing helper(s) plus error id
        var describedBy = [];
        var prev = field.getAttribute('aria-describedby');
        if (prev) {
          describedBy = prev.split(/\s+/).filter(Boolean);
        }
        if (describedBy.indexOf(errorId) === -1) describedBy.push(errorId);
        field.setAttribute('aria-describedby', describedBy.join(' '));

        field.setAttribute('aria-invalid','true');
      }

      function clearFieldError(field){
        var errorId = field.id + '-error';
        var existing = document.getElementById(errorId);
        if (existing && existing.parentNode) existing.parentNode.removeChild(existing);

        // Remove error id from aria-describedby but keep helpers
        var describedBy = (field.getAttribute('aria-describedby') || '').split(/\s+/).filter(Boolean);
        describedBy = describedBy.filter(function(d){ return d !== errorId; });
        if (describedBy.length) field.setAttribute('aria-describedby', describedBy.join(' '));
        else field.removeAttribute('aria-describedby');

        field.removeAttribute('aria-invalid');
      }

      function clearAllErrors(){
        [fullName, email, phone].forEach(clearFieldError);
        status.textContent = '';
        status.className = 'helper';
      }

      // Simple phone validation (optional). Accepts digits, spaces, hyphens, parentheses, leading +.
      function validatePhoneValue(val){
        if (!val) return true; // optional
        // A loose validation: must have between 7 and 15 digits total
        var digits = val.replace(/\D/g,'');
        return digits.length >= 7 && digits.length <= 15;
      }

      // Focus management: focus first invalid control and bring it into view
      function focusFirstInvalid(){
        var invalid = form.querySelector('[aria-invalid="true"]');
        if (invalid) {
          invalid.focus();
          // If focus couldn't land on input (rare), set tabindex -1 on parent and focus that
          if (document.activeElement !== invalid) {
            invalid.setAttribute('tabindex','-1');
            invalid.focus();
            // remove temporary tabindex after focus
            invalid.addEventListener('blur', function cleanup(){ invalid.removeAttribute('tabindex'); invalid.removeEventListener('blur',cleanup); });
          }
        }
      }

      // Validate one field, return true if valid
      function validateField(field){
        clearFieldError(field);
        var val = field.value.trim();

        if (field === fullName) {
          if (!val) {
            showFieldError(field, 'Please enter your full name.');
            return false;
          }
          return true;
        }

        if (field === email) {
          if (!val) {
            showFieldError(field, 'Please enter your email address.');
            return false;
          }
          // Basic email validation using browser's email pattern via a temporary input
          var temp = document.createElement('input');
          temp.type = 'email';
          temp.value = val;
          if (!temp.checkValidity()) {
            showFieldError(field, 'Please enter a valid email address, for example user@example.com.');
            return false;
          }
          return true;
        }

        if (field === phone) {
          if (!val) return true; // optional
          if (!validatePhoneValue(val)) {
            showFieldError(field, 'Please enter a valid phone number (e.g., +1 555-555-5555).');
            return false;
          }
          return true;
        }

        return true;
      }

      // Validate all fields and return boolean
      function validateAll(){
        clearAllErrors();
        var valid = true;
        // Validate required fields first so we can focus first invalid
        if (!validateField(fullName)) valid = false;
        if (!validateField(email)) valid = false;
        if (!validateField(phone)) valid = false;
        return valid;
      }

      // On submit
      form.addEventListener('submit', function(evt){
        evt.preventDefault();
        status.textContent = '';
        status.className = 'helper';

        var ok = validateAll();
        if (!ok) {
          // Focus first invalid input
          focusFirstInvalid();
          // Announce form-level message
          status.textContent = 'There are errors in the form. The first invalid field has been focused.';
          status.className = 'error';
          return;
        }

        // Simulate successful submission
        status.textContent = 'Sending…';
        status.className = 'helper';

        // Simulate network delay
        setTimeout(function(){
          form.reset();
          clearAllErrors();
          status.textContent = 'Message sent. Thank you — we will reply within 3 business days.';
          status.className = 'status-success';
          // Move focus to status so screen reader users get feedback
          status.setAttribute('tabindex','-1');
          status.focus();
          // remove tabindex after blur
          status.addEventListener('blur', function cleanup(){ status.removeAttribute('tabindex'); status.removeEventListener('blur',cleanup); });
        }, 600);
      });

      // Validate on blur for each field to give immediate feedback
      [fullName, email, phone].forEach(function(field){
        field.addEventListener('blur', function(){
          validateField(field);
        });
        // Remove error on input
        field.addEventListener('input', function(){
          if (field.hasAttribute('aria-invalid')) {
            // Live validation: re-check and remove error if valid
            validateField(field);
          }
        });
      });

      // Ensure keyboard users can reach main content after skip link
      // The skip link points to #maincontent already; the main has tabindex -1 (so focusable programmatically)
      // Nothing else needed here.

      // Expose nothing to global scope
    })();
  </script>
</body>
</html>