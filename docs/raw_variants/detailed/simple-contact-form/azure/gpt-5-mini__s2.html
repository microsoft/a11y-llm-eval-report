<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Contact form - Contact - Example Site</title>

  <style>
    :root{
      /* Color tokens (safe defaults) */
      --color-bg: #ffffff;
      --color-text: #0a0a0a;
      --color-muted-text: #3a3a3a; /* ensure 4.5:1 for smaller text */
      --color-link: #0b66ff;
      --color-border: #d1d5db;
      --color-focus: #005fcc;
      --color-danger: #b00020;
      --color-success: #006644;
      --radius: 6px;
      --control-padding: 0.6rem 0.75rem;
      --max-width: 680px;
      --gap: 1rem;
    }

    html,body{
      height:100%;
      margin:0;
      background:var(--color-bg);
      color:var(--color-text);
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.4;
    }

    /* Accessible "skip to main" link */
    .sr-only:not(:focus):not(:active) {
      clip: rect(0 0 0 0);
      clip-path: inset(50%);
      height: 1px;
      overflow: hidden;
      position: absolute;
      white-space: nowrap;
      width: 1px;
    }
    .sr-only:focus, .sr-only:active {
      position: static;
      width: auto;
      height: auto;
      clip: auto;
      clip-path: none;
      padding: 0.5rem 1rem;
      margin: 0.5rem;
      background: var(--color-bg);
      color: var(--color-text);
      border: 2px solid var(--color-focus);
      border-radius: 4px;
      text-decoration: none;
    }

    header, nav, main, footer { padding: 1rem; }

    .site {
      display:flex;
      flex-direction:column;
      min-height:100vh;
    }

    header {
      border-bottom: 1px solid var(--color-border);
      background: color-mix(in srgb, var(--color-bg) 90%, black 0%); /* no-op to avoid forcing colors but keeps tokens used */
    }

    .container {
      width: 100%;
      max-width: var(--max-width);
      margin: 0 auto;
    }

    nav ul {
      list-style:none;
      padding:0;
      margin:0.5rem 0 0;
      display:flex;
      gap: 1rem;
      flex-wrap:wrap;
    }
    nav a {
      color: var(--color-link);
      text-decoration: none;
      border-bottom: 2px solid transparent;
    }
    nav a:focus, nav a:hover {
      outline: none;
      border-bottom-color: color-mix(in srgb, var(--color-link) 80%, var(--color-bg) 20%);
    }

    main {
      flex:1;
      padding-top: 1rem;
    }

    h1 {
      font-size: 1.5rem;
      margin: 0 0 0.5rem 0;
    }

    form {
      background: transparent;
    }

    .card {
      background: color-mix(in srgb, var(--color-bg) 100%, black 0%);
      border: 1px solid var(--color-border);
      border-radius: var(--radius);
      padding: 1rem;
    }

    .form-grid {
      display:flex;
      flex-direction:column;
      gap: var(--gap);
    }

    .form-field {
      display:flex;
      flex-direction:column;
      gap: 0.375rem;
      min-width:0; /* allow inputs to shrink properly */
    }

    label {
      font-weight:600;
      font-size: 0.95rem;
      color:var(--color-text);
      display:flex;
      gap:0.25rem;
      align-items:center;
    }

    .required-indicator {
      color: var(--color-danger);
      font-weight:700;
      margin-left:0.125rem;
      font-size: 1rem;
    }

    input[type="text"],
    input[type="email"],
    input[type="tel"] {
      padding: var(--control-padding);
      border: 1px solid var(--color-border);
      border-radius: 6px;
      font-size: 1rem;
      color: var(--color-text);
      background: var(--color-bg);
      outline: none;
      width:100%;
      box-sizing:border-box;
      transition: box-shadow 120ms ease, border-color 120ms ease;
      min-height: 44px;
    }

    input::placeholder { color: var(--color-muted-text); opacity: 1; }

    input:focus {
      border-color: var(--color-focus);
      box-shadow: 0 0 0 3px color-mix(in srgb, var(--color-focus) 16%, var(--color-bg) 84%);
      outline: 2px solid transparent; /* for forced-colors fallback */
    }

    .helper {
      font-size: 0.88rem;
      color: var(--color-muted-text);
    }

    .error {
      color: var(--color-danger);
      font-size: 0.9rem;
      display:none;
    }

    .error[aria-hidden="false"] {
      display:block;
    }

    .controls {
      display:flex;
      gap: 0.75rem;
      margin-top: 0.5rem;
      align-items:center;
      flex-wrap:wrap;
    }

    button[type="submit"]{
      background: var(--color-link);
      color: #fff;
      padding: 0.6rem 1rem;
      border-radius: 6px;
      border: none;
      cursor:pointer;
      font-weight:600;
      font-size: 1rem;
      min-height:44px;
      box-shadow: none;
    }
    button[type="submit"]:focus {
      outline: 3px solid var(--color-focus);
      outline-offset: 2px;
    }
    button[type="submit"]:hover {
      filter:brightness(0.95);
    }

    /* Success region */
    .status {
      margin-top: 0.75rem;
      color: var(--color-success);
      font-weight:600;
    }

    /* Small screens: ensure reflow to single column and no horizontal scroll */
    @media (max-width: 520px) {
      :root { --gap: 0.75rem; }
      .container { padding-left: 0.75rem; padding-right: 0.75rem; }
    }

    /* Prevent long strings from forcing overflow */
    .form-field, label, input, .helper, .error {
      overflow-wrap: anywhere;
      word-break: break-word;
    }

    /* Forced colors (High Contrast) support */
    @media (forced-colors: active) {
      :root {
        /* rely on system colors */
      }
      body {
        background: Canvas;
        color: CanvasText;
      }
      input, button {
        background: Canvas;
        color: CanvasText;
        forced-color-adjust: auto;
      }
      input:focus {
        box-shadow: none;
        outline: 2px solid ButtonText; /* visible in HC mode */
      }
      button:focus {
        outline: 2px solid ButtonText;
      }
      .card {
        border: 1px solid ButtonBorder;
      }
    }

    /* Make focus styles more visible for keyboard users */
    :focus {
      caret-color: var(--color-focus);
    }

  </style>
</head>
<body>
  <div class="site">
    <header class="container" role="banner">
      <a href="#maincontent" class="sr-only">Skip to main content</a>
      <div style="display:flex;align-items:center;justify-content:space-between;">
        <div>
          <strong>Example Site</strong>
        </div>
        <nav aria-label="Primary" >
          <ul>
            <li><a href="#" tabindex="0">Home</a></li>
            <li><a href="#" tabindex="0">Contact</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <main id="maincontent" tabindex="-1" class="container" role="main">
      <h1>Contact us</h1>

      <section class="card" aria-labelledby="form-heading">
        <h2 id="form-heading" style="font-size:1rem;margin:0 0 0.5rem 0;">Send us a message</h2>

        <form id="contactForm" novalidate>
          <div class="form-grid" role="group" aria-labelledby="form-heading">

            <div class="form-field" id="field-fullname">
              <label for="fullName">Full Name <span class="required-indicator" aria-hidden="true">*</span></label>
              <input
                id="fullName"
                name="fullName"
                type="text"
                autocomplete="name"
                required
                aria-required="true"
                aria-describedby="fullName-helper"
                aria-invalid="false"
                placeholder="Your full name"
              />
              <p class="helper" id="fullName-helper">Please provide your first and last name.</p>
              <div class="error" id="fullName-error" role="alert" aria-hidden="true"></div>
            </div>

            <div class="form-field" id="field-email">
              <label for="email">Email Address <span class="required-indicator" aria-hidden="true">*</span></label>
              <input
                id="email"
                name="email"
                type="email"
                required
                aria-required="true"
                aria-describedby="email-help"
                aria-invalid="false"
                placeholder="name@example.com"
                autocomplete="email"
              />
              <p class="helper" id="email-help">Enter a valid email address (for example: name@example.com).</p>
              <div class="error" id="email-error" role="alert" aria-hidden="true"></div>
            </div>

            <div class="form-field" id="field-phone">
              <label for="phone">Phone Number <span style="font-size:0.9rem;color:var(--color-muted-text)">(optional)</span></label>
              <input
                id="phone"
                name="phone"
                type="tel"
                aria-describedby="phone-help"
                aria-invalid="false"
                placeholder="+1 555-555-5555"
                autocomplete="tel"
              />
              <p class="helper" id="phone-help">Preferred format: +1 555-555-5555. You can also use spaces, hyphens, or parentheses.</p>
              <div class="error" id="phone-error" role="alert" aria-hidden="true"></div>
            </div>

            <div class="controls">
              <button type="submit" id="submitBtn">Submit</button>
              <div id="form-status" class="status" role="status" aria-live="polite" hidden></div>
            </div>

          </div>
        </form>

      </section>

    </main>

    <footer class="container" role="contentinfo" aria-label="Footer">
      <p style="margin:0;font-size:0.9rem;color:var(--color-muted-text)">© Example Site</p>
    </footer>
  </div>

  <script>
    (function(){
      // Utility to manage describedby: ensure helper is always included
      function setDescribedBy(input, ids){
        var base = [];
        // keep existing helper if any
        var helper = input.getAttribute('aria-describedby') || '';
        // base will be rebuilt by ids argument
        input.setAttribute('aria-describedby', ids.join(' ').trim());
      }

      var form = document.getElementById('contactForm');
      var fullName = document.getElementById('fullName');
      var email = document.getElementById('email');
      var phone = document.getElementById('phone');

      var fullNameError = document.getElementById('fullName-error');
      var emailError = document.getElementById('email-error');
      var phoneError = document.getElementById('phone-error');

      var fullNameHelperId = 'fullName-helper';
      var emailHelperId = 'email-help';
      var phoneHelperId = 'phone-help';

      // Initialize aria-describedby to include helper ids
      fullName.setAttribute('aria-describedby', fullNameHelperId);
      email.setAttribute('aria-describedby', emailHelperId);
      phone.setAttribute('aria-describedby', phoneHelperId);

      // Phone validation regex: allows +, digits, spaces, parentheses, hyphens; require at least 7 chars if provided
      var phoneRegex = /^[+\d\s().-]{7,}$/;

      function clearError(input, errorEl, helperId){
        input.removeAttribute('aria-invalid');
        input.setAttribute('aria-invalid','false');
        errorEl.textContent = '';
        errorEl.setAttribute('aria-hidden','true');
        // ensure aria-describedby contains only the helper (no lingering error id)
        input.setAttribute('aria-describedby', helperId);
      }

      function showError(input, errorEl, helperId, msg){
        input.setAttribute('aria-invalid','true');
        errorEl.textContent = msg;
        errorEl.setAttribute('aria-hidden','false');
        // make screen readers know to read helper and error (helper first)
        input.setAttribute('aria-describedby', helperId + ' ' + errorEl.id);
      }

      function validateField(field){
        if(field === fullName){
          var val = fullName.value.trim();
          if(!val){
            showError(fullName, fullNameError, fullNameHelperId, 'Full name is required. Please enter your name.');
            return false;
          } else {
            clearError(fullName, fullNameError, fullNameHelperId);
            return true;
          }
        }

        if(field === email){
          var val = email.value.trim();
          if(!val){
            showError(email, emailError, emailHelperId, 'Email address is required. Please enter an email address.');
            return false;
          }
          // Use the browser's built-in email validity as primary check
          if(!email.checkValidity()){
            showError(email, emailError, emailHelperId, 'Please enter a valid email address (for example: name@example.com).');
            return false;
          }
          clearError(email, emailError, emailHelperId);
          return true;
        }

        if(field === phone){
          var val = phone.value.trim();
          if(!val){
            // optional and empty -> valid
            clearError(phone, phoneError, phoneHelperId);
            return true;
          }
          if(!phoneRegex.test(val)){
            showError(phone, phoneError, phoneHelperId, 'Phone format not recognized. Use digits and optional +, spaces, hyphens, or parentheses (e.g. +1 555-555-5555).');
            return false;
          }
          clearError(phone, phoneError, phoneHelperId);
          return true;
        }
        return true;
      }

      // Live validation on blur
      [fullName, email, phone].forEach(function(input){
        input.addEventListener('blur', function(){
          validateField(input);
        });
        input.addEventListener('input', function(){
          // clear error as user types to reduce cognitive load
          var errorEl = document.getElementById(input.id + '-error');
          var helperId = input.id === 'fullName' ? fullNameHelperId : input.id === 'email' ? emailHelperId : phoneHelperId;
          clearError(input, errorEl, helperId);
        });
      });

      form.addEventListener('submit', function(ev){
        ev.preventDefault();

        var firstInvalid = null;
        var okName = validateField(fullName);
        if(!okName && !firstInvalid) firstInvalid = fullName;
        var okEmail = validateField(email);
        if(!okEmail && !firstInvalid) firstInvalid = email;
        var okPhone = validateField(phone);
        if(!okPhone && !firstInvalid) firstInvalid = phone;

        if(firstInvalid){
          // Focus the first invalid control
          firstInvalid.focus();
          // If it's near the top, ensure main has focusable state for skip link target
          var main = document.getElementById('maincontent');
          if(main){
            // no-op; ensure main remains focusable
          }
          // Announce summary via status region (optional)
          var status = document.getElementById('form-status');
          status.hidden = false;
          status.textContent = 'There are errors in the form. The first error is focused.';
          return;
        }

        // If everything valid, simulate successful submission
        var status = document.getElementById('form-status');
        status.hidden = false;
        status.textContent = 'Thank you — your message has been submitted.';
        // Reset form for demo purposes (in real app, send to server)
        form.reset();
        // Clear any error states
        clearError(fullName, fullNameError, fullNameHelperId);
        clearError(email, emailError, emailHelperId);
        clearError(phone, phoneError, phoneHelperId);

        // Move focus to status for screen reader announcement
        status.focus?.();
      });

      // Ensure status region is focusable when used
      var formStatus = document.getElementById('form-status');
      formStatus.setAttribute('tabindex','-1');

    })();
  </script>
</body>
</html>